/*! For license information please see main.1396b447.chunk.js.LICENSE.txt */
(this.webpackJsonpslowroads=this.webpackJsonpslowroads||[]).push([[0],[,,,,,,,,,,,,,,,,function(e,t,i){},function(e,t,i){},function(e,t,i){},function(e,t,i){"use strict";i.r(t),t.default=i.p+"static/media/debug_body.193b9327.obj"},function(e,t,i){"use strict";i.r(t),t.default=i.p+"static/media/debug_wheel.291c4dc1.obj"},function(e,t,i){},,,,,,,,,,,,function(e,t,i){},function(e,t,i){"use strict";i.r(t),t.default=i.p+"static/media/mono_2.a6225cf4.obj"},function(e,t,i){"use strict";i.r(t),t.default=i.p+"static/media/mono_wheel.0c7cdca8.obj"},function(e,t,i){"use strict";i.r(t),t.default=i.p+"static/media/bus-02.07c5f9f2.obj"},function(e,t,i){"use strict";i.r(t),t.default=i.p+"static/media/bus-wheel.32095e6e.obj"},function(e,t,i){"use strict";i.r(t),t.default=i.p+"static/media/roadster-07-int.9a99909d.obj"},function(e,t,i){"use strict";i.r(t),t.default=i.p+"static/media/roadster_wheel_02.bbc40837.obj"},function(e,t,i){"use strict";i.r(t),t.default=i.p+"static/media/steering_wheel.9e78c67a.obj"},function(e,t,i){"use strict";i.r(t),t.default=i.p+"static/media/dashboard.fee32a07.obj"},function(e,t,i){"use strict";i.r(t),t.default=i.p+"static/media/marsrock.055b2928.obj"},function(e,t,i){},,function(e,t,i){},function(e,t,i){},function(e,t,i){},function(e,t,i){},function(e,t,i){},function(e,t,i){},function(e,t,i){},,,,,,function(e,t,i){"use strict";i.r(t);var s=i(2),n=i.n(s),a=i(22),o=i.n(a),r=(i(33),i(18),i(1)),h=i(23);class l{constructor(e=null,t=null){if(this.listeners=[],this.value=null,this.storageKey=null,this.default=null,this.value=e,this.default=e,this.storageKey=t,t&&localStorage.getItem(t))try{this.value=JSON.parse(localStorage.getItem(t)),"object"===typeof this.value&&(this.value={...e,...this.value},console.log(this.value))}catch(i){console.warn("Failed to load saved value for ",t)}}reset(){this.set(JSON.parse(JSON.stringify(this.default)))}set(e){this.value!==e&&(this.value=e,this.onChanged(this.value),this.storageKey&&localStorage.setItem(this.storageKey,JSON.stringify(this.value)))}onChanged(e){for(let t of this.listeners)t(e)}addListener(e){"function"===typeof e&&(this.listeners.includes(e)||this.listeners.push(e))}removeListener(e){let t=this.listeners.indexOf(e);t>=0&&this.listeners.splice(t,1)}}var d=new l(!0);var c={mouseWidgetHeight:24,mouseWidgetWidth:640,useMouse:!0};class p{constructor(e,t=null,i=((e,t)=>t)){this.listeners={any:[]},this.value={},this.default={},this.storageKey=null;for(let a in e)this.default[a]=JSON.parse(JSON.stringify(e[a]));this.storageKey=t;let s=!1;if(t&&localStorage.getItem(t))try{let n=i(t,JSON.parse(localStorage.getItem(t)));if(e)for(let t in e)t in n?(this.value[t]=n[t],this[t]=n[t]):(this.value[t]=e[t],this[t]=e[t]);else for(let e in n)this.value[e]=n[e],this[e]=n[e];s=!0}catch(n){console.warn("Failed to load saved value for ",t)}if(!s&&e)for(let a in e)this.value[a]=e[a],this[a]=e[a]}reset(){this.setMany(this.default)}setMany(e){for(let t in e)this.set(t,e[t],!0);for(let t in e)this.onChanged(t,this.value[t])}set(e,t,i=!1){e in this.value&&this.value[e]!==t&&(this.value[e]=t,this[e]=t,i||this.onChanged(e,this.value[e]),this.storageKey&&localStorage.setItem(this.storageKey,JSON.stringify(this.value)))}onChanged(e,t){for(let i of this.listeners[e]||[])i(t);for(let i of this.listeners.any||[])i(e)}addListener(e,t){"function"===typeof t&&(e in this.listeners||(this.listeners[e]=[]),this.listeners[e].push(t))}removeListener(e,t){if(!(e in this.listeners))return;let i=this.listeners[e].indexOf(t);i>=0&&this.listeners[e].splice(i,1)}}var u={Boolean:0,Enum:1,Integer:2,Float:3,IntegerRange:4,FloatRange:5};const g=new l({Forward:"0",Backward:"2",Boost:"0",Handbrake:"",ToggleHandbrake:"",Autodrive:"",Reset:"",Headlights:"",StickySteer:"",NextScene:"",PrevScene:"",CameraMode:"",Mute:"",Pause:"",ToggleUI:"",ToggleDebug:""},"controls_mouse"),m=new p({axisWidth:.5,steerSmoothing:.5,steerRange:.9,linearity:.25},"controls_mouse_settings"),x={axisWidth:{readable:"Steer bar width",desc:"Sets how much of the screen width is used for steering input",type:u.FloatRange,default:.5,min:.2,max:1,precision:2},steerSmoothing:{readable:"Steer smoothing",desc:"Applies gentle smoothing to the steering input",type:u.FloatRange,default:1,min:0,max:1,precision:2},steerRange:{readable:"Steer range",desc:"Alters the maximum steer angle",type:u.FloatRange,default:.9,min:.25,max:1,precision:2},linearity:{readable:"Steer linearity",desc:"Less linearity means more precision at small steer angles",type:u.FloatRange,default:.25,min:0,max:1,precision:2}},v={F3:!0,F4:!0,Tab:!0};var w=new class{constructor(){this.key={},this.keyHeld={},this.mouse={x:window.innerWidth/2,y:window.innerHeight/2},this.mouseDown=[],this.mouseScreen={x:0,y:0},this.mouseAxis={x:0,y:0},this.listeners={},this.scrollLock=null,this.mouseDidMove=!0,this.click={left:!1,right:!1},this.onMouseDownBound=this.onMouseDown.bind(this),this.onMouseUpBound=this.onMouseUp.bind(this),this.hideCursorInterval=null,this.onMouseMoveBound=this.onMouseMove.bind(this),this.scroll=0,this.scrollDelta=0,this.scrollFactor=-1,this.onScrollBound=this.onScroll.bind(this),this.scrollSense=.05,this.onKeyDownBound=e=>{this.onKeyDown(e)},this.onKeyDown=this.onKeyDownUnlocked,this.onKeyDownNull=()=>{},this.onKeyUpBound=e=>{this.onKeyUp(e)},this.onKeyUp=this.onKeyUpUnlocked,this.onKeyUpNull=()=>{},this.mouseEnabled=!0,this.keysLocked=!1,this.mouseWasEnabled=!0,this.halfScreen={x:window.innerWidth/2,y:window.innerHeight/2}}init(e,t){this.dom=e,this.canvas=t,this.dom.addEventListener("mousedown",this.onMouseDownBound,!1),this.dom.addEventListener("mouseup",this.onMouseUpBound,!1),this.dom.addEventListener("mousemove",this.onMouseMoveBound,!1),this.dom.addEventListener("wheel",this.onScrollBound,!1),this.dom.addEventListener("keydown",this.onKeyDownBound,!1),this.dom.addEventListener("keyup",this.onKeyUpBound,!1),setInterval((()=>{this.mouseDidMove?this.canvas.style.cursor="default":this.canvas.style.cursor="none",this.mouseDidMove=!1}),750)}destroy(){this.dom.removeEventListener("mousedown",this.onMouseDownBound,!1),this.dom.removeEventListener("mouseup",this.onMouseUpBound,!1),this.dom.removeEventListener("mousemove",this.onMouseMoveBound,!1),this.dom.removeEventListener("wheel",this.onScrollBound,!1),this.dom.removeEventListener("keydown",this.onKeyDownBound,!1),this.dom.removeEventListener("keyup",this.onKeyUpBound,!1)}addListener(e,t){e in this.listeners||(this.listeners[e]=[]),this.listeners[e].push(t)}removeListener(e,t){if(e in this.listeners){let i=this.listeners[e].indexOf(t);i>=0&&this.listeners[e].splice(i,1)}}onMouseDown(e){this.mouseEnabled&&(this.mouseDown[e.button]=!0,0==e.button?this.click.left=!0:2==e.button&&(this.click.right=!0),e.preventDefault())}onMouseUp(e){this.mouseEnabled&&(this.mouseDown[e.button]=!1,0==e.button?this.click.left=!1:2==e.button&&(this.click.right=!1),e.preventDefault())}onMouseMove(e){this.mouseEnabled&&(this.mouse.x=e.clientX,this.mouseWidth=Math.max(320,m.axisWidth*window.innerWidth),this.mouseScreen.x=Math.max(Math.min(1,(e.clientX-window.innerWidth/2)/window.innerWidth*2),-1),this.mouseAxis.x=Math.max(Math.min(1,(e.clientX-this.halfScreen.x)/this.mouseWidth*2),-1),this.mouse.y=e.clientY,this.mouseHeight=window.innerHeight*(c.mouseWidgetHeight/100),this.mouseScreen.y=-(e.clientY-window.innerHeight/2)/(window.innerHeight/2),this.mouseAxis.y=-(e.clientY-(this.halfScreen.y-this.mouseHeight)-this.halfScreen.y)/this.halfScreen.y*2,this.mouseDidMove||(this.canvas.style.cursor="default"),this.mouseDidMove=!0)}onScroll(e){this.scrollDelta=e.deltaY>0?1:-1,this.scroll+=this.scrollDelta*this.scrollSense,this.scroll=Math.min(Math.max(this.scroll,-1),1)}onKey(e){if(e in this.listeners){for(let t of this.listeners[e])t();return!0}return!1}onKeyDownUnlocked(e){this.key[e.code]=!0,(this.onKey(e.code)||v[e.code])&&e.preventDefault(),this.keyHeld[e.code]=!0}onKeyUpUnlocked(e){this.key[e.code]=!1,this.keyHeld[e.code]=!1}resetKeyState(){for(let e in this.key)this.key[e]=!1}setMouseEnabled(e){this.mouseEnabled=e,this.scroll=0,this.mouseAxis.x=0,this.mouseAxis.y=0;for(let t=0;t<this.mouseDown.length;t++)this.mouseDown[t]=!1;this.click.left=!1,this.click.right=!1}lockKeys(){this.keysLocked||(this.resetKeyState(),this.mouseWasEnabled=this.mouseEnabled,this.setMouseEnabled(!1),this.keysLocked=!0,this.onKeyDown=this.onKeyDownNull,this.onKeyUp=this.onKeyUpNull)}unlockKeys(){this.keysLocked&&(this.keysLocked=!1,this.setMouseEnabled(!0),this.onKeyDown=this.onKeyDownUnlocked,this.onKeyUp=this.onKeyUpUnlocked)}lockScroll(e){null==this.scrollLock&&(this.scrollLock=e)}unlockScroll(e){this.scrollLock==e&&(this.scrollLock=null)}setSize(e,t){this.halfScreen.x=e/2,this.halfScreen.y=t/2}};var f=class{static update(e,t){}};const b=new l({Forward:"KeyW",Left:"KeyA",Backward:"KeyS",Right:"KeyD",Boost:"ShiftLeft",Handbrake:"Space",ToggleHandbrake:"KeyB",Autodrive:"KeyF",Reset:"KeyR",Headlights:"KeyH",StickySteer:"KeyV",NextScene:"KeyE",PrevScene:"KeyQ",CameraMode:"KeyC",Mute:"KeyM",Pause:"KeyP",ToggleUI:"KeyU",ToggleCinecam:"KeyT",ToggleDebug:"F3",ToggleSpeedControl:"KeyZ",IncSpeedControl:"KeyI",DecSpeedControl:"KeyK"},"controls_keys"),A=new p({toggleBoost:!1,doubleTapBoost:!0,softSteer:!0,steerSpeed:1,recenterSpeed:2,lockedSteerSpeed:.6},"controls_keys_settings"),y={toggleBoost:{readable:"Boost Style",type:u.Boolean,default:!1,labels:["hold","toggle"]},doubleTapBoost:{readable:"Double-tap to boost",desc:"Engage boost by double-tapping forwards",type:u.Boolean,default:!0},softSteer:{readable:"Steer Input Style",desc:"Soft steering is more gentle; Quick steering is more direct",type:u.Boolean,default:!0,labels:["quick","soft"]},steerSpeed:{readable:"Steer Sensitivity",desc:"How quickly the wheels turn under input",type:u.FloatRange,default:1,min:.5,max:5},recenterSpeed:{readable:"Re-center Sensitivity",desc:"How quickly the wheels recenter when input is released",type:u.FloatRange,default:2,min:.5,max:5},lockedSteerSpeed:{readable:"Locked Steer Sensitivity",desc:"Steer sensitivity when using steer lock",type:u.FloatRange,default:.6,min:.25,max:1,precision:2}};let I;class S extends f{static update(e,t){I=b.value,t.Forward=0,t.Backward=0,t.Left=0,t.Right=0,t.Handbrake=0,t.StickySteer=0,t.Boost=0,w.key[I.Forward]&&(t.Forward=1),w.key[I.Backward]&&(t.Backward=1),w.key[I.Left]&&(t.Left=1),w.key[I.Right]&&(t.Right=1),w.key[I.Handbrake]&&(t.Handbrake=1),w.key[I.Boost]&&(t.Boost=1),w.key[I.StickySteer]&&(t.StickySteer=1)}}S.label="Keys";const M=[S,S,S];var D=new l(0,"config-controller-index");const C=new l({Translate:"WASD",Rotate:"Mouse Look",Elevate:"Left Click",Descend:"Right Click",Zoom:"Scrollwheel",DoubleSpeed:"ShiftLeft",ResetCamera:"G",MatchSpeed:"CapsLock",ToggleCinecam:"T (default)"}),N=new p({baseSpeed:1,boostFactor:2,elevationSpeed:.3,mouseSense:1,smoothing:.5,zoomSpeed:1},"constrols_cinecam_settings"),k={baseSpeed:{readable:"Base speed",type:u.FloatRange,default:1,min:.2,max:4},boostFactor:{readable:"Boost factor",type:u.FloatRange,default:2,min:.5,max:5},elevationSpeed:{readable:"Elevation speed",type:u.FloatRange,default:.33,min:.1,max:2},mouseSense:{readable:"Mouse sensitivity",type:u.FloatRange,default:1,min:.1,max:3},smoothing:{readable:"Mouse smoothing",type:u.FloatRange,default:.5,min:0,max:1},zoomSpeed:{readable:"Zoom sensitivity",type:u.FloatRange,default:1,min:1,max:5}};var z=new l(!1);const j=0,L=1,O={Forward:{type:j,index:7},Left:{type:L,index:0,sign:-1,max:1},Backward:{type:j,index:6},Right:{type:L,index:0,sign:1,max:1},Boost:{type:j,index:1},Handbrake:{type:j,index:5},ToggleHandbrake:{type:j,index:4},Autodrive:{type:j,index:0},Reset:{type:j,index:3},Headlights:{type:j,index:13},StickySteer:null,NextScene:{type:j,index:15},PrevScene:{type:j,index:14},CameraMode:{type:j,index:12},Mute:null,Pause:null,ToggleUI:null,ToggleDebug:null,ToggleSpeedControl:null,IncSpeedControl:null,DecSpeedControl:null},R=(new l(null),{connected:!0,axes:[0,0],buttons:[{pressed:!1,touched:!1,value:0},{pressed:!1,touched:!1,value:0},{pressed:!1,touched:!1,value:0},{pressed:!1,touched:!1,value:0},{pressed:!1,touched:!1,value:0}]}),T=(navigator.getGamepads,new l(O,"controls_gamepad")),P=new p({autoBoost:!1,steerSmoothing:.25,steerRange:.9,linearity:.25,deadzone:1},"controls_gamepad_settings"),G={autoBoost:{readable:"Max throttle boosts",desc:"Applies boost when at max throttle",type:u.Boolean,default:!1},steerSmoothing:{readable:"Steer smoothing",desc:"Applies gentle smoothing to the steering input",type:u.FloatRange,default:1,min:0,max:1,precision:2},steerRange:{readable:"Steer range",desc:"Alters the maximum steer angle",type:u.FloatRange,default:.9,min:.25,max:1,precision:2},linearity:{readable:"Steer linearity",desc:"Less linearity means more precision at small steer angles",type:u.FloatRange,default:.25,min:0,max:1,precision:2},deadzone:{readable:"Axis Deadzone",desc:"Width of deadzone as a percentage",type:u.FloatRange,default:.5,min:0,max:10,precision:1}},B={Forward:0,Left:1,Right:2,Backward:3,Handbrake:4,ToggleHandbrake:18,Boost:5,Autodrive:6,Reset:7,NextScene:8,PrevScene:9,StickySteer:10,Headlights:11,CameraMode:12,ToggleUI:13,ToggleDebug:14,ToggleCinecam:15,ToggleSpeedControl:16,IncSpeedControl:17,DecSpeedControl:18,Mute:19,Pause:20},W={Handbrake:!0,Autodrive:!0,Headlights:!0,StickySteer:!0,Boost:!1,CameraMode:!0,NextScene:!0,PrevScene:!0,ToggleUI:!0,ToggleDebug:!0,ToggleCinecam:!0,ToggleHandbrake:!0,ToggleSpeedControl:!0,Reset:!0,Mute:!0,Pause:!0},F={Autodrive:!0,Headlights:!0,CameraMode:!0,NextScene:!0,PrevScene:!0,ToggleUI:!0,ToggleDebug:!0,ToggleCinecam:!0,ToggleSpeedControl:!0,Reset:!0,IncSpeedControl:!0,DecSpeedControl:!0,Mute:!0,Pause:!0,ToggleHandbrake:!0};let E,Z,H,Q;var Y=new class{getGP(){var e,t;return(null===(e=(t=navigator).getGamepads)||void 0===e?void 0:e.call(t)[0])||null}constructor(){this.keys={},this.signal={},this.controllerSignal={},this.gamepadDidPress={},this.listeners={},this.dom={},this.keyMapCopy={},this.deadzoneMin=.05,this.deadzoneFactor=1.05,this.onKeyMapChangedBound=this.onKeyMapChanged.bind(this),this.onPauseBound=()=>this.on("Pause"),this.onMuteBound=()=>this.on("Mute"),this.onControllerChangedBound=this.onControllerChanged.bind(this),this.isCinecam=!1,this.hadController=0,this.onToggleCinecamBound=this.onToggleCinecam.bind(this),this.verifiedGamepadMap=!1,this.held={Autodrive:!1,Headlights:!1},this.toggled={Handbrake:!1,Boost:!1},this.keyState={lastAccel:0,hasAccel:!1,hasBoost:!1},this.mouseOff=!1,this.useMouseSim=!1,this.onGamepadRemapped=()=>{},this.remappingGamepad=!1,this.remappingGamepadControl=null,this.remapInitState={};for(let e in B)this.signal[e]=0,this.controllerSignal[e]=0,this.listeners[e]=[];D.addListener(this.onControllerChangedBound),this.controller=M[D.value],this.keyController=M[0],this.addListener("ToggleCinecam",this.onToggleCinecamBound),P.addListener("deadzone",this.updateGamepadDeadzone.bind(this)),this.updateGamepadDeadzone(),b.addListener(this.onKeyMapChangedBound),this.onKeyMapChanged(b.value),this.keys=w.key}updateGamepadDeadzone(e=P.deadzone){this.deadzoneMin=e/100,this.deadzoneFactor=1/(1-this.deadzoneMin)}initialise(){this.dom.mouseMarker=document.getElementById("ui-mouse-bar-marker")}onKeyMapChanged(e){null==this.keyMapCopy?(this.keyMapCopy={},w.addListener(e.Pause,this.onPauseBound),w.addListener(e.Mute,this.onMuteBound)):(this.keyMapCopy.Pause!==e.Pause&&(w.removeListener(this.keyMapCopy.Pause,this.onPauseBound),w.addListener(e.Pause,this.onPauseBound)),this.keyMapCopy.Mute!==e.Mute&&(w.removeListener(this.keyMapCopy.Mute,this.onMuteBound),w.addListener(e.Mute,this.onMuteBound))),Object.assign(this.keyMapCopy,e)}init(){}onControllerChanged(e){if(2==e){if(this.verifiedGamepadMap=!1,Q=this.getGP(),!Q)return;this.verifyControllerMap()}}onToggleCinecam(){z.value?D.set(this.hadController):(this.hadController=D.value,D.set(0)),z.set(!z.value)}verifyControllerMap(){if(Q=this.getGP(),!Q)return;let e={};for(let t in T.value){let i=T.value[t];i&&(i.type==j&&Q.buttons.length<=i.index&&(e[t]=null,console.warn("Unsetting missing button control for ",t)),i.type==L&&Q.axes.length<=i.index&&(e[t]=null,console.warn("Unsetting missing axis control for ",t)))}T.set({...T.value,...e}),this.verifiedGamepadMap=!0}halfLerp(e){return 2*((3-2*(e=e/2+.5))*e*e-.5)}update(){if(this.updateKeys(),z.value)return this.signal.Left=0,this.signal.Right=0,this.signal.Forward=0,this.signal.Backward=0,void(this.signal.Handbrake=this.toggled.Handbrake||this.signal.Handbrake>0?1:0);1==D.value?(this.updateMouse(),this.signal.Forward=Math.min(1,this.signal.Forward+this.controllerSignal.Forward),this.signal.Backward=Math.min(1,this.signal.Backward+this.controllerSignal.Backward)):2==D.value&&(this.updateGamepad(),this.signal.Forward=Math.min(1,this.signal.Forward+this.controllerSignal.Forward),this.signal.Backward=Math.min(1,this.signal.Backward+this.controllerSignal.Backward)),this.signal.ToggleHandbrake?(this.toggled.Handbrake=!this.toggled.Handbrake,this.on("ToggleHandbrake",this.toggled.Handbrake)):this.toggled.Handbrake&&this.signal.Handbrake&&(this.toggled.Handbrake=!1,this.on("ToggleHandbrake",!1)),this.signal.Handbrake=this.toggled.Handbrake||this.signal.Handbrake>0?1:0}updateKeys(){E=b.value,this.signal.Forward=0,w.key[E.Forward]||w.key.ArrowUp?(!this.keyState.hasAccel&&A.doubleTapBoost&&(!this.keyState.hasAccel&&ae.appTime-this.keyState.lastAccel<.2&&(A.toggleBoost?(this.toggled.Boost=!this.toggled.Boost,this.keyState.boostFromTap=this.toggled.Boost):this.keyState.boostFromTap=!0),this.keyState.lastAccel=ae.appTime),this.signal.Forward=1,this.keyState.hasAccel=!0):(this.keyState.hasAccel=!1,this.keyState.boostFromTap=!1),this.signal.Backward=0,(w.key[E.Backward]||w.key.ArrowDown)&&(this.signal.Backward=1),this.signal.StickySteer=w.key[E.StickySteer]?1:0,this.signal.Left=0,(w.key[E.Left]||w.key.ArrowLeft)&&(this.signal.Left=1),this.signal.Right=0,(w.key[E.Right]||w.key.ArrowRight)&&(this.signal.Right=1),this.signal.Handbrake=w.key[E.Handbrake]?1:0,this.checkDebouncedKey("ToggleHandbrake",!1),this.keyState.boostFromTap?this.signal.Boost=1:A.toggleBoost?(this.checkDebouncedKey("Boost",!1),this.signal.Boost&&(this.toggled.Boost=!this.toggled.Boost,this.keyState.boostFromTap=!1),this.signal.Boost=this.toggled.Boost):this.signal.Boost=w.key[E.Boost]?1:0,this.signal.Reset=w.key[E.Reset]?1:0,this.signal.Reset&&(w.key[E.Reset]=!1),this.checkDebouncedKey("Autodrive"),this.checkDebouncedKey("Headlights"),this.checkDebouncedKey("CameraMode"),this.checkDebouncedKey("NextScene"),this.checkDebouncedKey("PrevScene"),this.checkDebouncedKey("ToggleUI"),this.checkDebouncedKey("ToggleDebug"),this.checkDebouncedKey("ToggleCinecam"),this.checkDebouncedKey("ToggleSpeedControl"),this.checkDebouncedKey("IncSpeedControl"),this.checkDebouncedKey("DecSpeedControl")}updateMouse(){Z=g.value;for(let e in Z)null!==Z[e]&&this.getMouseValue(e);this.controllerSignal.Left=0,this.controllerSignal.Right=0,w.mouseAxis.y>0?(this.controllerSignal.Left=-1*Math.min(0,w.mouseAxis.x),this.controllerSignal.Right=Math.max(0,w.mouseAxis.x),this.dom.mouseMarker.style.transform="translateX("+(50+50*w.mouseAxis.x)+"%)",this.mouseOff=!1):this.mouseOff||(this.dom.mouseMarker.style.transform="translateX(50%)",this.mouseOff=!0)}getMouseValue(e){this.c=Z[e],this.v=w.mouseDown[this.c]?1:0,this.v>0?F[e]?this.gamepadDidPress[e]||(this.gamepadDidPress[e]=!0,W[e]&&(this.signal[e]=1),this.on(e,1)):this.signal[e]=1:this.gamepadDidPress[e]=!1,this.controllerSignal[e]=this.v}updateGamepadSim(){Q=R,Q.buttons[0].value=w.mouseDown[0]?1:0,Q.buttons[1].value=w.mouseDown[1]?1:0,Q.buttons[2].value=w.mouseDown[2]?1:0,Q.buttons[3].value=w.mouseDown[3]?1:0,Q.buttons[4].value=w.mouseDown[4]?1:0,Q.axes[0]=w.mouseAxis.x,Q.axes[1]=w.mouseAxis.y}updateGamepad(){if(H=T.value,Q=this.getGP(),Q)if(this.remappingGamepad)this.updateGamepadRemap();else{for(let e in H)this.getGamepadValue(e);P.autoBoost&&(this.signal.Boost=this.signal.Boost||this.controllerSignal.Forward>.99)}else this.controllerSignal.Forward=0,this.controllerSignal.Backward=0}updateGamepadRemap(){if(Q=this.getGP(),!Q)return;let e,t,i,s=null;if(Q.axes)for(let h=0;h<Q.axes.length;h++){var n;if(e=(null===(n=this.remapInitState.axes)||void 0===n?void 0:n[h])||0,this.remapInitState.axes&&Math.abs(Q.axes[h]-e)>.2){var a,o;if(t=Math.sign(Q.axes[h]),t<0)i=(null===(a=Q.axisMinimums)||void 0===a?void 0:a[h])||-1,i=Math.abs(i);else i=(null===(o=Q.axisMaximums)||void 0===o?void 0:o[h])||1;s={type:L,index:h,sign:t,max:i};break}}else console.warn("No axes detected");if(null==s&&Q.buttons)for(let h=0;h<Q.buttons.length;h++){var r;if(e=(null===(r=this.remapInitState.buttons)||void 0===r?void 0:r[h].value)||0,Math.abs(Q.buttons[h].value-e)>.5||Q.buttons[h].pressed){s={type:j,index:h},this.gamepadDidPress[this.remappingGamepadControl]=!0;break}}if(null!==s){let e=JSON.parse(JSON.stringify(T.value));T.set({...e,[this.remappingGamepadControl]:s}),this.onGamepadRemapped(),this.cancelGamepadRemap()}}cancelGamepadRemap(){this.remappingGamepad=!1,this.onGamepadRemapped=()=>{}}initGamepadRemap(e,t){if(Q=this.getGP(),this.remapInitState=null,Q&&Q.axes&&Q.buttons){w.setMouseEnabled(!0),this.remapInitState={axes:[],buttons:[]};for(let e of Q.axes)this.remapInitState.axes.push(e);for(let e of Q.buttons)this.remapInitState.buttons.push({pressed:e.pressed,value:e.value});this.remappingGamepadControl=t,this.onGamepadRemapped=e,this.remappingGamepad=!0}else console.warn("No gamepad state found; cannot remap")}getGamepadValue(e,t=!1){this.controllerSignal[e]=0,this.c=H[e],this.c&&(this.c.type==j&&Q.buttons[this.c.index]?(this.v=Math.abs(Q.buttons[this.c.index].value)||0,0==this.v&&Q.buttons[this.c.index].pressed&&(this.v=1),this.v>0?F[e]?this.gamepadDidPress[e]||(this.gamepadDidPress[e]=!0,W[e]&&(this.signal[e]=1),this.remappingGamepad||this.on(e,1)):this.signal[e]=this.v:this.gamepadDidPress[e]=!1,this.controllerSignal[e]=this.v):(this.v=Q.axes[this.c.index]||0,Math.sign(this.v)==this.c.sign&&(this.c.max||(this.c.max=1),this.v=Math.max(0,(this.v*this.c.sign-this.deadzoneMin)*this.deadzoneFactor)/this.c.max,this.controllerSignal[e]=this.v)))}checkDebouncedKey(e,t=!0){this.signal[e]=0,w.key[E[e]]?this.held[e]||(this.signal[e]=1,this.held[e]=!0,t&&this.on(e)):this.held[e]=!1}addListener(e,t){"function"===typeof t&&(this.listeners[e].includes(t)||this.listeners[e].push(t))}removeListener(e,t){if(!(e in this.listeners))return;let i=this.listeners[e].indexOf(t);i>=0&&this.listeners[e].splice(i,1)}on(e,t=null){for(let i of this.listeners[e])i(t)}};var V={Forward:"KeyW",Left:"KeyA",Right:"KeyD",Backward:"KeyS",LeftArrow:"ArrowLeft",UpArrow:"ArrowUp",RightArrow:"ArrowRight",DownArrow:"ArrowDown",Handbrake:"Space",CameraMatchSpeed:"CapsLock",BoostAccel:"ShiftLeft",BoostAccel2:"ShiftRight",Auto:"Equal",Mute:"KeyM",PageUp:"PageUp",PageDown:"PageDown",Q:"KeyQ",E:"KeyE",Camera:"KeyC",StickySteer:"IntlBackslash",Shift:"ShiftLeft",SwitchDrive:"KeyB",NodeDebug:"KeyN",Reset:"KeyR",Lights:"KeyL",Headlights:"KeyH",Pause:"KeyP",UI:"KeyU",Debug:"F3",Debug2:"F4",Reload:"F6",StepTicker:"BracketRight",Ackermann:"KeyX",AutoDrive:"KeyF",NextSkin:"KeyG",NextTopo:"KeyH",Esc:"Escape",Any:-1,Fullscreen:"F11",Control:"ControlLeft",T:"KeyT",Tab:"Tab",Plus:"NumpadAdd",Minus:"NumpadSubtract",CameraToggle:"Tab",ResetCamera:"KeyG",Caps:"CapsLock",Num1:"Digit1"};var U=(()=>{let e=!1;return(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|ipad|iris|kindle|Android|Silk|lge |maemo|midp|mmp|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(navigator.userAgent)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(navigator.userAgent.substr(0,4)))&&(e=!0),e})()&&null===window.localStorage.getItem("force-allow-mobile");var X=window.localStorage.getItem("isDev");const J={AudioLevel:"AudioLevel",Units:"Units",AutoPause:"AutoPause",DoubleTap:"DoubleTap",ShowWorm:"ShowWorm",Barriers:"Barriers"},q=0,K=1,_={AudioLevel:.5,Units:0,AutoPause:0,MouseLook:!1,ShowWorm:K,Barriers:!0},$={Units:{readable:"Units",type:u.Boolean,default:!1,labels:["miles","kilometres"],onSet:e=>ee.set("Units",e?1:0)},MouseLook:{readable:"Mouse look (first-person)",type:u.Boolean,default:!1,labels:["off","on"],onSet:e=>ee.set("MouseLook",e)},AutoPause:{readable:"Pause on window change",desc:"Enabling this will prevent the game from running in a separate window/monitor",type:u.Boolean,default:1,labels:["off","on"],onSet:e=>ee.set("AutoPause",e?1:0)},ShowWorm:{readable:"Show upcoming road worm",type:u.Enum,default:K,labels:["Always","Manual drive only","Never"],onSet:e=>ee.set("ShowWorm",e)},Barriers:{readable:"Walls and barriers",desc:"Enables and disables the collidable barriers beside the road",type:u.Boolean,default:1,labels:["disabled","enabled"],onSet:e=>ee.set("Barriers",e?1:0)}};const ee=new class extends p{constructor(...e){super(...e),this.value=_,this.loadConfig(),window.localStorage.getItem("barrier-fix")||(this.value.Barriers=!0,this.Barriers=!0,window.localStorage.setItem("barrier-fix",!0))}set(e,t){super.set(e,t),window.localStorage.setItem(J[e],t)}loadConfig(){let e,t;for(t in this.value)e=JSON.parse(window.localStorage.getItem(J[t])||_[t]),console.log("GameConfig: Load ",t,e),this.set(t,e)}}(_);var te=ee;const ie="no_prompt_ha";var se=new class extends l{constructor(...e){super(...e),this.default=!1,this.value=!1,this.disabled=null!=window.localStorage.getItem(ie)}disable(){this.disabled=!0,window.localStorage.setItem(ie,!0)}};const ne=window.location.pathname.includes("dash");var ae=new class{constructor(){this.appTime=0,this.listeners=[],this.stateListeners=[],this.blurListeners=[],this.slowListeners=[],this.slowInterval=20,this.slowTimer=null,this.wasPaused=!1,this.paused=!1,this.blurred=!1,this.playSpeed=1,this.onSplash=!1,this.playLocked=!1,this.pausedInterval=null,this.tick30Bound=this.tick30.bind(this),this.startTime=Date.now()/1e3,this.playTime=0,this.pTime=this.startTime,this.pSlowTime=this.startTime,Y.addListener("Pause",(()=>{this.toggle(!0)})),X&&(w.addListener(V.StepTicker,this.tickOnce.bind(this)),w.addListener(V.Plus,(()=>{this.playSpeed+=.25,console.log(this.playSpeed)})),w.addListener(V.Minus,(()=>{this.playSpeed>.3&&(this.playSpeed-=.25),console.log(this.playSpeed)}))),se.addListener((()=>{this.retire(!0)})),window.onblur=()=>{1==te.value.AutoPause&&this.pause()},window.onfocus=()=>{this.wasPaused||this.resume()},document.addEventListener("visibilitychange",(e=>{"visible"==document.visibilityState?(this.blurred=!1,this.updateBlurListeners()):(this.blurred=!0,this.updateBlurListeners())})),U||ne||(this.tick(),this.slowTimer=setInterval(this.tick30Bound,this.slowInterval))}toggle(e=!1){this.paused?this.resume(e):(this.wasPaused=!0,this.pause(e))}retire(){this.paused=!0,this.updateStateListeners(),cancelAnimationFrame(this.tickRAF),clearInterval(this.slowTimer),this.tick=()=>{},this.resume=()=>{}}pause(e=!1){this.playLocked=e||this.playLocked,ne||this.paused||(this.paused=!0,this.pausedInterval=setInterval(this.tickPaused,100),this.updateStateListeners(),cancelAnimationFrame(this.tickRAF),clearInterval(this.slowTimer))}resume(e=!1){this.playLocked&&!e||ne||this.paused&&(this.paused=!1,this.playLocked=!1,this.wasPaused=!1,clearInterval(this.pausedInterval),this.updateStateListeners(),this.pTime=Date.now()/1e3,this.pSlowTime=this.pTime,this.tick(),this.slowTimer=setInterval(this.tick30Bound,this.slowInterval))}tick(){this.tickRAF=requestAnimationFrame((()=>this.tick())),this.time=Date.now()/1e3,this.appTime=this.time-this.startTime,this.dT=this.time-this.pTime,this.dT=this.dT>.1?.1:this.dT,this.dT&&(this.playTime+=this.dT,this.dT*=this.playSpeed,this.updateListeners()),this.pTime=this.time}tickPaused(){Y.update()}tick30(){this.slowTime=Date.now()/1e3,this.slowdT=this.slowTime-this.pSlowTime,this.updateSlowListeners(this.slowdT),this.pSlowTime=this.slowTime}tickOnce(){console.log("\n\n ---------- STEP ---------- \n\n"),this.paused=!0,cancelAnimationFrame(this.tickRAF),clearInterval(this.slowTimer),this.time=Date.now()/1e3,this.appTime=this.time-this.startTime,this.dT=.016,this.updateListeners(),this.pTime=this.time,this.tick30()}updateListeners(){this.listeners.map((e=>e(this.dT,this.appTime)))}addListener(e){this.listeners.includes(e)||this.listeners.push(e)}removeListener(e){let t=this.listeners.indexOf(e);t>=0&&this.listeners.splice(t,1)}updateSlowListeners(){this.slowListeners.map((e=>e(this.slowdT,this.appTime)))}addSlowListener(e){this.slowListeners.includes(e)||this.slowListeners.push(e)}removeSlowListener(e){let t=this.slowListeners.indexOf(e);t>=0&&this.slowListeners.splice(t,1)}updateStateListeners(){this.stateListeners.map((e=>e(this.paused)))}addStateListener(e){this.stateListeners.includes(e)||this.stateListeners.push(e)}removeStateListener(e){let t=this.stateListeners.indexOf(e);t>=0&&this.stateListeners.splice(t,1)}updateBlurListeners(){this.blurListeners.map((e=>e(this.blurred)))}addBlurListener(e){this.blurListeners.includes(e)||this.blurListeners.push(e)}removeBlurListener(e){let t=this.blurListeners.indexOf(e);t>=0&&this.blurListeners.splice(t,1)}};const oe={};let re=window.location.search.substring(1).split("&");for(let tu of re){let e=tu.split("=");if(e[0].length)try{oe[e[0]]=JSON.parse(e[1])}catch(eu){oe[e[0]]=e[1].toString()}}var he=oe;let le=1==he.autodrive;le||!1===he.autodrive||(le=null!==window.localStorage.getItem("has-autodrive"));var de=new class extends l{set(e){super.set(e),e?window.localStorage.setItem("has-autodrive",!0):window.localStorage.removeItem("has-autodrive")}}(le),ce=i.p+"static/media/surface_hit.8d170970.wav",pe=i.p+"static/media/auto_on.b61cfb94.mp3",ue=i.p+"static/media/auto_off.5f03ab8c.mp3";r.b.prototype.stop=function(){if(!1!==this.hasPlaybackControl)return this._progress=0,this.source&&(this.source.stop(),this.source.onended=null),this.isPlaying=!1,this;console.warn("THREE.Audio: this Audio has no playback control.")},r.b.prototype.setVolumeStoppable=function(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),!this.isPlaying&&e>0?this.play():this.isPlaying&&0==e&&this.pause(),this};const ge={bonk:{src:ce,sound:null},autoOn:{src:pe,sound:null,vol:.5},autoOff:{src:ue,sound:null,vol:.5}};var me=new class{constructor(){this.loader=new r.d,this.hasInit=!1,this.muted=!1,this.prevLevel=.5,this.onAutodriveBound=this.onAutodrive.bind(this),this.onLevelChangedBound=this.onLevelChanged.bind(this),this.wasMuted=!1,this.onTickerStateBound=this.onTickerState.bind(this),this.fadeInBound=this.fadeIn.bind(this),this.fadeCounter=0,this.fadeTime=1,this.initListeners=[],this.listener=new r.c,ae.addStateListener(this.onTickerStateBound),ae.addBlurListener(this.onTickerStateBound),this.listener.setMasterVolume(te.AudioLevel),this.prevLevel=te.AudioLevel,te.addListener(J.AudioLevel,this.onLevelChangedBound),de.addListener(this.onAutodriveBound)}onAutodrive(e){e?this.play("autoOn"):this.play("autoOff")}onLevelChanged(e){this.muted=0==e,this.listener.setMasterVolume(e)}onTickerState(e){ae.paused||ae.blurred?(this.wasMuted=this.muted,this.listener.setMasterVolume(0)):this.wasMuted||this.listener.setMasterVolume(te.AudioLevel)}init(){if(this.hasInit)return;let e;"running"!==this.listener.context.state&&(this.listener.context.resume(),this.listener.setMasterVolume(0),ae.addListener(this.fadeInBound));for(let t in ge)e=ge[t],this.loadAudio(e);this.hasInit=!0;for(let t of this.initListeners)t()}fadeIn(e){this.fadeCounter+=e;let t=Math.min(te.AudioLevel,this.fadeCounter/this.fadeTime);this.listener.setMasterVolume(t),this.fadeCounter/this.fadeTime>=1&&ae.removeListener(this.fadeInBound)}play(e){e in ge&&ge[e].sound&&(ge[e].sound.isPlaying&&ge[e].sound.stop(),ge[e].sound.play())}loadAudio(e){let t=new r.b(this.listener);this.loader.load(e.src,(i=>{t.setBuffer(i),e.sound=t,e.vol&&t.setVolume(e.vol)}))}getAudio(e,t){let i=new r.b(this.listener);this.loader.load(e,(e=>{i.setBuffer(e),t(i)}))}getPositionalAudio(e,t,i=null){null==i&&(i=new r.M(this.listener)),this.loader.load(e,(e=>{i.setBuffer(e),t(i)}))}mute(){this.muted=!0,this.listener.setMasterVolume(0)}unmute(){this.muted=!1,this.listener.setMasterVolume(1)}toggleMute(){ae.paused?this.wasMuted=!this.wasMuted:(this.muted=!this.muted,this.muted&&te.AudioLevel>0&&(this.prevLevel=te.AudioLevel),te.set(J.AudioLevel,this.muted?0:this.prevLevel))}addInitListener(e){this.initListeners.push(e)}};const xe="reset",ve="modelChanged",we="headlights";class fe extends r.G{constructor(){super(),this.listeners={},this.headlightColour=16777215,this.geo=new r.G,this.pPosition=new r.W,this.frontAxlePosition=new r.W,this.fwd=new r.W,this.accel=new r.W,this.pVel=new r.W,this.vel=new r.W,this.velDir=new r.W,this.speed=0,this.steer=0,this.steerL=0,this.steerR=0,this.direction=0,this.drive=0,this.braking=!1,this.handbrake=!1,this.heading=0,this.gradient=0,this.roll=0,this.pitch=0,this.headlights=!0,this.headlightsManual=!1,this.downforce=0,this.brakeForce=0,this.brakeLerp=0,this.slip=0,this.speedLerp=0,this.powerLerp=0,this.motionHeading=0,this.wrongWay=!1,this.rockLonTarget=0,this.rockLon=0,this.rockLatTarget=0,this.rockLat=0,this.lights={left:{light:null,target:null},right:{light:null,target:null}},this.hasInit=!1,this.steerDifferential=1,this.rearSteerDifferential=1,this.frSteerDifferential=1,this.intensityFactor=1,this.headlightIntensity=1,this.add(this.geo),this.lightsContainer=new r.G;let e=new r.G,t=new r.T(16777215,1,80,.5,.5,1.8);t.target=e,this.lights.left.light=t,this.lights.left.target=e;let i=new r.G;this.lights.right.target=i;let s=t.clone();s.target=i,this.lights.right.light=s,this.lightsContainer.add(t),this.lightsContainer.add(s),this.lightsContainer.add(e),this.lightsContainer.add(i),this.add(this.lightsContainer),this.setHeadlightColour(this.headlightColour),this.frustumCulled=!1,this.matrixAutoUpdate=!1,this.matrixWorldAutoUpdate=!1,this.hasInit=!0}setHeadlightColour(e){this.headlightColour=e,this.lights.left.light.color.setHex(e),this.lights.right.light.color.setHex(e)}update(){}reset(){this.pPosition.copy(this.position),this.speed=0,this.pVel.set(0,0,0),this.vel.set(0,0,0),this.velDir.set(0,0,0),this.accel.set(0,0,0),this.steer=0,this.steerL=0,this.steerR=0,this.drive=0,this.direction=0,this.braking=!1,this.handbrake=!1,this.downforce=0,this.brakeForce=0,this.brakeLerp=0,this.speedLerp=0,this.powerLerp=0,this.wrongWay=!1,this.slip=0,this.frontAxlePosition.copy(this.position),this.fireEvent("reset")}updateSteer(){let e=Math.sin(this.steer),t=Math.cos(this.steer)*this.wheels.length*2,i=2*this.wheels.length*e/(t-this.wheels.width*e),s=2*this.wheels.length*e/(t+this.wheels.width*e);this.steerL=Math.atan(i),this.steerR=Math.atan(s),this.frSteerDifferential=this.wheels.length/Math.sin(this.steer)/(this.wheels.length/Math.tan(this.steer))||1,this.bike||(this.steerDifferential=this.wheels.length/Math.sin(this.steerL)/(this.wheels.length/Math.sin(this.steerR))||1,this.rearSteerDifferential=this.wheels.length/i/(this.wheels.length/s)||1,this.frSteerDifferential=this.wheels.length/Math.sin(this.steer)/(this.wheels.length/Math.tan(this.steer))||1,this.steerDifferential*=this.frSteerDifferential,this.rearSteerDifferential/=this.frSteerDifferential)}setModel(e){this.reset(),this.metrics=e.metrics,this.wheels=e.wheels,this.cameras=e.cameras,this.bike=!!e.bike,this.hasInit&&(this.lights.left.light.position.copy(this.metrics.headlightPos),this.lights.left.target.position.copy(this.metrics.headlightPos),this.lights.left.target.position.z+=1,this.lights.left.target.position.y-=.05,this.lights.right.light.position.copy(this.lights.left.light.position),this.lights.right.light.position.x*=-1,this.lights.right.target.position.copy(this.lights.left.target.position),this.lights.right.target.position.x*=-1),this.fireEvent(ve)}setHeadlights(e,t=!1){!e&&!t&&this.headlights&&this.headlightsManual||(this.headlightsManual=(this.headlightsManual||t)&&e,this.headlights=e,this.intensityFactor=e?1:0,this.setHeadlightIntensity(this.headlightIntensity),this.fireEvent(we))}setHeadlightIntensity(e){this.headlightIntensity=e,this.lights.right.light.intensity=e*this.intensityFactor,this.lights.left.light.intensity=e*this.intensityFactor}fireEvent(e,t=null){e in this.listeners&&this.listeners[e].map((e=>e(t)))}addListener(e,t){e in this.listeners||(this.listeners[e]=[]),this.listeners[e].push(t)}removeListener(e,t){if(!(e in this.listeners))return;let i=this.listeners[e].indexOf(t);i>=0&&this.listeners[e].splice(i,1)}}var be=new fe,Ae=i.p+"static/media/rolling_06.ca3a3b85.mp3",ye=i.p+"static/media/veh_accel_06.9e103abb.mp3",Ie=i.p+"static/media/veh_car.9991c48a.svg",Se=i.p+"static/media/veh_bus.9b1fce50.svg",Me=i.p+"static/media/veh_bike.af1bd6f4.svg",De=i.p+"static/media/roadster-07b_map.9b87de0b.jpg";const Ce={Chase:{pitch:{near:.3,far:.2},yOffset:{near:.8,far:1},posOffset:[0,0,1.4],range:{near:4,far:4.75},farSpeed:45,smoothFactor:1.5},ChaseFar:{pitch:{near:.25,far:.15},yOffset:{near:1,far:2},posOffset:[0,0,1.4],range:{near:6,far:9},farSpeed:45,smoothFactor:1.25},FirstPerson:{pitch:{near:.05,far:.05},yOffset:{near:.7,far:.7},posOffset:[0,.45,3.2],range:{near:.75,far:.75},farSpeed:45,smoothFactor:.3},Bonnet:{pitch:{near:.05,far:.05},yOffset:{near:.6,far:.6},posOffset:[0,.4,3.4],range:{near:0,far:0},farSpeed:45,smoothFactor:.3,hideVehicle:!0}},Ne={Debug:{enabled:!1,name:"Debug",skins:[],bodyObj:i(19),wheelObj:i(20),icon:Ie,audio:{roll:Ae,engine:ye},wheels:{tyreWidth:.1,width:1.36,widthHalf:.68,length:2.75,radius:.342665,circumference:2.1,travel:.07},metrics:{shadowMapSize:4,accel:9,reverse:5,jerk:48,brake:8,mass:700,maxSteer:.68,axleHeight:.342665,dampening:.04,rockFactor:4,drag:.001,topSpeed:45,rollResistance:.06,steerInterval:1,slipBase:.1,slipMod:.05,aeroFactor:.5,headlightPos:{x:.64,y:.7,z:3.1}},cameras:Ce},Bike:{enabled:!1,name:"Bike",skins:[],bike:!0,bodyObj:i(34),wheelObj:i(35),icon:Me,audio:{roll:Ae,engine:ye},materials:{},wheels:{tyreWidth:.077,width:0,widthHalf:0,length:1.95,radius:.26,circumference:1.63,travel:.07},metrics:{shadowMapSize:4,steerSpeed:1.57,accel:11,reverse:5,jerk:48,brake:8,mass:700,steerAccel:8,maxSteer:.4,dampening:.08,rockFactor:5,drag:.001,topSpeed:53,rollResistance:.04,steerInterval:1.8,slipBase:1,slipMod:0,aeroFactor:.4,headlightPos:{x:.3,y:.75,z:2.25}},cameras:{Chase:{pitch:{near:.3,far:.2},yOffset:{near:.8,far:1},posOffset:[0,0,1],range:{near:3.5,far:4.5},farSpeed:50,smoothFactor:.85,hideVehicle:!1},ChaseFar:{pitch:{near:.25,far:.15},yOffset:{near:1,far:2},posOffset:[0,0,1],range:{near:6,far:9},farSpeed:50,smoothFactor:.65},FirstPerson:{pitch:{near:.05,far:.05},yOffset:{near:.7,far:.7},posOffset:[0,.4,2.3],range:{near:.75,far:.75},farSpeed:50,smoothFactor:.2,hideVehicle:!0}}},Bus:{enabled:!0,name:"Coach",skins:[],bodyObj:i(36),wheelObj:i(37),icon:Se,audio:{roll:Ae,engine:ye},wheels:{tyreWidth:.2,width:2.24,widthHalf:1.12,length:5.47,radius:.3955,circumference:2.485,travel:.16},metrics:{shadowMapSize:8,steerSpeed:.45,accel:6,reverse:5,jerk:12,brake:4,mass:1400,steerAccel:6,maxSteer:.65,axleHeight:.3955,dampening:.06,rockFactor:5,drag:.002,topSpeed:32,rollResistance:.03,steerInterval:2,slipBase:1,slipMod:.25,aeroFactor:0,headlightPos:{x:.75,y:.75,z:7.25}},cameras:{Chase:{pitch:{near:.35,far:.3},yOffset:{near:1.6,far:2.6},posOffset:[0,0,2.7],range:{near:9,far:11},farSpeed:30,smoothFactor:1.6},ChaseFar:{pitch:{near:.4,far:.3},yOffset:{near:2,far:4},posOffset:[0,0,2.7],range:{near:14,far:16},farSpeed:30,smoothFactor:1.4},FirstPerson:{pitch:{near:.05,far:.05},yOffset:{near:1.8,far:1.8},posOffset:[0,0,6.6],range:{near:.75,far:.75},farSpeed:30,smoothFactor:.4,hideVehicle:!0}}},Roadster:{enabled:!0,name:"Roadster",bodyObj:i(38),wheelObj:i(39),steerObj:i(40),dashObj:i(41),map:De,icon:Ie,audio:{roll:Ae,engine:ye},wheels:{tyreWidth:.1,width:1.36,widthHalf:.68,length:2.75,radius:.342665,circumference:2.1,travel:.07},skins:{basic:{body:16316664}},metrics:{shadowMapSize:4,steerSpeed:1.57,accel:9,reverse:5,jerk:64,brake:8,mass:700,steerAccel:12,maxSteer:.68,axleHeight:.342665,dampening:.04,rockFactor:4,drag:.001,topSpeed:45,rollResistance:.06,steerInterval:1,slipBase:.2,slipMod:.1,aeroFactor:.4,headlightPos:{x:.64,y:.7,z:3.1},steeringPos:{x:.32,y:.82,z:1.75},steeringAngle:.3},cameras:{...Ce,Bonnet:{pitch:{near:.05,far:.05},yOffset:{near:.7,far:.7},posOffset:[0,.45,3.2],range:{near:.75,far:.75},farSpeed:45,smoothFactor:.3},Hood:{pitch:{near:.05,far:.05},yOffset:{near:.6,far:.6},posOffset:[0,.4,3.4],range:{near:0,far:0},farSpeed:45,smoothFactor:.3,hideVehicle:!0},FirstPerson:{isFirstPerson:!0,nearPlane:.08,pitch:{near:.025,far:.025},yOffset:{near:.7,far:.7},posOffset:[.32,1.08,1.3],range:{near:.75,far:.75},farSpeed:45,smoothFactor:0}}},Rover:{enabled:!1,name:"Rover",skins:[],bodyObj:i(19),wheelObj:i(20),icon:Ie,audio:{roll:Ae,engine:ye},materials:{},wheels:{tyreWidth:.25,width:2,widthHalf:1,length:3,radius:.4,circumference:2.513,travel:.15},metrics:{shadowMapSize:4,steerSpeed:1.57,accel:7,reverse:5,jerk:48,brake:8,mass:700,steerAccel:12,maxSteer:.68,axleHeight:.4,dampening:.03,rockFactor:5,drag:.001,topSpeed:35,rollResistance:.06,steerInterval:1,slipBase:.1,slipMod:.05,aeroFactor:.5,headlightPos:{x:.64,y:.7,z:3.1}},cameras:Ce}};const ke={Roadster:Ne.Roadster,Bike:Ne.Bike,Coach:Ne.Bus,Debug:Ne.Debug},ze=["Roadster","Bike","Coach"];const je=0,Le=1,Oe=2,Re=[270,360,450,720,900],Te={type:"config-vehicle-type",mode:"config-vehicle-mode",input:"config-vehicle-input",side:"config-vehicle-side",seat:"config-vehicle-seat",steerRotation:"config-vehicle-steer-angle",steerRotationIndex:"config-vehicle-steer-index",gripFactor:"config-vehicle-grip",speedFactor:"config-vehicle-speed",seatAdjustment:"config-vehicle-seat-adjustment",seatHeight:"config-vehicle-seat-height",showWheel:"config-vehicle-show-wheel",autodriveSide:"config-autodrive-side",autodriveSideIndex:"config-autodrive-side-index"},Pe={type:"Roadster",mode:0,input:0,side:0,seat:0,steerRotationIndex:0,steerRotation:270,gripFactor:1,speedFactor:1,showWheel:!0,seatAdjustment:0,seatHeight:0,autodriveSide:-1,autodriveSideIndex:0},Ge={mode:{readable:"Drive Mode",desc:"Controls which wheels receive acceleration power",type:u.Enum,default:je,labels:["All-wheel drive","Front-wheel drive","Rear-wheel drive"],onSet:e=>Be.set("mode",e)},autodriveSideIndex:{readable:"Autodrive lane",type:u.Enum,default:0,labels:["Left","None","Right"],onSet:e=>{Be.set("autodriveSideIndex",e),Be.set("autodriveSide",e-1)}},gripFactor:{readable:"Tyre grip factor",desc:"Lower values will be more slippery",type:u.FloatRange,default:1,min:.25,max:3,precision:2,onSet:e=>Be.set("gripFactor",e)},speedFactor:{readable:"Speed factor",desc:"Alter the motor power",type:u.FloatRange,default:1,min:.5,max:2,precision:2,onSet:e=>Be.set("speedFactor",e)},side:{readable:"Interior: Driver side",type:u.Boolean,default:!0,labels:["right","left"],onSet:e=>Be.set("side",e?1:0)},seat:{readable:"Interior: Seat",type:u.Boolean,default:!0,labels:["driver","passenger"],onSet:e=>Be.set("seat",e?1:0)},showWheel:{readable:"Interior: Show wheel",desc:"Toggle visibility of the steering wheel",type:u.Boolean,default:!0,onSet:e=>Be.set("showWheel",e)},steerRotationIndex:{readable:"Interior: Max wheel rotation",desc:"Adjusts the range of animation of the steering wheel (visual only)",type:u.Enum,default:0,labels:Re,onSet:e=>{Be.set("steerRotationIndex",e),Be.set("steerRotation",Re[e])}},seatAdjustment:{readable:"Interior: Seat adjustment",desc:"Slide the camera forwards/backwards in first-person view",type:u.FloatRange,default:0,min:-.25,max:.25,precision:2,onSet:e=>Be.set("seatAdjustment",e)},seatHeight:{readable:"Interior: Seat height",desc:"Slide the camera up/down in first-person view",type:u.FloatRange,default:0,min:-.05,max:.05,precision:2,onSet:e=>Be.set("seatHeight",e)}};const Be=new class extends p{constructor(){super(),this.value=Pe,this.loadConfig()}set(e,t){super.set(e,t),window.localStorage.setItem(Te[e],t)}resetMemory(){for(let e in this.value)window.localStorage.setItem(Te[e],Pe[e])}loadConfig(){let e,t;for(t in this.value){if(e=localStorage.getItem(Te[t]),null!==e){if("type"!==t)try{e=JSON.parse(window.localStorage.getItem(Te[t]))}catch(eu){console.warn("Failed to load setting from storage: ",t),e=Pe[t]}}else e=Pe[t];this[t]=e,console.log("VehicleConfig: Load ",t,e),this.set(t,e)}}};var We=Be;const Fe=()=>Date.now().toString(16).substring(3);let Ee=Fe(),Ze=0,He=window.location.search.substring(1).split("&"),Qe=localStorage.getItem("seed");if(Qe){console.log("Restoring seed from local storage"),Ee=Qe;let e=localStorage.getItem("config-scene-topography")||"normal",t=Ee+"?"+e,i=0;try{i=JSON.parse(localStorage.getItem(t))||0,console.log("Restoring saved progress to node ",i)}catch(eu){console.warn("Could not load saved progress for seed ",Ee)}Ze=i}if(He.length)for(let tu of He){let e=tu.split("=");if("seed"==e[0])console.log("Overriding seed with querystring"),Ee=e[1];else if("node"==e[0]){console.log("Overriding start node with querystring");try{Ze=JSON.parse(e[1])}catch(eu){console.error("Invalid start node param")}}}localStorage.setItem("seed",Ee);const Ye=(e=null,t=!1)=>(null===e&&(e=Fe()),(e=e.toString())==Ee||!Ve(e)&&(localStorage.setItem("seed",e),t&&window.location.reload(),Ee=e,!0)),Ve=e=>{let t=e.toString();return!!(t.length<=0||t.includes("?")||t.includes(" "))&&(console.warn("Invalid seed ",t),!0)};Ee=Ee.toString(),console.log("SEED: ",Ee);if(Qe=localStorage.getItem("start-node"),Qe){console.log("Restoring starting node as ",Qe);try{Ze=JSON.parse(Qe)}catch(eu){console.warn("Failed to retrieve intial node from ls")}}localStorage.removeItem("start-node");Ze>0&&(Ze-=5);var Ue="\n\n  uniform sampler2D noiseMap;\n  uniform bool isNight;\n\n  attribute float variant;\n  // attribute vec3 groundNormal;\n  attribute float shadow;\n\n  #define SPRITE_NORMAL vec3(0.0, 1.0, 0.0);\n\n  varying vec2 vUvOffset;\n  varying float vShadow;\n  varying float vNoise;\n\n  varying float vLightGrass;\n  varying float vDarkGrass;\n  #ifdef TREES\n    uniform bool highDef;\n  #endif\n\n";var Xe="\n\n  // Get uvLookup  from variant\n\n  /* Indexed into the texture as such:\n\n    2 | 3\n    - + -\n    0 | 1\n\n  */\n\n  vShadow = 1.0 - shadow;\n\n  // Common pieces for bush and grass\n  #if defined(GRASS) || defined(BUSH)\n    // We're only interested in the INSTANCE position for this, not vertex pos\n    vec4 wPos = modelMatrix * instanceMatrix * vec4(1.0);\n\n    float fade = texture2D(noiseMap, vec2(\n      wPos.x / 100.0,\n      wPos.z / 100.0\n    )).r;\n\n    float fade0 = texture2D(noiseMap, vec2(\n      wPos.x / 800.0,\n      wPos.z / 800.0\n    )).r;\n\n    float fade1 = texture2D(noiseMap, vec2(\n      wPos.x / 6400.0,\n      wPos.z / 6400.0\n    )).r;\n\n    fade0 = min(max(0.0,(fade0 - 0.25) * 2.0), 1.0);\n    float fade1b = min(max(0.0,(fade1 - 0.25) * 2.0), 1.0);\n\n    float heightVal = min(1.0, wPos.y/100.0);\n\n    vDarkGrass = 1.0;//1.1 - fade1b * 0.1;\n    vLightGrass = max(0.0, fade1b * heightVal * (fade0 + heightVal));\n\n    if(variant < 2.0) {\n      vLightGrass *= variant / 4.0 + 0.5;\n    }\n\n    #ifdef GRASS\n      float vari = 2.0;\n      if(shadow > 0.1) {\n        vari = floor(fade * 2.0) + 2.0;\n      }\n\n    #endif\n\n    #ifdef BUSH\n      float vari = variant; // Use given actual type for bushes maybe?\n    #endif\n\n    vUvOffset.x = mod(vari, 2.0) * 0.5;\n    vUvOffset.y = floor(vari / 2.0) * 0.5;\n\n  #endif\n\n  // Grass specific pieces\n  #ifdef GRASS\n\n    vNoise = fade;\n\n    if((vLightGrass + vNoise / 10.0 > 0.5 || fade < 0.25) && variant > 0.8) {\n      // 0, 0 for lower left, which is the pale hay type\n      vUvOffset *= 0.0;\n    }\n\n    //// HEATHER\n\n    heightVal =\n      min(1.0, wPos.y / 170.0)\n      *\n      fade1\n      *\n      (texture2D(noiseMap, vec2(\n        wPos.x / 1200.0,\n        wPos.z / 1200.0\n      )).r / 2.0 + 0.5);\n\n    heightVal = smoothstep(0.47, 0.53, heightVal) * fade0;\n\n    if(heightVal > 0.5 && variant > 0.8) {\n\n      // Sink the bush at the edges of the heather patch\n      transformed.y -= 1.0 - heightVal;\n\n      vUvOffset.x = 0.5;\n      vUvOffset.y = 0.0;\n      vLightGrass = 1.0 - heightVal;// - 0.5) * 2.0;\n      vDarkGrass = 1.0;\n    }\n\n  #endif\n\n\n  #ifdef TREES\n\n    vec4 wPos = modelMatrix * instanceMatrix * vec4( 1.0 );\n\n    vNoise = texture2D(noiseMap, vec2(\n      wPos.x / 4000.0,\n      wPos.z / 4000.0\n    )).r\n    *\n    texture2D(noiseMap, vec2(\n      wPos.x / 800.0,\n      wPos.z / 800.0\n    )).r;\n    // *\n    // (min(1.0, wPos.y / 25.0)) * 2.0\n    // -\n    // 0.5;\n\n    // vNoise *= 0.4;\n\n    // float vari = texture2D(noiseMap, vec2(\n    //   wPos.x / 200.0,\n    //   wPos.z / 200.0\n    // )).r;\n    //\n    // // Manually sample ranges\n    // if(vari < 0.4) {\n    //   vari = 0.0;\n    // } else if(vari < 0.6) {\n    //   vari = 1.0;\n    // } else {\n    //   vari = 2.0;\n    // }\n\n    // abuse vShadow for more texture\n    if(highDef) {\n      vShadow = texture2D(noiseMap, vec2(\n        wPos.x / 20.0,\n        wPos.z / 20.0\n      )).r - 0.5;\n    }\n\n    vUvOffset.x = mod(variant, 2.0) * 0.5;\n    vUvOffset.y = floor(variant / 2.0) * 0.5;\n\n  #endif\n\n  #ifdef AUTO_NORMAL\n    vNormal = SPRITE_NORMAL;\n  #endif\n";var Je="\n  varying vec2 vUvOffset;\n  varying float vShadow;\n  varying float vNoise;\n\n  varying float vLightGrass;\n  varying float vDarkGrass;\n\n  uniform vec4 colouration;\n\n  #ifdef TREES\n    uniform sampler2D mapb;\n    uniform bool highDef;\n  #endif\n";var qe="\n\nvec4 texelColor = texture2D( map, vUv + vUvOffset );\n\n  #ifdef GRASS\n    texelColor += colouration * vLightGrass * vNoise;\n    texelColor.rgb *= vDarkGrass;\n    texelColor.rgb *= vShadow;\n  #endif\n\n  #ifdef BUSH\n    texelColor.rgb *= 1.0 - (vLightGrass * 0.1);\n    texelColor.rgb *= vShadow;\n  #endif\n\n  #ifdef TREES\n    // Possibly use a second set\n    if(highDef == true) {\n      if(vNoise > 0.25) {\n        texelColor = texture2D( mapb, vUv + vUvOffset );\n      }\n      texelColor += colouration * vShadow;\n    }\n  #endif\n\n  diffuseColor *= texelColor;\n";const Ke=new r.U,_e=(e,t=1,i=r.O)=>{let s=Ke.load(e);return s.wrapS=i,s.wrapT=i,s.anisotropy=t,s},$e=(e,t={})=>{for(let i in t)e.userData[i]={value:t[i]};return e.userData.isNight={value:!1},i=>{for(let s in t)i.uniforms[s]=e.userData[s];i.uniforms.isNight=e.userData.isNight,i.vertexShader=i.vertexShader.replace("#define STANDARD","#define STANDARD\n"+Ue),i.vertexShader=i.vertexShader.replace("#include <begin_vertex>","#include <begin_vertex>\n"+Xe),i.fragmentShader=i.fragmentShader.replace("#define STANDARD","#define STANDARD\n"+Je),i.fragmentShader=i.fragmentShader.replace("#include <normal_fragment_begin>","\n  float faceDirection = -1.0;\n  vec3 normal = normalize(vNormal);\n  vec3 geometryNormal = normal;\n"),i.fragmentShader=i.fragmentShader.replace("#include <map_fragment>",qe),i.fragmentShader=i.fragmentShader.replace("#include <lights_fragment_begin>","\n/**\n * This is a template that can be used to light a material, it uses pluggable\n * RenderEquations (RE)for specific lighting scenarios.\n *\n * Instructions for use:\n * - Ensure that both RE_Direct, RE_IndirectDiffuse and RE_IndirectSpecular are defined\n * - If you have defined an RE_IndirectSpecular, you need to also provide a Material_LightProbeLOD. <---- ???\n * - Create a material parameter that is to be passed as the third parameter to your lighting functions.\n *\n * TODO:\n * - Add area light support.\n * - Add sphere light support.\n * - Add diffuse light probe (irradiance cubemap) support.\n */\n\nGeometricContext geometry;\n\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\n\n#ifdef USE_CLEARCOAT\n\n\tgeometry.clearcoatNormal = clearcoatNormal;\n\n#endif\n\n#ifdef USE_IRIDESCENCE\n\n\tfloat dotNVi = saturate( dot( normal, geometry.viewDir ) );\n\n\tif ( material.iridescenceThickness == 0.0 ) {\n\n\t\tmaterial.iridescence = 0.0;\n\n\t} else {\n\n\t\tmaterial.iridescence = saturate( material.iridescence );\n\n\t}\n\n\tif ( material.iridescence > 0.0 ) {\n\n\t\tmaterial.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );\n\n\t\t// Iridescence F0 approximation\n\t\tmaterial.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );\n\n\t}\n\n#endif\n\nIncidentLight directLight;\n\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\n\t\tpointLight = pointLights[ i ];\n\n\t\tgetPointLightInfo( pointLight, geometry, directLight );\n\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\n\t}\n\t#pragma unroll_loop_end\n\n#endif\n\n/* REFERENCE\n\nvoid getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {\n  vec3 lVector = spotLight.position - geometry.position;\n  light.direction = normalize( lVector );\n  float angleCos = dot( light.direction, spotLight.direction );\n  float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n  if ( spotAttenuation > 0.0 ) {\n    float lightDistance = length( lVector );\n    light.color = spotLight.color * spotAttenuation;\n    light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );\n    light.visible = ( light.color != vec3( 0.0 ) );\n  } else {\n    light.color = vec3( 0.0 );\n    light.visible = false;\n  }\n}\n\nstruct SpotLight {\n  vec3 position;\n  \n\t\tvec3 direction;\n  \n\t\tvec3 color;\n  \n\t\tfloat distance;\n  \n\t\tfloat decay;\n  \n\t\tfloat coneCos;\n  \n\t\tfloat penumbraCos;\n  \n\t\n}\n\n*/\n\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\n\tSpotLight spotLight;\n\tvec4 spotColor;\n\tvec3 spotLightCoord;\n\tbool inSpotLightMap;\n\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\n  #ifdef AUTO_NORMAL\n    geometry.normal = geometry.viewDir;\n  #endif\n\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\n\t\tspotLight = spotLights[ i ];\n\n    // Temper the intensity since we're directly reflecting; 100%  is just too bright\n    spotLight.color *= 0.75;\n    // Extra tempering if autonorm (perfectly vertical)\n    #ifdef AUTO_NORMAL\n      spotLight.color *= 0.33;\n    #endif\n\n\t\tgetSpotLightInfo( spotLight, geometry, directLight );\n\n\t\t// spot lights are ordered [shadows with maps, shadows without maps, maps without shadows, none]\n\t\t#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX\n\t\t#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS\n\t\t#else\n\t\t#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#endif\n\n\t\t#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )\n\t\t\tspotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;\n\t\t\tinSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );\n\t\t\tspotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );\n\t\t\tdirectLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;\n\t\t#endif\n\n\t\t#undef SPOT_LIGHT_MAP_INDEX\n\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t\t#endif\n\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\n\t}\n\t#pragma unroll_loop_end\n  geometry.normal = normal;\n\n#endif\n\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\n\t\tdirectionalLight = directionalLights[ i ];\n\n\t\tgetDirectionalLightInfo( directionalLight, geometry, directLight );\n\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\n\t}\n\t#pragma unroll_loop_end\n\n#endif\n\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\n\tRectAreaLight rectAreaLight;\n\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\n\t}\n\t#pragma unroll_loop_end\n\n#endif\n\n#if defined( RE_IndirectDiffuse )\n\n\tvec3 iblIrradiance = vec3( 0.0 );\n\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\n\tirradiance += getLightProbeIrradiance( lightProbe, geometry.normal );\n\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );\n\n\t\t}\n\t\t#pragma unroll_loop_end\n\n\t#endif\n\n#endif\n\n#if defined( RE_IndirectSpecular )\n\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n\n#endif\n")}},et=e=>{e.vertexShader=e.vertexShader.replace("#define STANDARD","#define STANDARD\n"+Ue),e.vertexShader=e.vertexShader.replace("#include <uv2_vertex>","#include <uv2_vertex>\n"+Xe),e.fragmentShader=e.fragmentShader.replace("#define STANDARD","#define STANDARD\n"+Je),e.fragmentShader=e.fragmentShader.replace("#include <map_fragment>",qe)},tt=(e,t=.75,i=0,s=null,n={},a={})=>{let o=new r.F({map:_e(e,i,r.h),alphaTest:t,side:r.k,depthTest:!0,roughness:1,defines:n});return s&&(o.normalMap=_e(s,i)),o.onBeforeCompile=$e(o,a),o},it=(e,t=.75,i=0,s=null,n=null,a={},o={})=>{let h=new r.F({map:_e(e,i,r.O),alphaTest:t,side:r.k,depthTest:!0,roughness:1,defines:a});return s&&(h.normalMap=_e(s,i)),h.onBeforeCompile=$e(h,o),h};var st=_e;const nt=[{midlineHorizon:2e3,midlineFineHorizon:100,farSize:200,viewDist:200,fwdHorizon:40,rearHorizon:10,nearFwdHorizon:15,wallGenHorizon:65,wallRenderHorizon:20},{midlineHorizon:2e3,midlineFineHorizon:100,farSize:400,viewDist:800,fwdHorizon:90,rearHorizon:15,nearFwdHorizon:25,wallGenHorizon:80,wallRenderHorizon:35},{midlineHorizon:2e3,midlineFineHorizon:110,farSize:700,viewDist:1400,fwdHorizon:180,rearHorizon:20,nearFwdHorizon:30,wallGenHorizon:95,wallRenderHorizon:50},{midlineHorizon:2e3,midlineFineHorizon:125,farSize:1e3,viewDist:2e3,fwdHorizon:250,rearHorizon:30,nearFwdHorizon:40,wallGenHorizon:115,wallRenderHorizon:70},{midlineHorizon:2e3,midlineFineHorizon:150,farSize:1500,viewDist:3e3,fwdHorizon:250,rearHorizon:40,nearFwdHorizon:50,wallGenHorizon:140,wallRenderHorizon:90}],at=[{medRes:5,nearRes:10},{medRes:8,nearRes:16},{medRes:10,nearRes:20},{medRes:12,nearRes:24}],ot=isNaN(parseInt(window.localStorage.getItem("config-view-lod-index")))?2:parseInt(window.localStorage.getItem("config-view-lod-index"));let rt=isNaN(parseInt(window.localStorage.getItem("config-detail-lod-index")))?1:parseInt(window.localStorage.getItem("config-detail-lod-index")),ht=nt[ot],lt=at[rt];const dt=e=>{ht=nt[e],St=ht.farSize,Mt=St/10,Ct=ht.viewDist,Nt=Ct/Math.cos(Dt*(Math.PI/180)/2*(window.screen.availWidth/window.screen.availHeight)),gt=ht.midlineHorizon,vt=ht.midlineFineHorizon,Lt=ht.fwdHorizon,Ot=ht.rearHorizon,Pt=ht.nearFwdHorizon,Gt=ht.rearHorizon,Xt=ht.wallGenHorizon,Jt=ht.wallRenderHorizon,kt.density=Math.sqrt(5/(Ct*Ct))},ct=e=>{lt=at[e],rt=e,jt=lt.medRes,Tt=lt.nearRes,kt=e>1?new r.q(16777215,Math.sqrt(5/(Ct*Ct))):new r.p(16777215,.1*Ct,Ct)},pt=(e,t,i)=>{kt.color.setHex(e),kt.near=t,kt.far=i,kt.isFogExp2&&(kt.density=Math.sqrt(5/(i*i)))},ut=()=>kt;let gt=1500;const mt=1e3,xt=gt-mt;let vt=ht.midlineFineHorizon,wt=7;const ft=e=>{wt=e},bt=new r.a(16777215,.1),At=new r.s(16777215,16777215,.2),yt=new r.j(16777215,.6);yt.sunOffset=new r.W(0,100,0);const It=new r.i(16777215);let St=ht.farSize,Mt=St/10,Dt=68,Ct=St*Math.floor(2.5),Nt=Ct/Math.cos(Dt*(Math.PI/180)/2*(window.screen.availWidth/window.screen.availHeight));let kt=new r.p(16777215,.1*Ct,Ct);const zt=10;let jt=lt.medRes,Lt=ht.fwdHorizon,Ot=ht.rearHorizon;const Rt=10;let Tt=lt.nearRes,Pt=ht.nearFwdHorizon,Gt=Ot;let Bt=1.4;const Wt=e=>{Bt=e};let Ft=.95;const Et=e=>{Ft=e};let Zt=.85;const Ht=e=>{Zt=e};let Qt=3;const Yt=e=>{Qt=e},Vt=.4,Ut=new r.F({map:null,alphaTest:.75});let Xt=ht.wallGenHorizon,Jt=ht.wallRenderHorizon;const qt=30;ht.treeRenderHorizon;const Kt=new r.C({depthTest:!1,fog:!0,map:st(null,2)});Kt.userData.nearCol={value:new r.i(0)},Kt.userData.farCol={value:new r.i(65535)},Kt.userData.hasClouds={value:!0},Kt.userData.camPos={value:new r.W},Kt.userData.time={value:0},Kt.onBeforeCompile=e=>(e.uniforms.nearCol=Kt.userData.nearCol,e.uniforms.farCol=Kt.userData.farCol,e.uniforms.hasClouds=Kt.userData.hasClouds,e.uniforms.camPos=Kt.userData.camPos,e.uniforms.time=Kt.userData.time,e.vertexShader=e.vertexShader.replace("#include <uv_pars_vertex>","#include <uv_pars_vertex>\n\n  uniform float time;\n  uniform vec3 camPos;\n\n  varying vec4 wPos;\n  varying vec2 vUUv;\n  varying vec2 vUUUv;\n\n  float skyScale = 7000.0; // Width of sky texture in metres\n  float skyScale2 = 5600.0;\n"),e.vertexShader=e.vertexShader.replace("#include <uv_vertex>","#include <uv_vertex>\n\n  wPos = modelMatrix * vec4( position, 1.0 );\n\n  // Distance (height) from camera to virtual plane\n  // Big hmm here, these values may intersect with road on rare occasions, could min them\n  float h0 = 350.0 - camPos.y;\n  // Distance from camera to image plane\n  float h1 = 450.0 - camPos.y;\n\n  float lowerScale = skyScale2 * h1 / h0;\n  float motionScale = (h1 - h0) / h0;\n\n  vUUv.x = wPos.x + time;\n  vUUv.y = wPos.z + time;\n\n  vUUv /= skyScale;\n\n  vUUUv.x = ((wPos.x + camPos.x * motionScale ) / lowerScale) + (3000.0 + time) / skyScale2;\n  vUUUv.y = ((wPos.z + camPos.z * motionScale ) / lowerScale) + (3000.0 + time) / skyScale2;\n\n"),e.vertexShader=e.vertexShader.replace("#include <fog_vertex>","vFogDepth = -mvPosition.z;\n#ifdef FOG_EXP2\nvFogDepth = max(0.0, (vFogDepth - fogNear) * (fogFar / (fogFar - fogNear)));\n#endif\n"),e.fragmentShader=e.fragmentShader.replace("#include <uv_pars_fragment>","#include <uv_pars_fragment>\n\n  uniform vec3 nearCol;\n  uniform vec3 farCol;\n  uniform bool hasClouds;\n\n  varying vec2 vUUv;\n  varying vec2 vUUUv;\n\n  const highp float NOISE_GRANULARITY = 0.1;\n\n  highp float random(vec2 coords) {\n     return (fract(sin(dot(coords.xy, vec2(12.9898,78.233))) * 43758.5453) * 0.2) - 0.1;\n  }\n"),e.fragmentShader=e.fragmentShader.replace("#include <aomap_fragment>","#include <aomap_fragment>\n\n  float vX = (vUv.x - 0.5) * 5.0;\n  float vY = (vUv.y - 0.5) * 5.0;\n\n  float dist = max(0.0, 1.0 - sqrt((vX * vX) + (vY * vY)));\n\n  // DITHERING - todo only on high qual?\n  // dist += random(vec2(vX, vY));\n\n  vec4 skyCol = vec4(mix(farCol, nearCol, dist*dist), 1.0);\n\n  if(hasClouds) {\n\n    // vec4 upperClouds = texture2D(map, vUUv);\n    // vec4 lowerClouds = texture2D(map, vUUUv);\n    //\n    // if(lowerClouds.a > 0.5) {\n    //   lowerClouds.rgb = mix(lowerClouds.rgb, vec3(1.0, 0.5, 0.28), (lowerClouds.a - 0.5) * 2.0);\n    // }\n    //\n    // vec4 cloudCol = max(upperClouds, lowerClouds);\n\n    vec4 cloudCol = max(texture2D( map, vUUv ), texture2D(map, vUUUv)); // MAX\n    // vec4 cloudCol = texture2D( map, vUUv ) * texture2D(map, vUUUv); // MULTIPLY\n    // vec4 cloudCol = (texture2D(map, vUUv) + texture2D( map, vUUUv )) / 2.0; // AVERAGE\n\n    // Apply colour if we have it?\n\n    diffuseColor = mix(skyCol, cloudCol, cloudCol.a);\n\n  } else {\n    diffuseColor = skyCol;\n  }\n\n"),e);const _t={discretisedTail:null,head:null,tail:null,vehicleIndex:0,vehicleNode:null,initIndex:0},$t={},ei=(e,t,i,s=!1,n=!1)=>{for($t.checkNode=i,$t.dist=(i.p.x-e)*(i.p.x-e)+(i.p.z-t)*(i.p.z-t),$t.closestDist=$t.dist,$t.closestNode=$t.checkNode,$t.closestFwdDist=$t.dist,$t.closestRearDist=$t.dist,$t.checkInterval=10;$t.checkInterval>0;$t.checkInterval-=9){for($t.checkMargin=10==$t.checkInterval?1.9:1.2,$t.closestFwdNode=$t.closestNode,$t.closestRearNode=$t.closestNode,$t.lastChance=!1,$t.checkCount=0,$t.checkNode=$t.closestFwdNode;!($t.checkCount>=10||$t.checkNode.i+$t.checkInterval>_t.tail.i);){if($t.checkInterval>1?$t.checkNode=$t.checkNode.next.next.next.next.next.next.next.next.next.next:$t.checkNode=$t.checkNode.next,$t.dist=($t.checkNode.p.x-e)*($t.checkNode.p.x-e)+($t.checkNode.p.z-t)*($t.checkNode.p.z-t),$t.dist<$t.closestDist)$t.lastChance=!1,$t.closestDist=$t.dist,$t.closestFwdDist=$t.closestDist,$t.closestFwdNode=$t.checkNode;else if($t.dist<$t.closestDist*$t.checkMargin)$t.lastChance=!1;else{if($t.lastChance)break;$t.lastChance=!0}$t.checkCount++}for($t.checkNode=$t.closestRearNode,$t.lastChance=!1,$t.checkCount=0;!($t.checkCount>=10||$t.checkNode.i-$t.checkInterval<_t.head.i);){if($t.checkInterval>1?$t.checkNode=$t.checkNode.prev.prev.prev.prev.prev.prev.prev.prev.prev.prev:$t.checkNode=$t.checkNode.prev,$t.dist=($t.checkNode.p.x-e)*($t.checkNode.p.x-e)+($t.checkNode.p.z-t)*($t.checkNode.p.z-t),$t.dist<$t.closestDist)$t.lastChance=!1,$t.closestDist=$t.dist,$t.closestRearDist=$t.closestDist,$t.closestRearNode=$t.checkNode;else if($t.dist<$t.closestDist*$t.checkMargin)$t.lastChance=!1;else{if($t.lastChance)break;$t.lastChance=!0}$t.checkCount++}if($t.closestFwdDist<$t.closestRearDist?$t.closestNode=$t.closestFwdNode:$t.closestNode=$t.closestRearNode,!s)break}return{n:$t.closestNode,d2:$t.closestDist}},ti=(e,t,i,s=!1,n=!1)=>{var a,o;if($t.side=i.n.x*(t-i.p.z)-i.n.z*(e-i.p.x),n&&console.log(e,t,i.p.x,i.p.z),$t.side<0&&(null===(a=i.next)||void 0===a?void 0:a.next))for($t.t=i.next.n.x*(t-i.next.p.z)-i.next.n.z*(e-i.next.p.x);$t.t<0&&i.next;)$t.side=$t.t,i=i.next,$t.t=i.next.n.x*(t-i.next.p.z)-i.next.n.z*(e-i.next.p.x);else for(;$t.side>0&&i.prev;)i=i.prev,$t.side=i.n.x*(t-i.p.z)-i.n.z*(e-i.p.x);if($t.x1=i.p.x,$t.z1=i.p.z,$t.x2=i.next.p.x,$t.z2=i.next.p.z,$t.len=($t.x2-$t.x1)*($t.x2-$t.x1)+($t.z2-$t.z1)*($t.z2-$t.z1),$t.t=((e-$t.x1)*($t.x2-$t.x1)+(t-$t.z1)*($t.z2-$t.z1))/$t.len,$t.t=Math.max(Math.min($t.t,1),0),s&&(null===(o=i.next.ps)||void 0===o?void 0:o.length)){var r,h;if($t.t1=Math.min(.999,$t.t)*i.ps.length,$t.t2=Math.floor($t.t1),$t.t1=$t.t1-$t.t2,$t.pa=i.ps[$t.t2],$t.na=i.ns[$t.t2],$t.pb=i.next.p,$t.nb=i.next.n,$t.t2<i.ps.length-1&&($t.pb=i.ps[$t.t2+1],$t.nb=i.ns[$t.t2+1]),n&&console.log($t.t1,$t.t2),void 0===$t.na||void 0===$t.pa)console.log("UNDEFINED looking up ",e,t),console.log(i),console.log(i.ps),console.log(null===(r=i.ps)||void 0===r?void 0:r.length),console.log(i.ns),console.log(null===(h=i.ns)||void 0===h?void 0:h.length),console.log($t.t1,$t.t2);return $t.side=$t.na.x*(t-$t.pa.z)-$t.na.z*(e-$t.pa.x),$t.side<0&&$t.t2<i.ps.length-2?$t.nb.x*(t-$t.pb.z)-$t.nb.z*(e-$t.pb.x)<0&&($t.t2++,$t.pa=i.ps[$t.t2],$t.pb=i.ps[$t.t2+1],$t.na=i.ns[$t.t2]):$t.side>0&&$t.t2>0&&($t.t2--,$t.pa=i.ps[$t.t2],$t.pb=i.ps[$t.t2+1],$t.na=i.ns[$t.t2]),$t.x1=$t.pa.x,$t.z1=$t.pa.z,$t.x2=$t.pb.x,$t.z2=$t.pb.z,$t.len=($t.x2-$t.x1)*($t.x2-$t.x1)+($t.z2-$t.z1)*($t.z2-$t.z1),$t.t1=((e-$t.x1)*($t.x2-$t.x1)+(t-$t.z1)*($t.z2-$t.z1))/$t.len,$t.x3=$t.x1+$t.t1*($t.x2-$t.x1),$t.z3=$t.z1+$t.t1*($t.z2-$t.z1),$t.x1=$t.x3-e,$t.z1=$t.z3-t,$t.side=$t.x1*$t.na.x+$t.z1*$t.na.z,{d:Math.sqrt($t.x1*$t.x1+$t.z1*$t.z1),y:$t.pa.y+$t.t1*($t.pb.y-$t.pa.y),da:i.da+$t.t*(i.next.da-i.da),s:$t.side<0?-1:1,w:i.w+$t.t*(i.next.w-i.w),g:i.g+$t.t*(i.next.g-i.g),t:$t.t,n:i}}return $t.x3=$t.x1+$t.t*($t.x2-$t.x1),$t.z3=$t.z1+$t.t*($t.z2-$t.z1),$t.x1=$t.x3-e,$t.z1=$t.z3-t,$t.side=$t.x1*i.n.x+$t.z1*i.n.z,{d:Math.sqrt($t.x1*$t.x1+$t.z1*$t.z1),y:i.p.y+$t.t*(i.next.p.y-i.p.y),da:i.da+$t.t*(i.next.da-i.da),s:$t.side<0?-1:1,w:i.w+$t.t*(i.next.w-i.w),g:i.g+$t.t*(i.next.g-i.g),t:$t.t,n:i}};var ii=_t;const si=new r.W(0,1,0),ni={};class ai{static initialise(e){console.log("Loading near grid cell..."),e()}constructor(e,t,i,s=!1){this.retired=!1,this.isDebug=!1,this.centroid=new r.W,this.genRow=0,this.genIndex=0,this.nodeIndex=0,this.meshReady=!1,this.foliRow=0,this.foliIndex=0,this.foliageReady=!1,this.lod=0,this.tileCoords={x:0,z:0},this.originNode=null,this.isDebug=!1,this.farCell={x:0,z:0},this.initialised=!1,this.getHeight=()=>{},this.lod=e,this.heightmap=i,this.heights=[],this.res=t,this.res1=t+1,this.grads=[],this.norms=new Float32Array(this.res1*this.res1*3),this.verts=new Float32Array(this.res1*this.res1*3),this.roadProx=new Float32Array(this.res1*this.res1),this.treeMask=new Float32Array(this.res1*this.res1),this.curves=new Float32Array(this.res1*this.res1),this.signedRoadProx=[]}initGeneration(e,t,i,s=!1,n){if(this.initialised=!1,this.retired=!1,this.hide(),this.active=!1,this.originNode=e,this.originIndex=e.i,this.coords=t,this.tileCoords={x:t.x%Mt,z:t.z%Mt},this.heightmap=n,this.tileCoords.x<0&&(this.tileCoords.x+=Mt),this.tileCoords.z<0&&(this.tileCoords.z+=Mt),this.originPos={x:t.x*Rt,y:0,z:t.z*Rt},this.originPos.y=this.heightmap.getXZ(this.originPos.x,this.originPos.z),this.centroid.set(this.originPos.x+5,this.originPos.y,this.originPos.z+5),this.tileset=i,this.tileIndex=i.nextTileIndex++,this.tileset.registerCallback(this.tileIndex,(e=>{this.tileIndex=e})),this.tileset.setRetireIndex(this.originIndex),0==this.tileIndex&&this.tileset.setOrigin(this.originPos),this.indexOffset=this.tileIndex*this.tileset.vertexCount,this.genRow=0,this.genIndex=0,this.farCell.x=Math.floor(this.originPos.x/St),this.farCell.z=Math.floor(this.originPos.z/St),this.preHeights=[],0==Sh.value.detailLodIndex?(this.precomputeHeights(),this.getHeight=this.lookupHeight2):this.getHeight=n.getXZ.bind(n),this.preCurves=[],this.precomputeCurvature(),this.initialised=this.preInitialise(s),this.initialised&&s){for(;!this.generate(););this.display(1==this.lod)}}preInitialise(){return!0}static sharpLerpAB(e,t,i){return(t-e)*i+e}static hockeyLerp(e){if(e>.3333){let t=1-(e-.3333)/.6667;return 1-t*t*.5}return 1.5*e}getNormal(e,t){let i,s;i=e<0?Math.floor((Rt+e%Rt)/Rt*this.res):Math.floor(e%Rt/Rt*this.res),s=t<0?Math.floor((Rt+t%Rt)/Rt*this.res):Math.floor(t%Rt/Rt*this.res);let n=3*(i*this.res1+s);return[this.norms[n],this.norms[n+1],this.norms[n+2]]}getNormalAtIndex(e){}lookupHeight(e,t){return ni.tx=(e-this.originPos.x)/Rt*this.res,ni.tz=(t-this.originPos.z)/Rt*this.res,ni.x=Math.floor(ni.tx),ni.z=Math.floor(ni.tz),ni.tx-=ni.x,ni.tz-=ni.z,ni.xi=ni.x*this.res1,ni.zi=ni.z,ni.c1=this.heights[ni.xi+ni.zi]*(1-ni.tx)+this.heights[ni.xi+this.res1+ni.zi]*ni.tx,ni.c2=this.heights[ni.xi+ni.zi+1]*(1-ni.tx)+this.heights[ni.xi+this.res1+ni.zi+1]*ni.tx,ni.c1*(1-ni.tz)+ni.c2*ni.tz}lerpHeight(e,t,i){return ni.lh=0,i.h=i.n.h+i.t*(i.n.next.h-i.n.h),i.gfa=i.n.gfa+i.t*(i.n.next.gfa-i.n.gfa),i.ga=Math.max(Math.abs(i.g),Math.abs(i.h))/3.6,i.w+=Vt+i.ga,i.y-=.01+.01*i.gfa,i.ga=1-i.ga*i.ga,ni.rm=4+16*Math.min(.75,Math.max(.4,i.ga)),i.d<i.w+ni.rm?i.d<i.w&&!i.n.bridge?ni.lh=i.y:(ni.lt=Math.max(0,Math.min(1,2*(i.d-i.w)/ni.rm)),ni.lt=ai.hockeyLerp(ni.lt),ni.lh=this.getHeight(e,t),i.n.bridge&&ni.lh<0&&(ni.lh>-i.y?ni.lt=Math.max(ni.lt,ni.lh/-i.y):ni.lt=1),ni.lh=ni.lh*ni.lt+i.y*(1-ni.lt)):ni.lh=this.getHeight(e,t),ni.lh}static lerpHeightGlobal(e,t,i,s){let n=0;if(i.ga=Math.max(Math.abs(i.g),Math.abs(i.n.h))/3.6,i.w+=Vt+i.ga,i.y-=.01+.02*i.n.gfa,i.ga=1-i.ga*i.ga,ni.rm=4+16*Math.min(.75,Math.max(.4,i.ga)),i.d<i.w+ni.rm)if(i.d<i.w&&!i.n.bridge)n=i.y;else{let a=Math.max(0,Math.min(1,2*(i.d-i.w)/ni.rm));a=ai.hockeyLerp(a),n=s(e,t),i.n.bridge&&n<0&&(a=n>-i.y?Math.max(a,n/-i.y):1),n=n*a+i.y*(1-a)}else n=s(e,t);return n}lookupHeight2(e,t){return ni.tx=(e-this.originPos.x)/Rt,ni.tz=(t-this.originPos.z)/Rt,ni.tx<0?(ni.tx+=1,ni.tz<0?(ni.tz+=1,ni.c1=this.preHeights[0]*(1-ni.tx)+this.preHeights[1]*ni.tx,ni.c2=this.preHeights[4]*(1-ni.tx)+this.preHeights[5]*ni.tx):ni.tz>1?(ni.tz-=1,ni.c1=this.preHeights[8]*(1-ni.tx)+this.preHeights[9]*ni.tx,ni.c2=this.preHeights[12]*(1-ni.tx)+this.preHeights[13]*ni.tx):(ni.c1=this.preHeights[4]*(1-ni.tx)+this.preHeights[5]*ni.tx,ni.c2=this.preHeights[8]*(1-ni.tx)+this.preHeights[9]*ni.tx)):ni.tx>1?(ni.tx-=1,ni.tz<0?(ni.tz+=1,ni.c1=this.preHeights[2]*(1-ni.tx)+this.preHeights[3]*ni.tx,ni.c2=this.preHeights[6]*(1-ni.tx)+this.preHeights[7]*ni.tx):ni.tz>1?(ni.tz-=1,ni.c1=this.preHeights[10]*(1-ni.tx)+this.preHeights[11]*ni.tx,ni.c2=this.preHeights[14]*(1-ni.tx)+this.preHeights[15]*ni.tx):(ni.c1=this.preHeights[6]*(1-ni.tx)+this.preHeights[7]*ni.tx,ni.c2=this.preHeights[10]*(1-ni.tx)+this.preHeights[11]*ni.tx)):ni.tz<0?(ni.tz+=1,ni.c1=this.preHeights[1]*(1-ni.tx)+this.preHeights[2]*ni.tx,ni.c2=this.preHeights[5]*(1-ni.tx)+this.preHeights[6]*ni.tx):ni.tz>1?(ni.tz-=1,ni.c1=this.preHeights[9]*(1-ni.tx)+this.preHeights[10]*ni.tx,ni.c2=this.preHeights[13]*(1-ni.tx)+this.preHeights[14]*ni.tx):(ni.c1=this.preHeights[5]*(1-ni.tx)+this.preHeights[6]*ni.tx,ni.c2=this.preHeights[9]*(1-ni.tx)+this.preHeights[10]*ni.tx),ni.c1*(1-ni.tz)+ni.c2*ni.tz}generate(){if(!this.initialised)return this.initialised=this.preInitialise(),!1;if(this.genRow>this.res)return!0;let e,t,i,s,n,a,o,r,h;this.genIndex=this.genRow*(this.res+1)*3,r=this.genRow/this.res*10;for(let l=0;l<=this.res;l++)h=l/this.res*10,e=this.genIndex+3*l,t=e/3,a=r+this.originPos.x,o=h+this.originPos.z,n=ti(a,o,this.originNode,1==this.lod),n.e=Vt+Math.abs(n.da),this.signedRoadProx[t]=n.d-(n.w+n.e),i=n.d-n.w,s=this.lerpHeight(a,o,n),this.isDebug&&console.log(n.t,n.n.h,n.n.gfa,n.n.next.gfa),this.heights[t]=s,this.roadProx[t]=i,this.treeMask[t]=0,this.verts[e]=a-this.tileset.origin.x,this.verts[e+1]=s-this.tileset.origin.y,this.verts[e+2]=o-this.tileset.origin.z;return this.genRow>0&&(this.computeSquareNormalsRow(this.genRow-1),this.postProcessRow(this.genRow-1)),this.genRow++,this.genRow>this.res&&(this.computeSquareNormalsRow(this.genRow-1),this.centroid.y=(this.heights[0]+this.heights[this.res]+this.heights[this.res*this.res1]+this.heights[this.res1*this.res+this.res])/4,this.centroid.sub(this.tileset.origin),this.postProcessRow(this.genRow-1),this.postProcessCell()),this.genRow>this.res}postProcessRow(e){}postProcessCell(){}computeSquareNormalsRow(e){let t,i,s,n,a,o,h,l,d,c,p=Rt/this.res,u=2*p,g=new r.W,m=new r.W;for(d=e*this.res1,t=0;t<=this.res;t++){o=e*p+this.originPos.x,h=t*p+this.originPos.z,0==t?(o=e*p+this.originPos.x,h=this.originPos.z-p,l=ti(o,h,this.originNode,1==this.lod),n=this.lerpHeight(o,h,l)):n=this.heights[d+(t-1)],t==this.res?(o=e*p+this.originPos.x,h=this.originPos.z+(t+1)*p,l=ti(o,h,this.originNode,1==this.lod),a=this.lerpHeight(o,h,l)):a=this.heights[d+(t+1)],0==e?(o=this.originPos.x-p,h=t*p+this.originPos.z,l=ti(o,h,this.originNode,1==this.lod),i=this.lerpHeight(o,h,l)):i=this.heights[(e-1)*this.res1+t],e==this.res?(o=(e+1)*p+this.originPos.x,h=t*p+this.originPos.z,l=ti(o,h,this.originNode,1==this.lod),s=this.lerpHeight(o,h,l)):s=this.heights[(e+1)*this.res1+t],g.set(u,s-i,0),m.set(0,a-n,u),g.cross(m).normalize().negate(),c=3*(d+t),this.norms[c]=g.x,this.norms[c+1]=g.y,this.norms[c+2]=g.z;let r=e/this.res1,x=t/this.res1,v=this.preCurves[0]*(1-r)+this.preCurves[1]*r,w=this.preCurves[2]*(1-r)+this.preCurves[3]*r;this.curves[d+t]=v*(1-x)+w*x,this.grads[d+t]=1-Math.abs(g.dot(si))}}precomputeHeights(){this.preHeights.length=0;let e,t,i=this.originPos.x,s=this.originPos.z;for(t=-1;t<3;t++)for(e=-1;e<3;e++)this.preHeights.push(this.heightmap.getXZ(i+10*e,s+10*t))}precomputeCurvature(){let e=this.originPos.x,t=this.originPos.z;this.getCurvature(e,t),this.getCurvature(e+10,t),this.getCurvature(e,t+10),this.getCurvature(e+10,t+10)}getCurvature(e,t,i=5){let s=this.heightmap.getXZLayer(e-i,t,0)+this.heightmap.getXZLayer(e+i,t,0)+this.heightmap.getXZLayer(e,t-i,0)+this.heightmap.getXZLayer(e,t+i,0);s=s/4-this.heightmap.getXZ(e,t),this.preCurves.push(.02*s)}display(e=!1){this.active=!0,this.tileset.tileReady(this.tileIndex,this.verts,this.norms,this.curves,this.roadProx,this.treeMask,this.centroid,e)}show(){this.tileset.draw(),this.active=!0}hide(){this.active=!1}retire(){this.tileset.hideTile(this.tileIndex),this.retired=!0}}var oi=ai;class ri extends r.g{constructor(e,t){super();let i,s,n,a,o=[],h=[],l=[],d=[];this.res=e,this.size=t,this.count=(e+1)*(e+1);for(let r=0;r<=e;r++)for(let c=0;c<=e;c++)o.push(r/e*t,0,c/e*t),l.push(0),r<e&&c<e&&(i=r*(e+1)+c,s=r*(e+1)+(c+1),n=(r+1)*(e+1)+c,a=(r+1)*(e+1)+(c+1),h.push(i,s,n),h.push(s,a,n)),d.push(0);this.setIndex(h),this.setAttribute("position",new r.o(new Float32Array(o),3)),this.setAttribute("heightOffset",new r.o(new Float32Array(l),1)),this.attributes.heightOffset.setUsage(r.l),this.setAttribute("normal",new r.o(new Float32Array(o.length),3)),this.attributes.normal.setUsage(r.l),this.setAttribute("curvature",new r.o(new Float32Array(d),1)),this.attributes.curvature.setUsage(r.l)}computeBoundingSphere(){null==this.boundingSphere&&(this.boundingSphere=new r.R(new r.W,0));const e=this.attributes.position.array,t=this.attributes.heightOffset.array;let i=e.length,s=t.length,n=e[i-3]-e[0],a=t[s-1]-t[0],o=e[i-1]-e[2],h=n*n+a*a+o*o,l=this.res*(this.res+1),d=this.res,c=3*l,p=3*d;n=e[p]-e[c],a=t[d]-t[l],o=e[p+2]-e[c+2];let u=n*n+a*a+o*o;u>h?(this.boundingSphere.radius=Math.sqrt(u)/2,this.boundingSphere.center.set((e[c]+e[p])/2,(t[l]+t[d])/2,(e[c+2]+e[p+2])/2)):(this.boundingSphere.radius=Math.sqrt(h)/2,this.boundingSphere.center.set((e[0]+e[i-3])/2,(t[0]+t[s-1])/2,(e[2]+e[i-1])/2)),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}computeTriangleNormals(){const e=this.index,t=this.attributes.position,i=this.attributes.normal,s=new r.W,n=new r.W,a=new r.W,o=new r.W,h=new r.W,l=new r.W,d=new r.W,c=new r.W;let p,u,g;for(let r=0,m=e.count;r<m;r+=3)p=e.getX(r+0),u=e.getX(r+1),g=e.getX(r+2),s.fromBufferAttribute(t,p),n.fromBufferAttribute(t,u),a.fromBufferAttribute(t,g),d.subVectors(a,n),c.subVectors(s,n),d.cross(c),o.fromBufferAttribute(i,p),h.fromBufferAttribute(i,u),l.fromBufferAttribute(i,g),o.add(d),h.add(d),l.add(d),i.setXYZ(p,o.x,o.y,o.z),i.setXYZ(u,h.x,h.y,h.z),i.setXYZ(g,l.x,l.y,l.z);this.normalizeNormals(),this.attributes.normal.needsUpdate=!0}}const hi=new r.W(0,1,0),li={vecV:new r.W,vecH:new r.W};var di=class{constructor(e,t){this.isDebug=!1,this.genRow=0,this.genIndex=0,this.nodeIndex=0,this.latestIndex=0,this.overlapIndex=0,this.overlapCells=[],this.needsOverlapRedraw=!1,this.ready=!1,this.originNode=null,this.exitNode=null,this.isDebug=!1,this.res=Mt,this.res1=this.res+1,this.res3=3*this.res1,this.size=St,this.heightmap=e,this.heights=[],this.grads=[],this.geo=new ri(this.res,this.size),this.ground=new r.B(this.geo,t),this.verts=this.geo.attributes.position.array,this.heightOffsets=this.geo.attributes.heightOffset.array,this.mesh=new r.G,this.mesh.matrixAutoUpdate=!1,this.mesh.renderOrder=10,this.mesh.add(this.ground),this.mesh.visible=!1}initGeneration(e,t,i,s,n,a,o=!1){this.hide(),this.originNode=i,this.exitNode=s,this.originCoords={x:e,z:t},this.originPos={x:e*this.size,y:0,z:t*this.size},this.heightmap=a,this.mesh.position.copy(this.originPos),this.needsOverlapRedraw=o,this.genRow=0,this.genIndex=0,this.overlapIndex=0,this.overlapCells.length=0,this.overlapTile=null,n&&(this.overlapTile=n,this.overlapCells=Object.keys(this.overlapTile)),this.originPos.y=this.heightmap.getXZ(this.originPos.x,this.originPos.z),this.mesh.position.y=this.originPos.y,this.isDebug=!1,this.ready=!1}resetOverlapMap(e,t){this.exitNode=e,this.overlapIndex=0,this.overlapCells.length=0,this.overlapTile=null,t&&(this.overlapTile=t,this.overlapCells=Object.keys(this.overlapTile))}forceGenerate(){for(;!this.generate(););this.display()}generate(){if(this.genRow<=this.res){for(this.genIndex=this.genRow*this.res1*3,li.i=0;li.i<=this.res;li.i++)li.index=this.genIndex+3*li.i,li.index3=this.genRow*this.res1+li.i,li.x=this.verts[li.index]+this.originPos.x,li.z=this.verts[li.index+2]+this.originPos.z,li.h=this.heightmap.getXZ(li.x,li.z),this.heights[li.index3]=li.h,this.heightOffsets[li.index3]=li.h-this.mesh.position.y;return this.genRow>0&&this.computeSquareNormalsRow(this.genRow-1),this.genRow++,this.genRow>this.res&&(this.computeSquareNormalsRow(this.genRow-1),this.geo.attributes.normal.needsUpdate=!0,this.geo.attributes.curvature.needsUpdate=!0),!1}if(this.overlapIndex<this.overlapCells.length){for(li.oz in li.ox=this.overlapCells[this.overlapIndex],this.overlapTile[li.ox])this.overlapTile[li.ox][li.oz]<0||(li.index=li.ox*this.res1+1*li.oz,this.heightOffsets[li.index]=this.heights[li.index]-this.mesh.position.y-(6+2.5*this.overlapTile[li.ox][li.oz]));return this.overlapIndex++,!1}return this.mesh.visible&&this.display(),this.ready=!0,!0}lookupHeight(e,t){return e<0||e>St||t<0||t>St?this.heightmap.getXZ(this.originPos.x+e,this.originPos.z+t):(li.cx=Math.max(e/10,0),li.cz=Math.max(t/10,0),li.ix=Math.min(Mt-1,Math.floor(li.cx)),li.iz=Math.min(Mt-1,Math.floor(li.cz)),li.index=this.res1*li.ix+li.iz,li.px=li.cx-li.ix,li.pz=li.cz-li.iz,li.hx=this.heights[li.index]*(1-li.px)+this.heights[li.index+this.res1]*li.px,li.hz=this.heights[li.index+1]*(1-li.px)+this.heights[li.index+this.res1+1]*li.px,li.hx*(1-li.pz)+li.hz*li.pz)}display(e=!1){if(e&&!this.ready)for(;!this.generate(););this.geo.attributes.heightOffset.needsUpdate=!0,this.geo.computeBoundingSphere(),this.mesh.updateMatrix(),this.show()}retire(){this.hide()}show(){this.mesh.visible=!0}hide(){this.mesh.visible=!1}computeSquareNormalsRow(e){for(li.d=St/this.res,li.d2=2*li.d,li.normalAttribute=this.geo.attributes.normal,li.curvatureAttribute=this.geo.attributes.curvature,li.rowIndex=e*this.res1,li.j=0;li.j<=this.res;li.j++)li.hAvg=0,li.tX=e*li.d+this.originPos.x,li.tZ=li.j*li.d+this.originPos.z,li.hAvg+=this.heightmap.getXZLayer(li.tX+5,li.tZ,0),li.hAvg+=this.heightmap.getXZLayer(li.tX-5,li.tZ,0),li.hAvg+=this.heightmap.getXZLayer(li.tX,li.tZ+5,0),li.hAvg+=this.heightmap.getXZLayer(li.tX,li.tZ-5,0),li.hAvg=li.hAvg/4-this.heights[li.rowIndex+li.j],0==li.j?(li.tX=e*li.d+this.originPos.x,li.tZ=this.originPos.z-li.d,li.left=this.heightmap.getXZ(li.tX,li.tZ)):li.left=this.heights[li.rowIndex+(li.j-1)],li.j==this.res?(li.tX=e*li.d+this.originPos.x,li.tZ=this.originPos.z+(li.j+1)*li.d,li.right=this.heightmap.getXZ(li.tX,li.tZ)):li.right=this.heights[li.rowIndex+(li.j+1)],0==e?(li.tX=this.originPos.x-li.d,li.tZ=li.j*li.d+this.originPos.z,li.up=this.heightmap.getXZ(li.tX,li.tZ)):li.up=this.heights[(e-1)*this.res1+li.j],e==this.res?(li.tX=(e+1)*li.d+this.originPos.x,li.tZ=li.j*li.d+this.originPos.z,li.down=this.heightmap.getXZ(li.tX,li.tZ)):li.down=this.heights[(e+1)*this.res1+li.j],li.vecV.set(li.d2,li.down-li.up,0),li.vecH.set(0,li.right-li.left,li.d2),li.vecV.cross(li.vecH).normalize().negate(),li.normalAttribute.setXYZ(li.rowIndex+li.j,li.vecV.x,li.vecV.y,li.vecV.z),this.grads[li.rowIndex+li.j]=1-Math.abs(li.vecV.dot(hi)),li.curvatureAttribute.array[li.rowIndex+li.j]=.02*li.hAvg}};class ci{constructor(){this.nearGridCell=oi,this.farGridCell=di}sanitiseConfig(e){this.skinList.includes(e.value.skin)||(console.log("Scene config not compatible; reverting to default skin"),e.set("skin","default",!0),e.set("weatherIndex",0,!0))}loader(){return 1}updateConfig(e,t){}reset(e,t,i){this.initialise(e,t,i)}initialise(e,t,i){this.seed=e,i()}onMidlineReady(){}onGridReady(){}nextWeather(){}setScene(e){}setWeather(e){}nextSkin(){}nextTopography(){}prepareGeometry(){}update(){}destroy(){}onToggleBarriers(e){}}ci.sceneName="Scene",ci.hasTrees=!0,ci.hasGrass=!0;var pi=class{constructor(e){this.rand=new window.alea(e||Ee)}generate(){}getXZ(e,t){return 0}getCell(e,t){return e in this.cacheAccess||(this.cacheAccess[e]={}),this.cacheAccess[e][t]=!0,this.cache[e]&&this.cache[e][t]||this.cacheCell(e,t),e in this.cacheAccess||(this.cacheAccess[e]={}),this.cacheAccess[e][t]=!0,this.cache[e][t]}clearCache(){if(this.cacheCount<=this.maxCached)return;let e,t;for(e in this.cache){for(t in this.cache[e])if(this.cacheAccess[e][t])this.cacheAccess[e][t]=!1;else if(delete this.cache[e][t],delete this.cacheAccess[e][t],this.cacheCount--,this.cacheCount<=this.maxCached)break;if(this.cacheCount<=this.maxCached)break}}generateCell(e,t){return[]}cacheCell(e,t){this.cacheCount++,this.clearCache();let i=this.generateCell(e,t);e in this.cache||(this.cache[e]={}),this.cache[e][t]=i}destroy(){}};const ui="Hanne!",gi={layer:0,d:0,h:0,sq:0,sqb:0,wx:0,wz:0,ox:0,oz:0,px:0,pz:0,cell:null,ix:0,iz:0,depth:0},mi={...gi},xi={};var vi=class extends pi{constructor(...e){super(...e),this.resolution=5,this.depth=3,this.upscale=2,this.heightScale=1,this.heightOffset=0,this.upscaleType=0,this.controls=[],this.cache={},this.cacheAccess={},this.cacheCount=0,this.maxCached=9,this.qCache={},this.smoothingFunc=()=>{},this.useQuick=!1;let t=e[1]||{};switch(null!==t.heightScale&&(this.heightScale=t.heightScale),null!==t.resolution&&(this.resolution=t.resolution),this.seed=e[0]||ui,this.depth=t.depth||3,this.radiusType=null==t.radiusType?1:t.radiusType,this.upscale=t.upscale||2,this.upscaleType=null==t.upscaleType?0:t.upscaleType,this.upscaleFactor=null==t.upscaleFactor?2:t.upscaleFactor,this.squared=t.squared||!1,this.compound=t.compound||!1,this.depthHeightFactor=t.depthHeightFactor||1,this.smoothLerpIndex=null==t.smoothLerp?2:t.smoothLerp,this.smoothLerpIndex){case 2:this.smoothingFunc=this.smootherLerp;break;case 1:this.smoothingFunc=this.smoothLerp;break;case 0:default:this.smoothingFunc=this.sharpLerp}if(null!=t.resolutions)this.resolutions=t.resolutions,this.resolution=this.resolutions[0],this.depth=this.resolutions.length;else{this.resolutions=[this.resolution];for(let e=0;e<this.depth-1;e++)this.resolutions.push(this.calculateNextDepthResolution(this.resolutions[e],e))}this.controls=[],this.cellScaleMetres=1e3,this.cellScaleWorld=3e3,this.heightOffset=t.heightOffset,this.cacheCell(0,0)}cosLerp(e){return Math.cos(3.1415*e)+1}sharpLerp(e){return 1-e}smoothLerp(e){return-1*(3-2*e)*e*e+1}smootherLerp(e){return(e*(6*e-15)+10)*e*e*e*-1+1}sharpLerpAB(e,t,i){return(t-e)*i+e}smootherLerpAB(e,t,i){return(i*(6*i-15)+10)*i*i*i*(t-e)+e}lerpHeight(e,t,i,s){return(e=(s.x-t)*(s.x-t)+(s.z-i)*(s.z-i))<s.r2?this.smoothingFunc(e/s.r2)*s.y:0}clearCache(){if(!(this.cacheCount<=this.maxCached))for(xi.ox in this.cache){for(xi.oz in this.cache[xi.ox])if(this.cacheAccess[xi.ox][xi.oz])this.cacheAccess[xi.ox][xi.oz]=!1;else if(delete this.cache[xi.ox][xi.oz],delete this.cacheAccess[xi.ox][xi.oz],this.cacheCount--,this.cacheCount<=this.maxCached)break;if(this.cacheCount<=this.maxCached)break}}cacheCell(e,t){for(this.cacheCount++,this.clearCache(),xi.cell=[],xi.hFactor=1,xi.rand=new window.alea(this.seed+e+t),xi.depthRes=this.resolution,xi.layer=[],xi.dhf=this.depthHeightFactor,xi.d=0;xi.d<this.depth;xi.d++){for(xi.depthRes=this.resolutions[xi.d],xi.hFactor=this.resolution/xi.depthRes*xi.dhf,xi.dhf*=this.depthHeightFactor,xi.layer=[],xi.rad=1/xi.depthRes,xi.i=0;xi.i<xi.depthRes;xi.i++){for(xi.subLayer=[],xi.j=0;xi.j<xi.depthRes;xi.j++)xi.h=2*xi.rand()-1,this.squared&&(xi.h<0?xi.h*=-xi.h*(1+xi.h)*4:xi.h*=xi.h*(1-xi.h)*4),xi.h*=xi.hFactor,xi.subLayer.push({x:(xi.i+.5)/xi.depthRes,y:xi.h*this.heightScale,z:(xi.j+.5)/xi.depthRes,r:xi.rad,r2:xi.rad*xi.rad});xi.layer.push(xi.subLayer)}xi.cell.push(xi.layer)}e in this.cache||(this.cache[e]={}),this.cache[e][t]=xi.cell}calculateNextDepthResolution(e,t){switch(this.upscaleType){case 5:let i,s=this.resolution,n=this.resolution;for(let e=0;e<t+1;e++)i=s+n,n=s,s=i;return i;case 4:return e*this.upscaleFactor+(t+1);case 3:return Math.round(e*this.upscaleFactor);case 2:return Math.pow(this.resolution,t+2);case 1:return this.resolution+Math.pow(this.upscale,t+1);case 0:default:return e+this.upscale*(t+1)}}getNextDepthResolution(e,t){return this.resolutions[t+1]}getResolution(e,t){return this.resolutions[t]}getNode(e,t,i,s){}getCell(e,t){return e in this.cacheAccess||(this.cacheAccess[e]={}),this.cacheAccess[e][t]=!0,this.cache[e]&&this.cache[e][t]||this.cacheCell(e,t),e in this.cacheAccess||(this.cacheAccess[e]={}),this.cacheAccess[e][t]=!0,this.cache[e][t]}getQuickCell(e,t){return this.cache[e]&&this.cache[e][t]||this.cacheCell(e,t),e in this.cacheAccess||(this.cacheAccess[e]={}),this.cacheAccess[e][t]=!0,this.qCache[e]&&this.qCache[e][t]||this.quickCache(e,t,this.cache[e][t][this.depth-1]),this.qCache[e][t]}quickCache(e,t,i){if(e in this.qCache){if(t in this.qCache[e])return}else this.qCache[e]={};let s=[];this.useQuick=!1;for(let n of i){let i=[];for(let s of n)i.push({x:s.x,y:this.getXZ((e+s.x)*this.cellScaleWorld,(t+s.z)*this.cellScaleWorld),z:s.z,r:s.r,r2:s.r2});s.push(i)}this.useQuick=!0,this.qCache[e][t]=s}getXZQuick(e,t){let i,s,n,a,o,r;return mi.d=0,mi.h=0,mi.wx=e/this.cellScaleWorld,mi.wz=t/this.cellScaleWorld,mi.ox=Math.floor(mi.wx),mi.oz=Math.floor(mi.wz),mi.px=mi.wx-mi.ox,mi.pz=mi.wz-mi.oz,mi.layer=this.getQuickCell(mi.ox,mi.oz),mi.sq=this.getResolution(this.resolution,this.depth-1),mi.sqb=mi.sq-1,mi.ssq=mi.sq,mi.ssqb=mi.sqb,i=mi.px*mi.sq-.5,mi.ix=Math.floor(mi.px*mi.sq-.5),s=mi.pz*mi.sq-.5,mi.iz=Math.floor(mi.pz*mi.sq-.5),i-=mi.ix,s-=mi.iz,mi.ix>=0?(n=mi.iz>=0?mi.layer[mi.ix][mi.iz].y:this.getQuickCell(mi.ox,mi.oz-1)[mi.ix][mi.sqb].y,a=mi.iz<mi.ssqb?mi.layer[mi.ix][mi.iz+1].y:this.getQuickCell(mi.ox,mi.oz+1)[mi.ix][0].y):(n=mi.iz>=0?this.getQuickCell(mi.ox-1,mi.oz)[mi.sqb][mi.iz].y:this.getQuickCell(mi.ox-1,mi.oz-1)[mi.sqb][mi.sqb].y,a=mi.iz<mi.ssqb?this.getQuickCell(mi.ox-1,mi.oz)[mi.sqb][mi.iz+1].y:this.getQuickCell(mi.ox-1,mi.oz+1)[mi.sqb][0].y),mi.ix<mi.ssqb?(o=mi.iz>=0?mi.layer[mi.ix+1][mi.iz].y:this.getQuickCell(mi.ox,mi.oz-1)[mi.ix+1][mi.sqb].y,r=mi.iz<mi.ssqb?mi.layer[mi.ix+1][mi.iz+1].y:this.getQuickCell(mi.ox,mi.oz+1)[mi.ix+1][0].y):(o=mi.iz>=0?this.getQuickCell(mi.ox+1,mi.oz)[0][mi.iz].y:this.getQuickCell(mi.ox+1,mi.oz-1)[0][mi.sqb].y,r=mi.iz<mi.ssqb?this.getQuickCell(mi.ox+1,mi.oz)[0][mi.iz+1].y:this.getQuickCell(mi.ox+1,mi.oz+1)[0][0].y),n=this.sharpLerpAB(n,a,s),o=this.sharpLerpAB(o,r,s),this.sharpLerpAB(n,o,i)}getXZLayer(e,t,i){gi.layer=0,gi.d=0,gi.h=0,gi.sq=this.resolution,gi.sqb=gi.sq-1,gi.wx=e/this.cellScaleWorld,gi.wz=t/this.cellScaleWorld,gi.ox=Math.floor(gi.wx),gi.oz=Math.floor(gi.wz),gi.px=gi.wx-gi.ox,gi.pz=gi.wz-gi.oz,gi.cell=this.getCell(gi.ox,gi.oz);let s=this.depth;gi.depth=0;let n=0;for(gi.layer of gi.cell)if(n++===i){if(gi.depth==s)break;gi.ix=Math.floor(gi.px*gi.sq-.5),gi.iz=Math.floor(gi.pz*gi.sq-.5),gi.th=0,gi.ix>=0?(gi.iz>=0?gi.th+=this.lerpHeight(gi.d,gi.px,gi.pz,gi.layer[gi.ix][gi.iz]):gi.th+=this.lerpHeight(gi.d,gi.px,gi.pz+1,this.getCell(gi.ox,gi.oz-1)[gi.depth][gi.ix][gi.sqb]),gi.iz<gi.sqb?gi.th+=this.lerpHeight(gi.d,gi.px,gi.pz,gi.layer[gi.ix][gi.iz+1]):gi.th+=this.lerpHeight(gi.d,gi.px,gi.pz-1,this.getCell(gi.ox,gi.oz+1)[gi.depth][gi.ix][0])):(gi.iz>=0?gi.th+=this.lerpHeight(gi.d,gi.px+1,gi.pz,this.getCell(gi.ox-1,gi.oz)[gi.depth][gi.sqb][gi.iz]):gi.th+=this.lerpHeight(gi.d,gi.px+1,gi.pz+1,this.getCell(gi.ox-1,gi.oz-1)[gi.depth][gi.sqb][gi.sqb]),gi.iz<gi.sqb?gi.th+=this.lerpHeight(gi.d,gi.px+1,gi.pz,this.getCell(gi.ox-1,gi.oz)[gi.depth][gi.sqb][gi.iz+1]):gi.th+=this.lerpHeight(gi.d,gi.px+1,gi.pz-1,this.getCell(gi.ox-1,gi.oz+1)[gi.depth][gi.sqb][0])),gi.ix<gi.sqb?(gi.iz>=0?gi.th+=this.lerpHeight(gi.d,gi.px,gi.pz,gi.layer[gi.ix+1][gi.iz]):gi.th+=this.lerpHeight(gi.d,gi.px,gi.pz+1,this.getCell(gi.ox,gi.oz-1)[gi.depth][gi.ix+1][gi.sqb]),gi.iz<gi.sqb?gi.th+=this.lerpHeight(gi.d,gi.px,gi.pz,gi.layer[gi.ix+1][gi.iz+1]):gi.th+=this.lerpHeight(gi.d,gi.px,gi.pz-1,this.getCell(gi.ox,gi.oz+1)[gi.depth][gi.ix+1][0])):(gi.iz>=0?gi.th+=this.lerpHeight(gi.d,gi.px-1,gi.pz,this.getCell(gi.ox+1,gi.oz)[gi.depth][0][gi.iz]):gi.th+=this.lerpHeight(gi.d,gi.px-1,gi.pz+1,this.getCell(gi.ox+1,gi.oz-1)[gi.depth][0][gi.sqb]),gi.iz<gi.sqb?gi.th+=this.lerpHeight(gi.d,gi.px-1,gi.pz,this.getCell(gi.ox+1,gi.oz)[gi.depth][0][gi.iz+1]):gi.th+=this.lerpHeight(gi.d,gi.px-1,gi.pz-1,this.getCell(gi.ox+1,gi.oz+1)[gi.depth][0][0])),gi.h+=gi.th,gi.depth++,gi.sq=this.resolutions[gi.depth],gi.sqb=gi.sq-1}else gi.depth++,gi.sq=this.resolutions[gi.depth],gi.sqb=gi.sq-1;return gi.h+this.heightOffset}getXZ(e,t,i){for(gi.layer of(gi.d=0,gi.h=0,gi.heightFactor=1,gi.sq=this.resolution,gi.sqb=gi.sq-1,gi.wx=e/this.cellScaleWorld,gi.wz=t/this.cellScaleWorld,gi.ox=Math.floor(gi.wx),gi.oz=Math.floor(gi.wz),gi.px=gi.wx-gi.ox,gi.pz=gi.wz-gi.oz,gi.cell=this.getCell(gi.ox,gi.oz),i=i||this.depth,gi.depth=0,gi.cell)){if(gi.depth==i)break;gi.ix=Math.floor(gi.px*gi.sq-.5),gi.iz=Math.floor(gi.pz*gi.sq-.5),gi.th=0,gi.ix>=0?(gi.iz>=0?gi.th+=this.lerpHeight(gi.d,gi.px,gi.pz,gi.layer[gi.ix][gi.iz]):gi.th+=this.lerpHeight(gi.d,gi.px,gi.pz+1,this.getCell(gi.ox,gi.oz-1)[gi.depth][gi.ix][gi.sqb]),gi.iz<gi.sqb?gi.th+=this.lerpHeight(gi.d,gi.px,gi.pz,gi.layer[gi.ix][gi.iz+1]):gi.th+=this.lerpHeight(gi.d,gi.px,gi.pz-1,this.getCell(gi.ox,gi.oz+1)[gi.depth][gi.ix][0])):(gi.iz>=0?gi.th+=this.lerpHeight(gi.d,gi.px+1,gi.pz,this.getCell(gi.ox-1,gi.oz)[gi.depth][gi.sqb][gi.iz]):gi.th+=this.lerpHeight(gi.d,gi.px+1,gi.pz+1,this.getCell(gi.ox-1,gi.oz-1)[gi.depth][gi.sqb][gi.sqb]),gi.iz<gi.sqb?gi.th+=this.lerpHeight(gi.d,gi.px+1,gi.pz,this.getCell(gi.ox-1,gi.oz)[gi.depth][gi.sqb][gi.iz+1]):gi.th+=this.lerpHeight(gi.d,gi.px+1,gi.pz-1,this.getCell(gi.ox-1,gi.oz+1)[gi.depth][gi.sqb][0])),gi.ix<gi.sqb?(gi.iz>=0?gi.th+=this.lerpHeight(gi.d,gi.px,gi.pz,gi.layer[gi.ix+1][gi.iz]):gi.th+=this.lerpHeight(gi.d,gi.px,gi.pz+1,this.getCell(gi.ox,gi.oz-1)[gi.depth][gi.ix+1][gi.sqb]),gi.iz<gi.sqb?gi.th+=this.lerpHeight(gi.d,gi.px,gi.pz,gi.layer[gi.ix+1][gi.iz+1]):gi.th+=this.lerpHeight(gi.d,gi.px,gi.pz-1,this.getCell(gi.ox,gi.oz+1)[gi.depth][gi.ix+1][0])):(gi.iz>=0?gi.th+=this.lerpHeight(gi.d,gi.px-1,gi.pz,this.getCell(gi.ox+1,gi.oz)[gi.depth][0][gi.iz]):gi.th+=this.lerpHeight(gi.d,gi.px-1,gi.pz+1,this.getCell(gi.ox+1,gi.oz-1)[gi.depth][0][gi.sqb]),gi.iz<gi.sqb?gi.th+=this.lerpHeight(gi.d,gi.px-1,gi.pz,this.getCell(gi.ox+1,gi.oz)[gi.depth][0][gi.iz+1]):gi.th+=this.lerpHeight(gi.d,gi.px-1,gi.pz-1,this.getCell(gi.ox+1,gi.oz+1)[gi.depth][0][0])),gi.temper=1,gi.depth>0&&(gi.temper=Math.min(Math.max(.25,(gi.h+this.heightOffset+30)/80),1)),gi.h+=gi.th*gi.temper,gi.depth++,gi.sq=this.resolutions[gi.depth],gi.sqb=gi.sq-1}return gi.h+this.heightOffset}},wi=i.p+"static/media/grass_summer_01.bb65c929.webp",fi=i.p+"static/media/gravel_01.72d5f86f.webp",bi=i.p+"static/media/rock_06.7e502144.webp",Ai=i.p+"static/media/forest_summer_01.629b3e11.webp",yi=i.p+"static/media/heather_01.3b4049ea.webp",Ii=i.p+"static/media/sand_01.8bf3d9a0.webp",Si=i.p+"static/media/road_03.29415d96.webp",Mi=i.p+"static/media/road_03_base.2e84c9f2.webp",Di=i.p+"static/media/foliage_grass_summer.2ca20eaf.webp",Ci=i.p+"static/media/foliage_bush_summer.7d19f331.webp",Ni=i.p+"static/media/trees_summer_far_04.9b418c41.webp",ki=i.p+"static/media/trees_summer_near_04.0b483335.webp",zi=i.p+"static/media/trees_summer_far_04b.71d33b5e.webp",ji=i.p+"static/media/trees_summer_near_04b.c599bf59.webp",Li=i.p+"static/media/trees_autumn_near_01.e4b1c1b7.webp",Oi=i.p+"static/media/trees_autumn_far_01.476e1169.webp",Ri=i.p+"static/media/trees_autumn_near_01b.784c372a.webp",Ti=i.p+"static/media/trees_autumn_far_01b.b7bc28be.webp",Pi=i.p+"static/media/grass_autumn_01.c593833e.webp",Gi=i.p+"static/media/forest_autumn_01.cd958a6a.webp",Bi=i.p+"static/media/foliage_grass_autumn.f92557d8.webp",Wi=i.p+"static/media/foliage_bush_autumn.f642e219.webp",Fi=i.p+"static/media/trees_spring_near_01.2740d9e4.webp",Ei=i.p+"static/media/trees_spring_far_01.e5b43ddb.webp",Zi=i.p+"static/media/trees_spring_far_01b.77e3faf6.webp",Hi=i.p+"static/media/trees_spring_near_01b.dc9a1b07.webp",Qi=i.p+"static/media/grass_spring_01.768b870f.webp",Yi=i.p+"static/media/heather_spring_01.73869f54.webp",Vi=i.p+"static/media/foliage_grass_spring.2de5b784.webp",Ui=i.p+"static/media/foliage_bush_spring.53436f47.webp",Xi=i.p+"static/media/snow_01.5d24a4d9.webp",Ji=i.p+"static/media/forest_winter.d339edd9.webp",qi=i.p+"static/media/road_04.c4c154ee.webp",Ki=i.p+"static/media/road_04_base.2ca13356.webp",_i=i.p+"static/media/trees_winter_near_01.bc2b0a44.webp",$i=i.p+"static/media/trees_winter_far_01.22579e5a.webp",es=i.p+"static/media/trees_winter_near_01b.6c45b1e5.webp",ts=i.p+"static/media/trees_winter_far_01b.d995fc50.webp",is=i.p+"static/media/rock_06_winter.1a82fc8c.webp",ss=i.p+"static/media/foliage_brush_winter.3157e6a1.webp",ns=i.p+"static/media/concrete_01.467e237b.webp",as=i.p+"static/media/drystone_04.c9668f42.webp",os=i.p+"static/media/drystone_04_snow.aee09a95.webp",rs=i.p+"static/media/wall_barrier_wood.06bbc7c3.webp",hs=i.p+"static/media/wall_barrier_wood_snow.5df52f00.webp",ls=i.p+"static/media/clouds_01b.d86e8361.webp",ds=i.p+"static/media/clouds_02.d765d208.webp",cs=i.p+"static/media/clouds_03.0544ea9f.webp",ps=i.p+"static/media/clouds_04.bdcd8039.webp",us=i.p+"static/media/clouds_sunrise_b.76566df4.webp",gs=i.p+"static/media/clouds_autumn_sunset.97e16563.webp",ms=i.p+"static/media/clouds_winter_sunrise.10f858c5.webp",xs=i.p+"static/media/ambiance_summer_low.0e101ef7.mp3",vs=i.p+"static/media/ambiance_spring.791a03fe.mp3",ws=i.p+"static/media/ambiance_cloudy.4d5b0a33.mp3",fs=i.p+"static/media/wind_02.deef0e2d.mp3",bs=i.p+"static/media/rock_06_bump.12f4b9f0.webp",As=i.p+"static/media/crossfade_fine.0d1ec73b.webp",ys=i.p+"static/media/crossfade_finest.3013f964.webp";var Is=i.p+"static/media/sea_waves.fba92bab.webp";const Ss={treemap:{heightScale:1,heightOffset:1.25,resolutions:[3,13,41],squared:!0,depthHeightFactor:1.8,threshold:.3,threshold2:.6,threshold3:.65},topography:{straight:{heightmap:{heightScale:190,heightOffset:80,resolutions:[3,7],compound:!1,squared:!0,depthHeightFactor:.6},roadWidth:3.2,smoothWindow:7},casual:{heightmap:{heightScale:160,heightOffset:110,resolutions:[5],compound:!1,squared:!0,depthHeightFactor:.9},roadWidth:3.2,smoothWindow:7},normal:{heightmap:{heightScale:160,heightOffset:95,resolutions:[3,12,24],compound:!1,squared:!0,depthHeightFactor:1},roadWidth:3,smoothWindow:7},hard:{heightmap:{heightScale:165,heightOffset:120,resolutions:[3,12,24,36],compound:!1,squared:!0,depthHeightFactor:.98},roadWidth:2.8,smoothWindow:5},easy:{heightmap:{heightScale:180,heightOffset:110,resolutions:[3,12],compound:!1,squared:!0,depthHeightFactor:.9},roadWidth:3.2,smoothWindow:7},flat:{heightmap:{heightScale:0,heightOffset:50,resolution:1,depth:1,upscale:1},roadWidth:20,smoothWindow:7}},weathers:{default:{audio:{ambiance:{src:xs,ls:.1,le:.1},wind:{src:fs,ls:.07,le:.07}},water:7048371,waterSkyReflection:10143703,underwater:4215398,col:16121855,hemTop:6710886,hemGround:16777215,skyCol:6859256,skyColFar:13368830,skyMap:ls,amb:0,hem:.6,dir:.9,fogNear:.25,fogFar:1,sunPos:[0,100,0]},clear:{col:15794175,skyCol:6859256,skyColFar:13368830,hemTop:13688285,hemGround:6317670,water:7048371,waterSkyReflection:10143703,underwater:4215398,amb:.2,hem:.2,dir:.8,fogNear:.5,fogFar:1,sunPos:[0,100,0]},clearSpring:{col:16777200,skyCol:5815520,skyColFar:11599615,hemTop:12303274,hemGround:8947831,water:8034974,waterSkyReflection:10872550,underwater:4478295,amb:0,hem:.6,dir:.8,fogNear:.1,fogFar:1,sunPos:[0,100,0],audio:{ambiance:{src:vs,ls:.1,le:.1},wind:{src:fs,ls:.07,le:.07}}},clearAutumn:{col:15794175,skyCol:6859256,skyColFar:13368830,hemTop:11582395,hemGround:8423560,water:7048371,waterSkyReflection:10143703,underwater:4281193,amb:0,hem:.5,dir:.7,fogNear:.2,fogFar:1,sunPos:[0,100,0]},clearSnow:{col:16645887,skyCol:6611189,skyColFar:9627639,skyMap:null,hemTop:11582395,hemGround:10529450,water:9151142,waterSkyReflection:11592172,underwater:4213066,amb:.4,hem:0,dir:.6,fogNear:-.1,fogFar:1},sunrise:{col:16760805,skyCol:14000311,skyColFar:15752863,skyMap:us,hemTop:16760805,hemGround:7825015,water:11240347,waterSkyReflection:13792927,underwater:4536640,amb:0,hem:.4,dir:.2,fogNear:0,fogFar:1},springSunrise:{col:16763868,skyCol:14517675,skyColFar:16750020,skyMap:us,hemTop:16770028,hemGround:7825015,water:12682908,waterSkyReflection:14388399,underwater:4537407,amb:0,hem:.5,dir:.25,fogNear:0,fogFar:1,audio:{ambiance:{src:vs,ls:.1,le:.1},wind:{src:fs,ls:.07,le:.07}}},autumnSunrise:{col:15191218,skyCol:12886223,skyColFar:12371399,skyMap:null,hemTop:15191218,water:8285060,waterSkyReflection:9939630,underwater:3748667,hemGround:16777215,amb:0,hem:.4,dir:.1,fogNear:.25,fogFar:1},winterSunrise:{col:16641966,skyCol:7829367,skyColFar:13948336,skyMap:ms,hemTop:13948336,hemGround:5592405,water:8158057,waterSkyReflection:13088880,underwater:4013366,amb:0,hem:.5,dir:.25,fogNear:.25,fogFar:1,particles:{colour:12368284,half:!0,speed:.8}},sunset:{col:16761489,skyCol:6611189,skyColFar:16769464,skyMap:ps,hemTop:16772047,hemGround:7829367,water:10062204,waterSkyReflection:14595739,underwater:4209463,amb:.2,hem:.4,dir:.3,fogNear:0,fogFar:1},twilight:{col:10650820,skyCol:4539806,skyColFar:10387156,skyMap:cs,hemTop:10650820,hemGround:6710886,water:4868728,waterSkyReflection:8152737,underwater:2829110,amb:0,hem:.4,dir:.2,fogNear:0,fogFar:1,headlights:!0},autumnSunset:{col:16767690,skyCol:7562623,skyColFar:13672883,skyMap:gs,hemTop:15380673,hemGround:6710886,water:5984868,waterSkyReflection:13209736,underwater:3749181,amb:0,hem:.5,dir:.2,fogNear:0,fogFar:1},winterSunset:{col:14849919,skyCol:15267574,skyColFar:16566188,skyMap:null,hemTop:16433573,hemGround:6710886,water:6903885,waterSkyReflection:11903124,underwater:3353897,amb:0,hem:.3,dir:.1,fogNear:0,fogFar:1,headlights:!0},rain:{audio:{ambiance:{src:ws,ls:.1,le:.1}},col:11843770,hemTop:11183520,hemGround:6709334,skyCol:10988204,skyColFar:11843770,skyMap:cs,water:7631213,waterSkyReflection:10330788,underwater:3552307,amb:0,hem:.6,dir:.5,fogNear:0,fogFar:1,dynamicFog:!0},springRain:{audio:{ambiance:{src:ws,ls:.1,le:.1}},col:13750208,hemTop:13421772,hemGround:8947848,skyCol:11381664,skyColFar:13421248,skyMap:ls,water:8159347,waterSkyReflection:12304304,underwater:3618868,amb:0,hem:.6,dir:.6,fogNear:0,fogFar:1,dynamicFog:!0},autumnRain:{audio:{ambiance:{src:ws,ls:.1,le:.1}},col:10262415,hemTop:16773350,hemGround:6709334,skyCol:9539465,skyColFar:10263189,skyMap:ds,water:4670524,waterSkyReflection:7696744,underwater:2828839,amb:0,hem:.5,dir:.2,fogNear:0,fogFar:1,dynamicFog:!0},night:{audio:{ambiance:{src:ws,ls:.1,le:.1}},col:1184020,skyCol:1184020,skyColFar:1184020,skyMap:ds,water:131332,waterSkyReflection:1184020,underwater:131332,amb:1.25,hem:0,dir:0,fogNear:.1,fogFar:1,headlights:!0},nightSnow:{audio:{ambiance:{src:ws,ls:.1,le:.1}},col:1184020,skyCol:1184020,skyColFar:1184020,skyMap:ds,water:131332,waterSkyReflection:1184020,underwater:131332,amb:1.25,hem:0,dir:0,fogNear:0,fogFar:.5,headlights:!0,particles:{colour:2236962,half:!1,speed:1.75}},snow:{audio:{ambiance:{src:ws,ls:.1,le:.1}},col:11772819,skyCol:11246985,skyColFar:11180677,skyMap:cs,water:8353387,waterSkyReflection:10655879,underwater:3552048,hemTop:14275267,hemGround:6709334,amb:0,hem:.6,dir:.3,fogNear:-.1,fogFar:.6,dynamicFog:!0,particles:{colour:14406598,half:!1,speed:1.25}}},skins:{spring:{name:"spring",weathers:["springSunrise","clearSpring","springRain","autumnSunset","night"],cycles:[["clearSpring","autumnSunset","night","night","springSunrise"],["springRain","autumnSunset","night","night","springSunrise"]],grass:Qi,heather:Yi,foliage:{trees:[Ei,Fi],treesb:[Zi,Hi],grass:Vi,bush:Ui,grassColouration:[20/255,10/255,20/255,0],treeColouration:[-.07,.1,.05,0]}},default:{name:"summer",weathers:["sunrise","clear","rain","sunset","night"],cycles:[["clear","sunset","night","night","sunrise"],["rain","sunset","night","night","sunrise"]],grass:wi,gravel:fi,rock:bi,forest:Ai,heather:yi,water:11057343,sand:Ii,road:Si,roadBase:Mi,walls:{sea:ns,fence:rs,drystone:as},foliage:{trees:[Ni,ki],treesb:[zi,ji],grass:Di,bush:Ci,grassColouration:[52/255,20/255,36/255,0],treeColouration:[-.05,.1,.1,0]}},autumn:{name:"autumn",weathers:["autumnSunrise","clearAutumn","autumnRain","twilight","night"],cycles:[["clear","twilight","night","night","autumnSunrise"],["autumnRain","twilight","night","night","autumnSunrise"]],grass:Pi,forest:Gi,gravel:fi,foliage:{trees:[Oi,Li],treesb:[Ti,Ri],grass:Bi,bush:Wi,grassColouration:[60/255,25/255,45/255,0],treeColouration:[.1,-.05,0,0]}},winter:{name:"winter",weathers:["winterSunrise","clearSnow","snow","winterSunset","nightSnow"],cycles:[["snow","winterSunset","night","night","winterSunrise"],["clearSnow","winterSunset","night","night","winterSunrise"]],grass:Xi,gravel:Xi,forest:Ji,heather:Ji,sand:Ji,road:qi,roadBase:Ki,rock:is,water:12110031,foliage:{trees:[$i,_i],treesb:[ts,es],grass:null,bush:ss,grassColouration:[0,0,0,0],treeColouration:[.15,.15,.15,0]},friction:{road:1.1,side:.8,grass:.6},walls:{drystone:os,fence:hs}}},time:{noon:{}}},Ms=(e,t)=>{Ns=Cs[e],zs=ks[e],Ls=js[e],Rs=Os[e],Bs=Gs[t],Ws=Bs/20,Zs=t>1,0==t?Hs=2:1==t?Hs=Math.floor(Nt/100):2==t?Hs=Math.floor(St/50):3==t&&(Hs=Math.floor(St/25)),Qs(t)},Ds=new r.F({map:st(wi,0),displacementMap:st(bs,4)}),Cs=[700,2e3,3500,6e3,8e3];let Ns=3500;const ks=[200,400,600,800,900];let zs=400;const js=[20,50,100,150,200];let Ls=100;const Os=[15,20,25,30,40];let Rs=10;const Ts=st(As),Ps=[tt(null,.75,4,null,{TREES:"",AUTO_NORMAL:""},{noiseMap:Ts,mapb:null,highDef:!0,colouration:[0,0,0,0]}),tt(null,.75,4,null,{TREES:"",AUTO_NORMAL:""},{noiseMap:Ts,mapb:null,highDef:!0,colouration:[0,0,0,0]})],Gs=[5e3,1e4,2e4,3e4,4e4];let Bs=5e3,Ws=Bs/20;const Fs=[tt(null,.75,4,null,{GRASS:"",AUTO_NORMAL:""},{noiseMap:Ts,colouration:[0,0,0,0]}),tt(null,.75,4,null,{BUSH:"",AUTO_NORMAL:""},{noiseMap:Ts,colouration:[0,0,0,0]})];Ds.userData.grassMap={value:null},Ds.userData.sandMap={value:null},Ds.userData.rockMap={value:st(bs,4)},Ds.userData.rockBumpMap={value:null},Ds.userData.gravelMap={value:null},Ds.userData.heatherMap={value:null},Ds.userData.forestMap={value:null},Ds.userData.roadBaseMap={value:null},Ds.userData.fadeRockMap={value:st(As,4)},Ds.userData.fadeFiner={value:st(ys,4)},Ds.userData.colouration={value:[.18,.08,.1,0]},Ds.onBeforeCompile=e=>(e.uniforms.grassMap=Ds.userData.grassMap,e.uniforms.sandMap=Ds.userData.sandMap,e.uniforms.rockMap=Ds.userData.rockMap,e.uniforms.rockBumpMap=Ds.userData.rockBumpMap,e.uniforms.gravelMap=Ds.userData.gravelMap,e.uniforms.heatherMap=Ds.userData.heatherMap,e.uniforms.forestMap=Ds.userData.forestMap,e.uniforms.roadBaseMap=Ds.userData.roadBaseMap,e.uniforms.fadeRockMap=Ds.userData.fadeRockMap,e.uniforms.fadeFiner=Ds.userData.fadeFiner,e.uniforms.colouration=Ds.userData.colouration,e.vertexShader=e.vertexShader.replace("#include <displacementmap_pars_vertex>","\n\nattribute float heightOffset;\nattribute float roadProximity;\nattribute float treeMask;\nattribute float curvature;\nattribute float grass;\n\nvarying float height;\nvarying float steepness;\nvarying float roadProx;\nvarying float vTreeMask;\nvarying vec2 vWv;\nvarying vec2 vWWv;\nvarying float vCurvature;\nvarying float vGrass;\nvarying float vLightGrass;\nvarying float vDarkGrass;\nvarying float vHeather;\n\nfloat wuvSize = 800.0;\n\nuniform sampler2D displacementMap;\nuniform sampler2D fadeRockMap;\n\nfloat map(float value, float min1, float max1, float min2, float max2) {\n  return min2 + (value - min1) * (max2 - min2) / (max1 - min1);\n}\n\nvec3 upvec = vec3(0.0,1.0,0.0);\n\n"),e.vertexShader=e.vertexShader.replace("#include <displacementmap_vertex>","\n\n  vec4 wPos = modelMatrix * vec4( position, 1.0 );\n\n  height = wPos.y + heightOffset;\n\n  // Unclear if worthwhile...\n  // if(abs(wPos.x) > 14000.0) {\n  //   wPos.x = mod(wPos.x, 14000.0);\n  // }\n  // if(abs(wPos.z) > 14000.0) {\n  //   wPos.z = mod(wPos.z, 14000.0);\n  // }\n\n  // Set UVs from world pos\n  vUv.x = wPos.x / 10.0;\n  vUv.y = wPos.z / 10.0;\n\n\n  // 0 is perfectly flat, 1 is 90 degrees\n  steepness = 1.0 - dot(normal, upvec);\n  steepness = clamp(steepness * 2.0, 0.0, 1.0);\n\n  // Anything up to 0.8 is 1\n  // 0.8 down to 0.6\n  // 0.6 and under is 0\n\n  // steepness = 1.0 - clamp((steepness - 0.6) / 0.2, 0.0, 1.0);\n  // steepness = 1.0 - map(steepness, 0.2, 0.7, 0.0, 1.0);\n\n  // steepness = 1.0 - steepness;//clamp((steepness * 2.0), 0.0, 1.0);\n  // steepness = map(steepness, 0.0, 1.0, 0.3, 0.7);\n\n  vWv.x = wPos.x / wuvSize;\n  vWv.y = wPos.z / wuvSize;\n\n  vWWv.x = vWv.x / 8.0;\n  vWWv.y = vWv.y / 8.0;\n\n  // MAGIC NUMBERS TO BE TWEAKED BASED ON HEIGHT PARAMETERS\n  if(curvature > 0.0) {\n    vCurvature = max(-1.0, curvature * -4.0);\n  } else {\n    vCurvature = min(1.0, curvature * -4.0);\n  }\n\n  //// GET FADES\n\n  float fade0 = texture2D(fadeRockMap, vWv).r;\n  float fade1 = texture2D(fadeRockMap, vWWv).r;\n  float fade2 = (texture2D(fadeRockMap,\n    vec2(\n      vWWv.x = wPos.x / 1200.0,\n      vWWv.y = wPos.z / 1200.0\n    )\n  ).r / 2.0) + 0.5;\n\n  //// HEATHER\n\n  vHeather = smoothstep(0.47, 0.53, min(1.0,height / 170.0) * fade1 * fade2);\n\n  //// GRASSES\n\n  // Focus contrast on middle range for sharper edges\n\n  fade0 = min(max(0.0,(fade0 - 0.25) * 2.0), 1.0);\n  fade1 = min(max(0.0,(fade1 - 0.25) * 2.0), 1.0);\n\n  float heightVal = min(1.0, height/100.0);\n  vLightGrass = min(1.0, max(0.0, fade1 * heightVal * (fade0 + heightVal)));\n  if(roadProximity > 0.0 && roadProximity < 2.0) {\n    vLightGrass *= roadProximity / 4.0 + 0.5;\n    vHeather *= roadProximity / 2.0;\n  }\n  vDarkGrass = 1.0;// 1.1 - (fade1 * 0.1);\n\n\n  //// ROAD PROX\n\n  roadProx = roadProximity;\n\n  if(roadProx < 0.0) {\n    steepness = 0.0;\n  }\n\n  //// TREE MASK\n\n  vTreeMask = treeMask;\n\n  //// GRASS  FIDDLING\n\n  // if(vCurvature > 0.0) {\n  //   vGrass = grass * vCurvature;\n  // } else {\n  //   vGrass = 0.0;\n  // }\n  // vGrass = grass * min(1.0, height / 100.0);\n\n  vGrass = grass;\n\n  vWWv.x = wPos.x / 400.0;\n  vWWv.y = wPos.z / 400.0;\n\n  transformed += vec3(0.0, heightOffset, 0.0);\n\n  // Experimenting with displacement map\n  transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * steepness * 1.25 );\n\n"),e.fragmentShader=e.fragmentShader.replace("#include <map_pars_fragment>","\n\n  varying float height;\n  varying float steepness;\n  varying float roadProx;\n  varying float vTreeMask;\n  varying float vCurvature;\n  varying float vGrass;\n  varying vec2 vWv;\n  varying vec2 vWWv;\n  varying float vLightGrass;\n  varying float vDarkGrass;\n  varying float vHeather;\n\n  uniform sampler2D grassMap;\n  uniform sampler2D sandMap;\n  uniform sampler2D rockMap;\n  uniform sampler2D rockMapBump;\n  uniform sampler2D gravelMap;\n  uniform sampler2D forestMap;\n  uniform sampler2D heatherMap;\n  uniform sampler2D fadeRockMap;\n  uniform sampler2D fadeFiner;\n\n  uniform vec4 colouration;\n\n  vec4 rockTex;\n\n  vec4 terrainBlend(vec4 tx1, float w1, vec4 tx2, float w2, float depth) {\n    // Perform the blending\n    float ma = max(tx1.a + w1, tx2.a + w2) - depth;\n    float b1 = max(tx1.a + w1 - ma, 0.0);\n    float b2 = max(tx2.a + w2 - ma, 0.0);\n\n    return ((tx1 * b1) + (tx2 * b2)) / (b1 + b2);\n  }\n\n  vec4 roadCol = vec4(0.45, 0.45, 0.474, 1.0);\n\n\n"),e.fragmentShader=e.fragmentShader.replace("#include <map_fragment>","\n\n  float fade = texture2D(fadeRockMap, vUv).r;\n  float fade1 = texture2D(fadeRockMap, vWv).r;\n  float fade2 = (texture2D(fadeRockMap, vWWv).r / 2.0) + 0.5;\n\n  float heightVal = min(1.0, (height/ 150.0));\n\n  vec4 darkGrass = texture2D(heatherMap, vUv);\n  darkGrass.a = darkGrass.g;\n\n  //// GRASS 1\n\n  vec4 texelColor = texture2D( grassMap, vUv );\n\n  //// LIGHT GRASS\n\n  texelColor += colouration * vLightGrass;\n\n  //// HEATHER\n\n  texelColor = mix(texelColor, darkGrass, vHeather * smoothstep(0.3, 0.7, fade1));\n\n  //// TREE MASK\n\n  texelColor = mix(texelColor, texture2D(forestMap, vUv), vTreeMask);\n  // texelColor.a = 1.0;\n  // vec4 forestCol = texture2D(forestMap, vUv);\n  // forestCol.a = 1.0 + fade * 0.1;//forestCol.r;// - fade * 0.5;\n  // texelColor = terrainBlend(\n  //   texelColor,\n  //   1.0-vTreeMask,\n  //   forestCol,\n  //   vTreeMask + fade * 0.25,\n  //   0.25\n  // );\n  // texelColor.a = 1.0;\n\n  //// DARK GRASS\n\n  texelColor *= vDarkGrass;\n\n  //// SAND BLEND\n\n  if(height < 4.0) {\n    float dark = 1.0 - vTreeMask * 0.3;\n    if(height < 0.0) {\n      texelColor = texture2D(sandMap, vUv) * 0.8333;\n    } else {\n      if(height < 2.0) {\n        dark = min(dark, 1.0 - (2.0 - height) / 12.0);\n      }\n      texelColor = mix(texture2D(sandMap, vUv) * dark, texelColor, height / 4.0);\n    }\n  }\n\n  //// ROADSIDE GRAVEL\n\n  if(roadProx < -0.2) {\n    texelColor = roadCol; // TODO pass in different colour as tex?\n  } else if(roadProx != 0.0 && roadProx < 0.7) {\n\n    float rp = roadProx / 0.7;\n\n    texelColor = mix(\n      texture2D(gravelMap, vUv),\n      texelColor,\n      smoothstep(\n        rp + 0.15,\n        rp - 0.15,\n        fade\n      )\n    );\n    // // Texture blend mode, not worth it\n    // vec4 gravelTex = texture2D(gravelMap, vUv);\n    // // float rp = roadProx / 1.25;\n    // gravelTex.a = gravelTex.r * gravelTex.r;\n    // texelColor.a = fade;\n    //\n    // texelColor = terrainBlend(\n      //   texelColor,\n      //   rp,\n      //   gravelTex,\n      //   1.0-rp,\n      //   0.1\n      // );\n\n\n\n\n  }\n\n  //// STEEPNESS CLIFF\n\n\n  if(roadProx == 0.0) {\n    rockTex = texture2D(rockMap, vWv) * (1.0 - vTreeMask * 0.5);\n    rockTex.a = 1.0 - texture2D(rockMapBump, vWv).r;\n  } else {\n    rockTex = texture2D(rockMap, vUv) * (1.0 - vTreeMask * 0.5);\n    rockTex.a = texture2D(rockMapBump, vUv).r;\n  }\n\n  texelColor.a = 0.2 + fade1 * 0.2;\n  texelColor = terrainBlend(texelColor,0.7, rockTex, steepness, 0.06);\n  texelColor.a = 1.0;\n\n  //// FINAL COMPOSITION\n\n  diffuseColor *= texelColor;\n\n"),e);let Es=null,Zs=!1,Hs=50;const Qs=e=>{var t;null===(t=Es)||void 0===t||t.dispose();let i={};e>0&&(i.WATER_WAVES="",e>1&&(i.WATER_DEPTH="")),Es=new r.C({wireframe:!1}),Es.defines=i,Es.userData.camPos={value:new r.W},Es.userData.skyCol={value:[1,1,1,1]},Es.userData.waves={value:st(Is,4)},Es.userData.sunCol={value:[1,1,1,1]},Es.userData.time={value:0},Es.onBeforeCompile=e=>(e.uniforms.camPos=Es.userData.camPos,e.uniforms.skyCol=Es.userData.skyCol,e.uniforms.waves=Es.userData.waves,e.uniforms.sunCol=Es.userData.sunCol,e.uniforms.time=Es.userData.time,e.vertexShader=e.vertexShader.replace("#include <color_pars_vertex>","#include <color_pars_vertex>\n\n\n  #ifdef WATER_DEPTH\n\n    attribute float depth;\n\n  #endif\n\n  #ifdef WATER_WAVES\n\n    uniform float time;\n\n    varying vec2 vUw;\n    varying vec2 vUUw;\n    varying vec2 vUUUw;\n\n  #endif\n\n  varying vec4 wPos;\n\n  #ifdef WATER_DEPTH\n\n    varying float vDepth;\n\n  #endif\n\n"),e.vertexShader=e.vertexShader.replace("#include <color_vertex>","#include <color_vertex>\n\n\n  wPos = modelMatrix * vec4( position, 1.0 );\n\n  #ifdef WATER_WAVES\n\n    // 50 and 200 for normal map\n\n\n    vUw.x = (time + wPos.x) / 200.0;\n    vUw.y = (time + wPos.z) / 200.0;\n\n    vUUw.x = (wPos.x - time) / 800.0;\n    vUUw.y = (wPos.z - time) / 800.0;\n\n    vUUUw.x = (wPos.x - time) / 300.0;\n    vUUUw.y = (wPos.z - time) / 300.0;\n  #endif\n\n  #ifdef WATER_DEPTH\n    vDepth = depth;\n  #endif\n\n"),e.fragmentShader=e.fragmentShader.replace("#include <map_pars_fragment>","#include <map_pars_fragment>\n\n\n\nuniform vec3 camPos;\nuniform vec4 skyCol;\nuniform vec4 sunCol;\n\n#ifdef WATER_WAVES\n  uniform sampler2D waves;\n\n  varying vec2 vUw;\n  varying vec2 vUUw;\n  varying vec2 vUUUw;\n\n#endif\n\nvarying vec4 wPos;\n\n#ifdef WATER_DEPTH\n  varying float vDepth;\n#endif\n\nvec3 upvec = vec3(0.0,1.0,0.0);\n\n\n"),e.fragmentShader=e.fragmentShader.replace("#include <map_fragment>","#include <map_fragment>\n\n\n  #ifdef WATER_DEPTH\n    // Abandon water rendering if it's well under ground\n    if(vDepth > 10.0) {\n      discard;\n    }\n  #endif\n  \n  vec3 camNorm = normalize(vec3(\n    camPos.x - wPos.x,\n    camPos.y - wPos.y,\n    camPos.z - wPos.z\n  ));\n\n  float seaDot = dot(camNorm, upvec);\n\n  #if defined(WATER_WAVES) || defined(WATER_DEPTH)\n\n\n    // Add lightness\n    float wave1 = texture2D(waves, vUw).r + 0.1;\n    float wave2 = texture2D(waves, vUUw).r + 0.1;\n\n    // Add darkness?\n    float wave4 = (texture2D(waves, vUUUw).r + 0.1);\n    float wave5 = (texture2D(waves, vUUw - vUw).r + 0.1);\n\n    //// WAVE RIPPLES\n\n    float darkReflect = 0.0;\n\n    #ifdef WATER_DEPTH\n\n      if(vDepth > -2.0) {\n        if(vDepth > -1.0) {\n          darkReflect = 1.0;\n        } else {\n          darkReflect = (2.0 + vDepth);\n        }\n      }\n\n    #endif\n\n    // Extra dark ripples by sea edge\n    seaDot += wave4 * wave5 * (0.5 + darkReflect / 4.0);\n    // No ripples by sea edge\n    seaDot -= wave1 * wave2 * (1.0 - darkReflect);\n\n    //// EDGE HIGHLIGHT\n\n    #ifdef WATER_DEPTH\n\n      if(vDepth < 0.0) {\n        if(vDepth > -2.0) {\n          seaDot -= (2.0 + vDepth) * 0.05 * (1.0 - wave2);\n        }\n      } else {\n        seaDot -= 0.1 * (1.0 - wave2);\n      }\n    #endif\n\n    //// CLAMP SEADOT\n\n    seaDot = min(max(0.0, seaDot), 1.0);\n\n    //// BLEND SKY WITH DARK BY SEADOT\n\n    float seaDotMix = 1.0 - seaDot;\n    diffuseColor = mix(diffuseColor, skyCol, seaDotMix * seaDotMix);\n\n    //// DARKEN DEPTHS\n\n    #ifdef WATER_DEPTH\n\n      if(vDepth < 0.0) {\n        diffuseColor *= 1.0 - min(1.0, vDepth / -15.0) * 0.2;\n      }\n\n    #endif\n\n    //// HIGHLIGHTS ON SHALLOW ANGLES\n\n    float sunDotMix = 0.0;\n    if(seaDot < 0.125) {\n      sunDotMix = 1.0 - seaDot * 8.0;\n    }\n    diffuseColor = mix(diffuseColor, sunCol, sunDotMix * sunDotMix);\n\n  #else\n    float seaDotMix = 1.0 - seaDot;\n    diffuseColor = mix(diffuseColor, skyCol, seaDotMix * seaDotMix);\n  #endif\n\n  //// FINALISE\n\n  diffuseColor.a = 1.0;\n\n"),e)};Ms(ot,rt);var Ys=Ss;const Vs=new r.I(Dt,1,.35,Nt);Vs.fwd=new r.W(0,0,1);var Us=Vs,Xs=new l;const Js=[0,180,480,900];var qs=new class extends l{constructor(...e){super(...e),this.default=0,this.value=0,this.cycleLength=Js[0]}set(e){this.cycleLength=Js[e],super.set(e)}};const Ks={ambient:{readable:"Ambient",type:u.FloatRange,default:1,min:0,max:1,precision:2,onSet:e=>_s.set("ambient",e)},wind:{readable:"Wind",type:u.FloatRange,default:1,min:0,max:1,precision:2,onSet:e=>_s.set("wind",e)},engine:{readable:"Engine",type:u.FloatRange,default:1,min:0,max:1,precision:2,onSet:e=>_s.set("engine",e)},brakes:{readable:"Brakes",type:u.FloatRange,default:1,min:0,max:1,precision:2,onSet:e=>_s.set("brakes",e)},tyres:{readable:"Tyres rolling",type:u.FloatRange,default:1,min:0,max:1,precision:2,onSet:e=>_s.set("tyres",e)},skidding:{readable:"Tyres skidding",type:u.FloatRange,default:1,min:0,max:1,precision:2,onSet:e=>_s.set("skidding",e)},collisions:{readable:"Collisions",type:u.FloatRange,default:1,min:0,max:1,precision:2,onSet:e=>_s.set("collisions",e)}},_s=new p({ambient:1,wind:1,engine:1,brakes:1,tyres:1,skidding:1,collisions:1},"audio-levels",((e,t)=>{for(let i in t)t[i]=Math.max(Math.min(Ks[i].max,t[i]),Ks[i].min);return t}));var $s=_s;const en="1.1.4-freezenova.games";localStorage.getItem("seen-version");window.localStorage.setItem("seen-version",en),window.localStorage.removeItem("undefined");var tn={version:"1.1.4-freezenova.games",seed:Ee,"draw-calls":0,"heightmap-cache":0,"roadside-objects":0,farcells:0,"farcells-staged":0,"nearcell-staged":0},sn=i(10);class nn extends r.G{constructor(...e){super(...e),this.geoSource=null,this.materials={},this.objectType="root",this.worldPosition=new r.W,this.variant=0,this.variantMaterials=[]}initialiseGeometry(e){this.geoSource&&nn.loader.load(this.geoSource,(t=>{t.traverse((e=>{e.isMesh&&(e.userData.matName=e.name.split("_")[1],e.userData.matName in this.materials?e.material=this.materials[e.userData.matName]:e.material=this.materials.default)})),this.add(t),e(this)}))}destroy(){this.traverse((e=>{e.isMesh&&e.geometry.dispose()}))}updatePosition(){this.position.subVectors(this.worldPosition,this.parent.position)}updateRetireIndex(e){this.retireIndex=e+5}setVariant(e){e<0||e>=this.variantMaterials.length?console.warn("No variant index "+e+" found for object type "+this.objectType):(this.variantIndex=e,this.traverse((e=>{e.isMesh&&e.userData.matName in this.variantMaterials[this.variantIndex]&&(e.material=this.variantMaterials[this.variantIndex][e.userData.matName])})))}}nn.loader=new sn.a;var an=nn,on=i.p+"static/media/sign.c5b548a5.obj",rn="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAIAAACQd1PeAAAACXBIWXMAAAsTAAALEwEAmpwYAAAFuGlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDUgNzkuMTYzNDk5LCAyMDE4LzA4LzEzLTE2OjQwOjIyICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdEV2dD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlRXZlbnQjIiB4bWxuczpkYz0iaHR0cDovL3B1cmwub3JnL2RjL2VsZW1lbnRzLzEuMS8iIHhtbG5zOnBob3Rvc2hvcD0iaHR0cDovL25zLmFkb2JlLmNvbS9waG90b3Nob3AvMS4wLyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOSAoV2luZG93cykiIHhtcDpDcmVhdGVEYXRlPSIyMDIyLTAyLTAxVDE2OjI4OjE1WiIgeG1wOk1ldGFkYXRhRGF0ZT0iMjAyMi0wMi0wMVQxNjoyODoxNVoiIHhtcDpNb2RpZnlEYXRlPSIyMDIyLTAyLTAxVDE2OjI4OjE1WiIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDpmMThkYjE2OS1mMjY5LTI3NGYtYWMwNC1mYzhmZGIwMmY5M2QiIHhtcE1NOkRvY3VtZW50SUQ9ImFkb2JlOmRvY2lkOnBob3Rvc2hvcDo0MGQyNWZiNi04NDU4LTFjNGUtYjJjNS0wMTExOGEzYzRjMGQiIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDplZjM0ZDlmZi04MWQ5LTdlNGItOGYxMS0zZTFiY2UzMDJjNzUiIGRjOmZvcm1hdD0iaW1hZ2UvcG5nIiBwaG90b3Nob3A6Q29sb3JNb2RlPSIzIj4gPHhtcE1NOkhpc3Rvcnk+IDxyZGY6U2VxPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0iY3JlYXRlZCIgc3RFdnQ6aW5zdGFuY2VJRD0ieG1wLmlpZDplZjM0ZDlmZi04MWQ5LTdlNGItOGYxMS0zZTFiY2UzMDJjNzUiIHN0RXZ0OndoZW49IjIwMjItMDItMDFUMTY6Mjg6MTVaIiBzdEV2dDpzb2Z0d2FyZUFnZW50PSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOSAoV2luZG93cykiLz4gPHJkZjpsaSBzdEV2dDphY3Rpb249InNhdmVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOmYxOGRiMTY5LWYyNjktMjc0Zi1hYzA0LWZjOGZkYjAyZjkzZCIgc3RFdnQ6d2hlbj0iMjAyMi0wMi0wMVQxNjoyODoxNVoiIHN0RXZ0OnNvZnR3YXJlQWdlbnQ9IkFkb2JlIFBob3Rvc2hvcCBDQyAyMDE5IChXaW5kb3dzKSIgc3RFdnQ6Y2hhbmdlZD0iLyIvPiA8L3JkZjpTZXE+IDwveG1wTU06SGlzdG9yeT4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz4VqR/6AAAADElEQVQIHWOo598OAAJWAUbmdvdzAAAAAElFTkSuQmCC";const hn=0,ln=1,dn=2,cn=3,pn=5,un=6,gn=8,mn=9,xn=10,vn=11,wn=[{sign:tt("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAYAAADDPmHLAAAACXBIWXMAAAsTAAALEwEAmpwYAAAFuGlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDUgNzkuMTYzNDk5LCAyMDE4LzA4LzEzLTE2OjQwOjIyICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdEV2dD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlRXZlbnQjIiB4bWxuczpkYz0iaHR0cDovL3B1cmwub3JnL2RjL2VsZW1lbnRzLzEuMS8iIHhtbG5zOnBob3Rvc2hvcD0iaHR0cDovL25zLmFkb2JlLmNvbS9waG90b3Nob3AvMS4wLyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOSAoV2luZG93cykiIHhtcDpDcmVhdGVEYXRlPSIyMDIyLTAyLTAxVDE4OjU5OjA5WiIgeG1wOk1ldGFkYXRhRGF0ZT0iMjAyMi0wMi0wMVQxODo1OTowOVoiIHhtcDpNb2RpZnlEYXRlPSIyMDIyLTAyLTAxVDE4OjU5OjA5WiIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo3YzM5YjcwZC00NGU0LTUzNDYtOTEwOS0xMjU3MjhiZjg3OGUiIHhtcE1NOkRvY3VtZW50SUQ9ImFkb2JlOmRvY2lkOnBob3Rvc2hvcDpmNDc1ZTE1MS02MmZhLTE4NDItOWM0Mi0yMjdkNzRjOTk4NzQi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",.75,0,rn)},{sign:tt("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAYAAADDPmHLAAAACXBIWXMAAAsTAAALEwEAmpwYAAAFuGlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDUgNzkuMTYzNDk5LCAyMDE4LzA4LzEzLTE2OjQwOjIyICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdEV2dD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlRXZlbnQjIiB4bWxuczpkYz0iaHR0cDovL3B1cmwub3JnL2RjL2VsZW1lbnRzLzEuMS8iIHhtbG5zOnBob3Rvc2hvcD0iaHR0cDovL25zLmFkb2JlLmNvbS9waG90b3Nob3AvMS4wLyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOSAoV2luZG93cykiIHhtcDpDcmVhdGVEYXRlPSIyMDIyLTAyLTAxVDE4OjU4OjI0WiIgeG1wOk1ldGFkYXRhRGF0ZT0iMjAyMi0wMi0wMVQxODo1ODoyNFoiIHhtcDpNb2RpZnlEYXRlPSIyMDIyLTAyLTAxVDE4OjU4OjI0WiIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo2OTlkMTg2MC02NjVlLTZiNGItODIxMS00YTJmODZjMDY5NTkiIHhtcE1NOkRvY3VtZW50SUQ9ImFkb2JlOmRvY2lkOnBob3Rvc2hvcDplOWM1MThkMy1jOWM1LTBkNDAtODZjYS1mNTI3M2QwYjQzODgi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",.75,0,rn)},{sign:tt("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAYAAADDPmHLAAAACXBIWXMAAAsTAAALEwEAmpwYAAAFuGlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDUgNzkuMTYzNDk5LCAyMDE4LzA4LzEzLTE2OjQwOjIyICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdEV2dD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlRXZlbnQjIiB4bWxuczpkYz0iaHR0cDovL3B1cmwub3JnL2RjL2VsZW1lbnRzLzEuMS8iIHhtbG5zOnBob3Rvc2hvcD0iaHR0cDovL25zLmFkb2JlLmNvbS9waG90b3Nob3AvMS4wLyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOSAoV2luZG93cykiIHhtcDpDcmVhdGVEYXRlPSIyMDIyLTAyLTAxVDE4OjU0OjEwWiIgeG1wOk1ldGFkYXRhRGF0ZT0iMjAyMi0wMi0wMVQxODo1NDoxMFoiIHhtcDpNb2RpZnlEYXRlPSIyMDIyLTAyLTAxVDE4OjU0OjEwWiIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDphNTNlOTZlZC0wNzg5LTc2NDQtYmU3Yi05YjZkYTVjZTk5ZTAiIHhtcE1NOkRvY3VtZW50SUQ9ImFkb2JlOmRvY2lkOnBob3Rvc2hvcDoxNzlkMmIyNi01ZTcwLWJiNGEtODAyMS1jMjE1Y2ZmMmY3ZDgi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",.75,0,rn)},{sign:tt("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAYAAADDPmHLAAAACXBIWXMAAAsTAAALEwEAmpwYAAAFuGlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDUgNzkuMTYzNDk5LCAyMDE4LzA4LzEzLTE2OjQwOjIyICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdEV2dD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlRXZlbnQjIiB4bWxuczpkYz0iaHR0cDovL3B1cmwub3JnL2RjL2VsZW1lbnRzLzEuMS8iIHhtbG5zOnBob3Rvc2hvcD0iaHR0cDovL25zLmFkb2JlLmNvbS9waG90b3Nob3AvMS4wLyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOSAoV2luZG93cykiIHhtcDpDcmVhdGVEYXRlPSIyMDIyLTAyLTAxVDE4OjU0OjM4WiIgeG1wOk1ldGFkYXRhRGF0ZT0iMjAyMi0wMi0wMVQxODo1NDozOFoiIHhtcDpNb2RpZnlEYXRlPSIyMDIyLTAyLTAxVDE4OjU0OjM4WiIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDoyOTg4MjdkYy01Y2Y1LWIyNGItOGE2ZS03Njk4OTJiYThkZmUiIHhtcE1NOkRvY3VtZW50SUQ9ImFkb2JlOmRvY2lkOnBob3Rvc2hvcDozNTQwZGNiOS04NTBhLWFkNGEtODQyYS0xNzIxMjA4NzA0N2Ii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",.75,0,rn)},{sign:tt("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAYAAADDPmHLAAAACXBIWXMAAAsTAAALEwEAmpwYAAAGNmlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDUgNzkuMTYzNDk5LCAyMDE4LzA4LzEzLTE2OjQwOjIyICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdEV2dD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlRXZlbnQjIiB4bWxuczpwaG90b3Nob3A9Imh0dHA6Ly9ucy5hZG9iZS5jb20vcGhvdG9zaG9wLzEuMC8iIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOSAoV2luZG93cykiIHhtcDpDcmVhdGVEYXRlPSIyMDIyLTAyLTAxVDIwOjI3OjMzWiIgeG1wOk1ldGFkYXRhRGF0ZT0iMjAyMi0wMi0wMVQyMDoyNzozM1oiIHhtcDpNb2RpZnlEYXRlPSIyMDIyLTAyLTAxVDIwOjI3OjMzWiIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDoxZWNhNDY1ZC1jOTQyLTBjNDMtOWJkZS1iMzg2YTNkNWU1OGUiIHhtcE1NOkRvY3VtZW50SUQ9ImFkb2JlOmRvY2lkOnBob3Rvc2hvcDo2ZDAyZjIxMi00NDRkLTEzNGUtYmU4Yy0xOWI1ZTg4ODFkOGEiIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo0NTZjZGY2YS01OTc2LTU3NDQtYjJhMS1jYmIyOTgwNjc1NzUiIHBob3Rvc2hvcDpDb2xvck1vZGU9IjMiIGRjOmZvcm1hdD0iaW1hZ2UvcG5nIj4gPHhtcE1NOkhpc3Rvcnk+IDxyZGY6U2VxPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0iY3JlYXRlZCIgc3RFdnQ6aW5zdGFuY2VJRD0ieG1wLmlpZDo0NTZjZGY2YS01OTc2LTU3NDQtYjJhMS1jYmIyOTgwNjc1NzUiIHN0RXZ0OndoZW49IjIwMjItMDItMDFUMjA6Mjc6MzNaIiBzdEV2dDpzb2Z0d2FyZUFnZW50PSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOSAoV2luZG93cykiLz4gPHJkZjpsaSBzdEV2dDphY3Rpb249InNhdmVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOjFlY2E0NjVkLWM5NDItMGM0My05YmRlLWIzODZhM2Q1ZTU4ZSIgc3RFdnQ6d2hlbj0iMjAyMi0wMi0wMVQyMDoyNzozM1oiIHN0RXZ0OnNvZnR3YXJlQWdlbnQ9IkFkb2JlIFBob3Rvc2hvcCBDQyAyMDE5IChXaW5kb3dzKSIgc3RFdnQ6Y2hhbmdlZD0iLyIvPiA8L3JkZjpTZXE+IDwveG1wTU06SGlzdG9yeT4gPHBob3Rvc2hvcDpUZXh0TGF5ZXJzPiA8cmRmOkJhZz4gPHJkZjpsaSBwaG90b3Nob3A6TGF5ZXJOYW1lPSIhIiBwaG90b3Nob3A6TGF5ZXJUZXh0PSIhIi8+IDwvcmRmOkJhZz4gPC9waG90b3Nob3A6VGV4dExheWVycz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz5dhtDoAAAT3klEQVR42u1dB1hU17aOJkaTm+Sq8ba85OZ9uffl3rwkNsoMZehSpDcBQVREY8MWY8t9scUYTYwxRk1ixR5jbyDNmWEGGDoiIlYsMAxNkTblzKx39qENRoR9mIEZ2Pv7fs8ZmjPn//c6a+291jovAMALBP0X5CIQAZCLQARAQARAQARAQATQN5FsxesI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",.75,0,rn)},{sign:tt("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAYAAADDPmHLAAAACXBIWXMAAAsTAAALEwEAmpwYAAAHzGlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDUgNzkuMTYzNDk5LCAyMDE4LzA4LzEzLTE2OjQwOjIyICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdEV2dD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlRXZlbnQjIiB4bWxuczpwaG90b3Nob3A9Imh0dHA6Ly9ucy5hZG9iZS5jb20vcGhvdG9zaG9wLzEuMC8iIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOSAoV2luZG93cykiIHhtcDpDcmVhdGVEYXRlPSIyMDIyLTAyLTAxVDIwOjI3OjEyWiIgeG1wOk1ldGFkYXRhRGF0ZT0iMjAyMi0wMi0wMlQxNDo1NDoyMloiIHhtcDpNb2RpZnlEYXRlPSIyMDIyLTAyLTAyVDE0OjU0OjIyWiIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDpiNTZiYjAwNS02YmRjLWY5NDMtYjY4MS02OTQ4MWE2MDY0OTgiIHhtcE1NOkRvY3VtZW50SUQ9ImFkb2JlOmRvY2lkOnBob3Rvc2hvcDpiMWUxMGI5Mi03YTkzLTMwNDAtOGFjMC1hNTE1ODRkZTZlZWIiIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo3NzA5MDQ4Ny1jZDE3LWI3NGUtYWQ1Zi0zODU4ZjExYjc5MzAiIHBob3Rvc2hvcDpDb2xvck1vZGU9IjMiIHBob3Rvc2hvcDpJQ0NQcm9maWxlPSJzUkdCIElFQzYxOTY2LTIuMSIgZGM6Zm9ybWF0PSJpbWFnZS9wbmciPiA8eG1wTU06SGlzdG9yeT4gPHJkZjpTZXE+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJjcmVhdGVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOjc3MDkwNDg3LWNkMTctYjc0ZS1hZDVmLTM4NThmMTFiNzkzMCIgc3RFdnQ6d2hlbj0iMjAyMi0wMi0wMVQyMDoyNzoxMloiIHN0RXZ0OnNvZnR3YXJlQWdlbnQ9IkFkb2JlIFBob3Rvc2hvcCBDQyAyMDE5IChXaW5kb3dzKSIvPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0ic2F2ZWQiIHN0RXZ0Omluc3RhbmNlSUQ9InhtcC5paWQ6ZmRmZTJhMGQtMmM0OS0zYzQ0LWEzZjEtNGJiZmQzYWJiY2YyIiBzdEV2dDp3aGVuPSIyMDIyLTAyLTAxVDIwOjI3OjEyWiIgc3RFdnQ6c29mdHdhcmVBZ2VudD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTkgKFdpbmRvd3MpIiBzdEV2dDpjaGFuZ2VkPSIvIi8+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJzYXZlZCIgc3RFdnQ6aW5zdGFuY2VJRD0ieG1wLmlpZDpiNTZiYjAwNS02YmRjLWY5NDMtYjY4MS02OTQ4MWE2MDY0OTgiIHN0RXZ0OndoZW49IjIwMjItMDItMDJUMTQ6NTQ6MjJaIiBzdEV2dDpzb2Z0d2FyZUFnZW50PSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOSAoV2luZG93cykiIHN0RXZ0OmNoYW5nZWQ9Ii8iLz4gPC9yZGY6U2VxPiA8L3htcE1NOkhpc3Rvcnk+IDxwaG90b3Nob3A6VGV4dExheWVycz4gPHJkZjpCYWc+IDxyZGY6bGkgcGhvdG9zaG9wOkxheWVyTmFtZT0iMTUlIiBwaG90b3Nob3A6TGF5ZXJUZXh0PSIxNSUi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",.75,0,rn)},{sign:tt("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAYAAADDPmHLAAAACXBIWXMAAAsTAAALEwEAmpwYAAAHzGlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDUgNzkuMTYzNDk5LCAyMDE4LzA4LzEzLTE2OjQwOjIyICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdEV2dD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlRXZlbnQjIiB4bWxuczpwaG90b3Nob3A9Imh0dHA6Ly9ucy5hZG9iZS5jb20vcGhvdG9zaG9wLzEuMC8iIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOSAoV2luZG93cykiIHhtcDpDcmVhdGVEYXRlPSIyMDIyLTAyLTAxVDIwOjI3OjEyWiIgeG1wOk1ldGFkYXRhRGF0ZT0iMjAyMi0wMi0wMlQxNDo1Mzo1NloiIHhtcDpNb2RpZnlEYXRlPSIyMDIyLTAyLTAyVDE0OjUzOjU2WiIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo4YTExMzQzMS00MWJlLTNiNGEtODk1Yy0xODBkOTYzNzdkNmYiIHhtcE1NOkRvY3VtZW50SUQ9ImFkb2JlOmRvY2lkOnBob3Rvc2hvcDpjN2VmYjY3MS0xZGRjLWJkNGYtYWE5NS0xNTU5ZGU0ODczZWMiIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo3NzA5MDQ4Ny1jZDE3LWI3NGUtYWQ1Zi0zODU4ZjExYjc5MzAiIHBob3Rvc2hvcDpDb2xvck1vZGU9IjMiIHBob3Rvc2hvcDpJQ0NQcm9maWxlPSJzUkdCIElFQzYxOTY2LTIuMSIgZGM6Zm9ybWF0PSJpbWFnZS9wbmciPiA8eG1wTU06SGlzdG9yeT4gPHJkZjpTZXE+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJjcmVhdGVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOjc3MDkwNDg3LWNkMTctYjc0ZS1hZDVmLTM4NThmMTFiNzkzMCIgc3RFdnQ6d2hlbj0iMjAyMi0wMi0wMVQyMDoyNzoxMloiIHN0RXZ0OnNvZnR3YXJlQWdlbnQ9IkFkb2JlIFBob3Rvc2hvcCBDQyAyMDE5IChXaW5kb3dzKSIvPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0ic2F2ZWQiIHN0RXZ0Omluc3RhbmNlSUQ9InhtcC5paWQ6ZmRmZTJhMGQtMmM0OS0zYzQ0LWEzZjEtNGJiZmQzYWJiY2YyIiBzdEV2dDp3aGVuPSIyMDIyLTAyLTAxVDIwOjI3OjEyWiIgc3RFdnQ6c29mdHdhcmVBZ2VudD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTkgKFdpbmRvd3MpIiBzdEV2dDpjaGFuZ2VkPSIvIi8+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJzYXZlZCIgc3RFdnQ6aW5zdGFuY2VJRD0ieG1wLmlpZDo4YTExMzQzMS00MWJlLTNiNGEtODk1Yy0xODBkOTYzNzdkNmYiIHN0RXZ0OndoZW49IjIwMjItMDItMDJUMTQ6NTM6NTZaIiBzdEV2dDpzb2Z0d2FyZUFnZW50PSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOSAoV2luZG93cykiIHN0RXZ0OmNoYW5nZWQ9Ii8iLz4gPC9yZGY6U2VxPiA8L3htcE1NOkhpc3Rvcnk+IDxwaG90b3Nob3A6VGV4dExheWVycz4gPHJkZjpCYWc+IDxyZGY6bGkgcGhvdG9zaG9wOkxheWVyTmFtZT0iMjAlIiBwaG90b3Nob3A6TGF5ZXJUZXh0PSIyMCUi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",.75,0,rn)},{sign:tt("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAYAAADDPmHLAAAACXBIWXMAAAsTAAALEwEAmpwYAAAGNmlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDUgNzkuMTYzNDk5LCAyMDE4LzA4LzEzLTE2OjQwOjIyICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdEV2dD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlRXZlbnQjIiB4bWxuczpwaG90b3Nob3A9Imh0dHA6Ly9ucy5hZG9iZS5jb20vcGhvdG9zaG9wLzEuMC8iIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOSAoV2luZG93cykiIHhtcDpDcmVhdGVEYXRlPSIyMDIyLTAyLTAxVDIwOjI3OjEyWiIgeG1wOk1ldGFkYXRhRGF0ZT0iMjAyMi0wMi0wMVQyMDoyNzoxMloiIHhtcDpNb2RpZnlEYXRlPSIyMDIyLTAyLTAxVDIwOjI3OjEyWiIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDpmZGZlMmEwZC0yYzQ5LTNjNDQtYTNmMS00YmJmZDNhYmJjZjIiIHhtcE1NOkRvY3VtZW50SUQ9ImFkb2JlOmRvY2lkOnBob3Rvc2hvcDo1NzMxZDNmYy1mOWY2LTZjNDMtYmYwNy02ZjVjNWE2MjkzNGUiIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo3NzA5MDQ4Ny1jZDE3LWI3NGUtYWQ1Zi0zODU4ZjExYjc5MzAiIHBob3Rvc2hvcDpDb2xvck1vZGU9IjMiIGRjOmZvcm1hdD0iaW1hZ2UvcG5nIj4gPHhtcE1NOkhpc3Rvcnk+IDxyZGY6U2VxPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0iY3JlYXRlZCIgc3RFdnQ6aW5zdGFuY2VJRD0ieG1wLmlpZDo3NzA5MDQ4Ny1jZDE3LWI3NGUtYWQ1Zi0zODU4ZjExYjc5MzAiIHN0RXZ0OndoZW49IjIwMjItMDItMDFUMjA6Mjc6MTJaIiBzdEV2dDpzb2Z0d2FyZUFnZW50PSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOSAoV2luZG93cykiLz4gPHJkZjpsaSBzdEV2dDphY3Rpb249InNhdmVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOmZkZmUyYTBkLTJjNDktM2M0NC1hM2YxLTRiYmZkM2FiYmNmMiIgc3RFdnQ6d2hlbj0iMjAyMi0wMi0wMVQyMDoyNzoxMloiIHN0RXZ0OnNvZnR3YXJlQWdlbnQ9IkFkb2JlIFBob3Rvc2hvcCBDQyAyMDE5IChXaW5kb3dzKSIgc3RFdnQ6Y2hhbmdlZD0iLyIvPiA8L3JkZjpTZXE+IDwveG1wTU06SGlzdG9yeT4gPHBob3Rvc2hvcDpUZXh0TGF5ZXJzPiA8cmRmOkJhZz4gPHJkZjpsaSBwaG90b3Nob3A6TGF5ZXJOYW1lPSIhIiBwaG90b3Nob3A6TGF5ZXJUZXh0PSIhIi8+IDwvcmRmOkJhZz4gPC9waG90b3Nob3A6VGV4dExheWVycz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz64/6jGAAAT1klEQVR42u2dB1hU17bHo4nR5Ca5arwtL7l5X+59uTcviY0yQxm6FOlNQBEV0diwxdhyX2wxRhNjjFGTWLHH2BtKc2aYAYaOiIgVCwxDk86UM7Pe2QchMyrCPszADOz9fX/PAKIzZ/3OPmutvfY6LwDAC0R9V+QkEADISSAAEBEAiAgARASA3qlkG157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",.75,0,rn)},{sign:tt("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAYAAADDPmHLAAAACXBIWXMAAAsTAAALEwEAmpwYAAAHLmlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDUgNzkuMTYzNDk5LCAyMDE4LzA4LzEzLTE2OjQwOjIyICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdEV2dD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlRXZlbnQjIiB4bWxuczpwaG90b3Nob3A9Imh0dHA6Ly9ucy5hZG9iZS5jb20vcGhvdG9zaG9wLzEuMC8iIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOSAoV2luZG93cykiIHhtcDpDcmVhdGVEYXRlPSIyMDIyLTAyLTAxVDIwOjI3OjEyWiIgeG1wOk1ldGFkYXRhRGF0ZT0iMjAyMi0wMi0wMlQxNDo1Mjo1NloiIHhtcDpNb2RpZnlEYXRlPSIyMDIyLTAyLTAyVDE0OjUyOjU2WiIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo1YjQ3ZTcyNS03MjJjLWY1NGQtOTNkNC05MWI2MDE3MzY2OTAiIHhtcE1NOkRvY3VtZW50SUQ9ImFkb2JlOmRvY2lkOnBob3Rvc2hvcDo3YTRjZWRiMC0xYjkzLWMwNDMtODJkMC0yMTQ1ZmM5MDllMjciIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo3NzA5MDQ4Ny1jZDE3LWI3NGUtYWQ1Zi0zODU4ZjExYjc5MzAiIHBob3Rvc2hvcDpDb2xvck1vZGU9IjMiIHBob3Rvc2hvcDpJQ0NQcm9maWxlPSJzUkdCIElFQzYxOTY2LTIuMSIgZGM6Zm9ybWF0PSJpbWFnZS9wbmciPiA8eG1wTU06SGlzdG9yeT4gPHJkZjpTZXE+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJjcmVhdGVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOjc3MDkwNDg3LWNkMTctYjc0ZS1hZDVmLTM4NThmMTFiNzkzMCIgc3RFdnQ6d2hlbj0iMjAyMi0wMi0wMVQyMDoyNzoxMloiIHN0RXZ0OnNvZnR3YXJlQWdlbnQ9IkFkb2JlIFBob3Rvc2hvcCBDQyAyMDE5IChXaW5kb3dzKSIvPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0ic2F2ZWQiIHN0RXZ0Omluc3RhbmNlSUQ9InhtcC5paWQ6ZmRmZTJhMGQtMmM0OS0zYzQ0LWEzZjEtNGJiZmQzYWJiY2YyIiBzdEV2dDp3aGVuPSIyMDIyLTAyLTAxVDIwOjI3OjEyWiIgc3RFdnQ6c29mdHdhcmVBZ2VudD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTkgKFdpbmRvd3MpIiBzdEV2dDpjaGFuZ2VkPSIvIi8+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJzYXZlZCIgc3RFdnQ6aW5zdGFuY2VJRD0ieG1wLmlpZDo1YjQ3ZTcyNS03MjJjLWY1NGQtOTNkNC05MWI2MDE3MzY2OTAiIHN0RXZ0OndoZW49IjIwMjItMDItMDJUMTQ6NTI6NTZaIiBzdEV2dDpzb2Z0d2FyZUFnZW50PSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOSAoV2luZG93cykiIHN0RXZ0OmNoYW5nZWQ9Ii8iLz4gPC9yZGY6U2VxPiA8L3htcE1NOkhpc3Rvcnk+IDxwaG90b3Nob3A6VGV4dExheWVycz4gPHJkZjpCYWc+IDxyZGY6bGkgcGhvdG9zaG9wOkxheWVyTmFtZT0iMTUlIiBwaG90b3Nob3A6TGF5ZXJUZXh0PSIxNSUi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",.75,0,rn)},{sign:tt("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAYAAADDPmHLAAAACXBIWXMAAAsTAAALEwEAmpwYAAAHLmlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDUgNzkuMTYzNDk5LCAyMDE4LzA4LzEzLTE2OjQwOjIyICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdEV2dD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlRXZlbnQjIiB4bWxuczpwaG90b3Nob3A9Imh0dHA6Ly9ucy5hZG9iZS5jb20vcGhvdG9zaG9wLzEuMC8iIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOSAoV2luZG93cykiIHhtcDpDcmVhdGVEYXRlPSIyMDIyLTAyLTAxVDIwOjI3OjEyWiIgeG1wOk1ldGFkYXRhRGF0ZT0iMjAyMi0wMi0wMlQxNDo1MzoxN1oiIHhtcDpNb2RpZnlEYXRlPSIyMDIyLTAyLTAyVDE0OjUzOjE3WiIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDpiNTk0OGVkNi1mZTViLWE0NGEtYjZlMy04ZDM5ZGJjOTdjMzUiIHhtcE1NOkRvY3VtZW50SUQ9ImFkb2JlOmRvY2lkOnBob3Rvc2hvcDpiZDJlYzBkOS00Yjg0LTI4NDAtYWZjOC0wOWM3OTVkMTkyMGQiIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo3NzA5MDQ4Ny1jZDE3LWI3NGUtYWQ1Zi0zODU4ZjExYjc5MzAiIHBob3Rvc2hvcDpDb2xvck1vZGU9IjMiIHBob3Rvc2hvcDpJQ0NQcm9maWxlPSJzUkdCIElFQzYxOTY2LTIuMSIgZGM6Zm9ybWF0PSJpbWFnZS9wbmciPiA8eG1wTU06SGlzdG9yeT4gPHJkZjpTZXE+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJjcmVhdGVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOjc3MDkwNDg3LWNkMTctYjc0ZS1hZDVmLTM4NThmMTFiNzkzMCIgc3RFdnQ6d2hlbj0iMjAyMi0wMi0wMVQyMDoyNzoxMloiIHN0RXZ0OnNvZnR3YXJlQWdlbnQ9IkFkb2JlIFBob3Rvc2hvcCBDQyAyMDE5IChXaW5kb3dzKSIvPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0ic2F2ZWQiIHN0RXZ0Omluc3RhbmNlSUQ9InhtcC5paWQ6ZmRmZTJhMGQtMmM0OS0zYzQ0LWEzZjEtNGJiZmQzYWJiY2YyIiBzdEV2dDp3aGVuPSIyMDIyLTAyLTAxVDIwOjI3OjEyWiIgc3RFdnQ6c29mdHdhcmVBZ2VudD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTkgKFdpbmRvd3MpIiBzdEV2dDpjaGFuZ2VkPSIvIi8+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJzYXZlZCIgc3RFdnQ6aW5zdGFuY2VJRD0ieG1wLmlpZDpiNTk0OGVkNi1mZTViLWE0NGEtYjZlMy04ZDM5ZGJjOTdjMzUiIHN0RXZ0OndoZW49IjIwMjItMDItMDJUMTQ6NTM6MTdaIiBzdEV2dDpzb2Z0d2FyZUFnZW50PSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOSAoV2luZG93cykiIHN0RXZ0OmNoYW5nZWQ9Ii8iLz4gPC9yZGY6U2VxPiA8L3htcE1NOkhpc3Rvcnk+IDxwaG90b3Nob3A6VGV4dExheWVycz4gPHJkZjpCYWc+IDxyZGY6bGkgcGhvdG9zaG9wOkxheWVyTmFtZT0iMjAlIiBwaG90b3Nob3A6TGF5ZXJUZXh0PSIyMCUi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",.75,0,rn)},{sign:tt("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAYAAADDPmHLAAAACXBIWXMAAAsTAAALEwEAmpwYAAAFuGlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDUgNzkuMTYzNDk5LCAyMDE4LzA4LzEzLTE2OjQwOjIyICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdEV2dD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlRXZlbnQjIiB4bWxuczpkYz0iaHR0cDovL3B1cmwub3JnL2RjL2VsZW1lbnRzLzEuMS8iIHhtbG5zOnBob3Rvc2hvcD0iaHR0cDovL25zLmFkb2JlLmNvbS9waG90b3Nob3AvMS4wLyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOSAoV2luZG93cykiIHhtcDpDcmVhdGVEYXRlPSIyMDIyLTAyLTAxVDIwOjM1OjE1WiIgeG1wOk1ldGFkYXRhRGF0ZT0iMjAyMi0wMi0wMVQyMDozNToxNVoiIHhtcDpNb2RpZnlEYXRlPSIyMDIyLTAyLTAxVDIwOjM1OjE1WiIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo1YjcyNGQ1Yy0xMTE2LTZhNDktYjBlNy01YWNjZDlkZDA2M2MiIHhtcE1NOkRvY3VtZW50SUQ9ImFkb2JlOmRvY2lkOnBob3Rvc2hvcDpmN2ViYTA2Ni1lYmRmLWJiNDgtYWVkYi0zODkzZDdmMDM0MTMiIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDowZTI5ZDJiMi0yYWUwLTgxNGItODdkZS0xYzU5MDU2ZDcxN2QiIGRjOmZvcm1hdD0iaW1hZ2UvcG5nIiBwaG90b3Nob3A6Q29sb3JNb2RlPSIzIj4gPHhtcE1NOkhpc3Rvcnk+IDxyZGY6U2VxPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0iY3JlYXRlZCIgc3RFdnQ6aW5zdGFuY2VJRD0ieG1wLmlpZDowZTI5ZDJiMi0yYWUwLTgxNGItODdkZS0xYzU5MDU2ZDcxN2QiIHN0RXZ0OndoZW49IjIwMjItMDItMDFUMjA6MzU6MTVaIiBzdEV2dDpzb2Z0d2FyZUFnZW50PSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOSAoV2luZG93cykiLz4gPHJkZjpsaSBzdEV2dDphY3Rpb249InNhdmVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOjViNzI0ZDVjLTExMTYtNmE0OS1iMGU3LTVhY2NkOWRkMDYzYyIgc3RFdnQ6d2hlbj0iMjAyMi0wMi0wMVQyMDozNToxNVoiIHN0RXZ0OnNvZnR3YXJlQWdlbnQ9IkFkb2JlIFBob3Rvc2hvcCBDQyAyMDE5IChXaW5kb3dzKSIgc3RFdnQ6Y2hhbmdlZD0iLyIvPiA8L3JkZjpTZXE+IDwveG1wTU06SGlzdG9yeT4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz7ANToYAAATX0lEQVR42u1d2XZTR9YWCRBCOoQES2eUZAszGE/yiA3GA5Dk5v9veIK8D6/AG/RF922v1eluLnqtHrLoDgGDMYMnWbZs8Dxo3F27Jh0J29iybJekOmt968hgxDm1v9q1p9rlAwCfxKLvAcEjghcEoFGVeOCVuRC8QfCQIKMHqOqR4bI2vAR4qAem5vCQEYCpfT3za1MTPPDxNV8PSG3ikU8bfDWNFz49CLUNTQBNAD0ImgAatUuA3PtTqwSA2OsXV2JhiI22VTxmnucx9bIL3o12wsTLbph53QP/enwF3jyPwvL8ffgwOwIr8SFYjd0+caxN34K1GQ78s5l+gI3/g/T7u/Du1yaYGW2C6ZfXYXa8GyZfdMDE8+49ZSnkjbLfNwH+9bgPOm6crXCcyaPpDLQ1fQHR1vPQ1XEeLl7wQU+XCeNjf4Rcbgy2Np7A9ta/YXvzHyeKJMU/KbY3EP8AgHewuvwY/v/HEETc0/TdojfOQWf7l9BK7mbgTPkJ8Pe/DMNX560qggnnzxvw9QULfD4ffEl+/vcvTwGvdAZgKwmQBXblTgi7XavrAIOD35PnPg1nz/nh3FdB+OJ8hLzDJTj7RYD8+TflJ8AvP98DO1AvYZURdhlhFd0L/y5c8HPQClPhO4YN//nlCR3cTCoDqc1t2FrfgjT5nCWSyGSPELkd4Pm7XAYfitzTTPiZZBYGB4bocwctFwwrBBftMEEDBP0GBL4JwNlT35WfAE9+vg9uICjhGOWD93sPC/F9O/4/ZLAsvwOOGYQQGTAcxEgoBK+ej/KpTkYcJU5UQA7VQDZ75CogV4Ti6Z9JpiG1kaSfl5eW4f7wPfrcruGQ97QJCUKEBBYEbJMQwAXzoh8+9509ChvgDthk4CoJlgem4YJl8Tv52ec7BaZpwbNnz+RgZ4XAj/H6iABC8EQFZAkZEXhtbmzB0MBdJnyiuRwieNsMESIEIUg0mG2ZYPgjUFdHlrRTviMgwN8GK5oACCPgcOGTQXQa4Omvv7E1P01mWSqlBAHwEfCeIssPkoDO/OVVGBm+T58bhc6Ez94RCeASAliEAKa/AeoumZoAxQTAWW+TQXNstuZH6q/C27cTbKZlcaAzkEwmlSBArsj621jfhNv9g/S5LdReBJoA+wAOkhB+KBihM54aTm4DjL96LQf/pK+PNUBOmh7r6xtwd+QH+tyG32bvhGT2vKcmwG7C52s9DkjQjdBBvBy5ChPvJungJrfTUsWqRgC8PnxYgoGBO8xLIWu+S7TXTu+qCbCb+icEwDXfderpIIZCESn8LLpVJy/7XY3A1dU1uHnzFhO+HSxQ+ZoA+5z9OGPEzI80XIFXY6/zLl32E5GWEyICM/iW5cy3bJu8R2jP99UEKJ71fhy0egjymd/YeA3ecYMvP9onKegchXT30lkKvJaIn3/7FjP4bOKyGoYFJvH1HXN/GsAiBPDXOgEufRuAkJj5kQiMvx7nfnVGiZmOnoaXAOkke67V5TVi7fMIHyFwXu3vXwPYdQ0Q+K5GCYDCN3HN5+Hda1eaYOzl2K4Dr9L1fvED3Oxhaz5qroO8tyZAAQlYkKc+dJkIf1yqXAz0qCR8fBYRc1j6sAJ9vbdZcMre3drXBNhhxnuNviD38yMNV+HF6MuC9VYF4XufRSxHKysrxM8XET72XqjF9rL6NQE8QkeDx8TkDlf7l4m1//b1OzbgGXVmu4B3GVpdJTO/r48J38gvYQcdi5rVAEgCHDAcuFO+z4m/HIJnT0ella+On5/XQOKOM39kZJiHdx36HgLFkT5NgD3Uf32okRtOYRh9ztU+JlMyZLZl1FnzceajHcJm/irx8wfoc5uWRYgcpK6rJsA+Zry4h9y8n28SX1kYfAVBnpwqGgBkyHlzcwuGhpirZwQMIjSH3InwAq4mwH5mvYAQvkVm0NOnLKWL6VwV3TwR5FlfXYd7d3/gBp/L3T33k36+JoBnvUdVafN8fjjUAKOjzwv9fEWmvTD2BCHX1zbgdj9T+05RPv+wqGoCiIESajEcjNBKHlSZT//7W0UEeTbXt+Du8PdS+AcN9NQsAcSsx884aCG3QRZzjD57WWBVF38+MXVP/PutrS0Z5FlfW4fbt+4UVPIc1M+vWQJ4XSMhfBy4N+MTJ57QKXbzvO7e5uYmy+oRV2/gdqHaL67m0QTYY/bjei9UP3P1GqSrJ619hUK73jUfXb3h4WFJ2sMaejW7BAjhX4k0yZRuLpuD5FZGiUBPcXRP5PN7enpYbN8NfjKfrwmwk/ClweeDhnAjvHn9tiDChylUFQI9KHy63udEDd86DNy5w4M8JhiGKd9HE+AAEPn8hkgEXr0al36+Smt+ngVi5q/A4MCwzOphhA+LOo56rKqCAMI6RoiZXx+OwNTUZOFMUyiu7yUD1vD19Q7IAs6jXPOrWgOIYo764GV4NZav5FGlmmenxM7qyhrc6mdqP1Bnld3Kr2oCeOPeOHA4iE3XmvMpXUWDO4KQWMPX293H1X7oo3fSBNhHTt/r52P17ts3EzKrp5qLJ6qLWN3+BxgaZGs+Pr+oRNYa4KAVvFztN16+VpDVy2bUmvXeSp7FxUXo7+/3rPknlySr6CVAZPVCdLvWG08+X61In3ftX1pakvl8x3aPfcZXBQG8QZ5wsB6e/zZaIHxVCICeB7qfqRRT+xsbGzA0NChT0ZZln3hxTMUQQFS74l24epcbL8sCTqpeFSrkYFvIspDcSsvS7aHBEb61nBDYco/Fz68qDYBrPqvePQVGwITnPJ/vXV9V8vOzvJhjbW2dCP+uJ7YfPFZfv+IJgIOGPnKIl25j/f7TX58VuFUqlW57r+WlFbjLmzMcRTavqgngHSxp8BH1/+L52EcJFRUifd61nxZzbGzB7f47sm5fNeErTQCR0mVFnA28gNOWxRyQA6VmfPEd8/rf3/+xQPiaACWofZe2ZfmMaoBnv72QlbIq+Pk4073Lj5j5mNIdGRnJF3OY6gleeQLQNd/lBp/fyc/8LBpXatTtC+PTu/zgzBel27blKDnrlSWAt3a/gW/acK36ggJOVP2ZFO6JP3kVQIXviTnjdq179+7mN23YQbptSxNgnwQQRZwu78aFpduvx98UCF+ler7kdkr6+SvLqzB4Z1huNlHFz68IAoikTn7Nx3KokGzOoGLtHlX/aWHtb8LgwMiR1O3XDAFwp64w+BojV2FsbGxHQ0s1Px9Tundu5ws4K0n4yhAAB03sz28IX4GJiSku/ByNpavWoEFEHbEJY/9N3pAp4B57Lr+iCVAY5GHCv3K5CV55mjCqVtAhkjvS1RtSN8KnNAFELt9bxoVNGKenZngMPadEF04RYRREFMUcKPze3t6KVftKaAA0+kR4N1J/BcbH8vn8dDKrBAGKfXxq7eOOnQHWk8dxghVh6StHABS8I7tx3ciXcXHLGqHKxg3vhTt2urq62E6jYJC5eqYmwIEJgCrzqy8vQLS9C969nZQ7dmghR5YXdiiiAQQJpqam8p05TNy0YWgClEIAFP6339TBZ77P4c9/+jmfN89CIUAtAvz0008sOBUOM+HbaMM4mgClaoBzZ78kVvQIxGfn8iTIqUUArwH45MkT6O7upiTw+/1021YlhHqVJYBl2nQwe7t7YX4ukQ/xKtSIWdQaCL8/FotBW1sbNwCJEeuGK9L3V4IAZsAixiDbzNHV0Q1L75fZoGdyFCrt4/N6AkiC9vY2nu1zqRurCVAiASwDCz5cOph9vf2wuLBIB3l7c1vJXT3imSYnJ6GltVUewOTdqKIJsO9QsEOBBBAk6OnqhcT8ggwDq0gAoQ2mZ2aIF9MpI4FaA5RIAIRrs5/FcjAXn1N2T593s2l8Ng7tLZ1F1b6iR0FIE2C/BEAE6gypCTrIzErMJ3YMxqgWHIpNx6Ez2sNJwDp64B0PatD1AAdIB4t1VOQGUBPEZmJ8g0Vu/wfjHuMlcgNoE0SjHdI7wBgBHdAKCBQpWRMotnq3tbbnlwMFCZDN5peDRCJBvIN22d7FdmxWGaQJUAoBwnI5aGtph6nJ6cKyMEUIgKlhPDBSkGBubk7GCTBcjEWhmgAlVgXThgmGzZs+3IAF7h14D01WpSrYaxfMEO9AJIwwUujd86/3BRzo4ZhxGLTzy0FsepbNvO00TR6p6CVQ7yAeh46ODnmGj6h/0AQogQDCTcTBvHG9mUbiVPQOimsGsQlER5S5iGbA1UvAYQjgDRZREnBNoNolDnYQZWOJxAK0t3byg6ga6Y5gy9AEKIkAGCewDRYsutZ4XXoHqHZx0FVpAyeKWAUJMNElIoZiz4NKYeOK6Q/ACi/zm0aibZ0wMx3jNkFK7sVXxVX0ho3Ri2lpaeHNIVzaAtbvD9ATPzQB9o18YwVRS9jc1AyzsfjHu4YUcRW9JPBmEVmwSLeIOVTDCGETtDa3wfROcYKcOjaB1ARTUzJYREmgNUDp2gCPSxMJpOamFpqYUXH/oCCAIMHbt2+hs7OTLwfaBjiETZA3EGkqubNH2gTpZFqJ3cO7FZZMT+dtAlYhHTqxOEEF9wl0C7wEHMzujh5I8PIylQiwExmQBNGOTtkd3JsQ0wQogQDeeoL5eELZOAG6hyJiODMTk6lkLwk0AUogAJaYmQFTVha9X3yv5Ozf3t4uaGmH+yI62rtlx1OZNzimgpIKbxfvcgibIAhBHifo670FsZlZWXKeEWXnCnkJ3sqilmZWY4jV0sFgiPZBPA4voYrOCwh5MoksTtAZ7ZaVRbjhVLXNJ94Gl7FZT5zAdWhNAU0pawKUGisIyuVgIcFTyYoRQLiHImyMhqE3TmAa5pHbBVVNAMdihmF7a7SQBIoVlXhPB5+dnfVsPhHLmyZASfaBMA6FJpifm2drbypDodolSLCwsACtfN+BOChaNKEot0aoagIID0HUE7Q0t8FcnJEguZVU1lWkWcT5eejq7OIuYr0UviZACW6iN1iEJBBhYxVb0HiXg0XiyqIhy4pKnCMJFNUIAWwyi1x6uAQO5vWrTXStVTFOIHIHGd4LF+sJuqK98gBp+m5G+YhQ5QRwpS2AcQLcrBF0wryyqAViMR4nyJBZx0/1UKm0DJ+L2gTEgBXlZRaWyDkiTnD4JaGKCbBbrCAEQTuvCUQqObWVYkuCoptP4nNxiHZEZXuaQCAAfgLH0hqgxHMIQjKVLLKIKhaUeI+awziBaFKBcQI8d0gT4FBxAldqgrioLFKolkAIv2BDqqfkHAkgQuGaAAcuKHFpfwKLbz7BHUhzPE6Aew6yCjWpEK1qhNeCJMjHCVjou9Q4Qc1qAFF5XBgnaIVZnkDCOIGKB8+KOEE8Pgsdnfmt6ZhOFgdoawIcYvNJW0ubbFyl6uaTnZpUlHrusCaAN1hkurzkvANmY2puPkFbQCSPRMl5e2s3PVmlOG+wn5oCTQAJZhMITYAkWOA9i2gTy5w6R9QIg1A2sZyYho5oV0GTCowR4CFb9icCRjVOgJ3dQ4e7iDd7+6R3kBHNLJXrUZCvNhapZNagwmJewieaVGgC7EYGToJOMrMWE+8/jhEo5CpijwK8WKcSRgIMFLEeBZoAh9AGjkwlS5tAsfOJxT5EYRdgfwKhCSxxcJUmQGlghaaWrDYWhabUJlDELvDaAt7G1oIEmDfwnmlQnETSBNiHkSgMw97um7KoJClyB4peqAnaOAmC/OT1ndxETYADbFEXLezE1nRV4wTCS5hPJKR3sFstwTES4E7FE8D1kEDlOIHXMMRUcmtzYbsa50QI8NdhmY6lsfgywi4jCr+bqE16AKRLPrtQdylA8/EsbNxOa/fUCxXnI4UZXk+wuPBedipxcDmgNkGYvp9rhDgBiMtYFyEEYDZP2Qnwz59/oIMoYFrlg/d7D4vC7w4W/GxYDlg2IQRvXNUR7ZWbT9IpftRNjp94wvGR63jEoM2zPJ6K6Lk8M4MJpKg868gido1hEsEH6sExwmDYJjh19WB8VwenfKeOgADEBnAsfwUisCOCjsHa1TQ1wuwcO+0sk93G0hIy9nkQahwzMgWfsZllOp3k5WVxaGtt5pVFeOqJQQiAmo4QgLyPHTDBX/fVUS0Bg+AStlUNjHqqQnEwr16/AZNTMY8hxgEnD7QHUf5ZXvEWn13guQNWaOqYjWCalyGALfzJEnAJbQDf2SPQAH/+ES7+zpH4poy4WEYc5P+8cN5P7n7WBcxtgok3k4WbT1SxC4q2QMRia9DXN0CP6cXnv/T1Jbh44SJ8ey4IvzsTOBoC/Pfv/dB242x1oek0RWfLOfj6nA9+vBuCmYk/ELX7CyQ3HpOZh/jriSKF9/RjSKX+RkDu5JkAJmBu7vcwMHARws4Z6Gr6DKI3Poe2K2eg7eppcPyn90+AvX5Ro/qhCaAJoAdBE0CjpgnwQg9EzeIFEuCRHoiaxSMkwAOCjB6MmgPK/AH5BL7sou9h9hP/ILt4akdkCNLvd0dml393nPjUM1Yj9pYlxUOUPSVAbtFn5BbIH+ylCRJFWGB38m/JAO8O/M/Id9PfOxAWyohPPGM1Yq+Zj7JGmUsCSLDl4NFOhmFyvggJdk/PESHHGTJzeYg/S5Hf2VooAYkygH8XPsNOz1gqxHeVA+V4np2e6yPB40RI0M8PvDL/HxKX9M7nOA4OAAAAAElFTkSuQmCC",.75,0,rn)},{sign:tt("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAYAAADDPmHLAAAACXBIWXMAAAsTAAALEwEAmpwYAAAFuGlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDUgNzkuMTYzNDk5LCAyMDE4LzA4LzEzLTE2OjQwOjIyICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdEV2dD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlRXZlbnQjIiB4bWxuczpkYz0iaHR0cDovL3B1cmwub3JnL2RjL2VsZW1lbnRzLzEuMS8iIHhtbG5zOnBob3Rvc2hvcD0iaHR0cDovL25zLmFkb2JlLmNvbS9waG90b3Nob3AvMS4wLyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOSAoV2luZG93cykiIHhtcDpDcmVhdGVEYXRlPSIyMDIyLTAyLTAxVDIwOjM1OjQxWiIgeG1wOk1ldGFkYXRhRGF0ZT0iMjAyMi0wMi0wMVQyMDozNTo0MVoiIHhtcDpNb2RpZnlEYXRlPSIyMDIyLTAyLTAxVDIwOjM1OjQxWiIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo0ODBhMzZmZS05MDViLTU0NDAtYmE4ZS1jNjNlNDc4ZWRlY2IiIHhtcE1NOkRvY3VtZW50SUQ9ImFkb2JlOmRvY2lkOnBob3Rvc2hvcDo1Nzg2ZDY0Yi0xOTczLTYwNDQtYjdjOS04YmEyZTM0MWQ3MGMi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",.75,0,rn)}],fn=new r.D({color:16777215});var bn=class extends an{constructor(...e){super(...e),this.geoSource=on,this.objectType="WarningSign",this.variantMaterials=wn,this.materials={pole:fn,sign:this.variantMaterials[0].sign}}},An=i.p+"static/media/vergemarker.f5ec7eac.obj";const yn={white:new r.D({color:16777215,emissive:16777215,emissiveIntensity:.2}),black:new r.D({color:3355443,flatShading:!0}),reflect:new r.D({color:16720418,emissive:16720418,emissiveIntensity:.2})};var In=class extends an{constructor(...e){super(...e),this.geoSource=An,this.objectType="VergeMarker",this.materials=yn}};const Sn={main:new r.D({color:8947848})};var Mn=class extends an{constructor(...e){super(...e),this.geoSource=null,this.objectType="BridgeSupport",this.materials=Sn}initialiseGeometry(e){super.initialiseGeometry();let t=new r.B(new r.e(2*Qt,20,1),this.materials.main);t.position.y=-10.5,this.add(t),e(this)}},Dn=i.p+"static/media/wallcap.aac16301.obj";var Cn=class{constructor(){this.boundingSphere=new r.R,this.bounds={maxX:0,minX:0,maxY:0,minY:0,maxZ:0,minZ:0},this.seg={},this.drawNode=null,this.drawnNode=0}static checkMakeSegment(e){}computeBoundingSphere(){}drawSegment(){}drawNextNode(){}postProcess(){}retire(){this.drawnNode=0}},Nn=i.p+"static/media/concrete_01.76bdb714.jpg";const kn=1/6,zn=2*kn,jn=151,Ln={};class On extends Cn{constructor(e=null,t=null){super(),this.mapSource=Nn,this.normSource=null,this.getHeightAt=t,this.material=new r.F({map:null,flatShading:!0}),this.mesh=new r.B(On.getGeo(),this.material),this.mesh.matrixAutoUpdate=!1,this.mesh.geometry.setDrawRange(0,0),this.posAttribute=this.mesh.geometry.attributes.position,this.posArr=this.posAttribute.array,this.uvAttribute=this.mesh.geometry.attributes.uv,this.uvArr=this.uvAttribute.array,e&&this.drawSegment(e),this.applyMaterial()}applyMaterial(){this.mapSource&&(this.material.map=st(this.mapSource,4)),this.normSource&&(this.material.normalMap=st(this.normSource,4))}setMap(e){this.material.map=e}drawSegment(e){return this.seg=e,this.drawNode=this.seg.startNode,this.pi=0,this.ui=0,this.ox=this.seg.startNode.p.x,this.oz=this.seg.startNode.p.z,this.lOffset=this.seg.distance<0?kn:0,this.uvDist=0,this.ux2=.46153846153846156,this.ux1=1-this.ux2,this.ni=0,this.drawNextNode()}drawNextNode(){for(Ln.dnp=this.drawNode.p,this.ni>0?(this.bounds.maxX=Math.max(this.bounds.maxX,Ln.dnp.x-this.ox),this.bounds.minX=Math.min(this.bounds.minX,Ln.dnp.x-this.ox),this.bounds.maxY=Math.max(this.bounds.maxY,Ln.dnp.y),this.bounds.minY=Math.min(this.bounds.minY,Ln.dnp.y),this.bounds.maxZ=Math.max(this.bounds.maxZ,Ln.dnp.z-this.oz),this.bounds.minZ=Math.min(this.bounds.minZ,Ln.dnp.z-this.oz)):(this.bounds.maxX=Ln.dnp.x-this.ox,this.bounds.minX=Ln.dnp.x-this.ox,this.bounds.maxY=Ln.dnp.y,this.bounds.minY=Ln.dnp.y,this.bounds.maxZ=Ln.dnp.z-this.oz,this.bounds.minZ=Ln.dnp.z-this.oz),Ln.j=0;Ln.j<this.drawNode.ps.length;Ln.j+=2)Ln.pj=this.drawNode.ps[Ln.j],Ln.nj=this.drawNode.ns[Ln.j],Ln.x=Ln.pj.x+Ln.nj.x*(this.seg.distance-this.lOffset),Ln.xw=Ln.x+Ln.nj.x*kn,Ln.z=Ln.pj.z+Ln.nj.z*(this.seg.distance-this.lOffset),Ln.zw=Ln.z+Ln.nj.z*kn,this.posArr[this.pi++]=Ln.x-this.ox-Ln.nj.x*zn,this.posArr[this.pi++]=Ln.pj.y,this.posArr[this.pi++]=Ln.z-this.oz-Ln.nj.z*zn,this.posArr[this.pi++]=Ln.x-this.ox,this.posArr[this.pi++]=Ln.pj.y+1,this.posArr[this.pi++]=Ln.z-this.oz,this.posArr[this.pi++]=Ln.xw-this.ox,this.posArr[this.pi++]=Ln.pj.y+1,this.posArr[this.pi++]=Ln.zw-this.oz,this.posArr[this.pi++]=Ln.xw-this.ox+Ln.nj.x*zn,this.posArr[this.pi++]=Ln.pj.y,this.posArr[this.pi++]=Ln.zw-this.oz+Ln.nj.z*zn,this.seg.contiguousStart||0!=this.ni||0!=Ln.j||(this.posArr[this.pi-11]-=1,this.posArr[this.pi-8]-=1,this.posArr[this.pi-5]-=1,this.posArr[this.pi-2]-=1),this.uvArr[this.ui++]=1,this.uvArr[this.ui++]=this.uvDist,this.uvArr[this.ui++]=this.ux1,this.uvArr[this.ui++]=this.uvDist,this.uvArr[this.ui++]=this.ux2,this.uvArr[this.ui++]=this.uvDist,this.uvArr[this.ui++]=0,this.uvArr[this.ui++]=this.uvDist,this.uvDist++;return this.ni++,this.drawNode=this.drawNode.next,!(this.drawNode.i<this.seg.endNode.i)&&(Ln.pj=this.drawNode.p,Ln.nj=this.drawNode.n,Ln.x=Ln.pj.x+Ln.nj.x*(this.seg.distance-this.lOffset),Ln.xw=Ln.x+Ln.nj.x*kn,Ln.z=Ln.pj.z+Ln.nj.z*(this.seg.distance-this.lOffset),Ln.zw=Ln.z+Ln.nj.z*kn,this.posArr[this.pi++]=Ln.x-this.ox-Ln.nj.x*zn,this.posArr[this.pi++]=Ln.pj.y,this.posArr[this.pi++]=Ln.z-this.oz-Ln.nj.z*zn,this.posArr[this.pi++]=Ln.x-this.ox,this.posArr[this.pi++]=Ln.pj.y+1,this.posArr[this.pi++]=Ln.z-this.oz,this.posArr[this.pi++]=Ln.xw-this.ox,this.posArr[this.pi++]=Ln.pj.y+1,this.posArr[this.pi++]=Ln.zw-this.oz,this.posArr[this.pi++]=Ln.xw-this.ox+Ln.nj.x*zn,this.posArr[this.pi++]=Ln.pj.y,this.posArr[this.pi++]=Ln.zw-this.oz+Ln.nj.z*zn,this.seg.contiguousEnd||(this.posArr[this.pi-11]-=1,this.posArr[this.pi-8]-=1,this.posArr[this.pi-5]-=1,this.posArr[this.pi-2]-=1),this.uvArr[this.ui++]=1,this.uvArr[this.ui++]=this.uvDist,this.uvArr[this.ui++]=.55,this.uvArr[this.ui++]=this.uvDist,this.uvArr[this.ui++]=.45,this.uvArr[this.ui++]=this.uvDist,this.uvArr[this.ui++]=0,this.uvArr[this.ui++]=this.uvDist,this.mesh.geometry.setDrawRange(0,5*this.seg.length*6*3),this.computeBoundingSphere(),this.mesh.geometry.boundingSphere=this.boundingSphere,this.mesh.position.set(this.ox,-.25,this.oz),this.posAttribute.needsUpdate=!0,this.uvAttribute.needsUpdate=!0,this.mesh.visible=!0,this.mesh.updateMatrix(),!0)}computeBoundingSphere(){Ln.minX=this.bounds.minX,Ln.maxX=this.bounds.maxX,Ln.minY=this.bounds.minY,Ln.maxY=this.bounds.maxY,Ln.minZ=this.bounds.minZ,Ln.maxZ=this.bounds.maxZ,this.boundingSphere.center.x=(Ln.minX+Ln.maxX)/2,this.boundingSphere.center.y=(Ln.minY+Ln.maxY)/2,this.boundingSphere.center.z=(Ln.minZ+Ln.maxZ)/2,this.boundingSphere.radius=Math.sqrt((Ln.maxX-Ln.minX)*(Ln.maxX-Ln.minX)+(Ln.maxY-Ln.minY)*(Ln.maxY-Ln.minY)+(Ln.maxZ-Ln.minZ)*(Ln.maxZ-Ln.minZ))/2+10}retire(){this.mesh.visible=!1}static getNorms(){let e=[];for(let t=0;t<jn;t++)e.push(1,0,0,0,1,0,0,1,0,-1,0,0);return e}static getGeo(){let e=new r.g;return e.setIndex(On.getIndex()),e.setAttribute("position",new r.o(new Float32Array(1812),3)),e.attributes.position.setUsage(r.l),e.setAttribute("uv",new r.o(new Float32Array(1208),2)),e.attributes.uv.setUsage(r.l),e}static getIndex(){let e,t,i,s,n,a,o,r,h=[];for(let l=0;l<jn;l++)e=4*l,t=e+1,i=e+2,s=e+3,n=4*(l+1),a=n+1,o=n+2,r=n+3,h.push(e,t,n,t,a,n,t,i,a,i,o,a,i,s,o,s,r,o);return h}}var Rn=On;var Tn=class{constructor(e,t,i,s){this.startNode=e,this.endNode=t,this.type=i,this.distance=s,this.length=t.i-e.i,this.contiguousStart=!1,this.contiguousEnd=!1}copy(e){this.startNode=e.startNode,this.endNode=e.endNode,this.type=e.type,this.distance=e.distance,this.length=e.length,this.contiguousStart=e.contiguousStart,this.contiguousEnd=e.contiguousEnd}};var Pn=class{constructor(e,t){this.prevRight=new Tn(e,e,-1,0),this.prevLeft=new Tn(e,e,-1,0),this.typeID=t}generateLeft(e){return this.test=this.testLeft,this.prev=this.prevLeft,this.side=-1,this.seg=null,e.i>this.prev.endNode.i&&this.testGenLeft(e)&&(this.seg=this.generate(e),this.seg&&(this.prevLeft=this.seg)),this.seg}testGenLeft(e){return!1}generateRight(e){return this.test=this.testRight,this.prev=this.prevRight,this.side=1,this.seg=null,e.i>this.prev.endNode.i&&this.testGenRight(e)&&(this.seg=this.generate(e),this.seg&&(this.prevRight=this.seg)),this.seg}testGenRight(e){return!1}generate(e){}};var Gn=class{constructor(e=10,t=1,i=0){this.rands=[],this.index=0,this.rand=new window.alea(Ee);for(let s=0;s<e;s++)this.rands.push(this.rand()*t-i);this.count=e,this.index=0}next(){return this.index>=this.count&&(this.index=0),this.rands[this.index++]}};const Bn=1.2,Wn=.3,Fn=.2,En=new Gn(23,.1),Zn=new Gn(37,.2),Hn=new r.F({map:st(null,4),flatShading:!0}),Qn={};class Yn extends Pn{constructor(...e){super(...e),this.p=new r.W}generate(e){let t=e;for(;t.prev&&this.test(t.prev)&&e.i-t.i<4;)t=t.prev;for(;this.test(e.next)&&e.next.i-t.i<qt;)e=e.next;if(e.i-t.i<1)return e.i==t.i&&(this.p.copy(e.p),this.p.x+=e.n.x*(Qt+1.1)*this.side,this.p.z+=e.n.z*(Qt+1.1)*this.side,Jn.addObject(Xn.WallCap,this.p,Math.PI-e.a,e.i)),null;let i=new Tn(t,e,this.typeID,this.side<0?-t.dswl:-t.dswr);return this.prev.endNode.i==t.i&&this.prev.type==i.type&&(this.prev.contiguousEnd=!0,i.contiguousStart=!0,i.distance=this.prev.distance),i}testGenLeft(e){return void 0!==e.dsel||void 0!==e.dswl}testGenRight(e){return void 0!==e.dser||void 0!==e.dswr}testGen(e){return void 0!==e.dswl||void 0!==e.dswr}testLeft(e){return void 0!==e.dswl}testRight(e){return void 0!==e.dswr}}var Vn=class extends Rn{constructor(...e){super(...e),this.p=new r.W,this.mesh.material=Hn}getDistFromGradient(e){return Qt+1}drawSegment(e){return this.seg=e,this.drawNode=this.seg.startNode,this.pi=0,this.ui=0,this.ox=this.seg.startNode.p.x,this.oz=this.seg.startNode.p.z,this.lOffset=this.seg.distance<0?Wn:0,this.uvDist=0,this.ux2=.4444444444444445,this.ux1=1-this.ux2,this.ni=0,this.side=e.distance<0?-1:1,this.h=0,this.d=0,this.drawNextNode()}drawNextNode(){for(Qn.dnp=this.drawNode.p,this.ni>0?(this.bounds.maxX=Math.max(this.bounds.maxX,Qn.dnp.x-this.ox),this.bounds.minX=Math.min(this.bounds.minX,Qn.dnp.x-this.ox),this.bounds.maxY=Math.max(this.bounds.maxY,Qn.dnp.y),this.bounds.minY=Math.min(this.bounds.minY,Qn.dnp.y),this.bounds.maxZ=Math.max(this.bounds.maxZ,Qn.dnp.z-this.oz),this.bounds.minZ=Math.min(this.bounds.minZ,Qn.dnp.z-this.oz)):(this.bounds.maxX=Qn.dnp.x-this.ox,this.bounds.minX=Qn.dnp.x-this.ox,this.bounds.maxY=Qn.dnp.y,this.bounds.minY=Qn.dnp.y,this.bounds.maxZ=Qn.dnp.z-this.oz,this.bounds.minZ=Qn.dnp.z-this.oz),this.seg.distance=this.getDistFromGradient(this.drawNode.g)*this.side,Qn.j=0;Qn.j<this.drawNode.ps.length;Qn.j+=2)Qn.pj=this.drawNode.ps[Qn.j],Qn.nj=this.drawNode.ns[Qn.j],Qn.x=Qn.pj.x+Qn.nj.x*(this.seg.distance-this.lOffset+this.d),Qn.xw=Qn.x+Qn.nj.x*Wn,Qn.z=Qn.pj.z+Qn.nj.z*(this.seg.distance-this.lOffset+this.d),Qn.zw=Qn.z+Qn.nj.z*Wn,Qn.y=this.drawNode.ps[Qn.j].y,this.posArr[this.pi++]=Qn.x-this.ox-Qn.nj.x*Fn,this.posArr[this.pi++]=Qn.y,this.posArr[this.pi++]=Qn.z-this.oz-Qn.nj.z*Fn,this.posArr[this.pi++]=Qn.x-this.ox,this.posArr[this.pi++]=Qn.y+Bn+this.h,this.posArr[this.pi++]=Qn.z-this.oz,this.posArr[this.pi++]=Qn.xw-this.ox,this.posArr[this.pi++]=Qn.y+Bn+this.h,this.posArr[this.pi++]=Qn.zw-this.oz,this.posArr[this.pi++]=Qn.xw-this.ox+Qn.nj.x*Fn,this.posArr[this.pi++]=Qn.y,this.posArr[this.pi++]=Qn.zw-this.oz+Qn.nj.z*Fn,this.uvArr[this.ui++]=1,this.uvArr[this.ui++]=this.uvDist,this.uvArr[this.ui++]=this.ux1,this.uvArr[this.ui++]=this.uvDist,this.uvArr[this.ui++]=this.ux2,this.uvArr[this.ui++]=this.uvDist,this.uvArr[this.ui++]=0,this.uvArr[this.ui++]=this.uvDist,this.uvDist++,this.h=En.next(),this.d=Zn.next();return this.ni++,this.drawNode=this.drawNode.next,!(this.drawNode.i<this.seg.endNode.i)&&(this.h=0,this.d=0,Qn.pj=this.drawNode.p,Qn.nj=this.drawNode.n,Qn.x=Qn.pj.x+Qn.nj.x*(this.seg.distance-this.lOffset+this.d),Qn.xw=Qn.x+Qn.nj.x*Wn,Qn.z=Qn.pj.z+Qn.nj.z*(this.seg.distance-this.lOffset+this.d),Qn.zw=Qn.z+Qn.nj.z*Wn,Qn.y=Qn.pj.y,this.posArr[this.pi++]=Qn.x-this.ox-Qn.nj.x*Fn,this.posArr[this.pi++]=Qn.y,this.posArr[this.pi++]=Qn.z-this.oz-Qn.nj.z*Fn,this.posArr[this.pi++]=Qn.x-this.ox,this.posArr[this.pi++]=Qn.y+Bn,this.posArr[this.pi++]=Qn.z-this.oz,this.posArr[this.pi++]=Qn.xw-this.ox,this.posArr[this.pi++]=Qn.y+Bn,this.posArr[this.pi++]=Qn.zw-this.oz,this.posArr[this.pi++]=Qn.xw-this.ox+Qn.nj.x*Fn,this.posArr[this.pi++]=Qn.y,this.posArr[this.pi++]=Qn.zw-this.oz+Qn.nj.z*Fn,this.uvArr[this.ui++]=1,this.uvArr[this.ui++]=this.uvDist,this.uvArr[this.ui++]=this.ux1,this.uvArr[this.ui++]=this.uvDist,this.uvArr[this.ui++]=this.ux2,this.uvArr[this.ui++]=this.uvDist,this.uvArr[this.ui++]=0,this.uvArr[this.ui++]=this.uvDist,this.mesh.geometry.setDrawRange(0,5*this.seg.length*6*3),this.computeBoundingSphere(),this.mesh.geometry.boundingSphere=this.boundingSphere,this.mesh.position.set(this.ox,-.35,this.oz),this.posAttribute.needsUpdate=!0,this.uvAttribute.needsUpdate=!0,this.mesh.visible=!0,this.mesh.updateMatrix(),this.seg.contiguousStart||(this.p.x=(this.posArr[0]+this.posArr[9])/2+this.mesh.position.x,this.p.y=this.posArr[1],this.p.z=(this.posArr[2]+this.posArr[11])/2+this.mesh.position.z,Jn.addObject(Xn.WallCap,this.p,Math.PI+Math.PI/2-this.seg.startNode.a,this.seg.startNode.i)),this.seg.contiguousEnd||(this.p.x=(this.posArr[this.pi-3]+this.posArr[this.pi-12])/2+this.mesh.position.x,this.p.y=this.posArr[this.pi-2],this.p.z=(this.posArr[this.pi-1]+this.posArr[this.pi-10])/2+this.mesh.position.z,Jn.addObject(Xn.WallCap,this.p,Math.PI+Math.PI/2-this.seg.endNode.a,this.seg.endNode.i)),!0)}};const Un={VergeMarker:{class:In,geo:null},WarningSign:{class:bn,geo:null},BridgeSupport:{class:Mn,geo:null},WallCap:{class:class extends an{constructor(...e){super(...e),this.geoSource=Dn,this.objectType="WallCap",this.materials={default:Hn}}},geo:null}},Xn={VergeMarker:"VergeMarker",WarningSign:"WarningSign",BridgeSupport:"BridgeSupport",WallCap:"WallCap"};var Jn=new class{constructor(){this.lastRepositionIndex=0,this.pools={},this.active=[],this.loadingQueue=[],this.getHeightAt=()=>{},this.loadCounter=0,this.didLoadBound=this.didLoad.bind(this),this.addObjectBound=this.addObject.bind(this),this.container=new r.G,this.container.matrixAutoUpdate=!1,this.loadingQueue=[]}destroy(){this.loadingQueue.length=0;for(let i in this.pools){var e;for(let e of this.pools[i])e.destroy();null===(e=Un[i].geo)||void 0===e||e.destroy()}for(let i of this.active){var t;null===(t=i.destroy)||void 0===t||t.call(i)}for(this.container.traverse((e=>{e.isMesh&&(e.geometry.dispose(),e.material.dispose())})),this.active.length=0,this.pools={};this.container.children.length;)this.container.remove(this.container.children[0])}initialise(e){this.getHeightAt=e,this.initLibrary()}initLibrary(){for(let e in Un)this.loadObject(e),this.pools[e]=[]}loadObject(e){let t=Un[e],i=new t.class;i.initialiseGeometry((()=>{t.geo=i,this.didLoad()}))}didLoad(){if(this.loadCounter++,this.loadCounter>=Object.keys(Un).length)for(;this.loadingQueue.length;){let e=this.loadingQueue.pop();this.addObject(...e)}}addCustom(e,t,i,s,n=null){if(n||(n=5),ii.vehicleIndex>s+n)return;let a;for(e.keyName=null,e.worldPosition=t.clone(),e.position.subVectors(e.worldPosition,this.container.position),e.rotation.y=i,e.visible=!0,e.retireIndex=s+n,this.container.add(e),a=0;a<this.active.length&&!(this.active[a].retireIndex>e.retireIndex);a++);this.active.splice(a,0,e)}addObject(e,t,i,s,n=null){if(!(e in Un))return void console.error("Unrecognised roadside object type ",e);if(!Un[e].geo)return void this.loadingQueue.push([e,t,i,s,n]);let a,o;for(this.pools[e].length?a=this.pools[e].pop():(a=Un[e].geo.clone(),this.container.add(a),tn["roadside-objects"]++),a.keyName=e,a.worldPosition.copy(t),a.position.subVectors(a.worldPosition,this.container.position),a.rotation.y=i,a.visible=!0,a.retireIndex=s+5,null!==n&&a.setVariant(n),o=0;o<this.active.length&&!(this.active[o].retireIndex>a.retireIndex);o++);return this.active.splice(o,0,a),a}update(){if(this.active.length&&ii.vehicleIndex>=this.active[0].retireIndex){let e=this.active.shift();e.visible=!1,e.keyName?this.pools[e.keyName].push(e):this.container.remove(e)}if(this.active.length>30){let e=this.active.shift();e.visible=!1,e.keyName?this.pools[e.keyName].push(e):this.container.remove(e)}if(ii.vehicleIndex-this.lastRepositionIndex>100){this.container.position.x=ii.vehicleNode.p.x,this.container.position.z=ii.vehicleNode.p.z,this.container.updateMatrix();for(let e of this.container.children)e.position.subVectors(e.worldPosition,this.container.position);this.lastRepositionIndex=ii.vehicleIndex}}},qn=i.p+"static/media/wall_barrier_02.44c5c0ea.webp",Kn=i.p+"static/media/wall_barrier_02_n.0c79c69f.webp";const _n=.78,$n=151;let ea=.55,ta=.68,ia=.88,sa=0,na=null;const aa=it(qn,.75,8,Kn,null,{}),oa={};class ra extends Cn{constructor(e=null){super(),this.p=new r.W,this.mapSource=null,this.normSource=null,this.bounds={maxX:0,minX:0,maxY:0,minY:0,maxZ:0,minZ:0},this.material=aa,this.mesh=new r.B(ra.getGeo(),this.material),this.mesh.matrixAutoUpdate=!1,this.mesh.geometry.setDrawRange(0,0),this.posAttribute=this.mesh.geometry.attributes.position,this.posArr=this.posAttribute.array,this.normAttribute=this.mesh.geometry.attributes.normal,this.normArr=this.normAttribute.array,this.uvAttribute=this.mesh.geometry.attributes.uv,this.uvArr=this.uvAttribute.array,e&&this.drawSegment(e),this.applyMaterial()}applyMaterial(){this.mapSource&&(this.material.map=st(this.mapSource,4)),this.normSource&&(this.material.normalMap=st(this.normSource,4))}setMap(e){this.material.map=e}drawSegment(e){return this.seg=e,this.drawNode=this.seg.startNode,this.pi=0,this.normi=0,this.ui=0,this.ox=this.seg.startNode.p.x,this.oz=this.seg.startNode.p.z,this.uvDist=0,this.side=Math.sign(e.distance),this.ni=0,this.drawNextNode()}drawNextNode(){for(oa.dnp=this.drawNode.p,this.ni>0?(this.bounds.maxX=Math.max(this.bounds.maxX,oa.dnp.x-this.ox),this.bounds.minX=Math.min(this.bounds.minX,oa.dnp.x-this.ox),this.bounds.maxY=Math.max(this.bounds.maxY,oa.dnp.y),this.bounds.minY=Math.min(this.bounds.minY,oa.dnp.y),this.bounds.maxZ=Math.max(this.bounds.maxZ,oa.dnp.z-this.oz),this.bounds.minZ=Math.min(this.bounds.minZ,oa.dnp.z-this.oz)):(this.bounds.maxX=oa.dnp.x-this.ox,this.bounds.minX=oa.dnp.x-this.ox,this.bounds.maxY=oa.dnp.y,this.bounds.minY=oa.dnp.y,this.bounds.maxZ=oa.dnp.z-this.oz,this.bounds.minZ=oa.dnp.z-this.oz),oa.j=0;oa.j<this.drawNode.ps.length;oa.j+=2)oa.pj=this.drawNode.ps[oa.j],oa.nj=this.drawNode.ns[oa.j],oa.njs={x:oa.nj.x*-this.side,z:oa.nj.z*-this.side},oa.x=oa.pj.x+oa.nj.x*this.seg.distance,oa.x1=oa.x+.1*oa.nj.x*this.side,oa.z=oa.pj.z+oa.nj.z*this.seg.distance,oa.z1=oa.z+.1*oa.nj.z*this.side,this.normArr[this.pi]=oa.njs.x,this.posArr[this.pi++]=oa.x1-this.ox,this.normArr[this.pi]=0,this.posArr[this.pi++]=oa.pj.y,this.normArr[this.pi]=oa.njs.z,this.posArr[this.pi++]=oa.z1-this.oz,rt>2&&(this.normArr[this.pi]=oa.njs.x,this.posArr[this.pi++]=oa.x1-this.ox,this.normArr[this.pi]=0,this.posArr[this.pi++]=oa.pj.y+.42900000000000005,this.normArr[this.pi]=oa.njs.z,this.posArr[this.pi++]=oa.z1-this.oz),rt>1&&(this.normArr[this.pi]=oa.njs.x,this.posArr[this.pi++]=oa.x-this.ox,this.normArr[this.pi]=0,this.posArr[this.pi++]=oa.pj.y+.5304000000000001,this.normArr[this.pi]=oa.njs.z,this.posArr[this.pi++]=oa.z-this.oz),rt>0&&(this.normArr[this.pi]=oa.njs.x,this.posArr[this.pi++]=oa.x-this.ox,this.normArr[this.pi]=0,this.posArr[this.pi++]=oa.pj.y+.6864,this.normArr[this.pi]=oa.njs.z,this.posArr[this.pi++]=oa.z-this.oz),this.normArr[this.pi]=oa.njs.x,this.posArr[this.pi++]=oa.x1-this.ox,this.normArr[this.pi]=0,this.posArr[this.pi++]=oa.pj.y+_n,this.normArr[this.pi]=oa.njs.z,this.posArr[this.pi++]=oa.z1-this.oz;if(this.ni++,this.drawNode=this.drawNode.next,this.drawNode.i<this.seg.endNode.i)return!1;if(oa.pj=this.drawNode.p,oa.nj=this.drawNode.n,oa.njs={x:oa.nj.x*-this.side,z:oa.nj.z*-this.side},oa.x=oa.pj.x+oa.nj.x*this.seg.distance,oa.z=oa.pj.z+oa.nj.z*this.seg.distance,oa.x1=oa.x+.1*oa.nj.x*this.side,oa.z1=oa.z+.1*oa.nj.z*this.side,this.normArr[this.pi]=oa.njs.x,this.posArr[this.pi++]=oa.x1-this.ox,this.normArr[this.pi]=0,this.posArr[this.pi++]=oa.pj.y,this.normArr[this.pi]=oa.njs.z,this.posArr[this.pi++]=oa.z1-this.oz,rt>2&&(this.normArr[this.pi]=oa.njs.x,this.posArr[this.pi++]=oa.x1-this.ox,this.normArr[this.pi]=0,this.posArr[this.pi++]=oa.pj.y+.42900000000000005,this.normArr[this.pi]=oa.njs.z,this.posArr[this.pi++]=oa.z1-this.oz),rt>1&&(this.normArr[this.pi]=oa.njs.x,this.posArr[this.pi++]=oa.x-this.ox,this.normArr[this.pi]=0,this.posArr[this.pi++]=oa.pj.y+.5304000000000001,this.normArr[this.pi]=oa.njs.z,this.posArr[this.pi++]=oa.z-this.oz),rt>0&&(this.normArr[this.pi]=oa.njs.x,this.posArr[this.pi++]=oa.x-this.ox,this.normArr[this.pi]=0,this.posArr[this.pi++]=oa.pj.y+.6864,this.normArr[this.pi]=oa.njs.z,this.posArr[this.pi++]=oa.z-this.oz),this.normArr[this.pi]=oa.njs.x,this.posArr[this.pi++]=oa.x1-this.ox,this.normArr[this.pi]=0,this.posArr[this.pi++]=oa.pj.y+_n,this.normArr[this.pi]=oa.njs.z,this.posArr[this.pi++]=oa.z1-this.oz,this.mesh.geometry.setDrawRange(0,5*this.seg.length*(2*(rt+1))*3),this.computeBoundingSphere(),this.mesh.geometry.boundingSphere=this.boundingSphere,this.mesh.position.set(this.ox,-.15,this.oz),this.posAttribute.needsUpdate=!0,this.normAttribute.needsUpdate=!0,this.mesh.visible=!0,this.mesh.updateMatrix(),!this.seg.contiguousStart)for(this.p.x=this.posArr[0]+this.mesh.position.x,this.p.y=this.posArr[1],this.p.z=this.posArr[2]+this.mesh.position.z,Jn.addObject(Xn.VergeMarker,this.p,Math.PI+Math.PI/2-this.seg.startNode.a,this.seg.startNode.i),oa.ii=0;oa.ii<rt+2;oa.ii++)this.posArr[3*oa.ii+1]-=_n;if(!this.seg.contiguousEnd)for(oa.ii=0;oa.ii<rt+2;oa.ii++)this.posArr[this.pi-(3*oa.ii+2)]-=_n;return!0}retire(){this.mesh.visible=!1}computeBoundingSphere(){oa.minX=this.bounds.minX,oa.maxX=this.bounds.maxX,oa.minY=this.bounds.minY,oa.maxY=this.bounds.maxY,oa.minZ=this.bounds.minZ,oa.maxZ=this.bounds.maxZ,this.boundingSphere.center.x=(oa.minX+oa.maxX)/2,this.boundingSphere.center.y=(oa.minY+oa.maxY)/2,this.boundingSphere.center.z=(oa.minZ+oa.maxZ)/2,this.boundingSphere.radius=Math.sqrt((oa.maxX-oa.minX)*(oa.maxX-oa.minX)+(oa.maxY-oa.minY)*(oa.maxY-oa.minY)+(oa.maxZ-oa.minZ)*(oa.maxZ-oa.minZ))/2+10}static getNorms(){let e=[];for(let t=0;t<$n*(rt+2);t++)e.push(0,0,1);return e}static getUV(){let e=[];for(let t=0;t<$n;t++)0==rt?e.push(t,0,t,1):1==rt?e.push(t,0,t,ia,t,1):2==rt?e.push(t,0,t,ea,t,ia,t,1):e.push(t,0,t,ea,t,ta,t,ia,t,1);return e}static getGeo(){if(null!==na&&sa==rt)return na.clone();let e=new r.g;e.setIndex(ra.getIndex()),e.setAttribute("position",new r.o(new Float32Array(453*(rt+2)),3)),e.attributes.position.setUsage(r.l),e.setAttribute("uv",new r.o(new Float32Array(ra.getUV()),2));let t=new Float32Array(ra.getNorms());return e.setAttribute("normal",new r.o(t,3)),e.attributes.normal.setUsage(r.l),na=e,sa=rt,e}static getIndex(){let e=[];if(0==rt){let t,i,s,n;for(let a=0;a<$n;a++)t=2*a,i=t+1,s=2*(a+1),n=s+1,e.push(t,i,s),e.push(i,n,s)}else if(1==rt){let t,i,s,n,a,o;for(let r=0;r<$n;r++)t=3*r,i=t+1,s=t+2,n=3*(r+1),a=n+1,o=n+2,e.push(t,i,n,i,a,n,i,s,a,s,o,a)}else if(2==rt){let t,i,s,n,a,o,r,h;for(let l=0;l<$n;l++)t=4*l,i=t+1,s=t+2,n=t+3,a=4*(l+1),o=a+1,r=a+2,h=a+3,e.push(t,i,a,i,o,a,i,s,o,s,r,o,s,n,r,n,h,r)}else{let t,i,s,n,a,o,r,h,l,d;for(let c=0;c<$n;c++)t=5*c,i=t+1,s=t+2,n=t+3,a=t+4,o=5*(c+1),r=o+1,h=o+2,l=o+3,d=o+4,e.push(t,i,o,i,r,o,i,s,r,s,h,r,s,n,h,n,l,h,n,a,l,a,d,l)}return e}}class ha extends Pn{constructor(...e){super(...e),this.fenceID=4}generate(e){let t=e.prev;for(e=e.next;this.test(t)&&t.prev&&t.i>this.prev.endNode.i&&e.i-t.i<11;)t=t.prev;for(t.i-this.prev.endNode.i<4&&(t=this.prev.endNode);this.test(e)&&e.i-t.i<qt;)e=e.next;let i=this.typeID;Sh.value.detailLodIndex>1&&(t.i%2==0||this.prev.endNode.i==t.i&&this.prev.type==this.fenceID)&&(i=this.fenceID);let s=new Tn(t,e,i,(t.w+Vt)*this.side);return this.prev.endNode.i==t.i&&this.prev.type==s.type&&(this.prev.contiguousEnd=!0,s.contiguousStart=!0,s.distance=this.prev.distance),s}testGenLeft(e){return!e.bridge&&null==e.lWallDist&&e.i>=this.prevLeft.endNode.i&&(e.g<-1||e.g<0&&e.da>.2&&e.h<.6)}testGenRight(e){return!e.bridge&&null==e.rWallDist&&e.i>=this.prevRight.endNode.i&&(e.g>1||e.g>0&&e.da<-.2&&e.h<.6)}testLeft(e){return!e.bridge&&e.p.y>3&&(e.g<-.5||e.g<.1&&e.da<-.05&&e.h<.6)}testRight(e){return!e.bridge&&e.p.y>3&&(e.g>.5||e.g>-.1&&e.da>.05&&e.h<.6)}}var la=ra,da=i.p+"static/media/wall_barrier_wood_n.f554ec90.webp";let ca=.52,pa=.56,ua=.8,ga=.956,ma=0,xa=null;const va=it(null,.75,8,da,null,{}),wa={};class fa extends Cn{constructor(e=null){super(),this.p=new r.W,this.postIndex=[],this.fenceIndex=[],this.drawIndex=[],this.fenceIndexTemplate=[],this.mapSource=null,this.normSource=null,this.bounds={maxX:0,minX:0,maxY:0,minY:0,maxZ:0,minZ:0},this.material=va,this.mesh=new r.B(fa.getGeo(),this.material),this.mesh.matrixAutoUpdate=!1,this.mesh.geometry.setDrawRange(0,0),this.posAttribute=this.mesh.geometry.attributes.position,this.posArr=this.posAttribute.array,this.normAttribute=this.mesh.geometry.attributes.normal,this.normArr=this.normAttribute.array,this.uvAttribute=this.mesh.geometry.attributes.uv,this.uvArr=this.uvAttribute.array,this.fenceIndexTemplate=fa.getFenceIndex(),e&&this.drawSegment(e),this.applyMaterial()}applyMaterial(){this.mapSource&&(this.material.map=st(this.mapSource,4)),this.normSource&&(this.material.normalMap=st(this.normSource,4))}setMap(e){this.material.map=e}drawSegment(e){return this.seg=e,this.drawNode=this.seg.startNode,this.pi=0,this.ui=0,this.normi=0,this.postI=6*(2*this.seg.length+1)*3,this.postUVI=6*(2*this.seg.length+1)*2,this.postIndex.length=0,this.ox=this.seg.startNode.p.x,this.oz=this.seg.startNode.p.z,this.uvDist=0,this.side=Math.sign(e.distance),this.ni=0,this.si=0,this.fenceDrawCount=60*this.seg.length,this.fenceVertCount=0,this.fenceIndex.length=0,this.fenceTriangleCount=0,this.postIndexCount=6*(2*this.seg.length+1),this.postDrawCount=0,this.drawNextNode()}updateBounds(){wa.dnp=this.drawNode.p,this.ni>0?(this.bounds.maxX=Math.max(this.bounds.maxX,wa.dnp.x-this.ox),this.bounds.minX=Math.min(this.bounds.minX,wa.dnp.x-this.ox),this.bounds.maxY=Math.max(this.bounds.maxY,wa.dnp.y),this.bounds.minY=Math.min(this.bounds.minY,wa.dnp.y),this.bounds.maxZ=Math.max(this.bounds.maxZ,wa.dnp.z-this.oz),this.bounds.minZ=Math.min(this.bounds.minZ,wa.dnp.z-this.oz)):(this.bounds.maxX=wa.dnp.x-this.ox,this.bounds.minX=wa.dnp.x-this.ox,this.bounds.maxY=wa.dnp.y,this.bounds.minY=wa.dnp.y,this.bounds.maxZ=wa.dnp.z-this.oz,this.bounds.minZ=wa.dnp.z-this.oz)}drawFenceVert(e,t,i,s,n=0){this.normArr[this.pi]=wa.njs.x,this.posArr[this.pi++]=e,this.normArr[this.pi]=0,this.posArr[this.pi++]=wa.pj.y+1*t+n,this.normArr[this.pi]=wa.njs.z,this.posArr[this.pi++]=i,this.uvArr[this.ui++]=this.si,this.uvArr[this.ui++]=.4*s}buildNextFenceIndex(){for(wa.fi=3*this.fenceTriangleCount,wa.i=0;wa.i<30;wa.i++)this.fenceIndex.push(this.fenceIndexTemplate[wa.fi+wa.i]);this.fenceTriangleCount+=10}drawFencePost(){wa.xA=wa.x-.02*wa.nj.x*this.side+.06*-wa.nj.z,wa.zA=wa.z-.02*wa.nj.z*this.side+.06*wa.nj.x,wa.xB=wa.x+.11*wa.nj.x*this.side+.06*-wa.nj.z,wa.zB=wa.z+.11*wa.nj.z*this.side+.06*wa.nj.x,wa.xC=wa.x+.11*wa.nj.x*this.side-.06*-wa.nj.z,wa.zC=wa.z+.11*wa.nj.z*this.side-.06*wa.nj.x,wa.xD=wa.x-.02*wa.nj.x*this.side-.06*-wa.nj.z,wa.zD=wa.z-.02*wa.nj.z*this.side-.06*wa.nj.x,wa.njs.x=0,wa.njs.z=0,wa.nup=1,this.normArr[this.postI]=wa.njs.x,this.posArr[this.postI++]=wa.xA,this.normArr[this.postI]=wa.nup,this.posArr[this.postI++]=wa.pj.y,this.normArr[this.postI]=wa.njs.z,this.posArr[this.postI++]=wa.zA,this.normArr[this.postI]=wa.njs.x,this.posArr[this.postI++]=wa.xA,this.normArr[this.postI]=wa.nup,this.posArr[this.postI++]=wa.pj.y+1+.03,this.normArr[this.postI]=wa.njs.z,this.posArr[this.postI++]=wa.zA,this.normArr[this.postI]=wa.njs.x,this.posArr[this.postI++]=wa.xB,this.normArr[this.postI]=wa.nup,this.posArr[this.postI++]=wa.pj.y,this.normArr[this.postI]=wa.njs.z,this.posArr[this.postI++]=wa.zB,this.normArr[this.postI]=wa.njs.x,this.posArr[this.postI++]=wa.xB,this.normArr[this.postI]=wa.nup,this.posArr[this.postI++]=wa.pj.y+1+.03,this.normArr[this.postI]=wa.njs.z,this.posArr[this.postI++]=wa.zB,this.normArr[this.postI]=wa.njs.x,this.posArr[this.postI++]=wa.xC,this.normArr[this.postI]=wa.nup,this.posArr[this.postI++]=wa.pj.y,this.normArr[this.postI]=wa.njs.z,this.posArr[this.postI++]=wa.zC,this.normArr[this.postI]=wa.njs.x,this.posArr[this.postI++]=wa.xC,this.normArr[this.postI]=wa.nup,this.posArr[this.postI++]=wa.pj.y+1+.03,this.normArr[this.postI]=wa.njs.z,this.posArr[this.postI++]=wa.zC,this.normArr[this.postI]=wa.njs.x,this.posArr[this.postI++]=wa.xD,this.normArr[this.postI]=wa.nup,this.posArr[this.postI++]=wa.pj.y,this.normArr[this.postI]=wa.njs.z,this.posArr[this.postI++]=wa.zD,this.normArr[this.postI]=wa.njs.x,this.posArr[this.postI++]=wa.xD,this.normArr[this.postI]=wa.nup,this.posArr[this.postI++]=wa.pj.y+1+.03,this.normArr[this.postI]=wa.njs.z,this.posArr[this.postI++]=wa.zD,this.normArr[this.postI]=wa.njs.x,this.posArr[this.postI++]=wa.xD,this.normArr[this.postI]=wa.nup,this.posArr[this.postI++]=wa.pj.y+1+.03,this.normArr[this.postI]=wa.njs.z,this.posArr[this.postI++]=wa.zD,this.uvArr[this.postUVI++]=.25,this.uvArr[this.postUVI++]=1,this.uvArr[this.postUVI++]=.25,this.uvArr[this.postUVI++]=.5,this.uvArr[this.postUVI++]=.5,this.uvArr[this.postUVI++]=1,this.uvArr[this.postUVI++]=.5,this.uvArr[this.postUVI++]=.5,this.uvArr[this.postUVI++]=.75,this.uvArr[this.postUVI++]=1,this.uvArr[this.postUVI++]=.75,this.uvArr[this.postUVI++]=.5,this.uvArr[this.postUVI++]=0,this.uvArr[this.postUVI++]=1,this.uvArr[this.postUVI++]=0,this.uvArr[this.postUVI++]=.5,this.uvArr[this.postUVI++]=.5,this.uvArr[this.postUVI++]=.42,this.postIndex.push(this.postIndexCount,this.postIndexCount+3,this.postIndexCount+1,this.postIndexCount,this.postIndexCount+2,this.postIndexCount+3,this.postIndexCount+2,this.postIndexCount+5,this.postIndexCount+3,this.postIndexCount+2,this.postIndexCount+4,this.postIndexCount+5,this.postIndexCount+4,this.postIndexCount+7,this.postIndexCount+5,this.postIndexCount+4,this.postIndexCount+6,this.postIndexCount+7,this.postIndexCount+6,this.postIndexCount+1,this.postIndexCount+7,this.postIndexCount+6,this.postIndexCount,this.postIndexCount+1,this.postIndexCount+1,this.postIndexCount+3,this.postIndexCount+8,this.postIndexCount+3,this.postIndexCount+5,this.postIndexCount+8),this.postIndexCount+=9,this.postDrawCount+=30}drawNextNode(e=!1){for(this.updateBounds(),wa.j=0;wa.j<this.drawNode.ps.length;wa.j+=5)wa.pj=this.drawNode.ps[wa.j],wa.nj=this.drawNode.ns[wa.j],wa.njs={x:wa.nj.x*-this.side,z:wa.nj.z*-this.side},wa.x=wa.pj.x+wa.nj.x*this.seg.distance-this.ox,wa.x1=wa.x+.08*wa.nj.x*this.side,wa.z=wa.pj.z+wa.nj.z*this.seg.distance-this.oz,wa.z1=wa.z+.08*wa.nj.z*this.side,wa.rand=.06*Math.random()-.03,wa.rand2=.06*Math.random()-.03,this.drawFenceVert(wa.x,0,wa.z,0,wa.rand),this.drawFenceVert(wa.x,pa,wa.z,ca,wa.rand),this.drawFenceVert(wa.x1,pa,wa.z1,pa,wa.rand),this.drawFenceVert(wa.x,ua,wa.z,ua,wa.rand2),this.drawFenceVert(wa.x,1,wa.z,ga,wa.rand2),this.drawFenceVert(wa.x1,1,wa.z1,1,wa.rand2),(this.ni>0||0==wa.j)&&this.buildNextFenceIndex(),(this.ni>0||this.seg.contiguousStart||wa.j>0)&&this.drawFencePost(),this.si++;if(this.ni++,this.drawNode=this.drawNode.next,this.drawNode.i<this.seg.endNode.i)return!1;if(this.updateBounds(),wa.pj=this.drawNode.p,wa.nj=this.drawNode.n,wa.njs={x:wa.nj.x*-this.side,z:wa.nj.z*-this.side},wa.x=wa.pj.x+wa.nj.x*this.seg.distance-this.ox,wa.z=wa.pj.z+wa.nj.z*this.seg.distance-this.oz,wa.x1=wa.x+.1*wa.nj.x*this.side,wa.z1=wa.z+.1*wa.nj.z*this.side,this.drawFenceVert(wa.x,0,wa.z,0),this.drawFenceVert(wa.x,pa,wa.z,ca),this.drawFenceVert(wa.x1,pa,wa.z1,pa),this.drawFenceVert(wa.x,ua,wa.z,ua),this.drawFenceVert(wa.x,1,wa.z,ga),this.drawFenceVert(wa.x1,1,wa.z1,1),this.buildNextFenceIndex(),this.seg.contiguousEnd&&this.drawFencePost(),this.si++,this.mesh.geometry.setDrawRange(0,this.fenceDrawCount+this.postDrawCount),this.computeBoundingSphere(),this.mesh.geometry.boundingSphere=this.boundingSphere,this.drawIndex=this.fenceIndex.concat(this.postIndex),this.mesh.geometry.setIndex(this.drawIndex),this.mesh.position.set(this.ox,-.15,this.oz),this.posAttribute.needsUpdate=!0,this.normAttribute.needsUpdate=!0,this.uvAttribute.needsUpdate=!0,this.mesh.visible=!0,this.mesh.updateMatrix(),!this.seg.contiguousStart)for(this.p.x=this.posArr[0]+this.mesh.position.x,this.p.y=this.posArr[1],this.p.z=this.posArr[2]+this.mesh.position.z,Jn.addObject(Xn.VergeMarker,this.p,Math.PI+Math.PI/2-this.seg.startNode.a,this.seg.startNode.i),wa.ii=0;wa.ii<6;wa.ii++)this.posArr[3*wa.ii+1]-=1;if(!this.seg.contiguousEnd)for(wa.ii=0;wa.ii<6;wa.ii++)this.posArr[this.pi-(3*wa.ii+2)]-=1;return!0}retire(){this.mesh.visible=!1}computeBoundingSphere(){wa.minX=this.bounds.minX,wa.maxX=this.bounds.maxX,wa.minY=this.bounds.minY,wa.maxY=this.bounds.maxY,wa.minZ=this.bounds.minZ,wa.maxZ=this.bounds.maxZ,this.boundingSphere.center.x=(wa.minX+wa.maxX)/2,this.boundingSphere.center.y=(wa.minY+wa.maxY)/2,this.boundingSphere.center.z=(wa.minZ+wa.maxZ)/2,this.boundingSphere.radius=Math.sqrt((wa.maxX-wa.minX)*(wa.maxX-wa.minX)+(wa.maxY-wa.minY)*(wa.maxY-wa.minY)+(wa.maxZ-wa.minZ)*(wa.maxZ-wa.minZ))/2+10}static getNorms(){let e=[];for(let t=0;t<366;t++)e.push(0,0,1);return e}static getUV(){let e=[];for(let t=0;t<61;t++)e.push(t,0,t,ca,t,pa,t,ua,t,ga,t,1);return e}static getGeo(){if(null!==xa&&ma==rt)return xa.clone();let e=new r.g;return e.setAttribute("position",new r.o(new Float32Array(5490),3)),e.attributes.position.setUsage(r.l),e.setAttribute("uv",new r.o(new Float32Array(3660),2)),e.attributes.uv.setUsage(r.l),e.setAttribute("normal",new r.o(new Float32Array(5490),3)),e.attributes.normal.setUsage(r.l),xa=e,ma=rt,e}static getFenceIndex(){let e,t,i,s,n,a,o,r,h,l,d,c,p=[];for(let u=0;u<61;u++)e=6*u,t=e+1,i=e+2,s=e+3,n=e+4,a=e+5,o=6*(u+1),r=o+1,h=o+2,l=o+3,d=o+4,c=o+5,p.push(e,t,o,t,r,o,t,i,r,i,h,r,i,s,h,s,l,h,s,n,l,n,d,l,n,a,d,a,c,d);return p}}var ba=fa;const Aa=2.3,ya=.3833333333333333,Ia=.19166666666666665,Sa=new r.F({map:null,flatShading:!0}),Ma={};class Da extends Pn{generate(e){let t=e.prev;for(e=e.next;this.testGen(t)&&t.prev&&e.i-t.i<4;)t=t.prev;for(t.i-this.prev.endNode.i<4&&(t=this.prev.endNode);this.testGen(e)&&e.i-t.i<qt;)e=e.next;let i=new Tn(t,e,this.typeID,(t.w+0)*this.side);return this.prev.endNode.i==t.i&&this.prev.type==i.type&&(this.prev.contiguousEnd=!0,i.contiguousStart=!0,i.distance=this.prev.distance),i}testGenLeft(e){return e.bridge&&e.i>=this.prev.endNode.i}testGenRight(e){return e.bridge&&e.i>=this.prev.endNode.i}testGen(e){return e.bridge&&e.i>=this.prev.endNode.i}testLeft(e){return e.bridge}testRight(e){return e.bridge}}var Ca=class extends Rn{constructor(...e){super(...e),this.mapSource=Ys.skins.default.walls.sea,this.p=new r.W,this.mesh.material=Sa}drawSegment(e){return this.seg=e,this.drawNode=this.seg.startNode,this.pi=0,this.ui=0,this.ox=this.seg.startNode.p.x,this.oz=this.seg.startNode.p.z,this.lOffset=this.seg.distance<0?ya:0,this.uvDist=0,this.ux1=1.15,this.ux2=1.3416666666666666,this.ux3=2.4916666666666663,this.ni=0,this.drawNextNode()}drawNextNode(){for(Ma.dnp=this.drawNode.p,this.ni>0?(this.bounds.maxX=Math.max(this.bounds.maxX,Ma.dnp.x-this.ox),this.bounds.minX=Math.min(this.bounds.minX,Ma.dnp.x-this.ox),this.bounds.maxY=Math.max(this.bounds.maxY,Ma.dnp.y),this.bounds.minY=Math.min(this.bounds.minY,Ma.dnp.y),this.bounds.maxZ=Math.max(this.bounds.maxZ,Ma.dnp.z-this.oz),this.bounds.minZ=Math.min(this.bounds.minZ,Ma.dnp.z-this.oz)):(this.bounds.maxX=Ma.dnp.x-this.ox,this.bounds.minX=Ma.dnp.x-this.ox,this.bounds.maxY=Ma.dnp.y,this.bounds.minY=Ma.dnp.y,this.bounds.maxZ=Ma.dnp.z-this.oz,this.bounds.minZ=Ma.dnp.z-this.oz),Ma.j=0;Ma.j<this.drawNode.ps.length;Ma.j+=2)Ma.pj=this.drawNode.ps[Ma.j],Ma.nj=this.drawNode.ns[Ma.j],Ma.x=Ma.pj.x+Ma.nj.x*(this.seg.distance-this.lOffset),Ma.xw=Ma.x+Ma.nj.x*ya,Ma.z=Ma.pj.z+Ma.nj.z*(this.seg.distance-this.lOffset),Ma.zw=Ma.z+Ma.nj.z*ya,this.posArr[this.pi++]=Ma.x-this.ox-Ma.nj.x*Ia,this.posArr[this.pi++]=Ma.pj.y,this.posArr[this.pi++]=Ma.z-this.oz-Ma.nj.z*Ia,this.posArr[this.pi++]=Ma.x-this.ox,this.posArr[this.pi++]=Ma.pj.y+Aa,this.posArr[this.pi++]=Ma.z-this.oz,this.posArr[this.pi++]=Ma.xw-this.ox,this.posArr[this.pi++]=Ma.pj.y+Aa,this.posArr[this.pi++]=Ma.zw-this.oz,this.posArr[this.pi++]=Ma.xw-this.ox+Ma.nj.x*Ia,this.posArr[this.pi++]=Ma.pj.y,this.posArr[this.pi++]=Ma.zw-this.oz+Ma.nj.z*Ia,this.seg.contiguousStart||0!=this.ni||0!=Ma.j||(this.posArr[this.pi-11]-=1.15,this.posArr[this.pi-8]-=1.15,this.posArr[this.pi-5]-=1.15,this.posArr[this.pi-2]-=1.15),this.uvArr[this.ui++]=0,this.uvArr[this.ui++]=this.uvDist,this.uvArr[this.ui++]=this.ux1,this.uvArr[this.ui++]=this.uvDist,this.uvArr[this.ui++]=this.ux2,this.uvArr[this.ui++]=this.uvDist,this.uvArr[this.ui++]=this.ux3,this.uvArr[this.ui++]=this.uvDist,this.uvDist++;return this.ni++,this.drawNode=this.drawNode.next,!(this.drawNode.i<this.seg.endNode.i)&&(Ma.pj=this.drawNode.p,Ma.nj=this.drawNode.n,Ma.x=Ma.pj.x+Ma.nj.x*(this.seg.distance-this.lOffset),Ma.xw=Ma.x+Ma.nj.x*ya,Ma.z=Ma.pj.z+Ma.nj.z*(this.seg.distance-this.lOffset),Ma.zw=Ma.z+Ma.nj.z*ya,this.posArr[this.pi++]=Ma.x-this.ox-Ma.nj.x*Ia,this.posArr[this.pi++]=Ma.pj.y,this.posArr[this.pi++]=Ma.z-this.oz-Ma.nj.z*Ia,this.posArr[this.pi++]=Ma.x-this.ox,this.posArr[this.pi++]=Ma.pj.y+Aa,this.posArr[this.pi++]=Ma.z-this.oz,this.posArr[this.pi++]=Ma.xw-this.ox,this.posArr[this.pi++]=Ma.pj.y+Aa,this.posArr[this.pi++]=Ma.zw-this.oz,this.posArr[this.pi++]=Ma.xw-this.ox+Ma.nj.x*Ia,this.posArr[this.pi++]=Ma.pj.y,this.posArr[this.pi++]=Ma.zw-this.oz+Ma.nj.z*Ia,this.seg.contiguousEnd||(this.posArr[this.pi-11]-=Aa,this.posArr[this.pi-8]-=Aa,this.posArr[this.pi-5]-=Aa,this.posArr[this.pi-2]-=Aa),this.uvArr[this.ui++]=1,this.uvArr[this.ui++]=this.uvDist,this.uvArr[this.ui++]=.55,this.uvArr[this.ui++]=this.uvDist,this.uvArr[this.ui++]=.45,this.uvArr[this.ui++]=this.uvDist,this.uvArr[this.ui++]=0,this.uvArr[this.ui++]=this.uvDist,this.mesh.geometry.setDrawRange(0,5*this.seg.length*6*3),this.computeBoundingSphere(),this.mesh.geometry.boundingSphere=this.boundingSphere,this.mesh.position.set(this.ox,-1.5,this.oz),this.posAttribute.needsUpdate=!0,this.uvAttribute.needsUpdate=!0,this.mesh.visible=!0,this.mesh.updateMatrix(),this.seg.contiguousStart||(this.p.x=(this.posArr[0]+this.posArr[9])/2+this.mesh.position.x,this.p.y=this.posArr[7]-1.15,this.p.z=(this.posArr[2]+this.posArr[11])/2+this.mesh.position.z,Jn.addObject(Xn.VergeMarker,this.p,Math.PI+Math.PI/2-this.seg.startNode.a,this.seg.startNode.i)),!0)}};const Na=new r.F({map:null,flatShading:!0});class ka extends Rn{constructor(...e){super(...e),this.mapSource=Ys.skins.default.walls.sea,this.mesh.material=Na}}ka.waterHeight=2.5,ka.waterThreshold=3;class za extends Pn{constructor(...e){super(...e),this.drystoneID=2}generate(e){let t=e.prev;for(e=e.next;this.test(t)&&t.prev&&e.i-t.i<4&&t.i>this.prev.endNode.i&&e.i-t.i<qt;)t=t.prev;for(t.i-this.prev.endNode.i<4&&(t=this.prev.endNode);this.test(e)&&e.i-t.i<qt;)e=e.next;let i=this.typeID;(t.i%2==0||this.prev.endNode.i==t.i&&this.prev.type==this.drystoneID)&&(i=this.drystoneID);let s=new Tn(t,e,i,(t.w+1)*this.side);return this.prev.endNode.i>=t.i&&this.prev.type==s.type&&(this.prev.contiguousEnd=!0,s.contiguousStart=!0,s.distance=this.prev.distance),s}testGenLeft(e){return e.i>=this.prev.endNode.i&&this.testGen(e)&&this.testLeft(e)}testGenRight(e){return e.i>=this.prev.endNode.i&&this.testGen(e)&&this.testRight(e)}testGen(e){return!e.bridge&&(e.p.y<=ka.waterHeight||e.i==this.prev.endNode.i&&e.p.y<ka.waterThreshold)}testLeft(e){return!e.bridge&&(e.g<.15||e.p.y<ka.waterThreshold&&e.h<-.5)}testRight(e){return!e.bridge&&(e.g>.15||e.p.y<ka.waterThreshold&&e.h<-.5)}}const ja={Barrier:0,SeaWall:1,Drystone:2,Bridge:3,Fence:4},La=[la,ka,Vn,Ca,ba];var Oa=class{constructor(e){this.activeSegments=[],this.prevSegmentsLeft=[],this.prevSegmentsRight=[],this.stagedSegments=[],this.count=0,this.prevWasContiguous=!1,this.getHeightAt=e,this.container=new r.G,this.segments=[],this.initPools()}destroy(){for(this.container.traverse((e=>{e.isMesh&&e.geometry.dispose()}));this.container.children.length;)this.container.remove(this.container.children[0])}initialise(){this.renderIndex=ii.vehicleIndex,this.genNode=ii.vehicleNode,this.genIndex=ii.vehicleIndex,this.genNodeLeft=ii.vehicleNode,this.genNodeRight=ii.vehicleNode,this.bridgeWallGenerator=new Da(ii.vehicleNode,ja.Bridge),this.seaWallGenerator=new za(ii.vehicleNode,ja.SeaWall),this.seaWallGenerator.drystoneID=ja.Drystone,this.drystoneGenerator=new Yn(ii.vehicleNode,ja.Drystone,this.getHeightAt),this.barrierGenerator=new ha(ii.vehicleNode,ja.Barrier);do{this.updateGeneration()}while(this.genIndex<ii.vehicleIndex+Xt);for(;this.segments.length>0&&ii.vehicleIndex+Jt>=this.segments[0].startNode.i;)this.drawNextSegment();do{this.updateStaged()}while(this.stagedSegments.length)}initPools(){this.pools=[];let e,t,i=Object.keys(ja).length;for(e=0;e<i;e++)t=new La[e](null,this.getHeightAt),this.container.add(t.mesh),this.pools.push([t])}setSkin(e){}handleMidlineReset(){(ii.tail.i<this.genNodeLeft.i||ii.tail.i<this.genNodeRight.i)&&(console.error("Wall controller must handle reset gracefully"),this.genNodeLeft=ii.tail,this.genNodeRight=ii.tail,this.renderIndex=ii.tail.i)}updateGeneration(){this.genIndex<ii.vehicleIndex+Xt&&this.genIndex++,this.genNodeLeft.i<this.genIndex&&(this.genNodeLeft=this.genNodeLeft.next,this.checkGenerateLeftSegment()),this.genNodeRight.i<this.genIndex&&(this.genNodeRight=this.genNodeRight.next,this.checkGenerateRightSegment())}update(){for(this.updateGeneration();this.segments.length>0&&ii.vehicleIndex+Jt>=this.segments[0].startNode.i;)this.drawNextSegment();if(this.activeSegments.length)for(;ii.vehicleIndex>this.activeSegments[0].endNode.i+10&&(this.retireSegment(this.activeSegments.shift()),0!=this.activeSegments.length););}updateStaged(){this.stagedSegments.length&&this.stagedSegments[0].drawNextNode()&&(this.stagedSegments.shift(),tn.walls=this.activeSegments.length+" ("+this.stagedSegments.length+")")}checkGenerateLeftSegment(){this.addLeftSegment(this.bridgeWallGenerator.generateLeft(this.genNodeLeft)),this.addLeftSegment(this.seaWallGenerator.generateLeft(this.genNodeLeft)),this.addLeftSegment(this.drystoneGenerator.generateLeft(this.genNodeLeft)),this.addLeftSegment(this.barrierGenerator.generateLeft(this.genNodeLeft))}checkGenerateRightSegment(){this.addRightSegment(this.bridgeWallGenerator.generateRight(this.genNodeRight)),this.addRightSegment(this.seaWallGenerator.generateRight(this.genNodeRight)),this.addRightSegment(this.drystoneGenerator.generateRight(this.genNodeRight)),this.addRightSegment(this.barrierGenerator.generateRight(this.genNodeRight))}addRightSegment(e){if(!e)return;let t=e.startNode;for(;t.i<e.endNode.i;)(!t.rWallDist||t.rWallDist>e.distance)&&(t.rWallDist=e.distance,t.wallSide=-1),t=t.next;this.segments.push(e)}addLeftSegment(e){if(!e)return;let t=e.startNode;for(;t.i<e.endNode.i;)(!t.lWallDist||t.lWallDist>-e.distance)&&(t.lWallDist=-e.distance,t.wallSide=1),t=t.next;this.segments.push(e)}getSegmentObject(e){let t;if(this.pools[e].length)t=this.pools[e].pop();else{t=new(0,La[e])(null,this.getHeightAt),this.container.add(t.mesh)}return t}drawNextSegment(){let e=this.segments.shift(),t=this.getSegmentObject(e.type);t.drawSegment(e)||this.stagedSegments.push(t),e.obj=t,this.activeSegments.push(e),tn.walls=this.activeSegments.length+" ("+this.stagedSegments.length+")"}retireSegment(e){e.obj.retire(),tn.walls=this.activeSegments.length+" ("+this.stagedSegments.length+")",this.pools[e.type].push(e.obj)}disable(){this.container.visible=!1}enable(){this.container.visible=!0}};const Ra=1.5*Math.PI;var Ta=class{constructor(){this.root=null,this.turnTail=null,this.gradTail=null,this.chevTail=null,this.placementNode=null,this.placementPos=new r.W,this.lastSignIndex=0,this.lastSignPos=new r.W,this.lastSignRot=0,this.dA=0,this.lastTurnIndex=-10,this.lastTurnType=null,this.lastTurnGeo=null,this.turnDir=0,this.dH=0,this.lastGradIndex=-16,this.lastGradGeo=null,this.taildH=0,this.curHillDir=0,this.onHill=!1,this.steepness=0,this.curHillSteepness=0,this.cA=0,this.lastChevIndex=0,this.chevDir=0}initialise(){for(this.root=ii.vehicleNode.next.next.next,this.turnTail=this.root,this.dA=this.root.da,this.gradTail=this.root,this.chevTail=this.root,this.cA=Math.abs(this.root.da);this.turnTail.i<this.root.i+5;)this.turnTail=this.turnTail.next,this.dA+=this.turnTail.da;for(;this.gradTail.i<this.root.i+8;)this.gradTail=this.gradTail.next;for(;this.chevTail.i<this.root.i+4;)this.chevTail=this.chevTail.next,this.cA+=Math.abs(this.chevTail.da);for(;this.root.i<ii.vehicleNode.i+25;)this.update()}destroy(){for(this.container.traverse((e=>{e.isMesh&&e.geometry.dispose()}));this.container.children.length;)this.container.remove(this.container.children[0])}handleMidlineReset(){console.warn("No midline reset handling for SignController")}update(){this.checkPlaceTurnSign(),this.checkPlaceGradientSign(),this.checkPlaceChevron(),this.root=this.root.next}checkPlaceTurnSign(){if(this.dA-=this.root.da,this.turnTail=this.turnTail.next,this.dA+=this.turnTail.da,this.turnDir=this.dA<0?1:-1,Math.abs(this.dA)>.9)if(this.turnTail.i-this.lastTurnIndex>10){if(this.placementNode=this.root.prev.prev.prev,this.placementNode.bridge)return;let s;var e,t,i;if(this.placementNode.da<-.1)s=Ra-(null===(e=this.placementNode.prev)||void 0===e||null===(t=e.prev)||void 0===t||null===(i=t.prev)||void 0===i?void 0:i.a)||this.placementNode.a,this.placementPos.set(this.placementNode.p.x+this.placementNode.n.x*(this.placementNode.w+1),this.placementNode.p.y,this.placementNode.p.z+this.placementNode.n.z*(this.placementNode.w+1));else s=Ra-this.placementNode.a,this.placementPos.set(this.placementNode.p.x-this.placementNode.n.x*(this.placementNode.w+1),this.placementNode.p.y,this.placementNode.p.z-this.placementNode.n.z*(this.placementNode.w+1));this.turnTail.i>=this.lastSignIndex&&this.turnTail.i-this.lastSignIndex<5&&this.combineWithLastGradSign(this.turnTail.i,s),this.lastTurnType=this.turnDir<0?hn:ln,this.lastTurnIndex=this.turnTail.i,this.lastTurnGeo=Jn.addObject(Xn.WarningSign,this.placementPos,s,this.placementNode.i,this.lastTurnType),this.lastSignIndex=this.turnTail.i,this.lastSignPos.copy(this.placementPos),this.lastSignRot=s}else this.lastTurnGeo&&(this.turnDir>0&&this.lastTurnType==hn?(this.lastTurnIndex=this.turnTail.i,this.lastTurnType=dn,this.lastTurnGeo.setVariant(dn)):this.turnDir<0&&this.lastTurnType==ln&&(this.lastTurnIndex=this.turnTail.i,this.lastTurnType=cn,this.lastTurnGeo.setVariant(cn)))}combineWithLastGradSign(e,t){this.lastGradGeo&&(this.lastGradGeo.worldPosition.copy(this.placementPos),this.lastGradGeo.worldPosition.y-=.65,this.lastGradGeo.updatePosition(),this.lastGradGeo.updateRetireIndex(e),this.lastGradGeo.rotation.y=t)}checkPlaceGradientSign(){var e;if(this.gradTail=this.gradTail.next,this.dH=this.gradTail.p.y-this.root.p.y,this.climbing=this.dH>0,this.dH=Math.abs(this.dH),this.steepness=this.dH>12?this.dH>16?2:1:0,this.taildH=this.gradTail.p.y-this.gradTail.prev.p.y,this.onHill)this.curHillDir>0&&this.taildH<0||this.curHillDir<0&&this.taildH>0?this.onHill=!1:this.steepness>this.curHillSteepness&&(null===(e=this.lastGradGeo)||void 0===e||e.setVariant(this.curHillDir>0?un:mn));else if(this.steepness>0&&this.gradTail.i-this.lastGradIndex>16){let e,n;if(this.onHill=!0,this.curHillDir=this.climbing?1:-1,this.curHillSteepness=this.steepness,this.gradTail.i-3-this.lastSignIndex<5)this.lastGradIndex=this.lastSignIndex,this.placementPos.copy(this.lastSignPos),this.placementPos.y-=.65,e=this.lastSignRot;else{if(this.lastGradIndex=this.gradTail.i,this.placementNode=this.root.prev.prev.prev,this.placementNode.bridge)return;var t,i,s;if(e=Ra-this.placementNode.a,this.placementNode.da<-.1)this.placementPos.set(this.placementNode.p.x+this.placementNode.n.x*(this.placementNode.w+1),this.placementNode.p.y,this.placementNode.p.z+this.placementNode.n.z*(this.placementNode.w+1)),e=Ra-(null===(t=this.placementNode.prev)||void 0===t||null===(i=t.prev)||void 0===i||null===(s=i.prev)||void 0===s?void 0:s.a)||this.placementNode.a;else this.placementPos.set(this.placementNode.p.x-this.placementNode.n.x*(this.placementNode.w+1),this.placementNode.p.y,this.placementNode.p.z-this.placementNode.n.z*(this.placementNode.w+1));this.lastSignIndex=this.gradTail.i,this.lastSignPos.copy(this.placementPos),this.lastSignRot=e}n=this.climbing?this.steepness>1?un:pn:this.steepness>1?mn:gn,this.lastGradGeo=Jn.addObject(Xn.WarningSign,this.placementPos,e,this.placementNode.i,n)}}checkPlaceChevron(){if(this.chevTail=this.chevTail.next,this.chevTail.i-this.lastChevIndex<8)return this.cA-=Math.abs(this.root.da),void(this.cA+=Math.abs(this.chevTail.da));if(this.chevDir=this.chevTail.da<0?1:-1,Math.abs(this.chevTail.da)>.6&&this.cA<.6){var e,t;this.placementNode=this.chevTail,Math.abs(this.placementNode.prev.da)>.25&&(this.placementNode=this.placementNode.prev),this.lastChevIndex=this.chevTail.i;let i=Ra-((null===(e=this.placementNode.prev)||void 0===e||null===(t=e.prev)||void 0===t?void 0:t.a)||this.placementNode.a);this.placementPos.set(this.placementNode.p.x-this.placementNode.n.x*(this.placementNode.w+.7)*this.chevDir,this.placementNode.p.y-.6,this.placementNode.p.z-this.placementNode.n.z*(this.placementNode.w+.7)*this.chevDir),Jn.addObject(Xn.WarningSign,this.placementPos,i,this.placementNode.i,this.chevDir<0?xn:vn),this.placementNode.ps?(this.placementPos.set(this.placementNode.ps[4].x-this.placementNode.ns[4].x*(this.placementNode.w+.7)*this.chevDir,this.placementNode.ps[4].y-.6,this.placementNode.ps[4].z-this.placementNode.ns[4].z*(this.placementNode.w+.7)*this.chevDir),Jn.addObject(Xn.WarningSign,this.placementPos,i,this.placementNode.i,this.chevDir<0?xn:vn),this.placementNode=this.placementNode.prev,this.placementPos.set(this.placementNode.ps[6].x-this.placementNode.ns[6].x*(this.placementNode.w+.7)*this.chevDir,this.placementNode.ps[6].y-.6,this.placementNode.ps[6].z-this.placementNode.ns[6].z*(this.placementNode.w+.7)*this.chevDir),Jn.addObject(Xn.WarningSign,this.placementPos,i,this.placementNode.i,this.chevDir<0?xn:vn)):console.warn("Attempting to place chevron without fine points")}this.cA-=Math.abs(this.root.da),this.cA+=Math.abs(this.chevTail.da)}};const Pa=1.5*Math.PI;class Ga extends r.G{constructor(){super(),this.shadowMat=new r.C({transparent:!0,opacity:.33,color:0}),this.waterOffset=.03,this.p=new r.W,this.originPos=new r.W;this.geo=new r.g,this.geo.setIndex(this.getIndex(26)),this.geo.setAttribute("position",new r.o(new Float32Array(156),3)),this.verts=this.geo.attributes.position.array,this.geo.attributes.position.setUsage(r.l);let e=new r.B(this.geo,this.shadowMat);this.add(e)}drawBridge(e){this.originPos.copy(e.p);let t,i,s,n=0,a=e;for(n=0;n<25&&(this.p.copy(a.p).sub(this.originPos),i=a.n,s=a.w+.6,t=6*n,this.verts[t]=this.p.x+i.x*s,this.verts[t+1]=-this.originPos.y+this.waterOffset,this.verts[t+2]=this.p.z+i.z*s,this.verts[t+3]=this.p.x-i.x*s,this.verts[t+4]=-this.originPos.y+this.waterOffset,this.verts[t+5]=this.p.z-i.z*s,a.bridge);n++)a=a.next;this.geo.setDrawRange(0,6*(n-1)),this.geo.attributes.position.needsUpdate=!0,this.geo.computeBoundingSphere()}getIndex(e){let t,i,s,n,a=[];for(let o=0;o<e-1;o++)t=2*o,i=t+1,s=2*(o+1),n=s+1,a.push(t,s,i),a.push(i,s,n);return a}}class Ba extends r.G{constructor(){super(),this.waterOffset=.03,this.wallMaterial=new r.F({color:12303291,side:r.k,flatShading:!0}),this.p=new r.W,this.originPos=new r.W;this.geo=new r.g,this.geo.setIndex(this.getIndex(25)),this.geo.setAttribute("position",new r.o(new Float32Array(312),3)),this.verts=this.geo.attributes.position.array,this.geo.attributes.position.setUsage(r.l);let e=new r.B(this.geo,this.wallMaterial);this.add(e)}drawBridge(e){this.originPos.copy(e.p);let t,i,s,n=0,a=e;for(n=0;n<25&&(this.p.copy(a.p).sub(this.originPos),i=a.n,s=a.w+.6,t=12*n,this.verts[t]=this.p.x+i.x*s,this.verts[t+1]=this.p.y+1,this.verts[t+2]=this.p.z+i.z*s,this.verts[t+3]=this.p.x+i.x*s,this.verts[t+4]=this.p.y-1,this.verts[t+5]=this.p.z+i.z*s,this.verts[t+6]=this.p.x-i.x*s,this.verts[t+7]=this.p.y-1,this.verts[t+8]=this.p.z-i.z*s,this.verts[t+9]=this.p.x-i.x*s,this.verts[t+10]=this.p.y+1,this.verts[t+11]=this.p.z-i.z*s,a.bridge);n++)a=a.next;this.geo.setDrawRange(0,18*(n-1)),this.geo.attributes.position.needsUpdate=!0,this.geo.computeBoundingSphere()}getIndex(e){let t,i,s,n,a,o,r,h,l=[];for(let d=0;d<e;d++)t=4*d,i=t+1,s=t+2,n=t+3,a=4*(d+1),o=a+1,r=a+2,h=a+3,l.push(t,i,a,i,o,a,i,s,o,s,r,o,s,n,r,n,h,r);return l}}var Wa=class{constructor(){this.root=null,this.tail=null,this.shadowPool=[],this.wallPool=[]}initialise(){for(this.root=ii.vehicleNode;this.root.i<ii.vehicleNode.i+100;)this.update()}getShadowObject(){if(this.shadowPool.length&&!this.shadowPool[0].visible)return this.shadowPool.shift();{let e=new Ga;return this.shadowPool.push(e),e}}getWallObject(){if(this.wallPool.length&&!this.wallPool[0].visible)return this.wallPool.shift();{let e=new Ba;return this.wallPool.push(e),e}}update(){if(this.root.bridge){let e=this.root.next;for(;e.bridge;){if(null==e.next)throw new Error("Bridge end null, root/end ",this.root.i,e.i);e=e.next}let t=e.i-this.root.i,i=this.getWallObject();i.drawBridge(this.root),Jn.addCustom(i,this.root.p,0,this.root.i,-(Jt-10));let s=this.getShadowObject();s.drawBridge(this.root),Jn.addCustom(s,this.root.p,0,e.i,50);let n=(t+1)%2;for(;this.root.bridge;)n%2==0&&Jn.addObject(Xn.BridgeSupport,this.root.p,Pa-this.root.a,this.root.i),this.root=this.root.next,n++}this.root=this.root.next}};const Fa=.04,Ea=new r.L({color:16777215,fog:!1,size:.04,transparent:!0,opacity:0});Ea.userData.headlightPos={value:new r.W},Ea.userData.headlightDir={value:new r.W},Ea.onBeforeCompile=e=>{e.uniforms.headlightPos=Ea.userData.headlightPos,e.uniforms.headlightDir=Ea.userData.headlightDir,e.vertexShader=e.vertexShader.replace("#include <clipping_planes_pars_vertex>","#include <clipping_planes_pars_vertex>\n\n  uniform vec3 headlightPos;\n  uniform vec3 headlightDir;\n\n  varying float vBrightness;\n"),e.vertexShader=e.vertexShader.replace("#include <project_vertex>","#include <project_vertex>\n\n\n  vec4 wPos = modelMatrix * vec4(position, 1.0);\n\n  vec3 carDir = headlightPos - wPos.xyz;\n\n  // Distance to catseyes,\n  float carDist = length(carDir);\n\n  if(carDist < 150.0) {\n    // View distance of 150m\n    float distBrightnessFactor = 1.0 - (carDist - 50.0) / 100.0;\n\n    // Check if car is aiming at the light close enough\n    float angleBrightnessFactor = max(0.0, dot(normal, headlightDir));\n\n    // Check\n    float coneBrightnessFactor = dot(headlightDir, normalize(carDir));\n    coneBrightnessFactor = (coneBrightnessFactor - 0.8) / 0.2;\n\n    // NOTE: Could set the road colour here to save on transparency rendering\n    vBrightness = distBrightnessFactor * angleBrightnessFactor * coneBrightnessFactor;\n  } else {\n    vBrightness = 0.0;\n  }\n\n"),e.fragmentShader=e.fragmentShader.replace("#include <clipping_planes_pars_fragment>","#include <clipping_planes_pars_fragment>\n\n\n  varying float vBrightness;\n\n"),e.fragmentShader=e.fragmentShader.replace("#include <alphatest_fragment>","#include <alphatest_fragment>\n\n\n  diffuseColor.a = vBrightness;\n\n")};const Za={};var Ha=class{constructor(){this.container=new r.G,this.instances=[],this.eyeOffset=0,this.genNode=null,this.seenIndex=0}initInstances(){for(let e=0;e<2;e++)this.instances.push(this.getInstance())}getInstance(){let e=new r.g;e.setAttribute("position",new r.o(new Float32Array(3*this.pointsCount),3)),e.attributes.position.setUsage(r.l),e.setAttribute("normal",new r.o(new Float32Array(3*this.pointsCount),3)),e.attributes.normal.setUsage(r.l);let t=new r.K(e,Ea);return t.visible=!0,t.frustumCulled=!1,t.matrixAutoUpdate=!1,this.container.add(t),t}initialise(){for(this.eyeSpacing=6.25,this.pointsCount=2*Math.ceil(400/this.eyeSpacing),this.eyeOffset=.25*this.eyeSpacing,this.genNode=ii.head,this.seenIndex=ii.head.i,this.initInstances(),this.prepNextInstance();this.seenIndex<ii.vehicleIndex+56;)this.update()}update(){this.seenIndex<ii.vehicleIndex+56&&(this.drawNextNode(),this.genNode=this.genNode.next,this.seenIndex=this.genNode.i,this.curInstance.userData.retireIndex<=ii.vehicleIndex&&(this.curInstance.visible=!1)),Ea.userData.headlightDir.value.copy(be.fwd).negate(),Ea.userData.headlightPos.value.copy(be.frontAxlePosition),Ea.uniformsNeedUpdate=!0}drawNextNode(){this.eyeOffset>=0&&this.eyeOffset<10&&(Za.placementDist=this.eyeOffset,Za.psA=Math.max(0,Math.floor(Za.placementDist)),Za.pa=this.genNode.ps[Za.psA],Za.psA<9?Za.pb=this.genNode.ps[Za.psA+1]:Za.pb=this.genNode.next.ps[0],Za.pLerp=Za.placementDist-Za.psA,Za.p={x:Za.pa.x*(1-Za.pLerp)+Za.pb.x*Za.pLerp,y:Za.pa.y*(1-Za.pLerp)+Za.pb.y*Za.pLerp,z:Za.pa.z*(1-Za.pLerp)+Za.pb.z*Za.pLerp},Za.n=this.genNode.ns[Za.psA],Za.nn={x:Za.n.x,z:Za.n.z},this.curNormArr[this.curIndex]=-Za.n.z,this.curPosArr[this.curIndex++]=Za.p.x+Za.nn.x*Fa-this.curInstanceOffset.x,this.curNormArr[this.curIndex]=0,this.curPosArr[this.curIndex++]=Za.p.y+.03-this.curInstanceOffset.y,this.curNormArr[this.curIndex]=Za.n.x,this.curPosArr[this.curIndex++]=Za.p.z+Za.nn.z*Fa-this.curInstanceOffset.z,this.curNormArr[this.curIndex]=-Za.n.z,this.curPosArr[this.curIndex++]=Za.p.x-Za.nn.x*Fa-this.curInstanceOffset.x,this.curNormArr[this.curIndex]=0,this.curPosArr[this.curIndex++]=Za.p.y+.03-this.curInstanceOffset.y,this.curNormArr[this.curIndex]=Za.n.x,this.curPosArr[this.curIndex++]=Za.p.z-Za.nn.z*Fa-this.curInstanceOffset.z,this.curIndex>this.maxIndex-6&&this.cycleInstances(),this.eyeOffset=Za.placementDist),this.eyeOffset=this.eyeOffset+this.eyeSpacing,this.eyeOffset<10?this.drawNextNode():this.eyeOffset-=10}cycleInstances(){this.curInstance.geometry.attributes.position.needsUpdate=!0,this.curInstance.geometry.attributes.normal.needsUpdate=!0,this.curInstance.updateMatrix(),this.curInstance.visible=!0,this.curInstance.userData.retireIndex=this.genNode.i+3,this.instances.push(this.instances.shift()),this.prepNextInstance()}prepNextInstance(){this.curInstance=this.instances[0],this.curPosArr=this.curInstance.geometry.attributes.position.array,this.curNormArr=this.curInstance.geometry.attributes.normal.array,this.curInstanceOffset={x:0,y:0,z:0},this.genNode&&(this.curInstanceOffset=this.genNode.p),this.curInstance.position.copy(this.curInstanceOffset),this.curIndex=0,this.maxIndex=3*this.pointsCount}};var Qa=i.p+"static/media/flake.d6a06041.webp";const Ya=new r.L({size:.02,map:st(Qa,4),alphaTest:.455});Ya.userData.time={value:0},Ya.userData.speed={value:1.25},Ya.userData.noise={value:st(ys,4)},Ya.userData.offset={value:new r.W},Ya.userData.boxWidth={value:30},Ya.userData.boxHeight={value:30},Ya.userData.headlightOn={value:!0},Ya.userData.headlightPos={value:new r.W},Ya.userData.headlightDir={value:new r.W},Ya.userData.snowCol={value:new r.i(16777215)},Ya.userData.minDist={value:0},Ya.onBeforeCompile=e=>(e.uniforms.time=Ya.userData.time,e.uniforms.speed=Ya.userData.speed,e.uniforms.noise=Ya.userData.noise,e.uniforms.offset=Ya.userData.offset,e.uniforms.boxWidth=Ya.userData.boxWidth,e.uniforms.boxHeight=Ya.userData.boxHeight,e.uniforms.headlightOn=Ya.userData.headlightOn,e.uniforms.headlightPos=Ya.userData.headlightPos,e.uniforms.headlightDir=Ya.userData.headlightDir,e.uniforms.snowCol=Ya.userData.snowCol,e.uniforms.minDist=Ya.userData.minDist,e.vertexShader=e.vertexShader.replace("#include <fog_pars_vertex>","#include <fog_pars_vertex>\n\n\n  uniform float time;\n  uniform sampler2D noise;\n  uniform vec3 offset;\n  uniform float boxWidth;\n  uniform float boxHeight;\n  uniform float minDist;\n  uniform float speed;\n\n  uniform bool headlightOn;\n  uniform vec3 headlightPos;\n  uniform vec3 headlightDir;\n\n  varying float vBrightness;\n  varying float skip;\n\n  float SPEED = 1.0;\n\n"),e.vertexShader=e.vertexShader.replace("#include <project_vertex>","\n\n  // divide x/z by turbulence factor/scale factor\n  // divide time by wind speed factr\n\n  vec4 wPos = modelMatrix * vec4( position, 1.0 );\n\n  vec2 wuv = vec2(\n    transformed.x/50. + time/200.,\n    transformed.z/50. + time/200.\n  );\n\n\n  float noise = texture2D(noise, wuv).r;\n\n  // fall speed\n  transformed.y = mod(mod(transformed.y - offset.y, boxWidth) - time * speed, boxHeight);\n  transformed.x = mod(transformed.x - offset.x, boxWidth);\n  transformed.z = mod(transformed.z - offset.z, boxWidth);\n\n  transformed.x += noise * 2.;\n  transformed.z += cos(noise);\n\n  //// PROJECT VERTEX\n\n  vec4 mvPosition = vec4( transformed, 1.0 );\n\n  #ifdef USE_INSTANCING\n\n    mvPosition = instanceMatrix * mvPosition;\n\n  #endif\n\n  mvPosition = modelViewMatrix * mvPosition;\n\n  gl_Position = projectionMatrix * mvPosition;\n\n  //// EXCLUSION BY CAM DIST\n\n  skip = 0.0;\n  if(-mvPosition.z < minDist) {\n    skip = 1.0;\n  }\n\n  //// BRIGHTNESS\n\n  vBrightness = 0.0;\n\n  if(headlightOn) {\n      wPos = modelMatrix * vec4( transformed, 1.0 );\n\n      vec3 carDir = headlightPos - wPos.xyz;\n\n      // Distance to catseyes,\n      float carDist = length(carDir);\n\n      if(carDist < 100.0) {\n        // View distance of 150m\n        float distBrightnessFactor = 1.0 - (carDist - 25.0) / 75.0;\n\n        // Check\n        carDir.y *= 1.75;\n        float coneBrightnessFactor = dot(headlightDir, normalize(carDir));\n        coneBrightnessFactor = (coneBrightnessFactor - 0.8) / 0.2;\n\n\n        // NOTE: Could set the road colour here to save on transparency rendering\n        vBrightness = distBrightnessFactor * coneBrightnessFactor;\n      }\n  }\n\n  vBrightness = max(0., vBrightness);\n\n"),e.vertexShader=e.vertexShader.replace("#include <logdepthbuf_vertex>","\n\n  gl_PointSize = (0.02 + noise*0.025) * ( scale / - mvPosition.z );//0.0;//10. + mvPosition.z;// / 10.0;\n\n\n#include <logdepthbuf_vertex>"),e.fragmentShader=e.fragmentShader.replace("#include <clipping_planes_pars_fragment>","#include <clipping_planes_pars_fragment>\n\n\n  uniform vec3 snowCol;\n  varying float vBrightness;\n  varying float skip;\n\n"),e.fragmentShader=e.fragmentShader.replace("#include <alphatest_fragment>","#include <alphatest_fragment>\n\n\n  if(skip > 0.5) {\n    discard;\n  }\n\n  diffuseColor.rgb = snowCol + vec3(vBrightness);//vBrightness;\n\n"),e);var Va=class{constructor(){this.density=200,this.boxWidth=30,this.boxHeight=30,this.boxWidthHalf=this.boxWidth/2,this.container=new r.G,this.onFirstPersonBound=this.onFirstPerson.bind(this),this.tVec=new r.W,this.camFwd=new r.W,this.speed=1.25,this.weatherDisabled=!1;let e,t,i=[],s=[];for(let n=0;n<=this.density;n++)for(let a=0;a<=this.density;a++)e=n/this.density,t=a/this.density,i.push(e*this.boxWidth,Math.random()*this.boxHeight,t*this.boxWidth),n%3==0&&a%3==0&&s.push(e*this.boxWidth,Math.random()*this.boxHeight,t*this.boxWidth);this.halfGeo=new r.g,this.halfGeo.setAttribute("position",new r.o(s,3)),this.fullGeo=new r.g,this.fullGeo.setAttribute("position",new r.o(i,3)),this.points=new r.K(this.halfGeo,Ya),this.points.position.x-=this.boxWidthHalf,this.points.position.y-=this.boxHeight/2,this.points.position.z-=this.boxWidthHalf,this.container.add(this.points),Xs.addListener(this.onFirstPersonBound)}destroy(){Xs.removeListener(this.onFirstPersonBound)}onFirstPerson(e){Ya.userData.minDist.value=e?.85:0}update(){this.points.visible&&(Us.parent?this.tVec.copy(Us.parent.position):this.tVec.copy(Us.position),Us.getWorldDirection(this.camFwd),this.camFwd.y=0,Us.fwd.copy(this.camFwd).normalize(),this.tVec.add(Us.fwd.multiplyScalar(this.boxWidthHalf)),this.container.position.copy(this.tVec),Ya.userData.time.value=ae.appTime,Ya.userData.offset.value.copy(this.container.position),Ya.userData.headlightOn.value=be.headlights,Ya.userData.headlightDir.value.copy(be.fwd).negate(),Ya.userData.headlightPos.value.copy(be.frontAxlePosition),Ya.uniformsNeedUpdate=!0)}onWeatherCycleChanged(e){this.weatherDisabled=e,this.points.visible=this.points.visible&&!this.weatherDisabled}setWeather(e){e?(this.points.visible=!0,e.half?this.points.geometry=this.halfGeo:this.points.geometry=this.fullGeo,Ya.userData.speed.value=e.speed||1.25,Ya.userData.snowCol.value.setHex(e.colour),Ya.uniformsNeedUpdate=!0):this.points.visible=!1}};const Ua={},Xa=2*Math.PI;var Ja=class extends pi{constructor(...e){super(...e),this.gradients=[],this.heightOffset=150,this.heightInitial=1,this.resolution=2,this.depth=3,this.upscale=5,this.cache={},this.cacheAccess={},this.cacheCount=0,this.maxCached=12,this.cellScaleMetres=1500,this.cellScaleWorld=1500,this.squared=!1,this.compound=!1,this.useQuick=!1,this.resolutions=[],this.smooth=!1;let t=e[1]||{};if(this.seed=e[0]||"foliage",this.heightScale=t.heightScale||1,this.heightInitial="heightInitial"in t?t.heightInitial:1,this.resolution=t.resolution||5,this.depth=t.depth||3,this.upscale=t.upscale||3,this.heightOffset=t.heightOffset||0,this.upscaleFactor=t.upscaleFactor||2,this.squared=t.squared||!1,this.squareLayers=t.squareLayers||this.depth,this.compound=t.compound||!1,this.threshold=t.threshold||.7,this.threshold2=t.threshold2||.8,this.threshold3=t.threshold3||.9,this.smooth=!!t.smooth,this.gap1=this.threshold2-this.threshold,this.gap2=this.threshold3-this.threshold2,this.gap3=1-this.threshold3,null!=t.resolutions)this.resolutions=t.resolutions,this.resolution=this.resolutions[0],this.depth=this.resolutions.length;else{this.resolutions=[this.resolution];for(let e=0;e<this.depth-1;e++)this.resolutions.push(this.calculateNextDepthResolution(this.resolutions[e],e))}this.cellScaleWorld=this.cellScaleMetres}generateCell(e,t){let i,s,n,a,o=new window.alea(this.seed+e+t),r=this.resolution,h=[],l=[];for(i=0;i<this.depth;i++){for(l=[],s=0;s<r;s++)for(l.push([]),n=0;n<r;n++)a=o()*Xa,l[s].push({x:Math.cos(a),y:Math.sin(a)});h.push(l),r=this.getNextDepthResolution(r,i)}return h}calculateNextDepthResolution(e,t){return Math.round(e*this.upscaleFactor)}getNextDepthResolution(e,t){return this.resolutions[t+1]}dotGridGradient(e,t,i,s,n){return this.grad=e[t][i],(s-t)*this.grad.x+(n-i)*this.grad.y}sharpLerp(e,t,i){return(t-e)*i+e}smoothLerp(e,t,i){return(t-e)*(3-2*i)*i*i+e}smootherLerp(e,t,i){return(i*(6*i-15)+10)*i*i*i*(t-e)+e}getXZ(e,t,i){for(Ua.layer of(Ua.d=0,Ua.h=0,Ua.sq=this.resolution,Ua.sqb=Ua.sq-1,Ua.wx=e/this.cellScaleWorld,Ua.wz=t/this.cellScaleWorld,Ua.ox=Math.floor(Ua.wx),Ua.oz=Math.floor(Ua.wz),Ua.px=Ua.wx-Ua.ox,Ua.pz=Ua.wz-Ua.oz,Ua.cell=this.getCell(Ua.ox,Ua.oz),i=i||this.depth,Ua.depth=0,Ua.h=this.heightInitial,Ua.heightFactor=1,Ua.ch=0,Ua.cell)){if(Ua.depth==i)break;Ua.sx=Ua.px*Ua.sq,Ua.sz=Ua.pz*Ua.sq,Ua.ix=Math.floor(Ua.sx),Ua.ix1=Ua.ix+1,Ua.iz=Math.floor(Ua.sz),Ua.iz1=Ua.iz+1,Ua.qx=Ua.sx-Ua.ix,Ua.qz=Ua.sz-Ua.iz,Ua.n0=this.dotGridGradient(Ua.layer,Ua.ix,Ua.iz,Ua.sx,Ua.sz),Ua.ix1<Ua.sq?Ua.n1=this.dotGridGradient(Ua.layer,Ua.ix1,Ua.iz,Ua.sx,Ua.sz):Ua.n1=this.dotGridGradient(this.getCell(Ua.ox+1,Ua.oz)[Ua.depth],0,Ua.iz,Ua.sx-Ua.sq,Ua.sz),Ua.int0=this.sharpLerp(Ua.n0,Ua.n1,Ua.qx),Ua.iz1<Ua.sq?(Ua.n0=this.dotGridGradient(Ua.layer,Ua.ix,Ua.iz1,Ua.sx,Ua.sz),Ua.ix1<Ua.sq?Ua.n1=this.dotGridGradient(Ua.layer,Ua.ix1,Ua.iz1,Ua.sx,Ua.sz):Ua.n1=this.dotGridGradient(this.getCell(Ua.ox+1,Ua.oz)[Ua.depth],0,Ua.iz1,Ua.sx-Ua.sq,Ua.sz)):(Ua.n0=this.dotGridGradient(this.getCell(Ua.ox,Ua.oz+1)[Ua.depth],Ua.ix,0,Ua.sx,Ua.sz-Ua.sq),Ua.ix1<Ua.sq?Ua.n1=this.dotGridGradient(this.getCell(Ua.ox,Ua.oz+1)[Ua.depth],Ua.ix1,0,Ua.sx,Ua.sz-Ua.sq):Ua.n1=this.dotGridGradient(this.getCell(Ua.ox+1,Ua.oz+1)[Ua.depth],0,0,Ua.sx-Ua.sq,Ua.sz-Ua.sq)),Ua.int1=this.sharpLerp(Ua.n0,Ua.n1,Ua.qx),Ua.heightFactor=1/(Ua.depth+1),Ua.h+=this.sharpLerp(Ua.int0,Ua.int1,Ua.qz)*Ua.heightFactor,Ua.sq=this.getNextDepthResolution(Ua.sq,Ua.depth),Ua.depth++}return this.squared&&(Ua.h<0?Ua.h*=-Ua.h*(1+Ua.h)*4:Ua.h*=Ua.h*(1-Ua.h)*4),Ua.h=Ua.h*this.heightScale+this.heightOffset,this.smooth?Ua.h>this.threshold?Ua.h>this.threshold3?2+(Ua.h-this.threshold3)/this.gap3:Ua.h>this.threshold2?1+(Ua.h-this.threshold2)/this.gap2:(Ua.h-this.threshold)/this.gap1:(Ua.h,0):Ua.h>this.threshold?Ua.h>this.threshold3?3:Ua.h>this.threshold2?2:1:0}getXZLayer(e,t,i){for(Ua.layer of(Ua.d=0,Ua.h=0,Ua.sq=this.resolution,Ua.sqb=Ua.sq-1,Ua.wx=e/this.cellScaleWorld,Ua.wz=t/this.cellScaleWorld,Ua.ox=Math.floor(Ua.wx),Ua.oz=Math.floor(Ua.wz),Ua.px=Ua.wx-Ua.ox,Ua.pz=Ua.wz-Ua.oz,Ua.cell=this.getCell(Ua.ox,Ua.oz),Ua.depth=0,Ua.h=this.heightInitial,Ua.heightFactor=1,Ua.ch=0,Ua.cell))if(Ua.depth<i)Ua.sq=this.getNextDepthResolution(Ua.sq,Ua.depth),Ua.depth++;else{if(Ua.depth==this.depth||Ua.depth>i)break;Ua.sx=Ua.px*Ua.sq,Ua.sz=Ua.pz*Ua.sq,Ua.ix=Math.floor(Ua.sx),Ua.ix1=Ua.ix+1,Ua.iz=Math.floor(Ua.sz),Ua.iz1=Ua.iz+1,Ua.qx=Ua.sx-Ua.ix,Ua.qz=Ua.sz-Ua.iz,Ua.n0=this.dotGridGradient(Ua.layer,Ua.ix,Ua.iz,Ua.sx,Ua.sz),Ua.ix1<Ua.sq?Ua.n1=this.dotGridGradient(Ua.layer,Ua.ix1,Ua.iz,Ua.sx,Ua.sz):Ua.n1=this.dotGridGradient(this.getCell(Ua.ox+1,Ua.oz)[Ua.depth],0,Ua.iz,Ua.sx-Ua.sq,Ua.sz),Ua.int0=this.smootherLerp(Ua.n0,Ua.n1,Ua.qx),Ua.iz1<Ua.sq?(Ua.n0=this.dotGridGradient(Ua.layer,Ua.ix,Ua.iz1,Ua.sx,Ua.sz),Ua.ix1<Ua.sq?Ua.n1=this.dotGridGradient(Ua.layer,Ua.ix1,Ua.iz1,Ua.sx,Ua.sz):Ua.n1=this.dotGridGradient(this.getCell(Ua.ox+1,Ua.oz)[Ua.depth],0,Ua.iz1,Ua.sx-Ua.sq,Ua.sz)):(Ua.n0=this.dotGridGradient(this.getCell(Ua.ox,Ua.oz+1)[Ua.depth],Ua.ix,0,Ua.sx,Ua.sz-Ua.sq),Ua.ix1<Ua.sq?Ua.n1=this.dotGridGradient(this.getCell(Ua.ox,Ua.oz+1)[Ua.depth],Ua.ix1,0,Ua.sx,Ua.sz-Ua.sq):Ua.n1=this.dotGridGradient(this.getCell(Ua.ox+1,Ua.oz+1)[Ua.depth],0,0,Ua.sx-Ua.sq,Ua.sz-Ua.sq)),Ua.int1=this.smootherLerp(Ua.n0,Ua.n1,Ua.qx),Ua.heightFactor=this.resolution/Ua.sq,this.compound&&(Ua.heightFactor*=Ua.h),Ua.h+=this.smootherLerp(Ua.int0,Ua.int1,Ua.qz)*Ua.heightFactor,Ua.sq=this.getNextDepthResolution(Ua.sq,Ua.depth),Ua.depth++}return this.squared&&(Ua.h*=Ua.h),Ua.h+=Ua.ch,Ua.h*this.heightScale+this.heightOffset}smootherLerpW(e){return(e*(6*e-15)+10)*e*e*e*-1+1}sharpLerpW(e){return 1-e}smoothLerpW(e){return-1*(3-2*e)*e*e+1}};const qa={layer:0,d:0,h:0,sq:0,sqb:0,wx:0,wz:0,ox:0,oz:0,px:0,pz:0,cell:null,ix:0,iz:0,depth:0},Ka={...qa};var _a=class extends pi{constructor(...e){super(...e),this.resolution=5,this.depth=3,this.upscale=2,this.heightScale=1,this.heightOffset=0,this.upscaleType=0,this.controls=[],this.cache={},this.cacheAccess={},this.cacheCount=0,this.maxCached=9,this.qCache={},this.smoothingFunc=()=>{},this.useQuick=!1;let t=e[1]||{};switch(null!==t.heightScale&&(this.heightScale=t.heightScale),null!==t.resolution&&(this.resolution=t.resolution),this.seed=e[0]||ui,this.depth=t.depth||3,this.radiusType=null==t.radiusType?1:t.radiusType,this.upscale=t.upscale||2,this.upscaleType=null==t.upscaleType?0:t.upscaleType,this.upscaleFactor=null==t.upscaleFactor?2:t.upscaleFactor,this.threshold=t.threshold,this.threshold2=t.threshold2,this.threshold3=t.threshold3,this.squared=t.squared||!1,this.compound=t.compound||!1,this.depthHeightFactor=t.depthHeightFactor||1,this.smoothLerpIndex=null==t.smoothLerp?2:t.smoothLerp,this.smoothLerpIndex){case 2:this.smoothingFunc=this.smootherLerp;break;case 1:this.smoothingFunc=this.smoothLerp;break;case 0:default:this.smoothingFunc=this.sharpLerp}if(null!=t.resolutions)this.resolutions=t.resolutions,this.resolution=this.resolutions[0],this.depth=this.resolutions.length;else{this.resolutions=[this.resolution];for(let e=0;e<this.depth-1;e++)this.resolutions.push(this.calculateNextDepthResolution(this.resolutions[e],e))}this.controls=[],this.cellScaleMetres=1e3,this.cellScaleWorld=3e3,this.heightOffset=t.heightOffset}cosLerp(e){return Math.cos(3.1415*e)+1}sharpLerp(e){return 1-e}smoothLerp(e){return-1*(3-2*e)*e*e+1}smootherLerp(e){return(e*(6*e-15)+10)*e*e*e*-1+1}sharpLerpAB(e,t,i){return(t-e)*i+e}smootherLerpAB(e,t,i){return(i*(6*i-15)+10)*i*i*i*(t-e)+e}lerpHeight(e,t,i,s){return(e=(s.x-t)*(s.x-t)+(s.z-i)*(s.z-i))<s.r2?this.sharpLerp(e/s.r2)*s.y:0}clearCache(){if(this.cacheCount<=this.maxCached)return;let e,t;for(e in this.cache){for(t in this.cache[e])if(this.cacheAccess[e][t])this.cacheAccess[e][t]=!1;else if(delete this.cache[e][t],delete this.cacheAccess[e][t],this.cacheCount--,this.cacheCount<=this.maxCached)break;if(this.cacheCount<=this.maxCached)break}}cacheCell(e,t){let i;this.cacheCount++,this.clearCache();let s=[],n=1,a=new window.alea(this.seed+e+t),o=this.resolution,r=[],h=this.depthHeightFactor;for(i=0;i<this.depth;i++){let e,t,l,d,c;for(o=this.resolutions[i],n=this.resolution/o*h,h*=this.depthHeightFactor,r=[],c=1/o,t=0;t<o;t++){for(e=[],l=0;l<o;l++)d=2*a()-1,this.squared&&(d*=d<0?-d*(1+d)*4:d*(1-d)*4),d*=n,e.push({x:(t+.5)/o,y:d*this.heightScale,z:(l+.5)/o,r:c,r2:c*c});r.push(e)}s.push(r)}e in this.cache||(this.cache[e]={}),this.cache[e][t]=s}calculateNextDepthResolution(e,t){switch(this.upscaleType){case 5:let i,s=this.resolution,n=this.resolution;for(let e=0;e<t+1;e++)i=s+n,n=s,s=i;return i;case 4:return e*this.upscaleFactor+(t+1);case 3:return Math.round(e*this.upscaleFactor);case 2:return Math.pow(this.resolution,t+2);case 1:return this.resolution+Math.pow(this.upscale,t+1);case 0:default:return e+this.upscale*(t+1)}}getNextDepthResolution(e,t){return this.resolutions[t+1]}getResolution(e,t){return this.resolutions[t]}getNode(e,t,i,s){}getCell(e,t){return e in this.cacheAccess||(this.cacheAccess[e]={}),this.cacheAccess[e][t]=!0,this.cache[e]&&this.cache[e][t]||this.cacheCell(e,t),e in this.cacheAccess||(this.cacheAccess[e]={}),this.cacheAccess[e][t]=!0,this.cache[e][t]}getQuickCell(e,t){return this.cache[e]&&this.cache[e][t]||this.cacheCell(e,t),e in this.cacheAccess||(this.cacheAccess[e]={}),this.cacheAccess[e][t]=!0,this.qCache[e]&&this.qCache[e][t]||this.quickCache(e,t,this.cache[e][t][this.depth-1]),this.qCache[e][t]}quickCache(e,t,i){if(e in this.qCache){if(t in this.qCache[e])return}else this.qCache[e]={};let s=[];this.useQuick=!1;for(let n of i){let i=[];for(let s of n)i.push({x:s.x,y:this.getXZ((e+s.x)*this.cellScaleWorld,(t+s.z)*this.cellScaleWorld),z:s.z,r:s.r,r2:s.r2});s.push(i)}this.useQuick=!0,this.qCache[e][t]=s}getXZQuick(e,t){let i,s,n,a,o,r;return Ka.d=0,Ka.h=0,Ka.wx=e/this.cellScaleWorld,Ka.wz=t/this.cellScaleWorld,Ka.ox=Math.floor(Ka.wx),Ka.oz=Math.floor(Ka.wz),Ka.px=Ka.wx-Ka.ox,Ka.pz=Ka.wz-Ka.oz,Ka.layer=this.getQuickCell(Ka.ox,Ka.oz),Ka.sq=this.getResolution(this.resolution,this.depth-1),Ka.sqb=Ka.sq-1,Ka.ssq=Ka.sq,Ka.ssqb=Ka.sqb,i=Ka.px*Ka.sq-.5,Ka.ix=Math.floor(Ka.px*Ka.sq-.5),s=Ka.pz*Ka.sq-.5,Ka.iz=Math.floor(Ka.pz*Ka.sq-.5),i-=Ka.ix,s-=Ka.iz,Ka.ix>=0?(n=Ka.iz>=0?Ka.layer[Ka.ix][Ka.iz].y:this.getQuickCell(Ka.ox,Ka.oz-1)[Ka.ix][Ka.sqb].y,a=Ka.iz<Ka.ssqb?Ka.layer[Ka.ix][Ka.iz+1].y:this.getQuickCell(Ka.ox,Ka.oz+1)[Ka.ix][0].y):(n=Ka.iz>=0?this.getQuickCell(Ka.ox-1,Ka.oz)[Ka.sqb][Ka.iz].y:this.getQuickCell(Ka.ox-1,Ka.oz-1)[Ka.sqb][Ka.sqb].y,a=Ka.iz<Ka.ssqb?this.getQuickCell(Ka.ox-1,Ka.oz)[Ka.sqb][Ka.iz+1].y:this.getQuickCell(Ka.ox-1,Ka.oz+1)[Ka.sqb][0].y),Ka.ix<Ka.ssqb?(o=Ka.iz>=0?Ka.layer[Ka.ix+1][Ka.iz].y:this.getQuickCell(Ka.ox,Ka.oz-1)[Ka.ix+1][Ka.sqb].y,r=Ka.iz<Ka.ssqb?Ka.layer[Ka.ix+1][Ka.iz+1].y:this.getQuickCell(Ka.ox,Ka.oz+1)[Ka.ix+1][0].y):(o=Ka.iz>=0?this.getQuickCell(Ka.ox+1,Ka.oz)[0][Ka.iz].y:this.getQuickCell(Ka.ox+1,Ka.oz-1)[0][Ka.sqb].y,r=Ka.iz<Ka.ssqb?this.getQuickCell(Ka.ox+1,Ka.oz)[0][Ka.iz+1].y:this.getQuickCell(Ka.ox+1,Ka.oz+1)[0][0].y),n=this.sharpLerpAB(n,a,s),o=this.sharpLerpAB(o,r,s),this.sharpLerpAB(n,o,i)}getXZLayer(e,t,i){qa.layer=0,qa.d=0,qa.h=0,qa.sq=this.resolution,qa.sqb=qa.sq-1,qa.wx=e/this.cellScaleWorld,qa.wz=t/this.cellScaleWorld,qa.ox=Math.floor(qa.wx),qa.oz=Math.floor(qa.wz),qa.px=qa.wx-qa.ox,qa.pz=qa.wz-qa.oz,qa.cell=this.getCell(qa.ox,qa.oz);let s=this.depth;qa.depth=0;let n=0;for(qa.layer of qa.cell)if(n++===i){if(qa.depth==s)break;qa.ix=Math.floor(qa.px*qa.sq-.5),qa.iz=Math.floor(qa.pz*qa.sq-.5),qa.th=0,qa.ix>=0?(qa.iz>=0?qa.th+=this.lerpHeight(qa.d,qa.px,qa.pz,qa.layer[qa.ix][qa.iz]):qa.th+=this.lerpHeight(qa.d,qa.px,qa.pz+1,this.getCell(qa.ox,qa.oz-1)[qa.depth][qa.ix][qa.sqb]),qa.iz<qa.sqb?qa.th+=this.lerpHeight(qa.d,qa.px,qa.pz,qa.layer[qa.ix][qa.iz+1]):qa.th+=this.lerpHeight(qa.d,qa.px,qa.pz-1,this.getCell(qa.ox,qa.oz+1)[qa.depth][qa.ix][0])):(qa.iz>=0?qa.th+=this.lerpHeight(qa.d,qa.px+1,qa.pz,this.getCell(qa.ox-1,qa.oz)[qa.depth][qa.sqb][qa.iz]):qa.th+=this.lerpHeight(qa.d,qa.px+1,qa.pz+1,this.getCell(qa.ox-1,qa.oz-1)[qa.depth][qa.sqb][qa.sqb]),qa.iz<qa.sqb?qa.th+=this.lerpHeight(qa.d,qa.px+1,qa.pz,this.getCell(qa.ox-1,qa.oz)[qa.depth][qa.sqb][qa.iz+1]):qa.th+=this.lerpHeight(qa.d,qa.px+1,qa.pz-1,this.getCell(qa.ox-1,qa.oz+1)[qa.depth][qa.sqb][0])),qa.ix<qa.sqb?(qa.iz>=0?qa.th+=this.lerpHeight(qa.d,qa.px,qa.pz,qa.layer[qa.ix+1][qa.iz]):qa.th+=this.lerpHeight(qa.d,qa.px,qa.pz+1,this.getCell(qa.ox,qa.oz-1)[qa.depth][qa.ix+1][qa.sqb]),qa.iz<qa.sqb?qa.th+=this.lerpHeight(qa.d,qa.px,qa.pz,qa.layer[qa.ix+1][qa.iz+1]):qa.th+=this.lerpHeight(qa.d,qa.px,qa.pz-1,this.getCell(qa.ox,qa.oz+1)[qa.depth][qa.ix+1][0])):(qa.iz>=0?qa.th+=this.lerpHeight(qa.d,qa.px-1,qa.pz,this.getCell(qa.ox+1,qa.oz)[qa.depth][0][qa.iz]):qa.th+=this.lerpHeight(qa.d,qa.px-1,qa.pz+1,this.getCell(qa.ox+1,qa.oz-1)[qa.depth][0][qa.sqb]),qa.iz<qa.sqb?qa.th+=this.lerpHeight(qa.d,qa.px-1,qa.pz,this.getCell(qa.ox+1,qa.oz)[qa.depth][0][qa.iz+1]):qa.th+=this.lerpHeight(qa.d,qa.px-1,qa.pz-1,this.getCell(qa.ox+1,qa.oz+1)[qa.depth][0][0])),qa.h+=qa.th,qa.depth++,qa.sq=this.resolutions[qa.depth],qa.sqb=qa.sq-1}else qa.depth++,qa.sq=this.resolutions[qa.depth],qa.sqb=qa.sq-1;return qa.h+this.heightOffset}getXZ(e,t,i){for(qa.layer of(qa.d=0,qa.h=0,qa.heightFactor=1,qa.sq=this.resolution,qa.sqb=qa.sq-1,qa.wx=e/this.cellScaleWorld,qa.wz=t/this.cellScaleWorld,qa.ox=Math.floor(qa.wx),qa.oz=Math.floor(qa.wz),qa.px=qa.wx-qa.ox,qa.pz=qa.wz-qa.oz,qa.cell=this.getCell(qa.ox,qa.oz),i=i||this.depth,qa.depth=0,qa.cell)){if(qa.depth==i)break;qa.ix=Math.floor(qa.px*qa.sq-.5),qa.iz=Math.floor(qa.pz*qa.sq-.5),qa.th=0,qa.ix>=0?(qa.iz>=0?qa.th+=this.lerpHeight(qa.d,qa.px,qa.pz,qa.layer[qa.ix][qa.iz]):qa.th+=this.lerpHeight(qa.d,qa.px,qa.pz+1,this.getCell(qa.ox,qa.oz-1)[qa.depth][qa.ix][qa.sqb]),qa.iz<qa.sqb?qa.th+=this.lerpHeight(qa.d,qa.px,qa.pz,qa.layer[qa.ix][qa.iz+1]):qa.th+=this.lerpHeight(qa.d,qa.px,qa.pz-1,this.getCell(qa.ox,qa.oz+1)[qa.depth][qa.ix][0])):(qa.iz>=0?qa.th+=this.lerpHeight(qa.d,qa.px+1,qa.pz,this.getCell(qa.ox-1,qa.oz)[qa.depth][qa.sqb][qa.iz]):qa.th+=this.lerpHeight(qa.d,qa.px+1,qa.pz+1,this.getCell(qa.ox-1,qa.oz-1)[qa.depth][qa.sqb][qa.sqb]),qa.iz<qa.sqb?qa.th+=this.lerpHeight(qa.d,qa.px+1,qa.pz,this.getCell(qa.ox-1,qa.oz)[qa.depth][qa.sqb][qa.iz+1]):qa.th+=this.lerpHeight(qa.d,qa.px+1,qa.pz-1,this.getCell(qa.ox-1,qa.oz+1)[qa.depth][qa.sqb][0])),qa.ix<qa.sqb?(qa.iz>=0?qa.th+=this.lerpHeight(qa.d,qa.px,qa.pz,qa.layer[qa.ix+1][qa.iz]):qa.th+=this.lerpHeight(qa.d,qa.px,qa.pz+1,this.getCell(qa.ox,qa.oz-1)[qa.depth][qa.ix+1][qa.sqb]),qa.iz<qa.sqb?qa.th+=this.lerpHeight(qa.d,qa.px,qa.pz,qa.layer[qa.ix+1][qa.iz+1]):qa.th+=this.lerpHeight(qa.d,qa.px,qa.pz-1,this.getCell(qa.ox,qa.oz+1)[qa.depth][qa.ix+1][0])):(qa.iz>=0?qa.th+=this.lerpHeight(qa.d,qa.px-1,qa.pz,this.getCell(qa.ox+1,qa.oz)[qa.depth][0][qa.iz]):qa.th+=this.lerpHeight(qa.d,qa.px-1,qa.pz+1,this.getCell(qa.ox+1,qa.oz-1)[qa.depth][0][qa.sqb]),qa.iz<qa.sqb?qa.th+=this.lerpHeight(qa.d,qa.px-1,qa.pz,this.getCell(qa.ox+1,qa.oz)[qa.depth][0][qa.iz+1]):qa.th+=this.lerpHeight(qa.d,qa.px-1,qa.pz-1,this.getCell(qa.ox+1,qa.oz+1)[qa.depth][0][0])),qa.h+=qa.th,qa.depth++,qa.sq=this.resolutions[qa.depth],qa.sqb=qa.sq-1}return qa.h+=this.heightOffset,qa.h>this.threshold?qa.h>this.threshold3?(qa.th*=qa.th,qa.th>.11?qa.th>.13?2:1:0):qa.h>this.threshold2?1:2:3}};var $a=new class{constructor(){this.lib={trees:{},brush:{}},this.randMaps={trees:[[],[],[]],brush:[]},this.stagedTiles={trees:{},brush:{}},this.hasTrees=!0,this.hasGrass=!0,this.rand=new window.alea(Ee),this.rands=[],this.randIndex=0,this.farTreeInstancePool=[],this.buildLibrary(),this.buildRandMaps(),this.buildRands()}buildMap(e){this.treeMap=new _a(Ee,e),this.grassMap=new Ja(Ee,{heightScale:2,heightOffset:.5,heightInitial:0,resolutions:[5],threshold:.05,threshold2:.25,threshold3:.5,smooth:!0})}buildRandMaps(){let e,t,i;for(e=1;e<=8;e++)for(i=0;i<this.randMaps.trees.length;i++){let e=[],s=Math.ceil(1.4*(i+this.rand())),n=.05,a=1-2*n;for(t=0;t<s;t++)e.push(n+this.rand()*a,n+this.rand()*a);this.randMaps.trees[i].push(e)}}buildRands(){for(let e=0;e<101;e++)this.rands.push(this.rand())}getRand(){return this.randIndex>=this.rands.length&&(this.randIndex=0),this.rands[this.randIndex++]}getTreesAt(e,t){return this.t=this.treeMap.getXZ(e,t),this.t?this.getSeededTreeMap(this.t,(e+t)/10):null}getSeededTreeMap(e,t){return this.randMaps.trees[e-1][7&t]}getTreeMap(e){return this.randMaps.trees[e-1][Math.floor(8*this.getRand())]}buildLibrary(){let e=new r.g,t=new Float32Array([-.5,0,0,-.5,1,0,.5,1,0,.5,0,0,0,0,.5,0,1,.5,0,1,-.5,0,0,-.5]);e.setAttribute("position",new r.o(t,3));let i=new Float32Array([0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0]);e.setAttribute("normal",new r.o(i,3));let s=new Float32Array([0,0,0,.49,.5,.49,.5,0,0,0,0,.49,.5,.49,.5,0]);e.setAttribute("uv",new r.o(s,2));e.setIndex([0,1,2,0,2,3,4,5,6,4,6,7]),this.baseGeo=e;let n=e.clone();n.scale(8,8,8),this.lib.trees.far={geo:n,mat:Ps[0]};let a=e.clone(),o=new Float32Array([0,0,0,.49,.25,.49,.25,0,.25,0,.25,.49,.5,.49,.5,0]);a.setAttribute("uv",new r.o(o,2));let h=a.clone();h.scale(8,8,8),this.lib.trees.near={geo:h,mat:Ps[1]};let l=e.clone();l.scale(1.6,1.6,1.6),this.lib.brush.grass={geo:l,mat:Fs[0]};let d=a.clone();d.scale(1.6,1.6,1.6),this.lib.brush.bush={geo:d,mat:Fs[1]}}getGrassInstance(e){let t=new r.u(this.lib.brush.grass.geo.clone(),this.lib.brush.grass.mat,e);return t.matrixAutoUpdate=!1,t.geometry.setAttribute("variant",new r.t(new Float32Array(e),1)),t.instanceVariant=t.geometry.attributes.variant,t.instanceVariant.setUsage(r.l),t.geometry.setAttribute("shadow",new r.t(new Float32Array(e),1)),t.instanceShadow=t.geometry.attributes.shadow,t.instanceShadow.setUsage(r.l),t.position.y=-.1,t.instanceMatrix.setUsage(r.l),t}getBushInstance(e){let t=new r.u(this.lib.brush.bush.geo.clone(),this.lib.brush.bush.mat,e);return t.matrixAutoUpdate=!1,t.geometry.setAttribute("variant",new r.t(new Float32Array(e),1)),t.instanceVariant=t.geometry.attributes.variant,t.instanceVariant.setUsage(r.l),t.geometry.setAttribute("shadow",new r.t(new Float32Array(e),1)),t.instanceShadow=t.geometry.attributes.shadow,t.instanceShadow.setUsage(r.l),t.position.y=-.1,t.instanceMatrix.setUsage(r.l),t}prepareTreeInstance(e,t,i=!0){e.geometry.setAttribute("variant",new r.t(new Float32Array(t),1)),e.instanceVariant=e.geometry.attributes.variant,e.instanceVariant.setUsage(r.l),i&&(e.geometry.setAttribute("shadow",new r.t(new Float32Array(t),1)),e.instanceShadow=e.geometry.attributes.shadow,e.instanceShadow.setUsage(r.l)),e.position.y=-.5,e.instanceMatrix.setUsage(r.l)}getNearTreeDetailInstance(e){let t=new r.u(this.lib.trees.detail.geo.clone(),this.lib.trees.detail.mat,e);return t.matrixAutoUpdate=!1,t.frustumCulled=!0,this.prepareTreeInstance(t,e,!1),t}getNearTreeInstance(e){let t=new r.u(this.lib.trees.near.geo.clone(),this.lib.trees.near.mat,e);return t.matrixAutoUpdate=!1,this.prepareTreeInstance(t,e,!1),t}returnFarTreeInstance(e){e.visible=!1,e.count=0,this.farTreeInstancePool.push(e)}getFarTreeInstance(e){if(this.farTreeInstancePool.length)return this.farTreeInstancePool.pop();let t=new r.u(this.lib.trees.far.geo.clone(),this.lib.trees.far.mat,e);return t.matrixAutoUpdate=!1,t.frustumCulled=!0,this.prepareTreeInstance(t,e,!1),t}};const eo=new r.A;class to{constructor(){this.initNodeIndex=0,this.retireNodeIndex=-1,this.showNodeIndex=0}}var io=class{constructor(e,t,i=50,s=null){this.lodInstances=[[],[]],this.stagedInstances=[[],[]],this.activeInstances=[[],[]],this.currentInstances=[],this.minRenderDist=50,this.maxInstanceRange=50,this.debug=!1,this.skipLod=null,this.instanceCounter=0,this.container=new r.G,this.instanceType=e,this.skipLod=s,this.instanceCount=t,this.minRenderDist=i,this.maxInstanceRange=i}revert(e,t){this.instanceCount=e||this.instanceCount,this.minRenderDist=t||this.minRenderDist,this.maxInstanceRange=this.minRenderDist,this.destroy(),this.lodInstances[0].length=0,this.lodInstances[1].length=0,this.stagedInstances[0].length=0,this.stagedInstances[1].length=0,this.activeInstances[0].length=0,this.activeInstances[1].length=0,this.initialise()}reset(){for(let e of this.currentInstances)null!=e&&(e.index=0,e.showNodeIndex=0,e.retireNodeIndex=0,e.initNodeIndex=0,e.mesh.count=0,e.mesh.visible=!1);this.lodInstances[0].length=0,this.lodInstances[1].length=0,this.stagedInstances[0].length=0,this.stagedInstances[1].length=0,this.activeInstances[0].length=0,this.activeInstances[1].length=0}destroy(){this.container.traverse((e=>{e.isMesh&&e.geometry.dispose()})),this.container.clear()}initialise(){0!==this.skipLod&&(tn["instance-"+this.instanceType.typeName+"-0"]=1,this.currentInstances[0]=this.getInstance(ii.head.p)),1!==this.skipLod&&(tn["instance-"+this.instanceType.typeName+"-1"]=1,this.currentInstances[1]=this.getInstance(ii.head.p))}initInstance(e){}getInstance(e=null){let t=new this.instanceType;return t.mesh.matrixAutoUpdate=!1,e&&(t.mesh.position.copy(e),t.mesh.updateMatrix()),t.mesh.visible=!1,t.iid=this.instanceCounter++,this.container.add(t.mesh),t}addInstance(e,t,i,s,n,a=null,o=0){let r=this.currentInstances[e];0==r.index?this.stageInstance(e,r,s,n):r.retireNodeIndex=s+3,eo.makeTranslation(-r.mesh.position.x,-r.mesh.position.y,-r.mesh.position.z),t.premultiply(eo),r.mesh.setMatrixAt(r.index,t),r.index++,r.index>=this.instanceCount&&this.cycleInstances(e)}stageInstance(e,t,i,s){t.initNodeIndex=i,t.showNodeIndex=i-this.minRenderDist,t.retireNodeIndex=i+this.maxInstanceRange+3,t.mesh.position.copy(s),t.mesh.updateMatrix(),this.stagedInstances[e].push(t)}updateInstanceState(e){e.mesh.instanceMatrix.needsUpdate=!0,e.mesh.count=Math.min(this.instanceCount,Math.max(0,e.index))}updateCurrentInstance(e){let t=this.currentInstances[e];ii.vehicleIndex>=t.showNodeIndex&&this.updateInstanceState(t)}initialiseVisible(){let e,t;do{e=this.stagedInstances[0].length,t=this.stagedInstances[1].length,this.updateVisible()}while(e!=this.stagedInstances[0].length||t!==this.stagedInstances[1].length)}updateVisible(){0!==this.skipLod&&(this.t=this.stagedInstances[0],this.t.length&&ii.vehicleIndex>=this.t[0].showNodeIndex&&(this.updateInstanceState(this.t[0]),this.t[0].mesh.visible=!0,this.activeInstances[0].push(this.t.shift())),this.t=this.activeInstances[0],this.t.length&&this.t[0].retireNodeIndex<=ii.vehicleIndex&&(this.t[0].mesh.visible=!1,this.lodInstances[0].push(this.activeInstances[0].shift())),this.currentInstances[0].index&&ii.vehicleIndex>=this.currentInstances[0].initNodeIndex&&this.cycleInstances(0),tn["instance-"+this.instanceType.typeName+"-0"]=this.activeInstances[0].length+"("+this.stagedInstances[0].length+")"),1!==this.skipLod&&(this.t=this.stagedInstances[1],this.t.length&&ii.vehicleIndex>=this.t[0].showNodeIndex&&(this.updateInstanceState(this.t[0]),this.t[0].mesh.visible=!0,this.activeInstances[1].push(this.t.shift())),this.t=this.activeInstances[1],this.t.length&&this.t[0].retireNodeIndex<=ii.vehicleIndex&&(this.t[0].mesh.visible=!1,this.lodInstances[1].push(this.activeInstances[1].shift())),this.currentInstances[1].index&&ii.vehicleIndex>=this.currentInstances[1].initNodeIndex&&this.cycleInstances(1),tn["instance-"+this.instanceType.typeName+"-1"]=this.activeInstances[1].length+"("+this.stagedInstances[1].length+")")}cycleInstances(e){let t=this.currentInstances[e];t.mesh.count!=t.index&&this.updateInstanceState(t),this.lodInstances[e].length?t=this.lodInstances[e].pop():(t=this.getInstance(),tn["instance-"+this.instanceType.typeName+"-"+e]=this.activeInstances[e].length+"("+(this.stagedInstances[e].length+1)+")"),t.index=0,t.mesh.count=0,t.mesh.visible=!1,this.currentInstances[e]=t}};const so=new r.A;var no=class extends io{addInstance(e,t,i,s,n,a=null,o=null){this.temp=this.currentInstances[e],0==this.temp.index?this.stageInstance(e,this.temp,s,n):s>this.temp.retireNodeIndex&&(this.temp.retireNodeIndex=s),so.makeTranslation(-this.temp.mesh.position.x,-this.temp.mesh.position.y,-this.temp.mesh.position.z),t.premultiply(so),this.temp.mesh.setMatrixAt(this.temp.index,t),this.temp.mesh.instanceVariant.array[this.temp.index]=i,null!==o&&(this.temp.mesh.instanceShadow.array[this.temp.index]=o),this.temp.index++,this.temp.index>=this.instanceCount&&this.cycleInstances(e,s,n)}updateInstanceState(e){e.mesh.instanceMatrix.needsUpdate=!0,e.mesh.instanceVariant.needsUpdate=!0,e.mesh.instanceShadow&&(e.mesh.instanceShadow.needsUpdate=!0),e.mesh.count=Math.min(this.instanceCount,Math.max(0,e.index))}updateCurrentInstance(e){let t=this.currentInstances[e];ii.vehicleIndex>=t.showNodeIndex&&t.mesh.count<t.index&&this.updateInstanceState(t)}cycleInstances(e){let t=this.currentInstances[e];t.retireNodeIndex+=5,t.mesh.count!=t.index&&this.updateInstanceState(t),this.lodInstances[e].length?t=this.lodInstances[e].pop():(t=this.getInstance(),tn["instance-"+this.instanceType.typeName+"-"+e]=this.activeInstances[e].length+"("+this.stagedInstances[e].length+")"),t.index=0,t.mesh.count=0,t.mesh.visible=!1,this.currentInstances[e]=t}};class ao extends to{constructor(){super(),this.index=0,this.mesh=$a.getNearTreeInstance(zs),this.retireNodeIndex=-1,this.showNodeIndex=0}}ao.typeName="trees";var oo=new no(ao,zs,Ls,1);class ro extends to{constructor(){super(),this.index=0,this.mesh=$a.getGrassInstance(Bs),this.mesh.receiveShadow=Sh.value.detailLodIndex>0,this.retireNodeIndex=-1,this.showNodeIndex=0}}ro.typeName="grass";var ho=new no(ro,Bs,Rs);class lo extends to{constructor(){super(),this.index=0,this.mesh=$a.getBushInstance(Ws),this.mesh.receiveShadow=Sh.value.detailLodIndex>1,this.retireNodeIndex=-1,this.showNodeIndex=0}}lo.typeName="bush";var co=new no(lo,Ws,Rs,0);const po={},uo=new r.G,go=new Gn(157),mo=new Gn(157,1,.5),xo=new Gn(103,6.28),vo=new Gn(101,4),wo=new Gn(101,.4),fo={};class bo extends oi{constructor(...e){super(...e),this.treeDensity=!1,this.forceTrees=!1,this.trees=[],this.treeMaskCorners=[],this.treeDensity=0,this.renderFoliage=!0}display(...e){super.display(...e),1==this.lod&&this.tileset.mesh.visible&&(ho.updateCurrentInstance(1),co.updateCurrentInstance(1))}preInitialise(e){var t;if(this.forceTrees=e,this.trees.length=0,this.renderFoliage=Sh.value.detailLodIndex>0,fo.treeMask=null===(t=po[this.farCell.x])||void 0===t?void 0:t[this.farCell.z],!fo.treeMask)return!1;fo.res1=Mt+1,fo.treeIndex=this.tileCoords.x*fo.res1+this.tileCoords.z,this.treeMaskCorners[0]=fo.treeMask[fo.treeIndex],this.treeMaskCorners[1]=fo.treeMask[fo.treeIndex+fo.res1],this.treeMaskCorners[2]=fo.treeMask[fo.treeIndex+1],this.treeMaskCorners[3]=fo.treeMask[fo.treeIndex+1+fo.res1],this.treeDensity=this.treeMaskCorners.reduce(((e,t)=>e+t),0)/4;let i=$a.getTreesAt(this.originPos.x,this.originPos.z);if(i){let e,t,s;for(t=0;t<i.length;t+=2)s=xo.next(),e={position:[i[t],i[t+1]],rotation:s,type:Math.round(s/2)},s=ti(e.position[0]*Rt+this.originPos.x,e.position[1]*Rt+this.originPos.z,this.originNode,!1),s.e=Vt+Math.abs(s.da),s.d-(s.w+s.e)>2&&this.trees.push(e)}else if(this.originNode.dswl||this.originNode.dswr){let e=ti(this.originPos.x+5,this.originPos.z+5,this.originNode);if(e.d<e.w+4&&(e.s>0&&this.originNode.dswl||e.s<0&&this.originNode.dswr)){let t=(e.w+2-e.d)/10;t>0&&t<.2&&this.trees.push({position:[.5-t*this.originNode.n.x*e.s,.5-t*this.originNode.n.z*e.s],rotation:15*t,type:Math.floor(12*t)})}}return!0}postProcessRow(e){this.placeGrassRow(e)}postProcessCell(){if(0==this.lod||this.forceTrees){let e,t,i;for(let s of this.trees)e=Math.floor(s.position[0]*this.res),t=Math.floor(s.position[1]*this.res),i=e*this.res1+t,this.grads[i]<.2&&this.heights[i]>1&&(uo.position.set((this.coords.x+s.position[0])*Rt,this.heights[i]-(.5+this.grads[i]),(this.coords.z+s.position[1])*Rt),fo.tms=.15*(3*this.treeDensity-1)+1,fo.hb=fo.tms+(wo.next()-.2)*fo.tms,uo.scale.set(fo.hb,fo.hb,fo.hb),uo.rotation.y=s.rotation,uo.updateMatrix(),oo.addInstance(0,uo.matrix,s.type,this.originIndex,uo.position))}}nearestTreeDist(e,t){let i,s=-1;for(let n of this.trees)i=(n.position[0]-e)*(n.position[0]-e)+(n.position[1]-t)*(n.position[1]-t),(i<s||s<0)&&(s=i);return s}placeGrassRow(e){for(fo.j=0;fo.j<=this.res;fo.j++)if(fo.ind=e*this.res1+fo.j,fo.h=this.heights[fo.ind],fo.r=this.signedRoadProx[fo.ind],fo.n=[this.norms[3*fo.ind],this.norms[3*fo.ind+1],this.norms[3*fo.ind+2]],fo.az=e/this.res,fo.ax=fo.j/this.res,fo.ma=this.treeMaskCorners[2]*fo.ax+this.treeMaskCorners[0]*(1-fo.ax),fo.mb=this.treeMaskCorners[3]*fo.ax+this.treeMaskCorners[1]*(1-fo.ax),fo.tm=fo.mb*fo.az+fo.ma*(1-fo.az),fo.r<2&&(fo.tm*=fo.r/2),this.treeMask[fo.ind]=fo.tm,this.renderFoliage&&(fo.grassProb=fo.j<this.res1&&fo.r>.2&&fo.r<20?fo.h>2?this.grads[fo.ind]<.2?1:.4-this.grads[fo.ind]:fo.h-1:0,fo.grassProb>go.next())){if(fo.r<Vt?fo.h-=Vt-fo.r:fo.h-=fo.r/20,uo.position.set((this.coords.x+fo.az)*Rt+mo.next(),fo.h-this.grads[fo.ind]/2+.2*mo.next(),(this.coords.z+fo.ax)*Rt+mo.next()),uo.rotation.y=xo.next(),fo.treeProx=this.nearestTreeDist(fo.az,fo.ax),fo.treeProx<0?fo.treeProx=0:(fo.treeProx=.25-Math.min(.25,fo.treeProx/.25),fo.r<4&&(fo.treeProx*=fo.r/4)),this.treeMask[fo.ind]=Math.max(this.treeMask[fo.ind],4*fo.treeProx),fo.treeProx=this.treeMask[fo.ind]/2+Math.abs(this.grads[fo.ind]/2),fo.bushProb=this.treeDensity+.008,fo.bushProb<.5&&(this.originNode.dswl||this.originNode.dswr)&&fo.r>1&&fo.r<1.6&&(fo.side=-this.originNode.n.z*(this.originPos.z+10*fo.az-this.originNode.p.z)-this.originNode.n.x*(this.originPos.x+10*fo.ax-this.originNode.p.x),(this.originNode.dswl&&fo.side>0||this.originNode.dswr&&fo.side<0)&&(fo.bushProb+=.33),fo.bushProb>1&&(fo.bushProb=1)),fo.r<.5||fo.r>4?fo.bushProb=0:fo.r<1?fo.bushProb*=4*(fo.r-.5):fo.r<2?fo.bushProb*=2:fo.r<4&&(fo.bushProb*=4-fo.r),fo.bushProb*=.25,1==this.lod&&fo.bushProb>Math.random()){uo.scale.x=uo.scale.y=uo.scale.z=Math.min(fo.r,1+this.treeDensity*wo.next()),uo.rotation.y=xo.next(),uo.updateMatrix(),co.addInstance(1,uo.matrix,Math.floor(vo.next()),this.originIndex,uo.position,fo.n,fo.treeProx);continue}uo.scale.y=1,fo.r>1?fo.r>2?uo.scale.y+=.5*this.treeDensity:uo.scale.y+=(fo.r-1)*this.treeDensity*.5:uo.scale.y=Math.max(.75,fo.r),uo.scale.x=uo.scale.z=uo.scale.y,uo.updateMatrix(),ho.addInstance(this.lod,uo.matrix,fo.r,this.originIndex,uo.position,fo.n,fo.treeProx)}}}bo.paved=!0;var Ao=bo;const yo={size:1e3,nodes:[[0,0],[200,0],[400,0],[600,0],[750,0],[1e3,0],[0,200],[200,100],[400,100],[550,200],[750,200],[1e3,150],[0,300],[200,300],[300,300],[500,300],[800,350],[1e3,350],[0,500],[150,500],[300,450],[500,450],[600,450],[800,450],[1e3,500],[0,700],[150,700],[300,700],[300,650],[400,650],[600,650],[700,650],[800,650],[1e3,650],[0,850],[200,850],[300,850],[400,850],[500,850],[700,800],[850,800],[1e3,800],[0,1e3],[200,1e3],[300,1e3],[500,1e3],[700,1e3],[850,1e3],[1e3,1e3]],fields:[{nodes:[0,1,7,6],center:[100,75],radius2:25625,radius:160.0781059358212,walls:[0,1,2,3]},{nodes:[1,2,8,7],center:[300,50],radius2:12500,walls:[4,5,6,1],radius:111.80339887498948},{nodes:[2,3,9,8],center:[487.5,75],radius2:19531.25,walls:[7,8,9,5],radius:139.75424859373686},{nodes:[3,4,10,9],center:[662.5,100],radius2:22656.25,walls:[10,11,12,8],radius:150.5199322349037},{nodes:[4,5,11,10],center:[875,87.5],radius2:28281.25,walls:[13,14,15,11],radius:168.17030058842138},{nodes:[6,7,13,12],center:[100,225],radius2:25625,walls:[2,16,17,18],radius:160.0781059358212},{nodes:[7,8,14,13],center:[275,200],radius2:25625,walls:[6,19,20,16],radius:160.0781059358212},{nodes:[8,9,15,14],center:[437.5,225],radius2:24531.25,walls:[9,21,22,19],radius:156.62455107677084},{nodes:[9,10,16,15],center:[650,262.5],radius2:30156.25,walls:[12,23,24,21],radius:173.65554986812256},{nodes:[10,11,17,16],center:[887.5,262.5],radius2:25312.5,walls:[15,25,26,23],radius:159.0990257669732},{nodes:[12,13,19,18],center:[87.5,400],radius2:22656.25,walls:[17,27,28,29],radius:150.5199322349037},{nodes:[13,14,20,19],center:[237.5,387.5],radius2:20312.5,walls:[20,30,31,27],radius:142.52192813739225},{nodes:[14,15,21,20],center:[400,375],radius2:15625,walls:[22,32,33,30],radius:125},{nodes:[15,16,23,22,21],center:[640,400],radius2:29600,walls:[24,34,35,36,32],radius:172.04650534085255},{nodes:[16,17,24,23],center:[900,412.5],radius2:17656.25,walls:[26,37,38,34],radius:132.87682265918312},{nodes:[18,19,26,25],center:[75,600],radius2:15625,walls:[28,39,40,41],radius:125},{nodes:[19,20,28,27,26],center:[240,600],radius2:26100,walls:[31,42,43,44,39],radius:161.55494421403512},{nodes:[20,21,29,28],center:[375,550],radius2:25625,walls:[33,45,46,42],radius:160.0781059358212},{nodes:[21,22,30,29],center:[525,550],radius2:25625,walls:[36,47,48,45],radius:160.0781059358212},{nodes:[22,23,32,31,30],center:[700,570],radius2:24400,walls:[35,49,50,51,47],radius:156.20499351813308},{nodes:[23,24,33,32],center:[900,562.5],radius2:22656.25,walls:[38,52,53,49],radius:150.5199322349037},{nodes:[25,26,35,34],center:[87.5,775],radius2:18281.25,walls:[40,54,55,56],radius:135.2081728298996},{nodes:[26,27,36,35],center:[237.5,775],radius2:13281.25,walls:[44,57,58,54],radius:115.2443057161611},{nodes:[27,28,29,37,36],center:[340,740],radius2:15700,walls:[43,46,59,60,57],radius:125.29964086141668},{nodes:[29,30,38,37],center:[475,750],radius2:25625,walls:[48,61,62,59],radius:160.0781059358212},{nodes:[30,31,39,38],center:[625,737.5],radius2:28281.25,walls:[51,63,64,61],radius:168.17030058842138},{nodes:[31,32,40,39],center:[762.5,725],radius2:13281.25,walls:[50,65,66,63],radius:115.2443057161611},{nodes:[32,33,41,40],center:[912.5,725],radius2:18281.25,walls:[53,67,68,65],radius:135.2081728298996},{nodes:[34,35,43,42],center:[100,925],radius2:15625,walls:[55,69,70,71],radius:125},{nodes:[35,36,37,44,43],center:[280,910],radius2:18e3,walls:[58,60,72,73,69],radius:134.16407864998737},{nodes:[37,38,45,44],center:[425,925],radius2:21250,walls:[62,74,75,72],radius:145.7737973711325},{nodes:[38,39,46,45],center:[600,912.5],radius2:22656.25,walls:[64,76,77,74],radius:150.5199322349037},{nodes:[39,40,47,46],center:[775,900],radius2:15625,walls:[66,78,79,76],radius:125},{nodes:[40,41,48,47],center:[925,900],radius2:15625,walls:[68,80,81,78],radius:125}],walls:[[0,0,200,0],[200,0,200,100],[200,100,0,200],[0,200,0,0],[200,0,400,0],[400,0,400,100],[400,100,200,100],[400,0,600,0],[600,0,550,200],[550,200,400,100],[600,0,750,0],[750,0,750,200],[750,200,550,200],[750,0,1e3,0],[1e3,0,1e3,150],[1e3,150,750,200],[200,100,200,300],[200,300,0,300],[0,300,0,200],[400,100,300,300],[300,300,200,300],[550,200,500,300],[500,300,300,300],[750,200,800,350],[800,350,500,300],[1e3,150,1e3,350],[1e3,350,800,350],[200,300,150,500],[150,500,0,500],[0,500,0,300],[300,300,300,450],[300,450,150,500],[500,300,500,450],[500,450,300,450],[800,350,800,450],[800,450,600,450],[600,450,500,450],[1e3,350,1e3,500],[1e3,500,800,450],[150,500,150,700],[150,700,0,700],[0,700,0,500],[300,450,300,650],[300,650,300,700],[300,700,150,700],[500,450,400,650],[400,650,300,650],[600,450,600,650],[600,650,400,650],[800,450,800,650],[800,650,700,650],[700,650,600,650],[1e3,500,1e3,650],[1e3,650,800,650],[150,700,200,850],[200,850,0,850],[0,850,0,700],[300,700,300,850],[300,850,200,850],[400,650,400,850],[400,850,300,850],[600,650,500,850],[500,850,400,850],[700,650,700,800],[700,800,500,850],[800,650,850,800],[850,800,700,800],[1e3,650,1e3,800],[1e3,800,850,800],[200,850,200,1e3],[200,1e3,0,1e3],[0,1e3,0,850],[400,850,300,1e3],[300,1e3,200,1e3],[500,850,500,1e3],[500,1e3,300,1e3],[700,800,700,1e3],[700,1e3,500,1e3],[850,800,850,1e3],[850,1e3,700,1e3],[1e3,800,1e3,1e3],[1e3,1e3,850,1e3]],nodeToFields:[[0],[0,1],[1,2],[2,3],[3,4],[4],[0,5],[0,1,5,6],[1,2,6,7],[2,3,7,8],[3,4,8,9],[4,9],[5,10],[5,6,10,11],[6,7,11,12],[7,8,12,13],[8,9,13,14],[9,14],[10,15],[10,11,15,16],[11,12,16,17],[12,13,17,18],[13,18,19],[13,14,19,20],[14,20],[15,21],[15,16,21,22],[16,22,23],[16,17,23],[17,18,23,24],[18,19,24,25],[19,25,26],[19,20,26,27],[20,27],[21,28],[21,22,28,29],[22,23,29],[23,24,29,30],[24,25,30,31],[25,26,31,32],[26,27,32,33],[27,33],[28],[28,29],[29,30],[30,31],[31,32],[32,33],[33]]};var Io=yo;let So=St,Mo=2*So*3;const Do=1.45,Co=Qt+1.25,No=new Gn(97),ko=new r.F({map:st(null),side:r.k,flatShading:!0,emissiveIntensity:.01}),zo={};class jo extends r.g{constructor(){super(),this.wallMap=[],this.curVertIndex=0,this.curIndex=0;let e=2*So*3;this.setIndex(new Float32Array(2*(So-1))),this.setAttribute("position",new r.o(new Float32Array(e),3)),this.attributes.position.setUsage(r.l);let t=[],i=0;for(let s=0;s<e;s+=6)t.push(0,i,.45,i),i+=2;this.setAttribute("uv",new r.o(new Float32Array(t),2)),this.attributes.uv.setUsage(r.l),this.matrixAutoUpdate=!1,this.setDrawRange(0,0)}}var Lo=class{constructor(e,t,i,s,n){this.verts=[],this.index=[],this.wallMap=[],this.wallsToDraw=[],this.fieldMap=[],this.leftWallNodes=[],this.rightWallNodes=[],this.curWallIndex=0,this.curVertIndex=0,this.curUVIndex=0,this.curIndex=0,this.fieldMapOffset=new r.V,this.getXZ=()=>{},this.getXZQuick=()=>{},this.addTree=()=>{},this.initialised=!1,this.initCounter=0,this.ready=!1,this.renderWalls=!0,this.distantResolution=20,this.fieldChance=0,this.getXZ=e,this.getXZQuick=t,this.getTreeDensity=i,this.addTree=s,So=St,Mo=2*So*3,this.renderWalls=n,this.geo=new jo,this.verts=this.geo.attributes.position.array,this.uvs=this.geo.attributes.uv.array,this.index=[],this.mesh=new r.B(this.geo,ko),this.mesh.visible=!1,zo.na=new r.V,zo.nb=new r.V,zo.t=new r.V,zo.ti=new r.V,zo.nextVert=new r.V}initialise(e,t=null,i=null,s=!1,n=!0){if(this.originPos=e,this.debug=s,t&&i){if(n)for(this.originNode=t,zo.midNodeIndex=(i.i-t.i)/2,zo.i=0;zo.i<zo.midNodeIndex&&this.originNode.next;zo.i++)this.originNode=this.originNode.next;this.entryNode=t,this.exitNode=i,this.distantResolution=10,this.checkBothDirections=i.i-t.i>.15*St||!n}else this.originNode=null,this.entryNode=null,this.exitNode=null,this.distantResolution=20;this.wallMap.length=0,this.fieldMap.length=0,this.skippedNodes=[],this.wallsToDraw.length=0,this.wallTileOffsets=[],this.wallOffsets=[],this.skippedFieldNodes=[],this.skippedFieldNodeIDs=[],this.skippedFieldNodeOffset=[],this.leftWallNodes.length=0,this.rightWallNodes.length=0,this.index.length=0,this.curWallIndex=0,this.curVertIndex=0,this.curUVIndex=0,this.curIndex=0,n&&this.geo.setDrawRange(0,0),this.fieldMapOffset.x=this.originPos.x%1e3,this.fieldMapOffset.z=this.originPos.z%1e3,this.fieldMapOffset.x<0&&(this.fieldMapOffset.x+=1e3),this.fieldMapOffset.z<0&&(this.fieldMapOffset.z+=1e3),this.initialised=!1,this.initCounter=0,this.ready=!1}continueInitialise(){if(this.initCounter<Io.fields.length){if(zo.fi=this.initCounter,zo.f=Io.fields[this.initCounter++],zo.fX=zo.f.center[0]-this.fieldMapOffset.x,zo.fZ=zo.f.center[1]-this.fieldMapOffset.z,zo.tX=0,zo.tZ=0,zo.fX<0&&(zo.fX+=1e3,zo.tX=1e3),zo.fZ<0&&(zo.fZ+=1e3,zo.tZ=1e3),zo.tX-=this.fieldMapOffset.x,zo.tZ-=this.fieldMapOffset.z,zo.debug=this.debug&&(24==zo.fi||25==zo.fi),zo.fX<St&&zo.fZ<St){for(zo.fn of zo.f.nodes)if(zo.fnn=Io.nodes[zo.fn],zo.fnX=zo.fnn[0]-this.fieldMapOffset.x,zo.fnZ=zo.fnn[1]-this.fieldMapOffset.z,zo.fnX<0&&(zo.fnX+=1e3),zo.fnZ<0&&(zo.fnZ+=1e3),zo.fnX>St||zo.fnZ>St)return;if(zo.h=this.getXZQuick(zo.fX,zo.fZ),zo.h>10&&zo.h<100&&0==this.getTreeDensity(zo.fX,zo.fZ))if(zo.fX+=this.originPos.x,zo.fZ+=this.originPos.z,this.originNode)if(this.checkBothDirections?(zo.rd=ei(zo.fX,zo.fZ,this.entryNode,!0,zo.debug),zo.rd2=ei(zo.fX,zo.fZ,this.exitNode,!0,zo.debug),zo.rd.d2>zo.rd2.d2&&(zo.rd=zo.rd2)):zo.rd=ei(zo.fX,zo.fZ,this.originNode,!0,zo.debug),zo.rd.d2>zo.f.radius2)for(zo.w of zo.f.walls)this.wallMap[zo.w]||(this.wallMap[zo.w]=!0,this.wallOffsets.push([zo.tX,zo.tZ]),this.wallsToDraw.push(Io.walls[zo.w]),this.fieldMap[zo.fi]=!0);else for(zo.sni of zo.f.nodes)this.skippedFieldNodes[zo.sni]=zo.rd.n,this.skippedFieldNodeIDs[zo.sni]=!0,this.skippedFieldNodeOffset[zo.sni]=[zo.tX,zo.tZ];else for(zo.w of zo.f.walls)this.wallMap[zo.w]||(this.wallMap[zo.w]=!0,this.wallOffsets.push([zo.tX,zo.tZ]),this.wallsToDraw.push(Io.walls[zo.w]),this.fieldMap[zo.fi]=!0)}}else{for(zo.rightIndex=-1,zo.leftIndex=-1,zo.ni=0;zo.ni<Io.nodes.length;zo.ni++)if(this.skippedFieldNodeIDs[zo.ni])for(zo.fi of Io.nodeToFields[zo.ni])if(this.fieldMap[zo.fi]){if(zo.node=Io.nodes[zo.ni],zo.offset=this.skippedFieldNodeOffset[zo.ni],zo.rd=ti(zo.node[0]+zo.offset[0]+this.originPos.x,zo.node[1]+zo.offset[1]+this.originPos.z,this.skippedFieldNodes[zo.ni]),zo.rd.d>Io.fields[zo.fi].radius||zo.rd.s<0&&zo.rd.n.g<-1.5||zo.rd.s>0&&zo.rd.n.g>1.5)break;if(zo.doBreak=!1,zo.rd.s<0){for(zo.rwn of this.rightWallNodes)if(1==Math.abs(zo.rd.n.i-zo.rwn.i)){zo.doBreak=!0;break}if(zo.doBreak)break;this.rightWallNodes.push(zo.rd.n),zo.rightIndex=this.wallsToDraw.length}else{for(zo.lwn of this.leftWallNodes)if(1==Math.abs(zo.rd.n.i-zo.lwn.i)){zo.doBreak=!0;break}if(zo.doBreak)break;this.leftWallNodes.push(zo.rd.n),zo.leftIndex=this.wallsToDraw.length}zo.d=Co+.1,zo.na.set(zo.rd.n.p.x-zo.rd.n.n.x*zo.d*zo.rd.s,zo.rd.n.p.z-zo.rd.n.n.z*zo.d*zo.rd.s),this.wallsToDraw.push([zo.node[0],zo.node[1],zo.na.x-this.originPos.x-zo.offset[0],zo.na.y-this.originPos.z-zo.offset[1],zo.rd.n]),this.wallOffsets.push(zo.offset);break}1==this.rightWallNodes.length&&(this.wallsToDraw.splice(zo.rightIndex,1),this.wallOffsets.splice(zo.rightIndex,1),zo.rightIndex<zo.leftIndex&&zo.leftIndex--),1==this.leftWallNodes.length&&(this.wallsToDraw.splice(zo.leftIndex,1),this.wallOffsets.splice(zo.leftIndex,1)),this.initialised=!0,this.ready=this.curWallIndex>=this.wallsToDraw.length}}buildNextWall(){if(this.initialised){if(this.curVertIndex>=Mo||this.curWallIndex>=this.wallsToDraw.length||!this.renderWalls)return this.ready=!0,void this.finalise();for(zo.cwi=this.wallsToDraw.length-1-this.curWallIndex,zo.nodes=this.wallsToDraw[zo.cwi],zo.offset=this.wallOffsets[zo.cwi],zo.na.set(zo.nodes[0],zo.nodes[1]),zo.nb.set(zo.nodes[2],zo.nodes[3]),zo.d=zo.na.distanceTo(zo.nb),zo.t.subVectors(zo.nb,zo.na).normalize(),zo.ti.set(-zo.t.y,zo.t.x),zo.fieldToTile={x:zo.offset[0],z:zo.offset[1]},zo.fieldToWorld={x:zo.fieldToTile.x+this.originPos.x,z:zo.fieldToTile.z+this.originPos.z},zo.refreshIndex=!0,zo.n=zo.nodes[4],zo.nearWall=!!zo.n,zo.distanceBetween=0,zo.minDist=zo.n?1:10,zo.hOffset=this.originPos.y+.6,zo.doBreak=!1;;){if(zo.d<zo.minDist?(zo.na.copy(zo.nb),zo.hOffset+=.2,zo.distanceBetween=zo.d,zo.doBreak=!0):(zo.na.x+=zo.t.x*zo.distanceBetween,zo.na.y+=zo.t.y*zo.distanceBetween),zo.nextVert.copy(zo.na),zo.nearWall&&zo.d<15?(zo.rd=ti(zo.nextVert.x+zo.fieldToWorld.x,zo.nextVert.y+zo.fieldToWorld.z,zo.n),zo.h=oi.lerpHeightGlobal(zo.nextVert.x+zo.fieldToWorld.x,zo.nextVert.y+zo.fieldToWorld.z,zo.rd,this.getXZ)):zo.h=this.getXZQuick(zo.nextVert.x+zo.fieldToTile.x,zo.nextVert.y+zo.fieldToTile.z),zo.nextVert.x+=zo.fieldToTile.x,zo.nextVert.y+=zo.fieldToTile.z,zo.byWater=zo.h<5,zo.h-=zo.hOffset,zo.nearWall&&Sh.value.detailLodIndex>0?(this.verts[this.curVertIndex++]=zo.nextVert.x+.2*zo.ti.x,this.verts[this.curVertIndex++]=zo.h,this.verts[this.curVertIndex++]=zo.nextVert.y+.2*zo.ti.y,this.verts[this.curVertIndex++]=zo.nextVert.x+.1*zo.ti.x,this.verts[this.curVertIndex++]=zo.h+Do,this.verts[this.curVertIndex++]=zo.nextVert.y+.1*zo.ti.y,this.verts[this.curVertIndex++]=zo.nextVert.x-.1*zo.ti.x,this.verts[this.curVertIndex++]=zo.h+Do,this.verts[this.curVertIndex++]=zo.nextVert.y-.1*zo.ti.y,this.verts[this.curVertIndex++]=zo.nextVert.x-.2*zo.ti.x,this.verts[this.curVertIndex++]=zo.h,this.verts[this.curVertIndex++]=zo.nextVert.y-.2*zo.ti.y,this.uvs[this.curUVIndex++]=0,this.uvs[this.curUVIndex++]=.46*zo.d,this.uvs[this.curUVIndex++]=.44,this.uvs[this.curUVIndex++]=.46*zo.d,this.uvs[this.curUVIndex++]=.56,this.uvs[this.curUVIndex++]=.46*zo.d,this.uvs[this.curUVIndex++]=1,this.uvs[this.curUVIndex++]=.46*zo.d,zo.refreshIndex||(zo.ii=this.curIndex-4,this.index.push(zo.ii,zo.ii+5,zo.ii+1,zo.ii,zo.ii+4,zo.ii+5,zo.ii+1,zo.ii+6,zo.ii+2,zo.ii+1,zo.ii+5,zo.ii+6,zo.ii+2,zo.ii+7,zo.ii+3,zo.ii+2,zo.ii+6,zo.ii+7)),this.curIndex+=4,zo.refreshIndex=!1):zo.byWater?zo.refreshIndex=!0:(this.verts[this.curVertIndex++]=zo.nextVert.x,this.verts[this.curVertIndex++]=zo.h,this.verts[this.curVertIndex++]=zo.nextVert.y,this.verts[this.curVertIndex++]=zo.nextVert.x,this.verts[this.curVertIndex++]=zo.h+Do,this.verts[this.curVertIndex++]=zo.nextVert.y,this.uvs[this.curUVIndex++]=0,this.uvs[this.curUVIndex++]=.46*zo.d,this.uvs[this.curUVIndex++]=.46,this.uvs[this.curUVIndex++]=.46*zo.d,zo.refreshIndex||(zo.ii=this.curIndex-2,this.index.push(zo.ii,zo.ii+3,zo.ii+1,zo.ii,zo.ii+2,zo.ii+3)),this.curIndex+=2,zo.refreshIndex=!1),zo.n?(zo.distanceBetween=Math.min(10,Math.max(2,zo.d/2)),!zo.byWater&&zo.d>20&&No.next()<.1&&this.addTree(zo.nextVert.x,zo.h,zo.nextVert.y)):(zo.distanceBetween=this.distantResolution,!zo.byWater&&No.next()<.2&&this.addTree(zo.nextVert.x,zo.h,zo.nextVert.y)),zo.d-=zo.distanceBetween,this.curVertIndex>=Mo){this.curWallIndex=this.wallsToDraw.length;break}if(zo.doBreak)break}this.curWallIndex++,this.ready=this.curWallIndex>=this.wallsToDraw.length,this.ready&&this.finalise()}else this.continueInitialise()}finalise(){if(this.leftWallNodes.length>1)for(this.leftWallNodes=this.leftWallNodes.sort(((e,t)=>e.i<t.i?-1:1)),zo.ci=0;zo.ci<this.leftWallNodes.length-1;zo.ci++){var e;if(zo.curNode=this.leftWallNodes[zo.ci],zo.target=this.leftWallNodes[zo.ci+1],zo.target.i-zo.curNode.i<30)for(;zo.curNode.i<=zo.target.i;)zo.curNode.dswl=Co,zo.curNode=zo.curNode.next;else(null===(e=zo.curNode.prev)||void 0===e?void 0:e.dswl)||(zo.curNode.dsel=!0)}if(this.rightWallNodes.length>1)for(this.rightWallNodes=this.rightWallNodes.sort(((e,t)=>e.i<t.i?-1:1)),zo.ci=0;zo.ci<this.rightWallNodes.length-1;zo.ci++){var t;if(zo.curNode=this.rightWallNodes[zo.ci],zo.target=this.rightWallNodes[zo.ci+1],zo.target.i-zo.curNode.i<30)for(;zo.curNode.i<=zo.target.i;)zo.curNode.dswr=-Co,zo.curNode=zo.curNode.next;else(null===(t=zo.curNode.prev)||void 0===t?void 0:t.dswr)||(zo.curNode.dser=!0)}this.geo.attributes.position.needsUpdate=!0,this.geo.attributes.uv.needsUpdate=!0,this.geo.setDrawRange(0,this.index.length),this.geo.setIndex(this.index),this.mesh.updateMatrix(),this.mesh.visible=!0}};const Oo=new r.G,Ro=new Gn(103,2*Math.PI),To=new Gn(51,.4),Po={vecV:new r.W,vecH:new r.W};var Go=class extends di{constructor(...e){super(...e),this.maxTreeCount=5120,this.treeMapRows=[],this.treeInstanceIndex=0,this.treeMap=[],this.currentTreeInstance=0,this.treeInstances=[],this.farWallRenderer=null,this.ready=!1,this.isDebug=!1,this.treeGenIndex=0,this.treeMapTile=null,this.nearestNode=null,this.sea=null,this.seaRes=10,this.seaDepth=null,this.seaDepthIndex=0,this.seaRow=0,this.maxTreeCount=Ns,this.treeInstances.push($a.getFarTreeInstance(this.maxTreeCount)),this.trees=this.treeInstances[0],this.trees.count=0,this.geo.setAttribute("treeMask",new r.o(new Float32Array(this.geo.count),1)),this.geo.attributes.treeMask.setUsage(r.l),this.treeMask=this.geo.attributes.treeMask.array,this.geo.setAttribute("grass",new r.o(new Float32Array(this.geo.count),1)),this.geo.attributes.grass.setUsage(r.l),this.grassArr=this.geo.attributes.grass.array,this.mesh.add(this.trees),this.renderFarWalls=Sh.value.detailLodIndex>0,this.farWallRenderer=new Lo(((e,t)=>this.heightmap.getXZ(e,t)),((e,t)=>this.lookupHeight(e,t)),((e,t)=>this.lookupTreemapDensity(e,t)),((e,t,i)=>this.addWallTree(e,t,i)),this.renderFarWalls),this.renderFarWalls&&this.mesh.add(this.farWallRenderer.mesh)}initGeneration(e,t,i,s,n,a,o){super.initGeneration(e,t,i,s,n,a,o),this.treeInstanceIndex=0,this.treeGenIndex=0;for(let r of this.treeInstances)r.count=0,r.visible=!1;this.currentTreeInstance=0,this.trees=this.treeInstances[this.currentTreeInstance],this.trees.visible=!0,po[e]||(po[e]={}),po[e][t]=null,Zs?(this.sea||(this.sea=this.getSeaMesh(),this.mesh.add(this.sea)),this.seaDepth=this.sea.geometry.attributes.depth.array,this.seaDepthIndex=0,this.seaRow=0,this.sea.visible=!0,this.sea.position.y=-this.mesh.position.y):(this.sea&&(this.sea.visible=!1),this.seaRow=Hs+1),this.farWallRenderer.initialise(this.originPos,i,s,this.debug),(e+t)%3==0&&(this.farWallRenderer.ready=!0)}resetOverlapMap(e,t){super.resetOverlapMap(e,t),this.treeInstanceIndex=0,this.treeGenIndex=0,this.currentTreeInstance=0,this.trees=this.treeInstances[this.currentTreeInstance],this.trees.visible=!0,this.farWallRenderer.initialise(this.originPos,this.originNode,e,this.debug,!1),(this.originCoords.x+this.originCoords.z)%3==0&&(this.farWallRenderer.ready=!0)}getSeaMesh(){let e=new r.J(this.size,this.size,Hs,Hs);e.setAttribute("depth",new r.o(new Float32Array((Hs+1)*(Hs+1)),1)),e.attributes.depth.setUsage(r.l);let t=new r.B(e,Es);return t.position.x+=this.size/2,t.position.z+=this.size/2,t.rotation.x=-Math.PI/2,t}generate(){if(this.genRow<=this.res){for(this.genIndex=this.genRow*this.res1*3,Po.i=0;Po.i<=this.res;Po.i++)Po.index=this.genIndex+3*Po.i,Po.index3=this.genRow*this.res1+Po.i,Po.x=this.verts[Po.index]+this.originPos.x,Po.z=this.verts[Po.index+2]+this.originPos.z,Po.h=this.heightmap.getXZ(Po.x,Po.z),this.heights[Po.index3]=Po.h,this.heightOffsets[Po.index3]=Po.h-this.mesh.position.y,this.treeMask[Po.index3]=0,this.treeMap[Po.index3]=$a.treeMap.getXZ(Po.x,Po.z),Po.h<100?this.grassArr[Po.index3]=$a.grassMap.getXZ(Po.x,Po.z)/3*(Po.h/100):this.grassArr[Po.index3]=$a.grassMap.getXZ(Po.x,Po.z)/3;return this.genRow>0&&this.computeSquareNormalsRow(this.genRow-1),this.genRow++,this.genRow>this.res&&(this.computeSquareNormalsRow(this.genRow-1),this.geo.attributes.normal.needsUpdate=!0,this.geo.attributes.curvature.needsUpdate=!0,this.geo.attributes.grass.needsUpdate=!0),!1}if(this.overlapIndex<this.overlapCells.length){for(Po.oz in Po.ox=this.overlapCells[this.overlapIndex],this.overlapTile[Po.ox])this.overlapTile[Po.ox][Po.oz]<0||(Po.index=Po.ox*this.res1+1*Po.oz,this.heightOffsets[Po.index]=this.heights[Po.index]-this.mesh.position.y-(6+2.5*this.overlapTile[Po.ox][Po.oz]));return this.overlapIndex++,!1}if(this.treeGenIndex<this.res)return this.computeTreeRow(this.treeGenIndex),this.treeGenIndex++,!1;if(!this.farWallRenderer.ready)return this.farWallRenderer.buildNextWall(),!1;if(this.seaRow<=Hs){for(Po.genIndex=this.seaRow*(Hs+1),Po.i=0;Po.i<=Hs;Po.i++)this.seaDepth[Po.genIndex+Po.i]=this.lookupHeight(Po.i/Hs*this.size,this.seaRow/Hs*this.size);return this.seaRow++,!1}return this.readyTrees(),this.geo.attributes.treeMask.needsUpdate=!0,Zs&&(this.sea.geometry.attributes.depth.needsUpdate=!0),po[this.originCoords.x][this.originCoords.z]=this.treeMask,this.mesh.visible&&this.display(),this.ready=!0,!0}lookupTreemapDensity(e,t){return e<0||e>this.size||t<0||t>this.size?0:(Po.cx=Math.max(e/10,0),Po.cz=Math.max(t/10,0),Po.ix=Math.min(this.size-1,Math.floor(Po.cx)),Po.iz=Math.min(this.size-1,Math.floor(Po.cz)),Po.index=this.res1*Po.ix+Po.iz,this.treeMask[Po.index])}addWallTree(e,t,i){Oo.position.set(e,t-1,i),Oo.rotation.y=Ro.next(),Oo.scale.set(.75,.75,.75),Oo.updateMatrix(),this.trees.setMatrixAt(this.treeInstanceIndex,Oo.matrix),this.trees.instanceVariant.array[this.treeInstanceIndex]=0,Oo.rotation.y>2.1&&(Oo.rotation.y>4.2?this.trees.instanceVariant.array[this.treeInstanceIndex]=2:this.trees.instanceVariant.array[this.treeInstanceIndex]=3),this.treeInstanceIndex++,this.treeInstanceIndex>=this.maxTreeCount&&this.getNewTreeInstance()}readyTrees(){this.trees.instanceMatrix.needsUpdate=!0,this.trees.instanceVariant.needsUpdate=!0,this.trees.count=Math.min(this.maxTreeCount,Math.max(0,this.treeInstanceIndex))}getNewTreeInstance(){if(this.readyTrees(),this.currentTreeInstance++,this.treeInstances.length<=this.currentTreeInstance){let e=$a.getFarTreeInstance(this.maxTreeCount);this.mesh.add(e),this.treeInstances.push(e)}this.trees=this.treeInstances[this.currentTreeInstance],this.trees.count=0,this.trees.visible=!0,this.treeInstanceIndex=0}computeTreeRow(e){for(Po.i=0;Po.i<this.res;Po.i++)if(this.treeInstanceIndex>=this.maxTreeCount&&this.getNewTreeInstance(),Po.index=e*this.res1*3+3*Po.i,Po.index3=e*this.res1+Po.i,Po.tm=this.treeMap[Po.index3],0!=Po.tm&&(Po.doContinue=!1,this.heights[Po.index3]<0&&(this.treeMask[Po.index3]=0,Po.doContinue=!0),this.heights[Po.index3+1]<0&&(this.treeMask[Po.index3+1]=0,Po.doContinue=!0),this.heights[Po.index3+this.res1]<0&&(this.treeMask[Po.index3+this.res1]=0,Po.doContinue=!0),this.heights[Po.index3+1+this.res1]<0&&(this.treeMask[Po.index3+1+this.res1]=0,Po.doContinue=!0),!Po.doContinue))if(this.grads[Po.index]>.2)this.treeMask[Po.index3]=0,this.treeMask[Po.index3+1]=0,this.treeMask[Po.index3+this.res1]=0,this.treeMask[Po.index3+1+this.res1]=0;else{Po.tx=e,Po.tz=Po.i,Po.jInit=0,this.overlapTile&&Po.tx+1 in this.overlapTile&&Po.tz+1 in this.overlapTile[Po.tx+1]&&(Po.jInit=100),Po.treePositions=$a.getTreeMap(Po.tm);for(Po.j=Po.jInit;Po.j<Po.treePositions.length;Po.j+=2)Po.ox=Po.treePositions[Po.j],Po.oz=Po.treePositions[Po.j+1],Po.ha=Po.ox*this.heightOffsets[Po.index3+this.res1]+(1-Po.ox)*this.heightOffsets[Po.index3],Po.hb=Po.ox*this.heightOffsets[Po.index3+1+this.res1]+(1-Po.ox)*this.heightOffsets[Po.index3+1],Oo.position.set(10*Po.ox+10*Po.tx,Po.oz*Po.hb+(1-Po.oz)*Po.ha,10*Po.oz+10*Po.tz),Oo.rotation.y=Ro.next(),Po.tms=.15*(Po.tm-1)+1,Po.hb=Po.tms+(To.next()-.2)*Po.tms,Oo.scale.set(Po.hb,Po.hb,Po.hb),Oo.updateMatrix(),this.trees.setMatrixAt(this.treeInstanceIndex,Oo.matrix),this.trees.instanceVariant.array[this.treeInstanceIndex]=0,Oo.rotation.y>2.1&&(Oo.rotation.y>4.2?this.trees.instanceVariant.array[this.treeInstanceIndex]=2:this.trees.instanceVariant.array[this.treeInstanceIndex]=3),this.treeInstanceIndex++,this.treeInstanceIndex>=this.maxTreeCount&&this.getNewTreeInstance();Po.hb=Po.tm/3,this.treeMask[Po.index3]=Math.max(Po.hb,this.treeMask[Po.index3]),this.treeMask[Po.index3+1]=Math.max(Po.hb,this.treeMask[Po.index3+1]),this.treeMask[Po.index3+this.res1]=Math.max(Po.hb,this.treeMask[Po.index3+this.res1]),this.treeMask[Po.index3+1+this.res1]=Math.max(Po.hb,this.treeMask[Po.index3+1+this.res1])}}display(e=!1){super.display(e);for(let t of this.treeInstances)t.visible&&(t.geometry.boundingSphere=this.geo.boundingSphere.clone());this.farWallRenderer.geo.boundingSphere=this.geo.boundingSphere.clone(),this.sea&&(this.sea.geometry.boundingSphere={center:{x:0,y:0,z:0},radius:this.geo.boundingSphere.radius})}retire(){super.retire(),this.resetTrees(),delete po[this.originCoords.x][this.originCoords.z],Object.keys(po[this.originCoords.x]).length||delete po[this.originCoords.x]}resetTrees(){for(;this.treeInstances.length>1;)$a.returnFarTreeInstance(this.treeInstances.pop());this.treeInstances[0].visible=!1}};class Bo extends ci{constructor(e){super(),this.nearGridCell=Ao,this.farGridCell=Go,this.groundMaterial=Ds,this.skinList=Object.keys(Ys.skins),this.skinIndex=0,this.weatherList=Object.keys(Ys.weathers),this.curWeatherIndex=0,this.skinWeatherList=[],this.weatherOverride=!1,this.cycleWeathers=!1,this.weatherCycles=[],this.weatherCycleIndex=0,this.weatherCycleCurrentIndex=0,this.weatherCycleInterval=0,this.weatherCycleCounter=0,this.colorsA={col:new r.i,hemTop:new r.i,hemGround:new r.i,water:new r.i,waterSkyReflection:new r.i,underwater:new r.i,skyCol:new r.i,skyColFar:new r.i},this.colorsB={col:new r.i,hemTop:new r.i,hemGround:new r.i,water:new r.i,waterSkyReflection:new r.i,underwater:new r.i,skyCol:new r.i,skyColFar:new r.i},this.weatherBlend={amb:0,dir:0,hem:0,fogNear:0,fogFar:0,col:new r.i,hemTop:new r.i,hemGround:new r.i,water:new r.i,waterSkyReflection:new r.i,underwater:new r.i,skyCol:new r.i,skyColFar:new r.i},this.topoList=Object.keys(Ys.topography),this.topoIndex=0,this.ambiantAudio=null,this.windAudio=null,this.cachedTextures={default:{}},this.onWeatherCycleChangedBound=this.onWeatherCycleChanged.bind(this),this.loadState={init:!1,walls:!1,reset:!0,progress:0},this.lastVehicleIndex=0,this.seaDepth=null,this.fogHeight=0,this.dynamicFog=!1,this.fogUpdate=!1,this.inWater=!1,this.lerpOffset=0,this.lerpCounter=0,this.timeInterval=1,this.weatherType=0,this.curWeatherIndex=0,this.audioLerp=0,this.tCol=new r.i,this.onToggleBarriersBound=this.onToggleBarriers.bind(this),this.getHeightAt=e,this.container=new r.G,this.config=Ys,Jn.initialise(e),this.container.add(Jn.container),this.wallController=new Oa(this.getHeightAt),this.container.add(this.wallController.container),this.signController=new Ta,this.bridgeController=new Wa(this.getHeightAt),this.catsEyesController=new Ha,this.container.add(this.catsEyesController.container),this.weatherController=new Va,this.container.add(this.weatherController.container),this.container.add(oo.container),Sh.value.detailLodIndex>0&&(this.container.add(ho.container),this.container.add(co.container)),$a.buildMap(Ys.treemap),oo.reset(),ho.reset(),co.reset(),be.addListener(we,this.onHeadlightsChanged.bind(this)),te.addListener("Barriers",this.onToggleBarriersBound),this.onToggleBarriers(te.Barriers),qs.addListener(this.onWeatherCycleChangedBound),this.onWeatherCycleChanged()}onWeatherCycleChanged(e){var t;if(0==qs.cycleLength||!(null===(t=this.skin)||void 0===t?void 0:t.cycles))return this.cycleWeathers=!1,void this.weatherController.onWeatherCycleChanged(!1);for(this.cycleWeathers||(this.weatherCycleIndex=0),this.cycleWeathers=!0,this.weatherController.onWeatherCycleChanged(!0),this.weatherCycles=this.skin.cycles,this.weatherCycleIndex=0;this.weatherCycleIndex<this.weatherCycles.length&&(this.weatherCycleCurrentList=this.weatherCycles[this.weatherCycleIndex],this.weatherCycleCurrentIndex=this.weatherCycleCurrentList.indexOf(this.skinWeatherList[this.curWeatherIndex]),!(this.weatherCycleCurrentIndex>=0));this.weatherCycleIndex++);this.weatherCycleCurrentIndex<0&&(this.weatherCycleCurrentIndex=0),this.weatherCycleInterval=qs.cycleLength/this.weatherCycleCurrentList.length,this.weatherCycleCounter=0,this.prepWeatherBlend()}updateConfig(e,t){Ms(e,t)}sanitiseConfig(e,t=!1){!t&&this.skinList.includes(e.value.skin)||(e.set("skin","default",!0),e.set("weatherIndex",1,!0))}destroy(){te.removeListener("Barriers",this.onToggleBarriersBound),Jn.destroy(),this.weatherController.destroy(),this.ambientAudio.stop(),this.windAudio.stop(),this.container.traverse((e=>{e.geometry&&e.geometry.dispose()})),this.container.clear();for(let e in this.cachedTextures)for(let t in this.cachedTextures[e])if(this.cachedTextures[e][t].isTexture)this.cachedTextures[e][t].dispose();else for(let i in this.cachedTextures[e][t])this.cachedTextures[e][t][i].isTexture&&this.cachedTextures[e][t][i].dispose();delete this.cachedTextures,oo.destroy(),ho.destroy(),co.destroy()}loader(){return 1}initialise(e,t,i){this.seed=e;let s=t.topography;this.topoIndex=this.topoList.indexOf(s),delete this.heightmap,this.heightmap=new vi(e,Ys.topography[s].heightmap),ft(Ys.topography[s].smoothWindow),Yt(Ys.topography[s].roadWidth),Zs||this.initSea(),i()}onMidlineReady(){this.lastVehicleIndex=ii.vehicleIndex,this.signController.initialise(),this.bridgeController.initialise(),this.catsEyesController.initialise(),oo.revert(zs,Ls),ho.revert(Bs,Rs),co.revert(Ws,Rs),this.sea&&(this.sea.position.x=ii.vehicleNode.p.x,this.sea.position.z=ii.vehicleNode.p.z)}onGridReady(){this.wallController.initialise(),co.initialiseVisible(),ho.initialiseVisible(),oo.initialiseVisible()}handleMidlineReset(){this.wallController.handleMidlineReset()}initSea(){let e=2*Nt,t=new r.J(e,e,Hs,Hs);this.sea=new r.B(t,Es),this.sea.rotation.x=-Math.PI/2,this.sea.frustumCulled=!1,this.container.add(this.sea)}destroySea(){this.sea&&(this.sea.geometry.dispose(),this.container.remove(this.sea),this.sea=null)}update(e){var t;this.weatherController.update(),this.lastVehicleIndex<ii.vehicleIndex&&(this.lastVehicleIndex++,this.wallController.update(),this.signController.update(),this.bridgeController.update(),Jn.update(),ho.updateVisible(),co.updateVisible(),oo.updateVisible(),this.sea&&(this.sea.position.x=ii.vehicleNode.p.x,this.sea.position.z=ii.vehicleNode.p.z)),this.catsEyesController.update(),this.wallController.updateStaged(),(null===(t=Us.parent)||void 0===t?void 0:t.position)?(Es.userData.camPos.value.copy(Us.parent.position),Kt.userData.camPos.value.copy(Us.parent.position)):(Es.userData.camPos.value.copy(Us.position),Kt.userData.camPos.value.copy(Us.position)),Es.userData.time.value=2*ae.appTime,Es.uniformsNeedUpdate=!0,this.cycleWeathers?this.updateWeather(e):this.dynamicFog&&this.fogUpdate&&(this.dynamicFogNear=1-Math.min(1,be.position.y/200),this.dynamicFogFar=.2+.8*this.dynamicFogNear,pt(this.weather.col,Ct*this.weather.fogNear*this.dynamicFogNear,Math.max(50,Ct*this.weather.fogFar*this.dynamicFogFar))),this.fogUpdate=!this.fogUpdate,Us.position.y<0?(this.inWater=!0,this.underwaterCol=this.weather.underwater,this.cycleWeathers&&(this.underwaterCol=this.weatherBlend.underwater.getHex()),It.setHex(this.underwaterCol),this.fogVis=2*Math.max(0,8+Us.position.y),pt(this.underwaterCol,-30+this.fogVis,10+this.fogVis)):this.inWater&&(this.inWater=!1,this.cycleWeathers||(It.setHex(this.weather.col),this.cycleWeathers?this.updateWeather(e):this.dynamicFog&&this.fogUpdate?(this.dynamicFogNear=1-Math.min(1,be.position.y/200),this.dynamicFogFar=.2+.8*this.dynamicFogNear,pt(this.weather.col,Ct*this.weather.fogNear*this.dynamicFogNear,Math.max(50,Ct*this.weather.fogFar*this.dynamicFogFar))):pt(this.weather.col,Ct*this.weather.fogNear,Ct*this.weather.fogFar)))}smoothLerp(e){return-1*(3-2*e)*e*e+1}smootherLerp(e){return(e*(6*e-15)+10)*e*e*e*-1+1}prepWeatherBlend(){this.weatherCycleCurrentIndex>=this.weatherCycleCurrentList.length&&(this.weatherCycleIndex=(this.weatherCycleIndex+1)%this.weatherCycles.length,this.weatherCycleCurrentList=this.weatherCycles[this.weatherCycleIndex],this.weatherCycleCurrentIndex=0),this.wA=Ys.weathers[this.weatherCycleCurrentList[this.weatherCycleCurrentIndex]],this.weatherCycleCurrentIndex==this.weatherCycleCurrentList.length-1?this.wB=Ys.weathers[this.weatherCycles[(this.weatherCycleIndex+1)%this.weatherCycles.length][0]]:this.wB=Ys.weathers[this.weatherCycleCurrentList[this.weatherCycleCurrentIndex+1]],this.colorsA.col.setHex(this.wA.col),this.colorsA.hemTop.setHex(this.wA.hemTop),this.colorsA.hemGround.setHex(this.wA.hemGround),this.colorsA.water.setHex(this.wA.water),this.colorsA.waterSkyReflection.setHex(this.wA.waterSkyReflection),this.colorsA.underwater.setHex(this.wA.underwater),this.colorsA.skyCol.setHex(this.wA.skyCol),this.colorsA.skyColFar.setHex(this.wA.skyColFar),this.colorsB.col.setHex(this.wB.col),this.colorsB.hemTop.setHex(this.wB.hemTop),this.colorsB.hemGround.setHex(this.wB.hemGround),this.colorsB.water.setHex(this.wB.water),this.colorsB.waterSkyReflection.setHex(this.wB.waterSkyReflection),this.colorsB.underwater.setHex(this.wB.underwater),this.colorsB.skyCol.setHex(this.wB.skyCol),this.colorsB.skyColFar.setHex(this.wB.skyColFar)}updateWeather(e){this.weatherCycleCounter+=e,this.weatherCycleCounter>this.weatherCycleInterval&&(this.weatherCycleCounter-=this.weatherCycleInterval,this.weatherCycleCurrentIndex++,this.prepWeatherBlend(this.wA,this.wB));let t=this.weatherCycleCounter/this.weatherCycleInterval;t=this.smoothLerp(1-t);let i=1-t;this.weatherBlend.amb=this.wA.amb*i+this.wB.amb*t,this.weatherBlend.dir=this.wA.dir*i+this.wB.dir*t,this.weatherBlend.hem=this.wA.hem*i+this.wB.hem*t,this.weatherBlend.fogNear=this.wA.fogNear*i+this.wB.fogNear*t,this.weatherBlend.fogFar=this.wA.fogFar*i+this.wB.fogFar*t,this.weatherBlend.col.copy(this.colorsA.col).lerp(this.colorsB.col,t),this.weatherBlend.hemTop.copy(this.colorsA.hemTop).lerp(this.colorsB.hemTop,t),this.weatherBlend.hemGround.copy(this.colorsA.hemGround).lerp(this.colorsB.hemGround,t),this.weatherBlend.water.copy(this.colorsA.water).lerp(this.colorsB.water,t),this.weatherBlend.waterSkyReflection.copy(this.colorsA.waterSkyReflection).lerp(this.colorsB.waterSkyReflection,t),this.weatherBlend.underwater.copy(this.colorsA.underwater).lerp(this.colorsB.underwater,t),this.weatherBlend.skyCol.copy(this.colorsA.skyCol).lerp(this.colorsB.skyCol,t),this.weatherBlend.skyColFar.copy(this.colorsA.skyColFar).lerp(this.colorsB.skyColFar,t),bt.intensity=this.weatherBlend.amb,bt.color.copy(this.weatherBlend.col),ko.emissive.copy(bt.color),At.intensity=this.weatherBlend.hem,At.color.copy(this.weatherBlend.hemTop),At.groundColor.copy(this.weatherBlend.hemGround),yt.intensity=this.weatherBlend.dir,yt.color.copy(this.weatherBlend.col),yt.sunOffset.fromArray([0,100,0]),It.copy(this.weatherBlend.col),be.headlightsManual||(this.wA.headlights&&!this.wB.headlights?be.setHeadlights(t<.5):!this.wA.headlights&&this.wB.headlights&&be.setHeadlights(t>.5)),be.headlights&&this.updateHeadlightIntensity(),this.wA.dynamicFog||this.wB.dynamicFog?(this.vehicleFogLerp=Math.min(1,be.position.y/200),this.wA.dynamicFog&&!this.wB.dynamicFog?this.dynamicFogNear=1-this.vehicleFogLerp*i:this.wB.dynamicFog&&!this.wA.dynamicFog?this.dynamicFogNear=1-this.vehicleFogLerp*t:this.dynamicFogNear=1-this.vehicleFogLerp,this.dynamicFogFar=.2+.8*this.dynamicFogNear,pt(this.weatherBlend.col.getHex(),Ct*this.weatherBlend.fogNear*this.dynamicFogNear,Math.max(50,Ct*this.weatherBlend.fogFar*this.dynamicFogFar))):pt(this.weatherBlend.col.getHex(),Ct*this.weatherBlend.fogNear,Ct*this.weatherBlend.fogFar),Kt.userData.hasClouds.value=!1,Kt.userData.nearCol.value.copy(this.weatherBlend.skyCol),Kt.userData.farCol.value.copy(this.weatherBlend.skyColFar),Kt.uniformsNeedUpdate=!0,Es.color.copy(this.weatherBlend.water),Es.userData.sunCol.value=this.hexToArray(this.weatherBlend.col.getHex()),Es.userData.skyCol.value=this.hexToArray(this.weatherBlend.waterSkyReflection.getHex()),Es.uniformsNeedUpdate=!0}updateHeadlightIntensity(){be.setHeadlightIntensity(Math.max(.25,3.25-2.5*(yt.intensity+At.intensity)))}onHeadlightsChanged(){this.catsEyesController.container.visible=be.headlights}nextSkin(){this.setSkin(this.skinList[++this.skinIndex%this.skinList.length]),this.onWeatherCycleChanged(qs.value)}setTopography(e){window.localStorage.setItem("config-scene-topography",e)}nextTopography(){this.setTopography(this.topoList[++this.topoIndex%this.topoList.length])}loadGroundMaterialSkin(e,t,i,s,n=4){this.skin[e]?(i[e]||(i[e]=st(this.skin[e],n)),Ds.userData[t].value=i[e]):(s[e]||(s[e]=st(Ys.skins.default[e],n)),Ds.userData[t].value=s[e])}getSkinName(e){var t;return(null===(t=Ys.skins[e])||void 0===t?void 0:t.name)||e}setScene(e){this.setSkin(e.skin),this.setWeatherIndex(e.weatherIndex%this.skinWeatherList.length),this.onWeatherCycleChanged(qs.value)}setSkin(e){this.skinName=e;let t=Ys.skins.default;this.skin=Ys.skins[e],this.cachedTextures[e]||(this.cachedTextures[e]={});let i=this.cachedTextures[e],s=this.cachedTextures.default;this.loadGroundMaterialSkin("grass","grassMap",i,s,2),this.loadGroundMaterialSkin("forest","forestMap",i,s),this.loadGroundMaterialSkin("heather","heatherMap",i,s),this.loadGroundMaterialSkin("gravel","gravelMap",i,s),this.loadGroundMaterialSkin("rock","rockMap",i,s),this.loadGroundMaterialSkin("sand","sandMap",i,s),this.loadGroundMaterialSkin("roadBase","roadBaseMap",i,s),this.skin.road?(i.road||(i.road=st(this.skin.road,8)),Ut.map=i.road):(s.road||(s.road=st(t.road,8)),Ut.map=s.road),Ds.userData.colouration.value=t.foliage.grassColouration,Fs[0].userData.colouration.value=t.foliage.grassColouration,Fs[1].userData.colouration.value=t.foliage.grassColouration,Ps[0].userData.colouration.value=t.foliage.treeColouration,Ps[1].userData.colouration.value=t.foliage.treeColouration,this.skin.foliage&&(this.skin.foliage.trees?(i.foliage||(i.foliage={}),i.foliage.trees||(i.foliage.trees=[st(this.skin.foliage.trees[0],4),st(this.skin.foliage.trees[1],4)]),Ps[0].map=i.foliage.trees[0],Ps[1].map=i.foliage.trees[1],this.skin.foliage.treesb&&Sh.value.detailLodIndex>0?(i.foliage.treesb||(i.foliage.treesb=[st(this.skin.foliage.treesb[0],4),st(this.skin.foliage.treesb[1],4)]),Ps[0].userData.mapb.value=i.foliage.treesb[0],Ps[1].userData.mapb.value=i.foliage.treesb[1],Ps[0].userData.highDef.value=!0,Ps[1].userData.highDef.value=!0):(Ps[0].userData.mapb.value=null,Ps[1].userData.mapb.value=null,Ps[0].userData.highDef.value=!1,Ps[1].userData.highDef.value=!1)):(s.foliage||(s.foliage={}),s.foliage.trees||(s.foliage.trees=[st(t.foliage.trees[0],4),st(t.foliage.trees[1],4)]),Ps[0].map=s.foliage.trees[0],Ps[1].map=s.foliage.trees[1]),"grass"in this.skin.foliage?(i.foliage||(i.foliage={}),i.foliage.grass||(i.foliage.grass=st(this.skin.foliage.grass,4)),Fs[0].map=i.foliage.grass):(s.foliage||(s.foliage={}),s.foliage.grass||(s.foliage.grass=st(t.foliage.grass,4)),Fs[0].map=s.foliage.grass),"bush"in this.skin.foliage?(i.foliage||(i.foliage={}),i.foliage.bush||(i.foliage.bush=st(this.skin.foliage.bush,4)),Fs[1].map=i.foliage.bush):(s.foliage||(s.foliage={}),s.foliage.bush||(s.foliage.bush=st(t.foliage.bush,4)),Fs[1].map=s.foliage.bush),this.skin.foliage.grassColouration&&(Ds.userData.colouration.value=this.skin.foliage.grassColouration,Fs[0].userData.colouration.value=this.skin.foliage.grassColouration,Fs[1].userData.colouration.value=this.skin.foliage.grassColouration),this.skin.foliage.treeColouration&&(Ps[0].userData.colouration.value=this.skin.foliage.treeColouration,Ps[1].userData.colouration.value=this.skin.foliage.treeColouration)),Ds.uniformsNeedUpdate=!0,Fs[0].uniformsNeedUpdate=!0,Fs[1].uniformsNeedUpdate=!0,Ps[0].uniformsNeedUpdate=!0,Ps[1].uniformsNeedUpdate=!0,this.skin.walls?(i.walls||(i.walls={}),s.walls||(s.walls={}),Na.visible=!0,"sea"in this.skin.walls?(null==this.skin.walls.sea&&(Na.visible=!1),i.walls.sea||(i.walls.sea=st(this.skin.walls.sea,4)),Na.map=i.walls.sea):(s.walls.sea||(s.walls.sea=st(t.walls.sea,4)),Na.map=s.walls.sea),Sa.visible=!0,this.skin.walls.sea?(i.walls.sea||(i.walls.sea=st(this.skin.walls.sea,4)),Sa.map=i.walls.sea):(s.walls.sea||(s.walls.sea=st(t.walls.sea,4)),Sa.map=s.walls.sea),Hn.visible=!0,"drystone"in this.skin.walls?(null==this.skin.walls.drystone&&(Hn.visible=!1),i.walls.drystone||(i.walls.drystone=st(this.skin.walls.drystone,4)),Hn.map=i.walls.drystone):(s.walls.drystone||(s.walls.drystone=st(t.walls.drystone,4)),Hn.map=s.walls.drystone),"fence"in this.skin.walls?(i.walls.fence||(i.walls.fence=st(this.skin.walls.fence,4)),va.map=i.walls.fence):(s.walls.fence||(s.walls.drystone=st(t.walls.fence,4)),va.map=s.walls.fence)):(s.walls||(s.walls={}),s.walls.drystone||(s.walls.drystone=st(t.walls.drystone,4)),Hn.map=s.walls.drystone,s.walls.fence||(s.walls.fence=st(t.walls.fence,4)),va.map=s.walls.fence,s.walls.sea||(s.walls.sea=st(t.walls.sea,4)),Na.map=s.walls.sea,Sa.map=s.walls.sea),ko.map=Hn.map,this.skin.friction?(Wt(this.skin.friction.road),Et(this.skin.friction.side),Ht(this.skin.friction.grass)):(Wt(1.4),Et(.95),Ht(.85)),this.weatherOverride=!1,this.skin.weathers?(this.weatherOverride=!0,this.skinWeatherList=this.skin.weathers,this.setWeather(this.skinWeatherList[this.curWeatherIndex%this.skinWeatherList.length])):this.setWeather(this.weatherList[this.curWeatherIndex%this.weatherList.length]),this.onWeatherCycleChanged(qs.value)}setWeatherIndex(e){this.curWeatherIndex=e,this.weatherOverride?this.setWeather(this.skinWeatherList[e]):this.setWeather(this.weatherList[e])}nextWeather(){this.weatherOverride?this.setWeather(this.skinWeatherList[++this.curWeatherIndex%this.skinWeatherList.length]):this.setWeather(this.weatherList[++this.curWeatherIndex%this.weatherList.length])}updateAudio(){var e,t;this.t=Math.min(1,Us.speed/30),this.t*=this.t,this.t*=$s.wind,this.interiorVol=Xs.value?.33:1,this.audioLerp=.9*this.audioLerp+.1*this.t,null===(e=this.ambientAudio)||void 0===e||e.setVolume((1-this.audioLerp)*this.interiorVol*$s.ambient),null===(t=this.windAudio)||void 0===t||t.setVolume(.75*this.audioLerp*this.interiorVol*$s.wind)}hexToArray(e){return this.tCol.setHex(e).toArray().concat(1)}setWeather(e){var t,i,s,n;this.weather=Ys.weathers[e],this.weatherB=Ys.weathers.sunset;let a=Ys.weathers.default,o=(null===(t=this.weather)||void 0===t||null===(i=t.audio)||void 0===i?void 0:i.ambiance)||a.audio.ambiance;me.getAudio(o.src,(e=>{this.ambientAudio&&this.ambientAudio.stop(),e.setLoop(!0),e.setLoopStart(o.ls),e.setLoopEnd(e.buffer.duration-o.le),this.ambientAudio=e,e.setVolume(0),e.play()}));let r=(null===(s=this.weather)||void 0===s||null===(n=s.audio)||void 0===n?void 0:n.wind)||a.audio.wind;me.getAudio(r.src,(e=>{this.windAudio&&this.windAudio.stop(),e.setLoop(!0),e.setLoopStart(r.ls),e.setLoopEnd(e.buffer.duration-r.le),this.windAudio=e,e.setVolume(0),e.play()})),bt.intensity=this.weather.amb,bt.color.setHex(this.weather.col),ko.emissive.copy(bt.color),At.intensity=this.weather.hem,At.color.setHex(this.weather.hemTop||this.weather.col),At.groundColor.setHex(this.weather.hemGround||this.weather.col),yt.intensity=this.weather.dir,yt.color.setHex(this.weather.col),yt.sunOffset.fromArray(this.weather.sunPos||[0,100,0]),It.setHex(this.weather.col),be.setHeadlightColour(16777215),pt(this.weather.col,Ct*this.weather.fogNear,Ct*this.weather.fogFar),this.dynamicFog=!!this.weather.dynamicFog,this.cachedTextures[e]||(this.cachedTextures[e]={});let h=this.cachedTextures[e],l=this.cachedTextures.default;Kt.userData.hasClouds.value=!0,"skyMap"in this.weather?null==this.weather.skyMap?Kt.userData.hasClouds.value=!1:(h.skyMap||(h.skyMap=st(this.weather.skyMap,2)),Kt.map=h.skyMap):(l.skyMap||(l.skyMap=st(a.skyMap,2)),Kt.map=l.skyMap),this.weather.skyCol?(Kt.userData.nearCol.value.setHex(this.weather.skyCol),Kt.userData.farCol.value.setHex(this.weather.skyColFar)):(Kt.userData.nearCol.value.setHex(a.skyCol),Kt.userData.farCol.value.setHex(a.skyColFar)),Kt.uniformsNeedUpdate=!0,Es.visible=!0,"water"in this.weather?(null==this.weather.water&&(Es.visible=!1),Es.color.setHex(this.weather.water),Es.userData.sunCol.value=this.hexToArray(this.weather.col),Es.userData.skyCol.value=this.hexToArray(this.weather.waterSkyReflection||a.waterSkyReflection),Es.uniformsNeedUpdate=!0):Es.color.setHex(a.water),be.setHeadlights(!!this.weather.headlights),this.weatherController.setWeather(this.weather.particles),this.onWeatherCycleChanged(qs.value)}onToggleBarriers(e){e?this.wallController.enable():this.wallController.disable()}}Bo.config=Ys,Bo.sceneName="Peaks";var Wo=Bo;const Fo={},Eo=2*Math.PI;var Zo=class extends pi{constructor(...e){super(...e),this.gradients=[],this.scale=4e3,this.heightOffset=150,this.heightInitial=1,this.resolution=2,this.depth=3,this.upscale=5,this.cache={},this.cacheAccess={},this.cacheCount=0,this.maxCached=15,this.craterLayers=3,this.craterDepth=2,this.craterCache={},this.cellScaleMetres=1500,this.cellScaleWorld=1e3,this.squared=!1,this.compound=!1,this.useQuick=!1;let t=e[1]||{};this.seed=e[0]||Ee,this.heightScale=t.heightScale||1,this.heightInitial=t.heightInitial||1,this.resolution=t.resolution||5,this.depth=t.depth||3,this.upscale=t.upscale||3,this.heightOffset=t.heightOffset||0,this.upscaleFactor=t.upscaleFactor||2,this.craterLayers=null==t.craterLayers?2:t.craterLayers,this.craterProb=t.craterProb||.33,this.craterDepth=t.craterDepth||2,this.squared=t.squared||!1,this.squareLayers=t.squareLayers||this.depth,this.compound=t.compound||!1,this.cellScaleWorld=this.cellScaleMetres}clearCache(){if(this.cacheCount<=this.maxCached)return;let e,t;for(e in this.cache){for(t in this.cache[e])if(this.cacheAccess[e][t])this.cacheAccess[e][t]=!1;else if(delete this.cache[e][t],delete this.cacheAccess[e][t],e in this.craterCache&&delete this.craterCache[e][t],this.cacheCount--,this.cacheCount<=this.maxCached)break;if(this.cacheCount<=this.maxCached)break}tn["heightmap-cache"]=this.cacheCount}checkCellCrater(e,t,i,s,n){var a;return this.craterCache[e]&&this.craterCache[e][t]||this.cacheCellCraters(e,t),null===(a=this.craterCache[e][t][n][Math.floor(i*(2*(n+1)))])||void 0===a?void 0:a[Math.floor(s*(2*(n+1)))]}cacheCellCraters(e,t){let i,s,n,a,o,r,h,l,d,c,p,u,g=[],m=0,x=new window.alea(""+this.seed+e+t);for(let v=0;v<this.craterLayers;v++){for(i={},s=2*(v+1),n=1/(2*s),r=1/s/2,h=r/2,o=r-h,m=this.craterProb*s*s,a=0;a<m;a++)c=h+x()*o,l=r-c,d=-l/2,p=Math.floor(x()*s),u=Math.floor(x()*s),i[p]||(i[p]={}),i[p][u]={x:p/s+n+(x()*l+d),y:-(1+x())*this.craterDepth,z:u/s+n+(x()*l+d),r:c,r2:c*c,r3:c*c*c*.512};g.push(i)}return this.craterCache[e]||(this.craterCache[e]={}),this.craterCache[e][t]=g,g}generateCell(e,t){let i,s,n,a,o=new window.alea(this.seed+e+t),r=this.resolution,h=[],l=[];for(i=0;i<this.depth;i++){for(l=[],s=0;s<r;s++)for(l.push([]),n=0;n<r;n++)a=o()*Eo,l[s].push({x:Math.cos(a),y:Math.sin(a)});h.push(l),r=this.getNextDepthResolution(r,i)}return h}getNextDepthResolution(e,t){return Math.round(e*this.upscaleFactor)}dotGridGradient(e,t,i,s,n){return this.grad=e[t][i],(s-t)*this.grad.x+(n-i)*this.grad.y}sharpLerp(e,t,i){return(t-e)*i+e}smoothLerp(e,t,i){return(t-e)*(3-2*i)*i*i+e}smootherLerp(e,t,i){return(i*(6*i-15)+10)*i*i*i*(t-e)+e}getXZ(e,t,i){for(Fo.layer of(Fo.d=0,Fo.h=0,Fo.sq=this.resolution,Fo.sqb=Fo.sq-1,Fo.wx=e/this.cellScaleWorld,Fo.wz=t/this.cellScaleWorld,Fo.ox=Math.floor(Fo.wx),Fo.oz=Math.floor(Fo.wz),Fo.px=Fo.wx-Fo.ox,Fo.pz=Fo.wz-Fo.oz,Fo.cell=this.getCell(Fo.ox,Fo.oz),i=i||this.depth,Fo.depth=0,Fo.h=this.heightInitial,Fo.heightFactor=1,Fo.ch=0,Fo.cell)){if(Fo.depth==i)break;Fo.sx=Fo.px*Fo.sq,Fo.sz=Fo.pz*Fo.sq,Fo.ix=Math.floor(Fo.sx),Fo.ix1=Fo.ix+1,Fo.iz=Math.floor(Fo.sz),Fo.iz1=Fo.iz+1,Fo.qx=Fo.sx-Fo.ix,Fo.qz=Fo.sz-Fo.iz,Fo.n0=this.dotGridGradient(Fo.layer,Fo.ix,Fo.iz,Fo.sx,Fo.sz),Fo.ix1<Fo.sq?Fo.n1=this.dotGridGradient(Fo.layer,Fo.ix1,Fo.iz,Fo.sx,Fo.sz):Fo.n1=this.dotGridGradient(this.getCell(Fo.ox+1,Fo.oz)[Fo.depth],0,Fo.iz,Fo.sx-Fo.sq,Fo.sz),Fo.int0=this.smootherLerp(Fo.n0,Fo.n1,Fo.qx),Fo.iz1<Fo.sq?(Fo.n0=this.dotGridGradient(Fo.layer,Fo.ix,Fo.iz1,Fo.sx,Fo.sz),Fo.ix1<Fo.sq?Fo.n1=this.dotGridGradient(Fo.layer,Fo.ix1,Fo.iz1,Fo.sx,Fo.sz):Fo.n1=this.dotGridGradient(this.getCell(Fo.ox+1,Fo.oz)[Fo.depth],0,Fo.iz1,Fo.sx-Fo.sq,Fo.sz)):(Fo.n0=this.dotGridGradient(this.getCell(Fo.ox,Fo.oz+1)[Fo.depth],Fo.ix,0,Fo.sx,Fo.sz-Fo.sq),Fo.ix1<Fo.sq?Fo.n1=this.dotGridGradient(this.getCell(Fo.ox,Fo.oz+1)[Fo.depth],Fo.ix1,0,Fo.sx,Fo.sz-Fo.sq):Fo.n1=this.dotGridGradient(this.getCell(Fo.ox+1,Fo.oz+1)[Fo.depth],0,0,Fo.sx-Fo.sq,Fo.sz-Fo.sq)),Fo.int1=this.smootherLerp(Fo.n0,Fo.n1,Fo.qx),Fo.heightFactor=this.resolution/Fo.sq,this.compound&&(Fo.heightFactor*=Fo.h),Fo.cl=1,Fo.depth<this.craterLayers&&(Fo.craterFactor=1/(2*(Fo.depth+1)),Fo.c=this.checkCellCrater(Fo.ox,Fo.oz,Fo.px,Fo.pz,Fo.depth),Fo.c&&(Fo.d=(Fo.c.x-Fo.px)*(Fo.c.x-Fo.px)+(Fo.c.z-Fo.pz)*(Fo.c.z-Fo.pz),Fo.d<Fo.c.r2&&(Fo.ch-=Fo.c.y*(1-this.smoothLerpW(1-Fo.d/Fo.c.r2))*Fo.craterFactor*.5*Fo.cl,Fo.d*=Math.sqrt(Fo.d),Fo.d<Fo.c.r3&&(Fo.d=Fo.d/Fo.c.r3,Fo.ch+=Fo.c.y*(1-this.smootherLerpW(1-Fo.d))*Fo.craterFactor*Fo.cl,Fo.cl=Math.min(Fo.cl,Fo.d))))),Fo.h+=this.smootherLerp(Fo.int0,Fo.int1,Fo.qz)*Fo.heightFactor*Fo.cl,Fo.sq=this.getNextDepthResolution(Fo.sq,Fo.depth),Fo.depth++}return this.squared&&(Fo.h*=Fo.h),Fo.h+=Fo.ch,Fo.h*this.heightScale+this.heightOffset}getXZLayer(e,t,i){for(Fo.layer of(Fo.d=0,Fo.h=0,Fo.sq=this.resolution,Fo.sqb=Fo.sq-1,Fo.wx=e/this.cellScaleWorld,Fo.wz=t/this.cellScaleWorld,Fo.ox=Math.floor(Fo.wx),Fo.oz=Math.floor(Fo.wz),Fo.px=Fo.wx-Fo.ox,Fo.pz=Fo.wz-Fo.oz,Fo.cell=this.getCell(Fo.ox,Fo.oz),Fo.depth=0,Fo.h=this.heightInitial,Fo.heightFactor=1,Fo.ch=0,Fo.cell))if(Fo.depth<i)Fo.sq=this.getNextDepthResolution(Fo.sq,Fo.depth),Fo.depth++;else{if(Fo.depth==this.depth||Fo.depth>i)break;Fo.sx=Fo.px*Fo.sq,Fo.sz=Fo.pz*Fo.sq,Fo.ix=Math.floor(Fo.sx),Fo.ix1=Fo.ix+1,Fo.iz=Math.floor(Fo.sz),Fo.iz1=Fo.iz+1,Fo.qx=Fo.sx-Fo.ix,Fo.qz=Fo.sz-Fo.iz,Fo.n0=this.dotGridGradient(Fo.layer,Fo.ix,Fo.iz,Fo.sx,Fo.sz),Fo.ix1<Fo.sq?Fo.n1=this.dotGridGradient(Fo.layer,Fo.ix1,Fo.iz,Fo.sx,Fo.sz):Fo.n1=this.dotGridGradient(this.getCell(Fo.ox+1,Fo.oz)[Fo.depth],0,Fo.iz,Fo.sx-Fo.sq,Fo.sz),Fo.int0=this.smootherLerp(Fo.n0,Fo.n1,Fo.qx),Fo.iz1<Fo.sq?(Fo.n0=this.dotGridGradient(Fo.layer,Fo.ix,Fo.iz1,Fo.sx,Fo.sz),Fo.ix1<Fo.sq?Fo.n1=this.dotGridGradient(Fo.layer,Fo.ix1,Fo.iz1,Fo.sx,Fo.sz):Fo.n1=this.dotGridGradient(this.getCell(Fo.ox+1,Fo.oz)[Fo.depth],0,Fo.iz1,Fo.sx-Fo.sq,Fo.sz)):(Fo.n0=this.dotGridGradient(this.getCell(Fo.ox,Fo.oz+1)[Fo.depth],Fo.ix,0,Fo.sx,Fo.sz-Fo.sq),Fo.ix1<Fo.sq?Fo.n1=this.dotGridGradient(this.getCell(Fo.ox,Fo.oz+1)[Fo.depth],Fo.ix1,0,Fo.sx,Fo.sz-Fo.sq):Fo.n1=this.dotGridGradient(this.getCell(Fo.ox+1,Fo.oz+1)[Fo.depth],0,0,Fo.sx-Fo.sq,Fo.sz-Fo.sq)),Fo.int1=this.smootherLerp(Fo.n0,Fo.n1,Fo.qx),Fo.heightFactor=this.resolution/Fo.sq,this.compound&&(Fo.heightFactor*=Fo.h),Fo.cl=1,Fo.depth<this.craterLayers&&(Fo.craterFactor=1/(2*(Fo.depth+1)),Fo.c=this.checkCellCrater(Fo.ox,Fo.oz,Fo.px,Fo.pz,Fo.depth),Fo.c&&(Fo.d=(Fo.c.x-Fo.px)*(Fo.c.x-Fo.px)+(Fo.c.z-Fo.pz)*(Fo.c.z-Fo.pz),Fo.d<Fo.c.r2&&(Fo.ch-=Fo.c.y*(1-this.smoothLerpW(1-Fo.d/Fo.c.r2))*Fo.craterFactor*.5*Fo.cl,Fo.d*=Math.sqrt(Fo.d),Fo.d<Fo.c.r3&&(Fo.d=Fo.d/Fo.c.r3,Fo.ch+=Fo.c.y*(1-this.smootherLerpW(1-Fo.d))*Fo.craterFactor*Fo.cl,Fo.cl=Math.min(Fo.cl,Fo.d))))),Fo.h+=this.smootherLerp(Fo.int0,Fo.int1,Fo.qz)*Fo.heightFactor*Fo.cl,Fo.sq=this.getNextDepthResolution(Fo.sq,Fo.depth),Fo.depth++}return this.squared&&(Fo.h*=Fo.h),Fo.h+=Fo.ch,Fo.h*this.heightScale+this.heightOffset}smootherLerpW(e){return(e*(6*e-15)+10)*e*e*e*-1+1}sharpLerpW(e){return 1-e}smoothLerpW(e){return-1*(3-2*e)*e*e+1}},Ho=i.p+"static/media/road_offworld.235fa320.webp",Qo=i.p+"static/media/mars_road_base.4b28c294.webp",Yo=i.p+"static/media/mars_surface.4083a724.webp",Vo=i.p+"static/media/mars_subsurface.d95fa5d1.webp",Uo=i.p+"static/media/mars_surface_bump.65340168.webp",Xo=i.p+"static/media/mars_cliff_bump.8e6fa674.webp",Jo=i.p+"static/media/mars_shale.9fd99ef9.webp",qo=i.p+"static/media/mars_shale_bump.c92f843f.webp",Ko=i.p+"static/media/mars_rubble.c8241124.webp",_o=i.p+"static/media/mars_rubble_bump.80ebc535.webp",$o=i.p+"static/media/mars_rock.75c6c859.webp",er=i.p+"static/media/mars_rock_bump.15322551.webp",tr=i.p+"static/media/mars_cliff.3ae2933c.webp",ir=i.p+"static/media/mars_barrier_wide.d7dc8819.webp",sr=i.p+"static/media/venus_road_base.20746f01.webp",nr=i.p+"static/media/venus_surface.38f0fb31.webp",ar=i.p+"static/media/venus_shale.bafde95f.webp",or=i.p+"static/media/venus_rubble.1f56f6fb.webp",rr=i.p+"static/media/venus_rock.c3115f27.webp",hr=i.p+"static/media/venus_cliff.fbb8e3df.webp",lr=i.p+"static/media/road_venus.61168361.webp",dr=i.p+"static/media/venus_barrier_wide.1b943c45.webp",cr=i.p+"static/media/moon_surface.f0a08f87.webp",pr=i.p+"static/media/moon_rock.47e45865.webp",ur=i.p+"static/media/moon_gravel.b53b019d.webp",gr=i.p+"static/media/moon_shale.07a93da8.webp",mr=i.p+"static/media/moon_cliff.4bb9ff9d.webp",xr=i.p+"static/media/road_moon.c594cb0f.webp",vr=i.p+"static/media/clouds_01.e03e365b.webp",wr=i.p+"static/media/clouds_02.840643a8.webp",fr=i.p+"static/media/ambiance_offworld.41a010f6.mp3",br=i.p+"static/media/wind_offworld_02.64ee03d4.mp3",Ar=i.p+"static/media/crossfade_fine.0d1ec73b.webp",yr=i.p+"static/media/crossfade_finest.da758a11.webp";const Ir={topography:{normal:{heightmap:{heightScale:50,heightOffset:500,heightInitial:1.1,resolution:1,craterLayers:2,craterDepth:.75,upscaleFactor:2.5,depth:4,midlineDepth:5,squared:!0,compound:!0},roadWidth:3,smoothWindow:7},hard:{heightmap:{heightScale:40,heightOffset:500,heightInitial:1,resolution:2,craterLayers:3,craterDepth:1.5,upscaleFactor:2,depth:5,midlineDepth:5,squared:!0,compound:!1},roadWidth:2.8,smoothWindow:5},easy:{heightmap:{heightScale:45,heightOffset:500,heightInitial:1.5,resolution:2,craterLayers:2,craterDepth:.75,upscaleFactor:2,depth:3,midlineDepth:5,squared:!1,compound:!0},roadWidth:3.2,smoothWindow:7},casual:{heightmap:{heightScale:60,heightOffset:500,heightInitial:1.5,resolution:2,craterLayers:1,craterDepth:.5,upscaleFactor:2,depth:2,midlineDepth:5,squared:!1,compound:!0},roadWidth:3.2,smoothWindow:7},straight:{heightmap:{heightScale:45,heightOffset:500,heightInitial:1.5,resolution:2,craterLayers:2,craterDepth:.5,upscaleFactor:2,depth:3,midlineDepth:5,squared:!1,compound:!0},roadWidth:3.2,smoothWindow:7},flat:{heightmap:{heightScale:0,heightOffset:50,resolution:1,depth:1,upscale:1},roadWidth:20,smoothWindow:7}},weathers:{default:{audio:{ambiance:{src:fr,ls:.1,le:.1},wind:{src:br,ls:.07,le:.07}},water:11378325,col:16121855,hemTop:6710886,hemGround:16777215,skyCol:5197130,skyColFar:15904116,skyMap:vr,amb:.2,hem:.3,dir:.5,fogNear:0,fogFar:1,sunPos:[0,100,0]},mars:{audio:{ambiance:{src:fr,ls:.1,le:.1},wind:{src:br,ls:.07,le:.07}},col:16758891,skyCol:11378567,skyColFar:16761989,skyMap:null,hemTop:16769727,hemGround:0,water:11378325,amb:.4,hem:.2,dir:.5,fogNear:-.05,fogFar:1,sunPos:[0,100,-75]},marsRise:{col:5338516,skyCol:2368806,skyColFar:5338516,skyMap:null,amb:0,hem:.25,dir:.25,headlights:!0,headlightColour:9694965,fogNear:-.1,fogFar:1,sunPos:[0,100,200]},marsNight:{col:1579803,skyCol:1183766,skyColFar:1579803,skyMap:null,amb:.7,hem:.5,dir:.2,headlights:!0,headlightColour:9694965},venus:{audio:{ambiance:{src:fr,ls:.1,le:.1},wind:{src:br,ls:.1,le:.1}},col:14729798,skyCol:12624422,skyColFar:12624422,skyMap:wr,water:null,amb:0,hem:.5,dir:.5,fogNear:-.1,fogFar:.5},venusSet:{col:6049571,skyCol:2366739,skyColFar:6049571,skyMap:wr,water:null,amb:.2,hem:.6,dir:.2,fogNear:-.2,fogFar:.5,headlights:!0,headlightColour:16773557},moon:{audio:{ambiance:{src:null,ls:.1,le:.1},wind:{src:null,ls:.07,le:.07}},col:1118480,skyCol:1118480,skyColFar:1118480,skyMap:null,hemTop:16777215,hemGround:0,water:null,amb:2,hem:0,dir:15,fogNear:.25,fogFar:1,sunPos:[-25,100,75]}},skins:{default:{name:"mars",weathers:["mars","marsRise"],surface:Yo,subSurface:Vo,gravel:Qo,gravelBump:Xo,rock:$o,cliff:tr,shale:Jo,shaleBump:qo,rubble:Ko,rubbleBump:_o,road:Ho,roadBase:Qo,friction:{road:.99,side:.95,grass:.9},walls:{barrier:ir}},venus:{name:"venus",weathers:["venus","venusSet"],surface:sr,subSurface:nr,gravel:nr,cliff:hr,rock:rr,shale:ar,rubble:or,road:lr,roadBase:nr,water:null,friction:{road:.99,side:.95,grass:.9},walls:{barrier:dr}},moon:{name:"moon",weathers:["moon"],surface:cr,subSurface:pr,gravel:ur,cliff:mr,rock:pr,shale:gr,rubble:null,road:xr,roadBase:ur,water:null,friction:{road:.99,side:.9,grass:.8},walls:{barrier:dr}}}};let Sr=new r.F({map:st(Yo,0)});Sr.userData.surfaceMap={value:null},Sr.userData.surfaceBump={value:st(Uo,0)},Sr.userData.subSurfaceMap={value:null},Sr.userData.shaleMap={value:null},Sr.userData.shaleBump={value:st(qo,4)},Sr.userData.rockMap={value:null},Sr.userData.rockBump={value:st(er,0)},Sr.userData.cliffMap={value:null},Sr.userData.cliffBump={value:st(Xo,0)},Sr.userData.gravelMap={value:null},Sr.userData.roadBaseMap={value:null},Sr.userData.fadeRockMap={value:st(Ar,4)},Sr.userData.fadeFiner={value:st(yr,4)},Sr.onBeforeCompile=e=>(e.uniforms.surfaceMap=Mr.userData.surfaceMap,e.uniforms.surfaceBump=Mr.userData.surfaceBump,e.uniforms.subSurfaceMap=Mr.userData.subSurfaceMap,e.uniforms.shaleMap=Mr.userData.shaleMap,e.uniforms.shaleBump=Mr.userData.shaleBump,e.uniforms.rockMap=Mr.userData.rockMap,e.uniforms.rockBump=Mr.userData.rockBump,e.uniforms.cliffMap=Mr.userData.cliffMap,e.uniforms.cliffBump=Mr.userData.cliffBump,e.uniforms.gravelMap=Mr.userData.gravelMap,e.uniforms.roadBaseMap=Mr.userData.roadBaseMap,e.uniforms.fadeRockMap=Mr.userData.fadeRockMap,e.uniforms.fadeFiner=Mr.userData.fadeFiner,e.vertexShader=e.vertexShader.replace("#include <displacementmap_pars_vertex>","\n\nattribute float heightOffset;\nattribute float roadProximity;\nattribute float curvature;\nattribute vec2 wuv;\n\nvarying float height;\nvarying float steepness;\nvarying float roadProx;\nvarying float vCurvature;\nvarying vec2 vWv;\nvarying vec2 vWWv;\n\nuniform sampler2D displacementMap;\nuniform sampler2D fadeFiner;\n\nfloat wuvSize = 150.0;\n\nfloat map(float value, float min1, float max1, float min2, float max2) {\n  return min2 + (value - min1) * (max2 - min2) / (max1 - min1);\n}\n\nvec3 upvec = vec3(0.0,1.0,0.0);\n\n"),e.vertexShader=e.vertexShader.replace("#include <displacementmap_vertex>","\n\n  vec4 wPos = modelMatrix * vec4( position, 1.0 );\n  height = wPos.y + heightOffset;\n\n  vUv.x = wPos.x / 10.0;\n  vUv.y = wPos.z / 10.0;\n\n\n  // 0 is perfectly flat, 1 is 90 degrees\n  steepness = 1.0 - dot(normal, upvec);\n  steepness = clamp(steepness * 4.0, 0.0, 1.0);\n\n  // Anything up to 0.8 is 1\n  // 0.8 down to 0.6\n  // 0.6 and under is 0\n\n  // steepness = 1.0 - clamp((steepness - 0.6) / 0.2, 0.0, 1.0);\n  // steepness = 1.0 - map(steepness, 0.2, 0.7, 0.0, 1.0);\n\n  // steepness = 1.0 - steepness;//clamp((steepness * 2.0), 0.0, 1.0);\n  // steepness = map(steepness, 0.0, 1.0, 0.3, 0.7);\n\n  if(roadProximity < 0.0) {\n    roadProx = -roadProximity * 2.0;\n    steepness = 0.0;\n  } else {\n    roadProx = 0.0;\n  }\n  // roadProx = roadProximity;\n\n  // if(roadProx > -1.0) {\n  //   transformed.y += texture2D( fadeFiner, vUv ).r * 0.1;\n  // }\n\n  // MAGIC NUMBERS TO BE TWEAKED BASED ON HEIGHT PARAMETERS\n  if(curvature > 0.0) {\n    vCurvature = min(1.0, curvature * 5.0);\n  } else {\n    vCurvature = max(-1.0, curvature * 5.0);\n  }\n\n  // TODO PASS IN SCALE AS UNIFORM\n  vWv.x = wPos.x / wuvSize;\n  vWv.y = wPos.z / wuvSize;\n\n  vWWv.x = vWv.x / 10.0;\n  vWWv.y = vWv.y / 10.0;\n\n  transformed += vec3(0.0, heightOffset, 0.0);\n\n  // Experimenting with displacement map\n  if(steepness > 0.3) {\n    transformed += normalize( objectNormal ) * ( texture2D( fadeFiner, vUv ).x * (steepness-0.3) * 0.5 );\n  }\n\n"),e.fragmentShader=e.fragmentShader.replace("#include <map_pars_fragment>","\n\n  varying float height;\n  varying float steepness;\n  varying float roadProx;\n  varying float vCurvature;\n  varying vec2 vWv;\n  varying vec2 vWWv;\n\n  uniform sampler2D surfaceMap;\n  uniform sampler2D subSurfaceMap;\n  uniform sampler2D surfaceBump;\n  uniform sampler2D shaleMap;\n  uniform sampler2D shaleBump;\n  uniform sampler2D rockMap;\n  uniform sampler2D rockBump;\n  uniform sampler2D cliffMap;\n  uniform sampler2D cliffBump;\n  uniform sampler2D gravelMap;\n  uniform sampler2D gravelBump;\n  uniform sampler2D roadBaseMap;\n  uniform sampler2D fadeRockMap;\n  uniform sampler2D fadeFiner;\n\n\n  vec4 terrainBlend(vec4 tx1, float w1, vec4 tx2, float w2, float depth) {\n    // Perform the blending\n    float ma = max(tx1.a + w1, tx2.a + w2) - depth;\n    float b1 = max(tx1.a + w1 - ma, 0.0);\n    float b2 = max(tx2.a + w2 - ma, 0.0);\n\n    return ((tx1 * b1) + (tx2 * b2)) / (b1 + b2);\n  }\n\n"),e.fragmentShader=e.fragmentShader.replace("#include <map_fragment>","\n\n  vec4 texelColor = texture2D( surfaceMap, vUv );\n\n  // Prep textures ahead of blending\n  vec4 surfaceTex = texture2D(surfaceMap, vUv); //vec4(0.7,0.7,0.0,1.0);\n  vec4 subSurfaceTex = texture2D(subSurfaceMap, vUv); //vec4(0.5,0.5,0.0,1.0);\n  vec4 shaleTex = texture2D(shaleMap, vUv);\n\n  vec4 rockTex = texture2D(rockMap, vUv); //vec4(0.3,0.3,0.1,1.0);\n\n  vec4 gravelTex = texture2D(gravelMap, vUv);\n  vec4 cliffTex = texture2D(cliffMap, vUv); //vec4(0.15,0.15,0.0,1.0);\n\n  // Get our fades at different scales\n  float fade0 = texture2D( fadeRockMap, vUv ).r;\n  float fade1 = texture2D( fadeRockMap, vWv ).r;\n  float fade2 = texture2D( fadeRockMap, vWWv ).r;\n\n  // Set alphas from maps etc.\n  float rockFade = texture2D(rockBump, vWv).r;\n  rockTex.a = texture2D(rockBump, vUv).r;\n  gravelTex.a = texture2D(gravelBump, vUv).r;\n  cliffTex.a = texture2D(cliffBump, vUv).r;\n  surfaceTex.a = texture2D(surfaceBump, vUv).r;\n  shaleTex.a = texture2D(shaleBump, vUv).r;\n\n  subSurfaceTex.a = fade1;\n\n  float roadProx2 = 1.0 - max(0.0, min(1.0, roadProx*0.25));\n\n  float w;\n\n  //// SAND/SURFACE\n\n  texelColor = mix(surfaceTex, subSurfaceTex, max(0.0,vCurvature-0.5)*fade2);\n\n  //// SHALE\n\n  if(vCurvature >= fade2) {\n    w = (vCurvature - fade2 * fade1) * roadProx2;\n\n    if(fade1 > 0.5) {\n      w *= 1.0 - (fade1 - 0.5) * 2.0;\n    }\n\n    w = min(0.6, w);\n    texelColor.a = 0.5;\n    texelColor = terrainBlend(texelColor, 1.0 - w, shaleTex, w, 0.1);\n  } else if(fade2 > 0.25) {\n    w = (fade2 - 0.25) * roadProx2;\n    texelColor = terrainBlend(texelColor, 1.0 - w, shaleTex, w, 0.1);\n  }\n\n  //// ROCK OUTCROPS\n\n  w = max(-0.8, ((vCurvature - fade2) * max(0.5, fade1))) * roadProx2;\n  rockTex.a -= rockFade;\n\n  if(w < 0.0) {\n    texelColor.a = 0.25 + fade2; //max(0.75, fade1);\n    texelColor = terrainBlend(texelColor, 1.0+w, rockTex, -w, 0.2);\n  } else if(fade1 > 0.5) {\n    texelColor.a = 0.25 + fade2;\n    w = (fade1 - 0.5) * 2.0;\n    texelColor = terrainBlend(texelColor, 1.0-w, rockTex, w, 0.2);\n  }\n\n  //// CLIFFS\n\n  if(steepness > 0.2) {\n    w = (steepness-0.2) + fade1 * 0.2;\n    texelColor = terrainBlend(texelColor, 1.0-w, cliffTex, w, 0.2);\n  }\n\n  //// ROAD PROXIMITY\n\n  if(roadProx > 0.0) {\n    w = min(1.0, (roadProx/2.5) - fade1*fade0);\n    texelColor = terrainBlend(texelColor, 1.0-w, gravelTex, w, 0.5);\n  }\n\n  texelColor.a = 1.0;\n\n  diffuseColor *= texelColor;\n\n"),e);const Mr=Sr,Dr=(e,t)=>{zr=kr[Math.floor((e+t)/2)],Nr=Cr[e],jr=jt,Or()},Cr=[5,10,15,20];let Nr=10;const kr=[500,1e3,2e3,3e3];let zr=1e3;let jr=32;const Lr=[],Or=()=>{Lr.length=0;let e,t=new window.alea("bump");for(let i=0;i<jr;i++){e=[];for(let i=0;i<jr;i++)e.push(.1*t());e.push(e[0]),Lr.push(e)}Lr.push(Lr[0])};Dr(ot,rt),Or();var Rr=Ir;var Tr={rock:{src:i(42),obj:null}};var Pr=class{constructor(e,t){this.loader=new sn.a,this.assetCount=Object.keys(e).length,this.loadCount=0,this.onComplete=t,this.loadedAssets={};for(let i in e)this.loader.load(e[i].src.default,(e=>{this.loadedAssets[i]=e,this.onLoaded(i)}))}onLoaded(e){++this.loadCount>=this.assetCount&&this.onComplete(this.loadedAssets)}},Gr=i.p+"static/media/marsmarker.6a313c62.obj";const Br={black:new r.D({color:5588019}),reflect:new r.D({color:2293725,emissive:2293725,emissiveIntensity:.2})};var Wr=class extends an{constructor(...e){super(...e),this.geoSource=Gr,this.objectType="VergeMarker",this.materials=Br}},Fr=i.p+"static/media/marsbarrier.c460e93d.obj";const Er={black:new r.D({color:5588019}),reflect:new r.D({color:2293725,emissive:2293725,emissiveIntensity:.75})};const Zr={VergeMarker:{class:Wr,geo:null},BarrierMarker:{class:class extends an{constructor(...e){super(...e),this.geoSource=Fr,this.objectType="BarrierMarker",this.materials=Er}},geo:null}},Hr="BarrierMarker";var Qr=new class{constructor(){this.lastRepositionIndex=0,this.pools={},this.active=[],this.loadingQueue=[],this.getHeightAt=()=>{},this.loadCounter=0,this.didLoadBound=this.didLoad.bind(this),this.addObjectBound=this.addObject.bind(this),this.container=new r.G,this.container.matrixAutoUpdate=!1,this.loadingQueue=[]}destroy(){this.loadingQueue.length=0;for(let t in this.pools){var e;for(let e of this.pools[t])e.destroy();null===(e=Zr[t].geo)||void 0===e||e.destroy()}for(let t of this.active)t.destroy();for(this.active.length=0,this.pools={};this.container.children.length;)this.container.remove(this.container.children[0])}initialise(e){this.getHeightAt=e,this.initLibrary()}reset(e){this.getHeightAt=e}initLibrary(){for(let e in Zr)this.loadObject(e),this.pools[e]=[]}loadObject(e){let t=Zr[e],i=new t.class;i.initialiseGeometry((()=>{t.geo=i,this.didLoad()}))}didLoad(){if(this.loadCounter++,this.loadCounter>=Object.keys(Zr).length)for(;this.loadingQueue.length;){let e=this.loadingQueue.pop();this.addObject(...e)}}addCustom(e,t,i,s,n=null){if(n||(n=5),ii.vehicleIndex>s+n)return;let a;for(e.keyName=null,e.worldPosition=t.clone(),e.position.subVectors(e.worldPosition,this.container.position),e.rotation.y=i,e.visible=!0,e.retireIndex=s+n,this.container.add(e),a=0;a<this.active.length&&!(this.active[a].retireIndex>e.retireIndex);a++);this.active.splice(a,0,e)}addObject(e,t,i,s,n=null){if(!(e in Zr))return void console.error("Unrecognised roadside object type ",e);if(!Zr[e].geo)return void this.loadingQueue.push([e,t,i,s,n]);let a,o;for(this.pools[e].length?a=this.pools[e].pop():(a=Zr[e].geo.clone(),this.container.add(a),tn["roadside-objects"]++),a.keyName=e,a.worldPosition.copy(t),a.position.subVectors(a.worldPosition,this.container.position),a.rotation.y=i,a.visible=!0,a.retireIndex=s+5,null!==n&&a.setVariant(n),o=0;o<this.active.length&&!(this.active[o].retireIndex>a.retireIndex);o++);return this.active.splice(o,0,a),a}update(){if(this.active.length&&ii.vehicleIndex>=this.active[0].retireIndex){let e=this.active.shift();e.visible=!1,e.keyName?this.pools[e.keyName].push(e):this.container.remove(e)}if(ii.vehicleIndex-this.lastRepositionIndex>100){this.container.position.x=ii.vehicleNode.p.x,this.container.position.z=ii.vehicleNode.p.z,this.container.updateMatrix();for(let e of this.container.children)e.position.subVectors(e.worldPosition,this.container.position);this.lastRepositionIndex=ii.vehicleIndex}}};const Yr=.8,Vr=151,Ur=.65,Xr=((e,t=.75,i=0,s=null,n=null,a=!1)=>{let o=new r.F({map:_e(e,i,r.O),alphaTest:t,side:r.k,depthTest:!0,roughness:1,flatShading:!0});return s&&(o.normalMap=_e(s,i)),o.onBeforeCompile=et,o})(null,.75,8,null,null,!0),Jr={};class qr extends Cn{constructor(e=null){super(),this.p=new r.W,this.ni=0,this.mapSource=null,this.normSource=null,this.material=Xr,this.mesh=new r.B(qr.getGeo(),this.material),this.mesh.matrixAutoUpdate=!1,this.mesh.geometry.setDrawRange(0,0),this.posAttribute=this.mesh.geometry.attributes.position,this.posArr=this.posAttribute.array,this.uvAttribute=this.mesh.geometry.attributes.uv,this.uvArr=this.uvAttribute.array,e&&this.drawSegment(e),this.applyMaterial()}applyMaterial(){this.mapSource&&(this.material.map=st(this.mapSource,4)),this.normSource&&(this.material.normalMap=st(this.normSource,4))}setMap(e){this.material.map=e}drawSegment(e){return this.seg=e,this.drawNode=this.seg.startNode,this.pi=0,this.ui=0,this.ni=0,this.ox=this.seg.startNode.p.x,this.oz=this.seg.startNode.p.z,this.uvDist=0,this.side=Math.sign(e.distance),this.drawNextNode()}drawNextNode(){for(Jr.dnp=this.drawNode.p,this.ni>0?(this.bounds.maxX=Math.max(this.bounds.maxX,Jr.dnp.x-this.ox),this.bounds.minX=Math.min(this.bounds.minX,Jr.dnp.x-this.ox),this.bounds.maxY=Math.max(this.bounds.maxY,Jr.dnp.y),this.bounds.minY=Math.min(this.bounds.minY,Jr.dnp.y),this.bounds.maxZ=Math.max(this.bounds.maxZ,Jr.dnp.z-this.oz),this.bounds.minZ=Math.min(this.bounds.minZ,Jr.dnp.z-this.oz)):(this.bounds.maxX=Jr.dnp.x-this.ox,this.bounds.minX=Jr.dnp.x-this.ox,this.bounds.maxY=Jr.dnp.y,this.bounds.minY=Jr.dnp.y,this.bounds.maxZ=Jr.dnp.z-this.oz,this.bounds.minZ=Jr.dnp.z-this.oz),Jr.j=0;Jr.j<this.drawNode.ps.length;Jr.j+=2)Jr.pj=this.drawNode.ps[Jr.j],Jr.nj=this.drawNode.ns[Jr.j],Jr.x=Jr.pj.x+Jr.nj.x*this.seg.distance,Jr.x1=Jr.x+.1*Jr.nj.x*this.side,Jr.z=Jr.pj.z+Jr.nj.z*this.seg.distance,Jr.z1=Jr.z+.1*Jr.nj.z*this.side,this.posArr[this.pi++]=Jr.x1-this.ox,this.posArr[this.pi++]=Jr.pj.y,this.posArr[this.pi++]=Jr.z1-this.oz,this.posArr[this.pi++]=Jr.x-this.ox,this.posArr[this.pi++]=Jr.pj.y+.52,this.posArr[this.pi++]=Jr.z-this.oz,this.posArr[this.pi++]=Jr.x-this.ox,this.posArr[this.pi++]=Jr.pj.y+.7200000000000001,this.posArr[this.pi++]=Jr.z-this.oz,this.posArr[this.pi++]=Jr.x1-this.ox,this.posArr[this.pi++]=Jr.pj.y+Yr,this.posArr[this.pi++]=Jr.z1-this.oz;return this.ni++,this.drawNode=this.drawNode.next,!(this.drawNode.i<this.seg.endNode.i)&&(Jr.pj=this.drawNode.p,Jr.nj=this.drawNode.n,Jr.x=Jr.pj.x+Jr.nj.x*this.seg.distance,Jr.z=Jr.pj.z+Jr.nj.z*this.seg.distance,Jr.x1=Jr.x+.1*Jr.nj.x*this.side,Jr.z1=Jr.z+.1*Jr.nj.z*this.side,this.posArr[this.pi++]=Jr.x1-this.ox,this.posArr[this.pi++]=Jr.pj.y,this.posArr[this.pi++]=Jr.z1-this.oz,this.posArr[this.pi++]=Jr.x-this.ox,this.posArr[this.pi++]=Jr.pj.y+.52,this.posArr[this.pi++]=Jr.z-this.oz,this.posArr[this.pi++]=Jr.x-this.ox,this.posArr[this.pi++]=Jr.pj.y+.7200000000000001,this.posArr[this.pi++]=Jr.z-this.oz,this.posArr[this.pi++]=Jr.x1-this.ox,this.posArr[this.pi++]=Jr.pj.y+Yr,this.posArr[this.pi++]=Jr.z1-this.oz,this.mesh.geometry.setDrawRange(0,5*this.seg.length*6*3),this.computeBoundingSphere(),this.mesh.geometry.boundingSphere=this.boundingSphere,this.mesh.position.set(this.ox,-.1,this.oz),this.posAttribute.needsUpdate=!0,this.mesh.visible=!0,this.mesh.updateMatrix(),this.seg.contiguousStart||(this.p.x=this.posArr[0]+this.mesh.position.x,this.p.y=this.posArr[1],this.p.z=this.posArr[2]+this.mesh.position.z,Qr.addObject(Hr,this.p,Math.PI+Math.PI/2*this.side-this.seg.startNode.a,this.seg.startNode.i)),!0)}retire(){this.mesh.visible=!1}computeBoundingSphere(){Jr.minX=this.bounds.minX,Jr.maxX=this.bounds.maxX,Jr.minY=this.bounds.minY,Jr.maxY=this.bounds.maxY,Jr.minZ=this.bounds.minZ,Jr.maxZ=this.bounds.maxZ,this.boundingSphere.center.x=(Jr.minX+Jr.maxX)/2,this.boundingSphere.center.y=(Jr.minY+Jr.maxY)/2,this.boundingSphere.center.z=(Jr.minZ+Jr.maxZ)/2,this.boundingSphere.radius=Math.sqrt((Jr.maxX-Jr.minX)*(Jr.maxX-Jr.minX)+(Jr.maxY-Jr.minY)*(Jr.maxY-Jr.minY)+(Jr.maxZ-Jr.minZ)*(Jr.maxZ-Jr.minZ))/2+10}static getNorms(){let e=[];for(let t=0;t<Vr;t++)e.push(0,1,0,0,1,0,0,1,0,0,1,0);return e}static getUV(){let e=[],t=0;for(let i=0;i<Vr;i++)t=.4*i,e.push(t,0,t,Ur,t,.9,t,1);return e}static getGeo(){let e=new r.g;e.setIndex(qr.getIndex()),e.setAttribute("position",new r.o(new Float32Array(1812),3)),e.attributes.position.setUsage(r.l),e.setAttribute("uv",new r.o(new Float32Array(qr.getUV()),2));let t=new Float32Array(qr.getNorms());return e.setAttribute("normal",new r.o(t,3)),e}static getIndex(){let e,t,i,s,n,a,o,r,h=[];for(let l=0;l<Vr;l++)e=4*l,t=e+1,i=e+2,s=e+3,n=4*(l+1),a=n+1,o=n+2,r=n+3,h.push(e,t,n,t,a,n,t,i,a,i,o,a,i,s,o,s,r,o);return h}}class Kr extends Pn{generate(e){let t=e.prev;for(e=e.next;this.test(t)&&t.prev&&t.i>this.prev.endNode.i;)t=t.prev;for(t.i-this.prev.endNode.i<4&&(t=this.prev.endNode);this.test(e)&&e.i-t.i<qt;)e=e.next;let i=new Tn(t,e,this.typeID,(t.w+Vt)*this.side);return this.prev.endNode.i==t.i&&this.prev.type==i.type&&(this.prev.contiguousEnd=!0,i.contiguousStart=!0,i.distance=this.prev.distance),i}testGenLeft(e){return!e.bridge&&null==e.lWallDist&&e.i>=this.prevLeft.endNode.i&&(e.g<-1.25||e.g<0&&e.da>.25&&e.h<.6)}testGenRight(e){return!e.bridge&&null==e.rWallDist&&e.i>=this.prevRight.endNode.i&&(e.g>1.25||e.g>0&&e.da<-.25&&e.h<.6)}testLeft(e){return!e.bridge&&e.p.y>3&&(e.g<-.75||e.g<.1&&e.da<-.05&&e.h<.6)}testRight(e){return!e.bridge&&e.p.y>3&&(e.g>.75||e.g>-.1&&e.da>.05&&e.h<.6)}}const _r={Barrier:0},$r=[qr];var eh=class{constructor(e){this.stagedSegments=[],this.activeSegments=[],this.count=0,this.prevWasContiguous=!1,this.getHeightAt=e,this.container=new r.G,this.segments=[],this.initPools()}initialise(){this.renderIndex=ii.vehicleIndex,this.genNode=ii.vehicleNode,this.genIndex=ii.vehicleIndex,this.genNodeLeft=ii.vehicleNode,this.genNodeRight=ii.vehicleNode,this.barrierGenerator=new Kr(ii.vehicleNode,_r.Barrier),this.segments.length=0;do{this.updateGeneration()}while(this.genIndex<ii.vehicleIndex+Xt);for(;this.segments.length>0&&ii.vehicleIndex+Jt>=this.segments[0].startNode.i;)this.drawNextSegment();do{this.updateStaged()}while(this.stagedSegments.length)}reset(e){this.getHeightAt=e,this.resetPools(),this.initialise()}initPools(){this.pools=[];let e,t,i=Object.keys(_r).length;for(e=0;e<i;e++)t=new $r[e](null,this.getHeightAt),this.container.add(t.mesh),this.pools.push([t])}resetPools(){for(;this.activeSegments.length;)this.retireSegment(this.activeSegments.shift())}setSkin(e){}handleMidlineReset(){(ii.tail.i<this.genNodeLeft.i||ii.tail.i<this.genNodeRight.i)&&(console.error("Wall controller must handle reset gracefully"),this.genNodeLeft=ii.tail,this.genNodeRight=ii.tail,this.renderIndex=ii.tail.i)}updateGeneration(){this.genIndex++,this.genNodeLeft.i<this.genIndex&&(this.genNodeLeft=this.genNodeLeft.next,this.checkGenerateLeftSegment()),this.genNodeRight.i<this.genIndex&&(this.genNodeRight=this.genNodeRight.next,this.checkGenerateRightSegment())}update(){for(this.updateGeneration();this.segments.length>0&&ii.vehicleIndex+Jt>=this.segments[0].startNode.i;)this.drawNextSegment();if(this.activeSegments.length)for(;ii.vehicleIndex>this.activeSegments[0].endNode.i+10&&(this.retireSegment(this.activeSegments.shift()),0!=this.activeSegments.length););}updateStaged(){this.stagedSegments.length&&this.stagedSegments[0].drawNextNode()&&(this.stagedSegments.shift(),tn.walls=this.activeSegments.length+" ("+this.stagedSegments.length+")")}checkGenerateLeftSegment(){this.addLeftSegment(this.barrierGenerator.generateLeft(this.genNodeLeft))}checkGenerateRightSegment(){this.addRightSegment(this.barrierGenerator.generateRight(this.genNodeRight))}addRightSegment(e){if(!e)return;let t=e.startNode;for(;t.i<e.endNode.i;)(!t.rWallDist||t.rWallDist>e.distance)&&(t.rWallDist=e.distance,t.wallSide=-1),t=t.next;this.segments.push(e)}addLeftSegment(e){if(!e)return;let t=e.startNode;for(;t.i<e.endNode.i;)(!t.lWallDist||t.lWallDist>-e.distance)&&(t.lWallDist=-e.distance,t.wallSide=1),t=t.next;this.segments.push(e)}getSegmentObject(e){let t;if(this.pools[e].length)t=this.pools[e].pop();else{t=new(0,$r[e])(null,this.getHeightAt),this.container.add(t.mesh)}return t}drawNextSegment(){let e=this.segments.shift(),t=this.getSegmentObject(e.type);t.drawSegment(e)||this.stagedSegments.push(t),e.obj=t,this.activeSegments.push(e),tn.walls=this.activeSegments.length+" ("+this.stagedSegments.length+")"}retireSegment(e){e.obj.retire(),this.pools[e.type].push(e.obj),tn.walls=this.activeSegments.length+" ("+this.stagedSegments.length+")"}disable(){this.container.visible=!1}enable(){this.container.visible=!0}};const th=new r.F({map:null});const ih=new class{constructor(){this.loader=new sn.a,this.meshes=[],this.template=null;let e=st(_o);th.map=e,th.bumpMap=e,th.bumpScale=.02}getInstancedMesh(e){let t=new r.u(Tr.rock.geo.clone(),th,e);return t.matrixAutoUpdate=!1,t.instanceMatrix.setUsage(r.l),this.template||this.meshes.push(),t}};class sh extends to{constructor(){super(),this.index=0,this.mesh=ih.getInstancedMesh(zr),this.mesh.receiveShadow=!0,this.retireNodeIndex=-1,this.showNodeIndex=0}}sh.typeName="rubble",sh.rubbleController=ih;var nh=new io(sh,zr,Nr);const ah=new r.G,oh=new Gn(119),rh=new Gn(47,6.28),hh=new Gn(119,.7,-.1),lh={},dh=(e,t,i,s)=>(lh.x=Math.round((e-i.x)/Rt*jr),lh.z=Math.round((t-i.z)/Rt*jr),lh.x<0?lh.x+=jr:lh.x>=jr&&(lh.x-=jr),lh.z<0?lh.z+=jr:lh.z>=jr&&(lh.z-=jr),Lr[lh.x][lh.z]);class ch extends oi{constructor(...e){super(...e),this.rubbleProb=.05,this.rubbleProb=100/(this.res1*this.res1)}lerpHeight(e,t,i){i.ga=Math.abs(i.g),i.w+=Vt+.25*i.ga;let s=0,n=16*(1-Math.max(.25,Math.min(.5,.25*i.ga)));if(i.d<i.w+n)if(i.d<i.w)s=i.y,i.d<i.w-1?s+=.15*dh(e,t,this.originPos,this.res):s+=dh(e,t,this.originPos,this.res)*(1-(i.w-i.d));else{let a=Math.max(0,Math.min(1,(i.d-i.w)/n));a=ch.hockeyLerp(a),s=this.heightmap.getXZ(e,t),s=s*a+i.y*(1-a)+dh(e,t,this.originPos,this.res)*Math.max(0,Math.min(1,1-(i.d-i.w)/n))}else s=this.heightmap.getXZ(e,t);return s}postProcessRow(e){nh.active&&this.placeRubbleRow(e)}placeRubbleRow(e){let t,i,s,n,a,o;for(let r=0;r<this.res;r++)t=e*this.res1+r,s=this.heights[t],i=this.signedRoadProx[t],n=[this.norms[3*t],this.norms[3*t+1],this.norms[3*t+2]],a=i>.2&&i<20?this.grads[t]<.1?1:.1-this.grads[t]:0,o=hh.next(),a*=Math.abs(this.curves[t]),a*this.rubbleProb>oh.next()&&(s-=i<Vt?Vt-i:i/20*.2,s-=.1*o,ah.position.set((this.coords.x+e/this.res)*Rt+(oh.next()-.5),s-this.grads[t]/2,(this.coords.z+r/this.res)*Rt+(oh.next()-.5)),ah.scale.set(o,o,o),ah.rotation.y=rh.next(),ah.rotation.x=rh.next(),ah.updateMatrix(),nh.addInstance(this.lod,ah.matrix,0,this.originIndex,ah.position,n))}postProcessCell(){}display(){super.display(),1==this.lod&&this.tileset.mesh.visible&&nh.updateCurrentInstance(1)}}ch.paved=!1;var ph=ch;var uh=class extends di{},gh=i.p+"static/media/earthrise.c3eff6a4.webp";class mh extends ci{constructor(e){super(),this.groundMaterial=Mr,this.nearGridCell=ph,this.farGridCell=uh,this.skinList=Object.keys(Rr.skins),this.skinIndex=0,this.weatherList=Object.keys(Rr.weathers),this.weatherIndex=0,this.skinWeatherList=[],this.weatherOverride=!1,this.topoList=Object.keys(Rr.topography),this.topoIndex=0,this.ambiantAudio=null,this.windAudio=null,this.cachedTextures={default:{}},this.hasRubble=!0,this.lastVehicleIndex=0,this.loadState={init:!1,assets:!1,walls:!1,reset:!0,progress:0},this.p=new r.W,this.curWeatherIndex=0,this.audioLerp=0,this.onToggleBarriersBound=this.onToggleBarriers.bind(this),this.getHeightAt=e,this.container=new r.G,this.config=Rr}updateConfig(e,t){Dr(e,t),nh.revert(zr,Nr)}destroy(){var e,t;te.removeListener("Barriers",this.onToggleBarriersBound),Qr.destroy(),null===(e=this.ambientAudio)||void 0===e||e.stop(),null===(t=this.windAudio)||void 0===t||t.stop(),this.container.traverse((e=>{e.isMesh&&e.geometry.dispose()})),this.container.clear();for(let i in this.cachedTextures)for(let e in this.cachedTextures[i])if(this.cachedTextures[i][e].isTexture)this.cachedTextures[i][e].dispose();else for(let t in this.cachedTextures[i][e])this.cachedTextures[i][e][t].isTexture&&this.cachedTextures[i][e][t].dispose();delete this.cachedTextures,this.destroyAssets(),nh.destroy()}initialise(e,t,i){var s;this.seed=e;let n=t.topography;this.topoIndex=this.topoList.indexOf(n),null===(s=this.heightmap)||void 0===s||s.destroy(),this.heightmap=new Zo(e,Rr.topography[n].heightmap),this.loadState.init=!1,this.loadState.progress=0,ft(Rr.topography[n].smoothWindow),Yt(Rr.topography[n].roadWidth),this.hasRubble=Sh.value.detailLodIndex>0,this.loadState.assets||new Pr(Tr,this.onAssetsLoaded.bind(this)),i()}onGridReady(){nh.updateVisible()}reset(e,t,i){this.loadState.reset=!1,this.initialise(e,t,(()=>{this.loadState.init=!0,i()}))}destroyAssets(){for(let e in Tr)Tr[e].geo.dispose()}onAssetsLoaded(e){for(let t in Tr)Tr[t].geo=e[t].children[0].geometry;nh.revert(zr,Nr),this.loadState.assets=!0}loader(){return this.loadState.init?this.loadState.assets?this.loadState.walls?(this.loadState.reset||(this.lastVehicleIndex=ii.vehicleIndex,this.wallController.reset(this.getHeightAt),Qr.reset(this.getHeightAt),this.loadState.reset=!0),nh.revert(zr,Nr),1):(this.wallController=new eh(this.getHeightAt),this.wallController.initialise(),this.container.add(this.wallController.container),this.loadState.walls=!0,te.addListener("Barriers",this.onToggleBarriersBound),this.onToggleBarriers(te.Barriers),.9):(this.loadState.walls=!1,.7):(this.lastVehicleIndex=ii.vehicleIndex,this.earthrise||(this.earthrise=new r.B(new r.J(10,10),new r.C({map:st(gh),fog:!1,depthTest:!1,alphaTest:.5,side:r.k})),this.earthrise.renderOrder=-1,this.earthrise.rotation.y=-Math.PI/2,this.container.add(this.earthrise)),Qr.initialise(this.getHeightAt),this.container.add(Qr.container),this.hasRubble&&this.container.add(nh.container),nh.active=this.hasRubble,this.loadState.init=!0,.3)}handleMidlineReset(){this.wallController.handleMidlineReset()}update(){if(this.earthrise.visible&&(this.earthrise.position.x=Us.position.x+100,this.earthrise.position.y=Us.position.y+15,this.earthrise.position.z=Us.position.z),ii.vehicleIndexDidChange)do{this.lastVehicleIndex++,this.wallController.update(),Qr.update(),this.hasRubble&&nh.updateVisible()}while(this.lastVehicleIndex<ii.vehicleIndex);this.wallController.updateStaged()}nextSkin(){this.setSkin(this.skinList[++this.skinIndex%this.skinList.length])}setTopography(e){window.localStorage.setItem("config-scene-topography",e)}nextTopography(){this.setTopography(this.topoList[++this.topoIndex%this.topoList.length])}loadGroundMaterialSkin(e,t,i,s,n=4){this.skin[e]?(i[e]||(i[e]=st(this.skin[e],n)),Mr.userData[t].value=i[e]):(s[e]||(s[e]=st(Rr.skins.default[e],n)),Mr.userData[t].value=s[e])}getSkinName(e){var t;return(null===(t=Rr.skins[e])||void 0===t?void 0:t.name)||e}setScene(e){this.setSkin(e.skin),this.setWeatherIndex(e.weatherIndex%this.skinWeatherList.length)}sanitiseConfig(e){super.sanitiseConfig(e),e.set("weatherIndex",0,!0)}setSkin(e){this.skinName=e,this.earthrise.visible="moon"==e;let t=Rr.skins.default;this.skin=Rr.skins[e],this.cachedTextures[e]||(this.cachedTextures[e]={});let i=this.cachedTextures[e],s=this.cachedTextures.default;this.loadGroundMaterialSkin("surface","surfaceMap",i,s),this.loadGroundMaterialSkin("subSurface","subSurfaceMap",i,s),this.loadGroundMaterialSkin("shale","shaleMap",i,s,8),this.loadGroundMaterialSkin("gravel","gravelMap",i,s),this.loadGroundMaterialSkin("rock","rockMap",i,s),this.loadGroundMaterialSkin("cliff","cliffMap",i,s),this.loadGroundMaterialSkin("roadBase","roadBaseMap",i,s),Mr.uniformsNeedUpdate=!0,this.skin.road?(i.road||(i.road=st(this.skin.road,8)),Ut.map=i.road):(s.road||(s.road=st(t.road,8)),Ut.map=s.road),this.skin.rubble?(i.rubble||(i.rubble=st(this.skin.rubble,2)),nh.container.visible=!0,th.map=i.rubble):nh.container.visible=!1,this.skin.walls?(i.walls||(i.walls={}),s.walls||(s.walls={}),Xr.visible=!0,"barrier"in this.skin.walls?(null==this.skin.walls.barrier&&(Xr.visible=!1),i.walls.barrier||(i.walls.barrier=st(this.skin.walls.barrier,4)),Xr.map=i.walls.barrier):(s.walls.barrer||(s.walls.barrier=st(t.walls.barrier,4)),Xr.map=s.walls.barrier)):(s.walls||(s.walls={}),s.walls.barrier||(s.walls.barrier=st(t.walls.barrier,4)),Xr.map=s.walls.barrier),this.skin.friction?(Wt(this.skin.friction.road),Et(this.skin.friction.side),Ht(this.skin.friction.grass)):(Wt(1.4),Et(.95),Ht(.85)),this.weatherOverride=!1,this.skin.weathers?(this.weatherOverride=!0,this.skinWeatherList=this.skin.weathers,this.setWeather(this.skinWeatherList[this.curWeatherIndex%this.skinWeatherList.length])):this.setWeather(this.weatherList[this.curWeatherIndex%this.weatherList.length])}setWeatherIndex(e){this.curWeatherIndex=e,this.weatherOverride?this.setWeather(this.skinWeatherList[e]):this.setWeather(this.weatherList[e])}nextWeather(){this.weatherOverride?this.setWeather(this.skinWeatherList[++this.weatherIndex%this.skinWeatherList.length]):this.setWeather(this.weatherList[++this.weatherIndex%this.weatherList.length])}updateAudio(){var e,t;this.t=Math.min(1,Us.speed/35),this.t*=this.t,this.t*=$s.wind,this.interiorVol=Xs.value?.33:1,this.audioLerp=.9*this.audioLerp+.1*this.t,null===(e=this.ambientAudio)||void 0===e||e.setVolume((1-this.audioLerp)*this.interiorVol*$s.ambient),null===(t=this.windAudio)||void 0===t||t.setVolume(.8*this.audioLerp*this.interiorVol*$s.wind)}setWeather(e){var t,i,s,n;this.weather=Rr.weathers[e];let a=Rr.weathers.default;this.ambientAudio&&this.ambientAudio.stop();let o=(null===(t=this.weather)||void 0===t||null===(i=t.audio)||void 0===i?void 0:i.ambiance)||a.audio.ambiance;null!==o.src&&me.getAudio(o.src,(e=>{this.ambientAudio&&this.ambientAudio.stop(),e.setLoop(!0),e.setLoopStart(o.ls),e.setLoopEnd(e.buffer.duration-o.le),this.ambientAudio=e,e.setVolume(0),e.play()})),this.windAudio&&this.windAudio.stop();let r=(null===(s=this.weather)||void 0===s||null===(n=s.audio)||void 0===n?void 0:n.wind)||a.audio.wind;null!==r.src&&me.getAudio(r.src,(e=>{e.setLoop(!0),e.setLoopStart(r.ls),e.setLoopEnd(e.buffer.duration-r.le),this.windAudio=e,e.setVolume(0),e.play()})),bt.intensity=this.weather.amb,bt.color.setHex(this.weather.col),At.intensity=this.weather.hem,At.color.setHex(this.weather.hemTop||this.weather.col),At.groundColor.setHex(this.weather.hemGround||this.weather.col),yt.intensity=this.weather.dir,yt.color.setHex(this.weather.col),yt.sunOffset.fromArray(this.weather.sunPos||[0,100,0]),be.setHeadlightColour(this.weather.headlightColour||16777215),It.setHex(this.weather.col),pt(this.weather.col,Ct*this.weather.fogNear,Ct*this.weather.fogFar),this.cachedTextures[e]||(this.cachedTextures[e]={});let h=this.cachedTextures[e],l=this.cachedTextures.default;Kt.userData.hasClouds.value=!0,"skyMap"in this.weather?null==this.weather.skyMap?Kt.userData.hasClouds.value=!1:(h.skyMap||(h.skyMap=st(this.weather.skyMap,2)),Kt.map=h.skyMap):(l.skyMap||(l.skyMap=st(a.skyMap,2)),Kt.map=l.skyMap),this.weather.skyCol?(Kt.userData.nearCol.value.setHex(this.weather.skyCol),Kt.userData.farCol.value.setHex(this.weather.skyColFar)):(Kt.userData.nearCol.value.setHex(a.skyCol),Kt.userData.farCol.value.setHex(a.skyColFar)),be.setHeadlights(!!this.weather.headlights)}onToggleBarriers(e){e?this.wallController.enable():this.wallController.disable()}}mh.config=Rr,mh.sceneName="Planet",mh.hasTrees=!1,mh.hasGrass=!1;const xh={Hills:Wo,Planet:mh},vh=["Hills","Planet"],wh=["straight","casual","easy","normal","hard"],fh=[.5,.75,1,1.5,2],bh={seed:"seed",sceneName:"config-scene-name",topography:"config-scene-topography",skin:"config-scene-skin",weatherIndex:"config-scene-weather-index",viewLodIndex:"config-view-lod-index",detailLodIndex:"config-detail-lod-index",antialias:"config-antialias",renderScale:"config-render-scale",verticalFov:"config-vertical-fov"},Ah={seed:Ee,sceneName:"Hills",topography:"normal",skin:"summer",weatherIndex:2,viewLodIndex:2,detailLodIndex:1,antialias:!0,renderScale:2,verticalFov:68},yh={viewLodIndex:{readable:"View Distance",type:u.Enum,labels:["Low","Medium","High","Ultra","Ultra+"],onSet:e=>Ih.set("viewLodIndex",e)},detailLodIndex:{readable:"Environment Detail",type:u.Enum,labels:["Low","Medium","High","Ultra"],onSet:e=>Ih.set("detailLodIndex",e)},renderScale:{readable:"Render Scale",type:u.Enum,labels:["50%","75%","100%","150%","200%"],onSet:e=>Ih.set("renderScale",e)},verticalFov:{readable:"Vertical FOV",type:u.FloatRange,default:68,min:40,max:80,precision:0,onSet:e=>Ih.set("verticalFov",e)}};const Ih=new class extends p{constructor(){super(),this.value={...Ah},this.initialValue={...Ah},this.initialNode=0,this.accumulatedProgress=0,this.sceneMeta={},this.buildSceneMeta(),this.loadConfig(),this.loadProgress();let e=window.location.search.substring(1).split("&");for(let t of e){let e=t.split("=");if("node"==e[0])try{let t=parseInt(e[1]);!isNaN(t)&&t>0&&(this.initialNode=t,console.log("Overwriting initial node from QS: ",e[1]))}catch(eu){console.error("Failed to load initial node from QS:",e[1])}else"topo"==e[0]&&(wh.includes(e[1])||"flat"===e[1]?(this.set("topography",e[1],!0),console.log("Overwriting topography from QS: ",e[1])):(console.warn("Invalid topo parameter; reverting to 'normal'"),this.set("topography","normal",!0)))}}resetMemory(){console.log("Resetting config to defaults");for(let e in this.value)window.localStorage.setItem(bh[e],Ah[e])}buildSceneMeta(){let e,t={current:Ah.sceneName,hasCycles:!1,scenes:{}};for(let i in xh){e=xh[i].config,t.scenes[i]={topography:Object.keys(e.topography),skins:Object.keys(e.skins)};let s={},n={};for(let a in e.skins)s[a]=e.skins[a].weathers.slice(),n[a]=e.skins[a].name,t.scenes[i].hasCycles=t.hasCycles||void 0!==e.skins[a].cycles;t.scenes[i].skinWeathers=s,t.scenes[i].skinNames=n}return this.sceneMeta=t,this.sceneMeta}set(e,t,i=!1){i||!d.value?("verticalFov"==e&&(Dt=t,Nt=Ct/Math.cos(Dt*(Math.PI/180)/2*(window.screen.availWidth/window.screen.availHeight)),Nt=Ct/Math.cos(Dt*(Math.PI/180)/2*(window.screen.availWidth/window.screen.availHeight))),super.set(e,t,i),window.localStorage.setItem(bh[e],t)):console.warn("Preventing config update to "+e+" during load")}loadConfig(){let e,t;for(t in this.value){if(e=window.localStorage.getItem(bh[t])||Ah[t],"sceneName"==t)e in xh||(console.warn("Loaded unrecognsied scene name "+e+", restoring default"),e=Ah.sceneName),this.sceneMeta.current=e;else try{e=JSON.parse(e)}catch(eu){}console.log("SceneConfig: Load ",t,e),this.set(t,e,!0),this.initialValue[t]=e}}revertProgress(){this.saveProgress(0,0),this.saveProgress=()=>{}}saveProgress(e=0,t=null){let i=this.getConfigKey();window.localStorage.setItem(i+"_node",Math.max(0,e-5)),null!==t&&window.localStorage.setItem(i+"_progress",t)}loadProgress(){this.convertLegacyProgress(),this.initialNode=0,this.accumulatedProgress=0;let e=this.getConfigKey(),t=e+"_node";if(localStorage.getItem(t)){let e=parseInt(localStorage.getItem(t));e&&(this.initialNode=e)}let i=e+"_progress";if(localStorage.getItem(i)){let e=parseInt(localStorage.getItem(i));e&&(this.accumulatedProgress=e)}if(localStorage.getItem("restore-progress")){let e=0;try{e=parseInt(localStorage.getItem("restore-progress")),e>0&&(this.accumulatedProgress+=e,localStorage.setItem(i,this.accumulatedProgress),console.log("Storing accumulated progress ",e,this.accumulatedProgress))}catch(eu){}localStorage.removeItem("restore-progress")}console.log("Loaded node and progress "+this.initialNode+", "+this.accumulatedProgress+" for confKey "+e)}convertLegacyProgress(){try{let e,t,i,s,n=JSON.parse(localStorage.getItem("analytics_seeds")),a=["easy","normal","hard"];for(t of n)if(t)for(i of(e=t.toString(),a))s=e+"?"+i,localStorage.getItem(s)&&(console.log("Converting legacy progress for seed ",e,i),localStorage.setItem(e+"_Hills_"+i+"_node",localStorage.getItem(s)),localStorage.removeItem(s))}catch(eu){}}getConfigKey(){return this.value.seed+"_"+this.value.sceneName+"_"+this.value.topography}};var Sh=Ih;const Mh=.3,Dh=window.localStorage.getItem("settings-camera-mode")||0;var Ch=new r.P;const Nh=new r.C({color:110832,fog:!1,depthTest:!1});r.G;class kh extends r.G{constructor(e){super();let t=new r.S(.5,8,8);this.mesh=new r.B(t,Nh.clone()),(null===e||void 0===e?void 0:e.scale)&&this.scale.set(e.scale,e.scale,e.scale),(null===e||void 0===e?void 0:e.color)&&this.mesh.material.color.setHex(e.color),this.add(this.mesh),Ch.add(this)}}const zh=Math.floor(wt/2);let jh=!1;const Lh=10,Oh=(Sh.value.topography,.463),Rh=10,Th=2,Ph=.18,Gh={},Bh={vecA:new r.W,vecB:new r.W};var Wh=class{constructor(e=!1){this.lineMat=new r.w({color:16724787}),this.lineIndex=0,this.head=null,this.tail=null,this.discretisedTail=null,this.origin=new r.W,this.prevOriginSide=0,this.originOverflow=0,this.antiTarget=new r.W,this.antiTargetRevert=40,this.antiTargetRange=0,this.antiTargetDebug=jh?new kh({color:16711935,scale:10}):null,this.antiTargetTrigger=0,this.antiTargetTriggerPoint=new r.W,this.antiTargetTriggerCount=0,this.antiWeight=0,this.antiResetIndex=0,this.maxRetractIndex=0,this.bridging=!1,this.antiBridgePoint=new r.W,this.bridge={landing:new r.W,distance:0,spawnNode:null},this.turnTrackers=[{i:0,m:15,r:15,n:null,a:3.3,da:0,o:0},{i:1,m:30,r:10,n:null,a:3.3,da:0,o:.5},{i:2,m:60,r:15,n:null,a:3.4,da:0,o:.75},{i:3,m:120,r:20,n:null,a:3.6,da:0,o:.8}],this.trackIndex=null,this.vehicleDebug=jh?new kh({color:16711680,scale:.5}):null,this.antiDir=new r.W,this.originDir=new r.W(0,0,1),this.midlineDir=new r.W,this.midlineOrth=new r.W,this.isStraight=!1,this.hasInitGeneration=!1,this.generationResets=0,this.hasInitSmoothing=!1,this.hasInitDiscretisation=!1,this.loaderIteration=0,this.tVec=new r.W,this.h1=0,this.h2=0,this.feelDir=new r.W(1,0,.5),this.feelLeft=jh?new kh({color:255,scale:1}):null,this.feelRight=jh?new kh({color:16711680,scale:1}):null,this.prevT=0,this.byWater=!1,this.waterFactor=0,this.closestApproach=0,this.trackRevertCount=0,this.allowEmergencyBridge=!1,this.landing=new r.W,this.smoothWindowHead=null,this.doUpdate=0,this.didExtend=!1,this.lineOrigin=new r.W,this.container=new r.G,jh=!1,jh&&(this.lineArr=new Float32Array(15e4),this.lineGeo=new r.g,this.lineGeo.setAttribute("position",new r.f(this.lineArr,3)),this.lineGeo.attributes.position.updateRange.count=0,this.line=new r.v(this.lineGeo,this.lineMat),this.container.add(this.line)),this.isStraight="straight"==Sh.value.topography}initialise(e,t,i){return this.heightmap=t,this.hasInitGeneration=!1,this.generationResets=0,this.hasInitSmoothing=!1,this.hasInitDiscretisation=!1,this.loaderIteration=0,this.maxResets=Sh.initialNode/30+50,ii.vehicleIndex=0,ii.vehicleIndexDidChange=!0,this.reset(e,i)}loader(){if(!this.hasInitGeneration){if(ii.tail.i<Sh.initialNode+gt){if(this.extendMidline()||this.generationResets++,320==this.antiTargetRevert||this.generationResets>this.maxResets||null==ii.tail.prev){if(this.generationResets=0,this.antiTargetRevert=15,console.error("Bad seed ",ii.head.a),delete ii.head.next,ii.head.next=null,ii.head.a+=this.rand(),ii.head.a>6.28)return console.error("Too many angle attempts; abandoning"),-1;for(Gh.tracker of(this.originDir.set(Math.cos(ii.head.a),0,Math.sin(ii.head.a)),ii.tail=ii.head,this.smoothWindowHead=ii.head,this.turnTrackers))Gh.tracker.n=ii.head,Gh.tracker.da=0;this.resetBridgeState(),this.bridging=!1,this.trackRevertCount=0,this.antiTargetRevert=0}}else{for(this.hasInitGeneration=!0,Gh.n=ii.head,Gh.i=0;Gh.i<=zh;Gh.i++)Gh.h={i:0-(Gh.i+1),p:ii.head.p.clone(),c:ii.head.c.clone(),h:0,next:Gh.n,prev:null},Gh.n.prev=Gh.h,Gh.n=Gh.n.prev;this.smoothWindowHead=Gh.n}return ii.tail.i-ii.head.i>gt&&(ii.head=ii.head.next,ii.head.prev.next=null,delete ii.head.prev,ii.head.prev=null,ii.vehicleNode=ii.head),ii.tail.i/(Sh.initialNode+gt)*.8}return this.hasInitSmoothing?this.hasInitDiscretisation?void 0:ii.discretisedTail.i<ii.vehicleIndex+vt?(this.discretiseNext(),.9+ii.discretisedTail.i/(ii.vehicleIndex+vt)*.0999):(this.hasInitDiscretisation=!0,1):(this.smoothWindowHead.i<ii.tail.i-wt?this.smoothHeight():(this.hasInitSmoothing=!0,ii.head.prev.next=null,delete ii.head.prev,this.resetDiscretised()),.8+this.smoothWindowHead.i/(ii.tail.i-wt)*.1)}finalise(){for(ii.vehicleNode=ii.head,Gh.i=0;Gh.i<5;Gh.i++)ii.vehicleNode=ii.vehicleNode.next;ii.vehicleIndex=ii.vehicleNode.i,ii.vehicleIndexDidChange=!0}destroy(){this.revert(),jh&&this.lineGeo.dispose()}revert(){for(Gh.t of(delete ii.head,delete ii.discretisedTail,delete ii.tail,delete ii.vehicleNode,this.turnTrackers))Gh.t.n=null}reset(e,t){for(Gh.tracker of(this.revert(),this.rand=new window.alea(e),ii.head={i:0,p:new r.W(t.x,this.heightmap.getXZ(t.x,t.z,this.heightmap.midlineDepth),t.z),n:{x:1,z:0},a:Math.PI/2,da:0,t:0,c:new r.W,w:Qt,g:0,gfa:0,h:0,ps:null,ns:null,next:null,prev:null},ii.tail=ii.head,ii.vehicleNode=ii.head,ii.vehicleIndex=ii.head.i,ii.vehicleIndexDidChange=!0,this.originDir.set(Math.cos(ii.head.a),0,Math.sin(ii.head.a)),this.origin.copy(ii.head.p),jh&&(this.lineOrigin.copy(this.origin),this.line.position.copy(this.lineOrigin),this.line.position.y=0),this.smoothWindowHead=ii.head,this.turnTrackers))Gh.tracker.n=ii.head,Gh.tracker.da=0}processCurve(e,t,i,s,n=!1){for(Gh.ps=[],Gh.ns=[],Gh.i=0;Gh.i<s;Gh.i++)Gh.t=Gh.i/s,Gh.ti=1-Gh.t,Gh.x=Gh.ti*Gh.ti*e.p.x+2*Gh.ti*Gh.t*t.x+Gh.t*Gh.t*i.p.x,Gh.z=Gh.ti*Gh.ti*e.p.z+2*Gh.ti*Gh.t*t.z+Gh.t*Gh.t*i.p.z,Gh.ps.push({x:Gh.x,y:Gh.ti*Gh.ti*e.p.y+2*Gh.ti*Gh.t*t.y+Gh.t*Gh.t*i.p.y,z:Gh.z}),n&&Gh.i>0&&(Gh.dx=Gh.x-Gh.ps[Gh.i-1].x,Gh.dz=Gh.z-Gh.ps[Gh.i-1].z,Gh.dxz=Math.sqrt(Gh.dx*Gh.dx+Gh.dz*Gh.dz),Gh.ns.push({x:-Gh.dz/Gh.dxz,z:Gh.dx/Gh.dxz}));return n&&(Gh.dx=i.x-Gh.ps[s-1].x,Gh.dz=i.z-Gh.ps[s-1].z,Gh.dxz=Math.sqrt(Gh.dx*Gh.dx+Gh.dz*Gh.dz),Gh.ns.push({x:-Gh.dz/Gh.dxz,z:Gh.dx/Gh.dxz})),{ps:Gh.ps,ns:Gh.ns}}stitchNormals(e,t){let i,s,n,a=e.ps[e.ps.length-2];i=t.ps[0].x-a.x,s=t.ps[0].z-a.z,n=Math.sqrt(i*i+s*s),e.ns[e.ps.length-1]={x:-s/n,z:i/n},a=e.ps[e.ps.length-1],i=t.ps[1].x-a.x,s=t.ps[1].z-a.z,n=Math.sqrt(i*i+s*s),t.ns[0]={x:-s/n,z:i/n};for(let o=1;o<t.ps.length-1;o++)i=t.ps[o+1].x-t.ps[o-1].x,s=t.ps[o+1].z-t.ps[o-1].z,n=Math.sqrt(i*i+s*s),t.ns[o]={x:-s/n,z:i/n}}resetDiscretised(){ii.discretisedTail=ii.head,ii.vehicleIndex=ii.head.i,ii.vehicleNode=ii.head,Gh.head=ii.head,Gh.pc=this.processCurve(Gh.head,Gh.head.c,Gh.head.next,10,!0),ii.head.ps=Gh.pc.ps,ii.head.ns=Gh.pc.ns,ii.vehicleNode=ii.head}discretiseNext(){Gh.nextTail=ii.discretisedTail.next,Gh.pc=this.processCurve(Gh.nextTail,Gh.nextTail.c,Gh.nextTail.next,10),this.stitchNormals(ii.discretisedTail,Gh.pc),Gh.nextTail.ps=Gh.pc.ps,Gh.nextTail.ns=Gh.pc.ns,ii.discretisedTail=Gh.nextTail}drawFeelers(e){this.feelLeft.position.copy(ii.tail.p),this.feelRight.position.copy(ii.tail.p);let t=Math.cos(ii.tail.a-Oh)*e+ii.tail.p.x,i=Math.sin(ii.tail.a-Oh)*e+ii.tail.p.z;this.feelLeft.position.set(t,this.heightmap.getXZ(t,i,this.heightmap.midlineDepth),i),t=Math.cos(ii.tail.a+Oh)*e+ii.tail.p.x,i=Math.sin(ii.tail.a+Oh)*e+ii.tail.p.z,this.feelRight.position.set(t,this.heightmap.getXZ(t,i,this.heightmap.midlineDepth),i)}extendMidline(){if(this.didExtend=!0,jh&&this.lineIndex>=15e4)return;for(Bh.tracker of(ii.tail.i>gt&&ii.tail.i-ii.vehicleIndex<mt&&!this.allowEmergencyBridge&&!this.bridging&&(console.warn("Midline stuck; safe horizon no longer safe. Allowing emergency bridge"),this.allowEmergencyBridge=!0),Gh.feelDist=Lh*(1+this.waterFactor),Gh.feelL=this.heightmap.getXZ(Math.cos(ii.tail.a-Oh)*Gh.feelDist+ii.tail.p.x,Math.sin(ii.tail.a-Oh)*Gh.feelDist+ii.tail.p.z,this.heightmap.midlineDepth),Gh.feelR=this.heightmap.getXZ(Math.cos(ii.tail.a+Oh)*Gh.feelDist+ii.tail.p.x,Math.sin(ii.tail.a+Oh)*Gh.feelDist+ii.tail.p.z,this.heightmap.midlineDepth),Gh.feelA=this.heightmap.getXZ(ii.tail.p.x,ii.tail.p.z,this.heightmap.midlineDepth),Gh.feelA=Math.max(Gh.feelA,Th),this.waterFactor=0,this.byWater=!1,(Gh.feelR<2*Th||Gh.feelL<2*Th)&&(this.byWater=!0),Gh.feelAvg=(Gh.feelR+Gh.feelL)/2,Gh.feelAvg<3*Th&&(Gh.feelAvg>Th?this.waterFactor=1-(Gh.feelAvg-Th)/(2*Th):this.waterFactor=1),Gh.feelDif=(Gh.feelR-Gh.feelL)/2,Gh.gradLat=(Gh.feelL-Gh.feelR)/Gh.feelDist,Gh.gradLat/=Ph,Gh.gradLon=(Gh.feelAvg-Gh.feelA)/Gh.feelDist,Gh.gradLon/=Ph,Gh.bT=0,0!==Gh.feelDif&&(Gh.bT=(Gh.feelAvg-Gh.feelA)/Gh.feelDif),Gh.bT=Math.max(Math.min(Gh.bT,1),-1),this.midlineDir.set(Math.cos(ii.tail.a),0,Math.sin(ii.tail.a)),this.midlineOrth.set(-this.midlineDir.z,0,this.midlineDir.x),Bh.originDot=Math.max(Math.min(1,this.midlineDir.dot(this.originDir)),-1),Bh.originSide=-1*this.midlineOrth.dot(this.originDir),0!=Bh.originSide&&(Bh.originSide/=Math.abs(Bh.originSide)),Bh.originSide==this.prevOriginSide&&this.originOverflow>1.5&&(1==Bh.originSide?Bh.originSide=-2:Bh.originSide=2),Bh.originSide!==this.prevOriginSide?Bh.originSide>this.prevOriginSide?this.prevT<0?(this.originOverflow+=this.prevT,this.originOverflow>0?(Bh.originSide=this.prevOriginSide,Bh.originDot=-1):this.originOverflow=0):this.prevT>0&&(this.originOverflow+=this.prevT,Bh.originSide=this.prevOriginSide,Bh.originDot=-1):this.prevT>0?(this.originOverflow-=this.prevT,this.originOverflow>0?(Bh.originSide=this.prevOriginSide,Bh.originDot=-1):this.originOverflow=0):this.prevT<0&&(this.originOverflow-=this.prevT,Bh.originSide=this.prevOriginSide,Bh.originDot=-1):this.originOverflow=0,this.prevOriginSide=Bh.originSide,Bh.originAng=Math.acos(Bh.originDot),Gh.gradLeft=(Gh.feelL-Gh.feelA)/Gh.feelDist/Ph,Gh.gradRight=(Gh.feelR-Gh.feelA)/Gh.feelDist/Ph,Gh.maxT=1,Gh.minT=-1,Gh.gradLeftAbs=Math.abs(Gh.gradLeft),Gh.gradRightAbs=Math.abs(Gh.gradRight),(Gh.gradLeftAbs>1||Gh.gradRightAbs>1)&&(Gh.gradDif=(Gh.gradLeft-Gh.gradRight)/2,Gh.gradAvg=(Gh.gradLeft+Gh.gradRight)/2,Gh.gradLeft>1&&Gh.gradRight>1||Gh.gradLeft<-1&&Gh.gradRight<-1?Gh.gradLeftAbs<Gh.gradRightAbs?(Gh.maxT=1,Gh.minT=1):(Gh.maxT=-1,Gh.minT=-1):(Gh.gradLeftAbs>1&&(Gh.gradLeft<0?Gh.maxT=(1+Gh.gradAvg)/Math.abs(Gh.gradDif):Gh.maxT=(1-Gh.gradAvg)/Math.abs(Gh.gradDif)),Gh.gradRightAbs>1&&(Gh.gradRight<0?Gh.minT=(1+Gh.gradAvg)/Math.abs(Gh.gradDif):Gh.minT=(1-Gh.gradAvg)/Math.abs(Gh.gradDif),Gh.minT*=-1))),Gh.gradAvg=(Math.abs(Gh.gradLat)+Math.abs(Gh.gradLon))/2,Gh.maxDif=.5+.5*Math.abs(Gh.gradAvg),Gh.maxT*=1.5,Gh.minT*=1.5,Gh.maxT>0&&(Gh.maxT=Math.min(Gh.maxT,this.prevT+Gh.maxDif)),Gh.minT<0&&(Gh.minT=Math.max(Gh.minT,this.prevT-Gh.maxDif)),this.byWater&&(Gh.gradLat<0?Gh.maxT>0&&(Gh.maxT*=1-this.waterFactor):Gh.minT<0&&(Gh.minT*=1-this.waterFactor)),Gh.bT=Math.max(Math.min(Gh.maxT,Gh.bT),Gh.minT),!this.bridging&&this.byWater&&(Bh.originSide<0&&Gh.gradLat>0||Bh.originSide>0&&Gh.gradLat<0)&&(this.tVec.set(0,0,0),(0==this.originOverflow&&this.allowEmergencyBridge||Gh.gradLon<-.3&&Math.abs(Gh.gradLat)<1)&&(this.tVec.x=this.midlineDir.x,this.tVec.z=this.midlineDir.z,this.tVec.normalize(),this.testForBridge(ii.tail.prev,1,this.tVec)),this.tVec.x=ii.tail.prev.n.x*-Bh.originSide,this.tVec.z=ii.tail.prev.n.z*-Bh.originSide,this.tVec.normalize(),this.testForBridge(ii.tail.prev,1,this.tVec),this.allowEmergencyBridge&&(this.tVec.x+=this.midlineDir.x,this.tVec.z+=this.midlineDir.z,this.tVec.normalize(),this.testForBridge(ii.tail.prev,1,this.tVec))),Gh.gradLon2=Gh.gradLon*Gh.gradLon,Gh.gradLon2<=1?(!this.byWater||Gh.gradLon>0)&&(Gh.bT*=Math.abs(Gh.gradLon2)):Gh.bT<0?Gh.bT=Gh.minT:Gh.bT=Gh.maxT,Gh.bT=Math.max(Math.min(Gh.maxT,Gh.bT),Gh.minT),this.antiWeight=0,this.antiTargetRange>0&&(Bh.d=ii.tail.p.x-this.antiTarget.x,Bh.d=Bh.d*Bh.d+(ii.tail.p.z-this.antiTarget.z)*(ii.tail.p.z-this.antiTarget.z),this.antiDir.set(this.antiTarget.x-ii.tail.p.x,0,this.antiTarget.z-ii.tail.p.z),this.antiDir.normalize(),Bh.antiDot=this.midlineDir.dot(this.antiDir),Bh.d<this.antiTargetRange?(this.antiWeight=1-Bh.d/this.antiTargetRange,Bh.antiSide=this.midlineOrth.dot(this.antiDir),Bh.antiRedirect=2*Oh*Bh.antiSide,Bh.antiAdjust=(Bh.antiDot+1)/2,this.antiWeight*=Bh.antiAdjust,Bh.antiRedirect=Math.max(Math.min(Gh.maxT,Bh.antiRedirect),Gh.minT),Gh.bT=this.antiWeight*Bh.antiRedirect+(1-this.antiWeight)*Gh.bT):Bh.antiDot<-.707&&(this.antiTargetRange=0,this.trackIndex=null,this.trackRevertCount=0)),Bh.originAdjust=(1-(Bh.originDot+1)/2)*(1-this.waterFactor*this.waterFactor),Bh.originAdjust*=1-this.antiWeight,Bh.originRedirect=Bh.originAng*Bh.originSide/Oh,Bh.originRedirect=Math.max(Math.min(Gh.maxT,Bh.originRedirect),Gh.minT),Gh.bT=Bh.originAdjust*Bh.originRedirect+(1-Bh.originAdjust)*Gh.bT,Bh.shouldBridge=!this.bridging&&this.byWater&&this.bridge.spawnNode&&ii.tail.i-this.bridge.spawnNode.i<150&&(this.originOverflow>0||this.allowEmergencyBridge),this.turnTrackers))if(Bh.tracker.da+=ii.tail.da,Bh.tracker.n.i<=ii.tail.i-Bh.tracker.m&&(Bh.tracker.da-=Bh.tracker.n.da,Bh.tracker.n=Bh.tracker.n.next),Math.abs(Bh.tracker.da)>Bh.tracker.a&&(this.byWater||Bh.originDot<Bh.tracker.o)||Bh.shouldBridge){for(this.bridging&&(Bh.shouldBridge=!1,this.bridging=!1,this.bridge.spawnNode=null),Bh.shouldBridge||this.trackRevertCount++,(Bh.shouldBridge||this.trackRevertCount>5&&this.bridge.spawnNode&&ii.tail.i-this.bridge.spawnNode.i<this.antiTargetRevert)&&(this.bridging=!0,this.improveBridgeStartNode(),this.bridge.landing.y=(this.bridge.spawnNode.p.y+this.bridge.landing.y)/2,this.bridge.height=this.bridge.landing.y),this.didExtend=!1,Bh.revertDistance=0,this.bridging?(this.trackIndex=null,this.antiTargetRange=0,this.antiTargetTrigger=ii.tail.i,Bh.revertDistance=ii.tail.i-this.bridge.spawnNode.i):Math.abs(this.antiResetIndex-ii.tail.i)<2*Bh.tracker.m||this.trackIndex==Bh.tracker.i&&this.antiWeight>0?(this.antiTargetTriggerCount++,this.antiTargetRevert+=this.antiTargetTriggerCount*Bh.tracker.r,ii.tail.i-this.antiTargetRevert<this.maxRetractIndex&&(this.antiTarget.copy(ii.tail.p),this.antiTargetRevert=ii.tail.i-this.maxRetractIndex,console.warn("Max revert; allowing emergency bridge"),this.allowEmergencyBridge=!0),Bh.revertDistance=this.antiTargetRevert):(this.trackIndex=Bh.tracker.i,this.antiTarget.copy(ii.tail.p),this.antiTargetRevert=Bh.tracker.m,this.antiTargetTrigger=ii.tail.i,this.antiTargetTriggerPoint.copy(this.antiTarget),this.antiTargetTriggerCount=0,Bh.revertDistance=this.antiTargetRevert),Bh.resetIndex=ii.tail.i-Bh.revertDistance;ii.tail.i>Bh.resetIndex;){var e;if(!ii.tail.bridge&&(null===(e=ii.tail.prev)||void 0===e?void 0:e.bridge)){for(Bh.bn=ii.tail.prev;null===(t=Bh.bn)||void 0===t?void 0:t.bridge;){var t;Bh.bn=Bh.bn.prev}if(Bh.bn.i<Bh.resetIndex)break;this.antiBridgePoint.copy(ii.tail.p)}if(null==ii.tail.prev||ii.tail.i-ii.head.i<wt)break;ii.tail=ii.tail.prev,delete ii.tail.next,ii.tail.next=null}if(this.smoothWindowHead.i>ii.tail.i-wt)for(Bh.startI=0,this.smoothWindowHead.i<=ii.tail.i?Bh.startI=Math.max(0,ii.tail.i-this.smoothWindowHead.i):(this.smoothWindowHead=ii.tail,this.smoothWindowHead.p.y+=this.smoothWindowHead.h),Bh.i=Bh.startI;Bh.i<=wt;Bh.i++)this.smoothWindowHead.prev&&(this.smoothWindowHead=this.smoothWindowHead.prev,this.smoothWindowHead.p.y+=this.smoothWindowHead.h);for(Bh.tracker2 of(this.bridging||(this.antiTargetRange=4*this.antiTarget.distanceToSquared(ii.tail.p),this.antiResetIndex=ii.tail.i),!this.bridging&&this.bridge.spawnNode&&this.bridge.spawnNode.i>ii.tail.i&&this.resetBridgeState(),ii.vehicleIndex>ii.tail.i&&(ii.vehicleIndex=ii.tail.i,ii.vehicleNode=ii.tail),this.hasInitGeneration&&ii.tail.i-mt+100<ii.vehicleIndex&&(console.error("Midline reset violation"),console.log(ii.vehicleIndex,ii.tail.i)),this.turnTrackers))for(Bh.tracker2.n=ii.tail,Bh.tracker2.da=ii.tail.da,Bh.i=0;Bh.i<Bh.tracker2.m&&Bh.tracker2.n.prev;Bh.i++)Bh.tracker2.n=Bh.tracker2.n.prev,Bh.tracker2.da+=Bh.tracker2.n.da;return this.prevT=ii.tail.t,this.waterFactor=Math.max(Math.min(1,1-(ii.tail.p.y-Th)/(2*Th)),0),"o"in ii.tail?ii.tail.o<0?(this.prevOriginSide=-1,this.originOverflow=-ii.tail.o):(this.prevOriginSide=1,this.originOverflow=ii.tail.o):(this.midlineDir.set(Math.cos(ii.tail.a),0,Math.sin(ii.tail.a)),this.midlineOrth.set(-this.midlineDir.z,0,this.midlineDir.x),Bh.originDot=this.midlineDir.dot(this.originDir),Bh.originSide=-1*this.midlineOrth.dot(this.originDir),0!=Bh.originSide&&(Bh.originSide/=Math.abs(Bh.originSide)),this.prevOriginSide=Bh.originSide,this.originOverflow=0),!1}this.bridging&&(Bh.vecA.set(this.bridge.landing.x-ii.tail.p.x,0,this.bridge.landing.z-ii.tail.p.z).normalize(),Bh.vecB.set(ii.tail.p.x-ii.tail.prev.p.x,0,ii.tail.p.z-ii.tail.prev.p.z).normalize(),ii.tail.p.distanceTo(this.bridge.landing)<10&&(this.bridging=!1,this.allowEmergencyBridge=!1,this.resetBridgeState()),Gh.dot=Math.min(Bh.vecA.dot(Bh.vecB),1),Gh.side=(this.bridge.landing.x-ii.tail.p.x)*Bh.vecB.z-(this.bridge.landing.z-ii.tail.p.z)*Bh.vecB.x,Gh.side=Gh.side<0?-1:1,Gh.bT=Math.min(Math.max(Math.acos(Gh.dot),-1.5),1.5)*Gh.side),this.isStraight&&(Gh.bT=0),this.prevT=Gh.bT,Gh.bDir=ii.tail.a-Gh.bT*Oh,Gh.bDir<-Math.PI?Gh.bDir+=2*Math.PI:Gh.bDir>Math.PI&&(Gh.bDir-=2*Math.PI),Bh.cDist=.5*Rh,Bh.x=Math.cos(ii.tail.a)*Bh.cDist+ii.tail.p.x,Bh.z=Math.sin(ii.tail.a)*Bh.cDist+ii.tail.p.z,Bh.roadSinkFactor=.1*(1-this.waterFactor),ii.tail.c.x=Bh.x,ii.tail.c.y=ii.tail.p.y,ii.tail.c.z=Bh.z,Bh.nx=Bh.x-ii.tail.p.x,Bh.nz=Bh.z-ii.tail.p.z,Bh.nxz=Math.sqrt(Bh.nx*Bh.nx+Bh.nz*Bh.nz),ii.tail.n={x:-Bh.nz/Bh.nxz,z:Bh.nx/Bh.nxz},Bh.x=Math.cos(Gh.bDir)*Bh.cDist+Bh.x,Bh.z=Math.sin(Gh.bDir)*Bh.cDist+Bh.z;let i={i:ii.tail.i+1,p:new r.W(Bh.x,(this.bridging?this.bridge.height:Math.max(this.heightmap.getXZ(Bh.x,Bh.z,this.heightmap.midlineDepth),Th))-Bh.roadSinkFactor,Bh.z),a:Gh.bDir,da:Gh.bT*Oh,h:0,c:new r.W,t:Gh.bT,n:{x:0,z:1},w:Qt,g:Gh.gradLat,gfa:Math.abs(Gh.gradLon),next:null,prev:ii.tail};return(this.bridging||this.isStraight&&i.p.y<=2)&&(i.bridge=!0),ii.tail.c.y=(ii.tail.c.y+i.p.y)/2,this.originOverflow>0&&(i.o=this.originOverflow*Bh.originSide),ii.tail.next=i,isNaN(Bh.x)?(console.log("NAN x AT INDEX "+i.i),console.log("bT ",Gh.bT),console.log("bDir ",Gh.bDir),console.log("E.originDot ",Bh.originDot),console.log("originAdjust ",Bh.originAdjust),console.log("OriginRedirect ",Bh.originRedirect),console.log("OriginSide ",Bh.originSide),console.log("originAng ",Bh.originAng),console.log("Origindir ",this.originDir),console.log("Min max ",Gh.minT,Gh.maxT),console.log("Gradlat, lon ",Gh.gradLat,Gh.gradLon),console.log("gradAVg ",Gh.gradAvg),console.log("antiWeight ",this.antiWeight),console.log("feelL, feelR ",Gh.feelL,Gh.feelR),console.log("feelAvg ",Gh.feelAvg),console.log("feelDif ",Gh.feelDif),console.log("waterFactor ",this.waterFactor),console.log("maxDif ",Gh.maxDif),!1):(jh&&this.drawPoints(ii.tail),ii.tail=i,this.maxRetractIndex=Math.max(this.maxRetractIndex,ii.tail.i-xt),ii.tail.i>1640&&ii.tail.i,!0)}resetBridgeState(){this.bridge.spawnNode=null,this.bridge.distance=0,this.bridge.landing.set(0,0,0)}improveBridgeStartNode(){let e,t,i=this.bridge.spawnNode.prev,s=this.bridge.spawnNode.p.distanceToSquared(this.bridge.landing),n=new r.V,a=new r.V;a.x=i.p.x-i.prev.p.x,a.y=i.p.z-i.prev.p.z,a.normalize(),n.set(this.bridge.landing.x-i.p.x,this.bridge.landing.z-i.p.z).normalize(),t=a.dot(n);let o=a.dot(n);for(let r=0;r<20&&i.prev&&!(Math.abs(i.p.y-this.bridge.landing.y)>2);r++)e=i.p.distanceToSquared(this.bridge.landing),a.x=i.p.x-i.prev.p.x,a.y=i.p.z-i.prev.p.z,a.normalize(),n.set(this.bridge.landing.x-i.p.x,this.bridge.landing.z-i.p.z).normalize(),t=a.dot(n),(e<s||s<0)&&t>-.1&&(s=e,this.bridge.spawnNode=i),t>o&&e<1.2*s&&(o=t,this.bridge.spawnNode=i),i=i.prev}testForBridge(e,t,i){this.landing=new r.W;let s=0,n=250,a=5,o=n/2;if(this.allowEmergencyBridge)do{this.landing.x=e.p.x+i.x*n*t,this.landing.z=e.p.z+i.z*n*t,this.landing.y=this.heightmap.getXZ(this.landing.x,this.landing.z,this.heightmap.midlineDepth),n+=250,a+=1}while(this.landing.y<2);else if(this.landing.x=e.p.x+i.x*n*t,this.landing.z=e.p.z+i.z*n*t,this.landing.y=this.heightmap.getXZ(this.landing.x,this.landing.z,this.heightmap.midlineDepth),this.landing.y<2)return this.landing.y=0,null;for(let r=0;r<a;r++)this.landing.x=e.p.x+i.x*o*t,this.landing.z=e.p.z+i.z*o*t,this.landing.y=this.heightmap.getXZ(this.landing.x,this.landing.z,this.heightmap.midlineDepth),this.landing.y<2?(s=o,o=.5*s+.5*n):(n=o,o=.5*s+.5*n);return o<40||this.landing.distanceTo(this.antiBridgePoint)<100?null:(!this.bridge.spawnNode||e.i-this.bridge.spawnNode.i>20||o<this.bridge.distance)&&this.checkBridgeQuality(e.p,this.landing)?(this.bridge.spawnNode=e,this.bridge.distance=o,this.bridge.landing.copy(this.landing),this.landing):null}checkBridgeQuality(e,t){let i=e.clone().add(t).multiplyScalar(.5);if(this.heightmap.getXZ(i.x,i.z,this.heightmap.midlineDepth)>-2)return!1;let s=t.clone().sub(e);if(s.y=0,s.normalize(),0==this.originOverflow&&s.dot(this.originDir)<0)return!1;s.y=s.x,s.x=-s.z,s.z=s.y;let n=e.distanceTo(i)/2,a=s.clone().multiplyScalar(n).add(i);return!(this.heightmap.getXZ(a.x,a.z,this.heightmap.midlineDepth)>0)&&(a=s.multiplyScalar(-n).add(i),!(this.heightmap.getXZ(a.x,a.z,this.heightmap.midlineDepth)>0))}smoothHeight(){for(Bh.avg=0,Bh.n=this.smoothWindowHead,Bh.i=0;Bh.i<wt;Bh.i++)Bh.avg+=Bh.n.p.y,Bh.n=Bh.n.next,Bh.i<=zh&&(Bh.s=Bh.n);Bh.avg/=wt,Bh.r=Bh.s.prev,Bh.q=Bh.r.prev,Bh.s.h=Bh.s.p.y-Bh.avg,Bh.hAngle=(Bh.avg-(Bh.q.p.y-Bh.q.h))/20,Bh.r.c.y=Bh.r.p.y-Bh.r.h+5*Bh.hAngle,this.smoothWindowHead.p.y-=this.smoothWindowHead.h,this.smoothWindowHead=this.smoothWindowHead.next}update(){return ii.tail.i<ii.vehicleIndex+gt?(this.extendMidline(),this.smoothHeight()):ii.tail.i-ii.head.i>gt&&(Gh.n=ii.head.next,delete ii.head,ii.head=Gh.n,ii.head.prev=null),ii.discretisedTail.i<ii.vehicleIndex+vt?this.discretiseNext():ii.discretisedTail.i-ii.head.i>vt&&(Gh.n=ii.head.next,delete ii.head,ii.head=Gh.n,ii.head.prev=null),this.didExtend}drawFine(e){let t;for(;null===(i=e.next)||void 0===i?void 0:i.ps;){var i;for(t of e.ps)this.lineArr[this.lineIndex++]=t.x,this.lineArr[this.lineIndex++]=t.y+1,this.lineArr[this.lineIndex++]=t.z;e=e.next}this.lineGeo.setDrawRange(0,this.lineIndex/3),this.lineGeo.attributes.position.needsUpdate=!0,this.lineGeo.computeBoundingSphere()}drawPoints(e){let t,i,s,n,a;for(;e.next;){for(s of(t=new r.N(e.p,e.c,e.next.p),i=t.getPoints(1),i))n=s.x-this.line.position.x,a=s.z-this.line.position.z,this.lineArr[this.lineIndex++]=n,this.lineArr[this.lineIndex++]=Math.max(2,this.heightmap.getXZ(s.x,s.z,this.heightmap.midlineDepth))+1,this.lineArr[this.lineIndex++]=a;e=e.next}this.lineGeo.setDrawRange(0,this.lineIndex/3),this.lineGeo.attributes.position.needsUpdate=!0,this.lineGeo.computeBoundingSphere()}};class Fh{static getUVs(e){let t=[],i=Math.floor(100/(2*Qt));i=16;for(let s=0;s<=e;s++)t.push(1,s/e*16),t.push(0,s/e*16);return t}constructor(e,t=!1){this.genNode=null,this.genIndex=0,this.nodeIndex=0,this.originPos=new r.W,this.numPoints=10,this.isCoarse=!1,this.p=new r.W,this.numPoints=e,this.isCoarse=t,this.geo=new r.g,this.geo.setIndex(Fh.getIndex(e+1)),this.geo.setAttribute("position",new r.o(new Float32Array(2*(e+1)*3),3)),this.verts=this.geo.attributes.position.array,this.geo.attributes.position.setUsage(r.l);let i=Fh.getUVs(e);this.geo.setAttribute("uv",new r.o(new Float32Array(i),2)),this.mesh=new r.B(this.geo,Ut),this.mesh.matrixAutoUpdate=!1,this.mesh.receiveShadow=!0,this.mesh.visible=!1}initialise(e){for(this.initGeneration(e);!this.generate(););this.display()}initGeneration(e,t=0){this.midlineNode=e,this.genNode=e,this.originPos.copy(e.p),this.mesh.position.copy(this.originPos),this.genIndex=0,this.nodeIndex=0}generate(){let e,t;this.isCoarse?(this.p.copy(this.genNode.p).sub(this.originPos),e=this.genNode.n,t=this.genNode.w):(this.nodeIndex>=this.genNode.ps.length&&(this.nodeIndex=0,this.genNode=this.genNode.next),this.p.copy(this.genNode.ps[this.nodeIndex]).sub(this.originPos),e=this.genNode.ns[this.nodeIndex],t=this.genNode.w);let i=6*this.genIndex;return this.verts[i]=this.p.x+e.x*t,this.verts[i+1]=this.p.y+.01,this.verts[i+2]=this.p.z+e.z*t,this.verts[i+3]=this.p.x-e.x*t,this.verts[i+4]=this.p.y+.01,this.verts[i+5]=this.p.z-e.z*t,this.genIndex++,this.isCoarse?this.genIndex<=this.numPoints&&(this.genNode=this.genNode.next):this.nodeIndex+=1,this.genIndex==this.numPoints+1}display(){this.geo.attributes.position.needsUpdate=!0,this.geo.computeVertexNormals(),this.geo.computeBoundingSphere(),this.mesh.updateMatrix(),this.show()}show(){this.mesh.visible=!0}hide(){this.mesh.visible=!1}retire(){this.hide()}static getIndex(e){let t,i,s,n,a=[];for(let o=0;o<e-1;o++)t=2*o,i=t+1,s=2*(o+1),n=s+1,a.push(t,s,i),a.push(i,s,n);return a}}Fh.mat=new r.D({color:8947848});var Eh=class{constructor(){this.nearSegs=[],this.farSegs=[],this.seenIndex=0,this.nearIndex=0,this.nearCheck=15,this.nextNearReady=!1,this.farIndex=0,this.farCheck=45,this.nextFarReady=!1,this.container=new r.G,this.initSegs(),this.nearIndex=0,this.farIndex=0}destroy(){for(this.container.traverse((e=>{e.isMesh&&e.geometry.dispose()}));this.container.children.length;)this.container.remove(this.container.children[0])}handleMidlineReset(){ii.tail.i<this.farIndex&&console.error("Road controller cannot handle reset gracefully")}initSegs(){let e;for(e=0;e<10;e++){let e=new Fh(10,!0);this.container.add(e.mesh),this.farSegs.push(e)}for(this.farSegs[1].initialise(ii.head),this.farSegs[0].initialise(this.farSegs[1].genNode),this.farSegs[0].hide(),this.farSegs[1].hide(),this.farSegs[9].initGeneration(this.farSegs[0].genNode),e=0;e<4;e++){let e=new Fh(100);this.container.add(e.mesh),this.nearSegs.push(e)}this.nearSegs[1].initialise(ii.head),this.nearSegs[0].initialise(this.nearSegs[1].genNode),this.nearSegs[3].initGeneration(this.nearSegs[0].genNode)}update(){if(this.nextNearReady||(this.nextNearReady=this.nearSegs[3].generate()),this.nearIndex-ii.vehicleIndex<this.nearCheck){for(;!this.nextNearReady;)this.nextNearReady=this.nearSegs[3].generate();this.nearSegs.unshift(this.nearSegs.pop()),this.nearSegs[0].display(),this.nearIndex=this.nearSegs[0].genNode.i,this.nearSegs[3].retire(),this.nearSegs[3].initGeneration(this.nearSegs[0].genNode),this.nextNearReady=!1}if(this.nextFarReady){if(this.farIndex-ii.vehicleIndex<this.farCheck){this.farSegs.unshift(this.farSegs.pop()),this.farSegs[0].display(),this.farIndex=this.farSegs[0].genNode.i,this.farSegs[9].retire(),this.farSegs[9].initGeneration(this.farSegs[0].genNode),this.nextFarReady=!1;let e=Math.floor(4.5)-1;this.farSegs[e].hide(),this.farSegs[e+3].show()}}else this.nextFarReady=this.farSegs[9].generate()}};var Zh=window;var Hh="slowroads.io";class Qh extends r.g{updateHeights(){this.attributes.heightOffset.needsUpdate=!0}drawCount(e){this.setDrawRange(0,e*this.res*this.res*6),this.attributes.position.needsUpdate=!0,this.attributes.normal.needsUpdate=!0,this.attributes.heightOffset.needsUpdate=!0,this.attributes.roadProximity.needsUpdate=!0,this.attributes.treeMask.needsUpdate=!0,this.attributes.curvature.needsUpdate=!0}constructor(e,t,i){super(),this.tileIndexSize=0,this.centroid=new r.W;let s=t+1;this.res=t;let n,a,o,h,l=s*s*i,d=[],c=[],p=[],u=0;for(let r=0;r<i;r++){for(let e=0;e<=t;e++)for(let i=0;i<=t;i++)d.push(i/t,e/t),c.push(i/t/10,e/t/10),e<t&&i<t&&(n=e*s+i+u,a=e*s+(i+1)+u,o=(e+1)*s+i+u,h=(e+1)*s+(i+1)+u,p.push(n,a,o),p.push(a,h,o));u+=s*s}this.setIndex(p),this.setAttribute("position",new r.o(new Float32Array(3*l),3)),this.attributes.position.setUsage(r.l),this.setAttribute("normal",new r.o(new Float32Array(3*l),3)),this.attributes.normal.setUsage(r.l),this.setAttribute("heightOffset",new r.o(new Float32Array(l),1)),this.attributes.heightOffset.setUsage(r.l),this.setAttribute("roadProximity",new r.o(new Float32Array(l),1)),this.attributes.roadProximity.setUsage(r.l),this.setAttribute("treeMask",new r.o(new Float32Array(l),1)),this.attributes.treeMask.setUsage(r.l),this.setAttribute("curvature",new r.o(new Float32Array(l),1)),this.attributes.curvature.setUsage(r.l),this.setAttribute("uv",new r.o(new Float32Array(d),2)),this.setAttribute("wuv",new r.o(new Float32Array(c),2))}computeBoundingSphere(e=null){if(null==this.boundingSphere&&(this.boundingSphere=new r.R(new r.W,0)),null==e)return;let t;for(t of(this.boundingSphere.center.set(0,0,0),e))t&&this.boundingSphere.center.add(t);this.boundingSphere.center.multiplyScalar(1/e.length);let i,s=0;for(t of e)i=t.distanceToSquared(this.boundingSphere.center),i>s&&(s=i);this.boundingSphere.radius=Math.sqrt(s)+10}}var Yh=class{constructor(e,t,i,s,n){this.indexCallbacks=[],this.redrawTilesets={},this.redrawCells=[],this.centroids=[],this.centroid=new r.W,this.origin=new r.W,this.lod=e,this.res=t,this.id=s,0==this.lod?this.tileCount=i*i*4:this.tileCount=i*i*1,this.vertexCount=(t+1)*(t+1),this.nextTileIndex=0,this.maxTileIndex=this.tileCount-1,this.readyCount=0,this.drawCount=0,this.retireIndex=Ot,this.geo=new Qh(e,t,this.tileCount),this.mesh=new r.B(this.geo,n),this.showHeight=new Float32Array((t+1)*(t+1)),this.hideHeight=new Float32Array((t+1)*(t+1));for(let a=0;a<this.hideHeight.length;a++)this.hideHeight[a]=-5,this.showHeight[a]=0;this.mesh.visible=!1,this.mesh.receiveShadow=!0,this.mesh.matrixAutoUpdate=!1,this.posArr=this.geo.attributes.position.array,this.normArr=this.geo.attributes.normal.array,this.curveArr=this.geo.attributes.curvature.array,this.heightOffsetArr=this.geo.attributes.heightOffset.array,this.roadProxArr=this.geo.attributes.roadProximity.array,this.treeMaskArr=this.geo.attributes.treeMask.array,this.vec3Count=3*this.vertexCount,this.floatCount=this.vertexCount}reset(){this.nextTileIndex=0,this.retireIndex=Ot,this.readyCount=0,this.drawCount=0,this.indexCallbacks.length=0,this.mesh.visible=!1,this.redrawTilesets={},this.redrawCells.length=0,this.centroids.length=0,this.geo.drawCount(this.nextTileIndex)}registerCallback(e,t){this.indexCallbacks[e]=t}setOrigin(e){this.origin.copy(e),this.mesh.position.copy(this.origin)}setRetireIndex(e){this.retireIndex=Math.max(this.retireIndex,e+Ot)}tileReady(e,t,i,s,n,a,o,r){this.posArr.set(t,e*t.length),this.normArr.set(i,e*i.length),this.curveArr.set(s,e*s.length),this.heightOffsetArr.set(this.showHeight,e*this.showHeight.length),this.roadProxArr.set(n,e*n.length),this.treeMaskArr.set(a,e*a.length),this.centroids[e]=o,this.readyCount++,this.drawCount++,(this.readyCount==this.tileCount||r)&&this.draw()}registerRedrawCell(e){this.redrawCells.push(e)}registerRedraw(e){e.id in this.redrawTilesets||(this.redrawTilesets[e.id]=e)}hideTile(e){this.heightOffsetArr.set(this.hideHeight,e*this.floatCount)}draw(){if(this.redrawCells.length){let e;for(e of this.redrawCells)e.retire(),this.registerRedraw(e.tileset);for(e in this.redrawTilesets)this.redrawTilesets[e].update()}this.mesh.visible=!0,this.geo.drawCount(this.drawCount),this.geo.computeBoundingSphere(this.centroids),this.mesh.updateMatrix()}update(){this.geo.updateHeights()}},Vh=i.p+"static/media/road-despawns.677d3840.webp";const Uh={};var Xh=class{constructor(e,t,i){this.cells=[[],[]],this.lods=[{res:jt,node:null,horizon:Lt,tileSize:5,tiles:Math.floor(2.5),prevCheck:{x:0,z:0}},{res:Tt,node:null,horizon:Pt,tileSize:3,tiles:Math.floor(1.5),prevCheck:{x:0,z:0}}],this.tilesets=[[],[]],this.stagedCells=[],this.loadedCells={},this.activeCells={},this.counts=[0,0],this.nearNode=null,this.medIndex=0,this.medNode=null,this.seenIndex=-1,this.rearNode=null,this.prevCheckCell={x:0,z:0},this.heightmap=e,this.container=new r.G,this.container.matrixAutoUpdate=!1,this.despawnBarrier=new r.B(new r.J(4,1),new r.C({map:st(Vh,16),alphaTest:.5})),this.container.add(this.despawnBarrier),this.groundMaterial=t,this.resetLodConfig(),this.cellClass=i,this.cellClass.initialise((()=>{this.initialise()})),Zh.location.host.indexOf(Hh)<0||Zh.location.host.length,this.seenIndex=ii.head.i}preInit(){let e=Zh.location.host.indexOf(Hh);e<0||Zh.location.host.length}destroy(){for(this.container.traverse((e=>{e.isMesh&&e.geometry.dispose()}));this.container.children.length;)this.container.remove(this.container.children[0])}loader(){return this.progressNodes(!0,1)?(this.lods[1].node.i-this.seenIndex)/this.lods[1].horizon*.5:this.progressNodes(!0,0,0)?.5+(this.lods[0].node.i-this.seenIndex)/this.lods[0].horizon*.5:1}resetLodConfig(){this.lods=[{res:jt,node:null,horizon:Lt,tileSize:5,tiles:Math.floor(2.5),prevCheck:{x:0,z:0}},{res:Tt,node:null,horizon:Pt,tileSize:3,tiles:Math.floor(1.5),prevCheck:{x:0,z:0}}]}reset(e){this.heightmap=e,this.nearNode=ii.head,this.seenIndex=ii.head.i,this.resetLodConfig();for(let t of this.cells)for(let e of t)e.retire();for(let t of this.stagedCells)t.retire(),this.cells[t.lod].push(t);this.stagedCells.length=0,delete this.activeCells,this.activeCells={},delete this.loadedCells,this.loadedCells={};for(let t of this.tilesets)for(let e of t)e.reset();this.initialise()}handleMidlineReset(){ii.tail.i<this.lods[0].node.i&&console.error("Near grid cannot reset gracefully")}testGround(e,t,i){let s=Math.floor(e/Rt),n=Math.floor(t/Rt);if(null==i&&(i={n:[0,1,0]}),i.f=Zt,i.r=!1,i.w=!1,this.activeCells[s]&&this.activeCells[s][n]){i.n=this.activeCells[s][n].getNormal(e,t);let a=ti(e,t,this.activeCells[s][n].originNode,!0);return a.n.lWallDist&&1==a.s&&(i.w=!0,i.wi=Math.floor(100*a.n.lWallDist),!0===i.insideWall?i.wd=a.d-(a.n.lWallDist-.2):!1===i.insideWall?i.wd=a.d-(a.n.lWallDist+.2):i.wd=a.d-a.n.lWallDist,i.ws=a.s,i.wn=a.n.n),a.n.rWallDist&&-1==a.s&&(i.w=!0,i.wi=-1*Math.floor(100*a.n.rWallDist),!0===i.insideWall?i.wd=a.d-(a.n.rWallDist-.2):!1===i.insideWall?i.wd=a.d-(a.n.rWallDist+.2):i.wd=a.d-a.n.rWallDist,i.wn=a.n.n,i.ws=a.s),a.d<a.w?(this.cellClass.paved?i.h=a.y:i.h=this.activeCells[s][n].lookupHeight(e,t),i.f=Bt,i.r=!0):(a.d<a.w+Vt&&(i.f=Ft),i.h=this.activeCells[s][n].lookupHeight(e,t)),i}return i.h=this.heightmap.getXZ(e,t),i.n.length=0,i.n.push(0,1,0),i}testHeight(e,t){let i=Math.floor(e/Rt),s=Math.floor(t/Rt);if(this.loadedCells[i]&&this.loadedCells[i][s]){let n=ti(e,t,this.loadedCells[i][s].originNode,!0);return n.d<n.w?n.y:this.loadedCells[i][s].lerpHeight(e,t,n)}return this.heightmap.getXZ(e,t)}getCoords(e){return{x:Math.floor(e.x/Rt),y:0,z:Math.floor(e.z/Rt)}}getOrigin(e){return{x:Math.floor(e.x/Rt)*Rt,y:0,z:Math.floor(e.z/Rt)*Rt}}getCell(e,t){let i=this.cells[e];if(i.length&&(i[i.length-1].retired||this.seenIndex-i[i.length-1].originIndex>Gt)){var s,n;let e=i.pop();return(null===(s=this.loadedCells[e.coords.x])||void 0===s?void 0:s[e.coords.z])&&this.loadedCells[e.coords.x][e.coords.z].lod==e.lod&&(delete this.loadedCells[e.coords.x][e.coords.z],t!=e.coords.x&&0==Object.keys(this.loadedCells[e.coords.x]).length&&delete this.loadedCells[e.coords.x]),(null===(n=this.activeCells[e.coords.x])||void 0===n?void 0:n[e.coords.z])&&this.activeCells[e.coords.x][e.coords.z].lod==e.lod&&((!this.rearNode||e.originNode.i>this.rearNode.i)&&(this.rearNode=e.originNode,this.despawnBarrier.position.copy(this.rearNode.next.p),this.despawnBarrier.position.y+=1,this.despawnBarrier.rotation.y=.5*Math.PI-this.rearNode.next.a),delete this.activeCells[e.coords.x][e.coords.z],t!==e.coords.x&&0==Object.keys(this.activeCells[e.coords.x]).length&&delete this.activeCells[e.coords.x]),e}{let t=new this.cellClass(e,this.lods[e].res,this.heightmap);return this.counts[e]++,t}}getTileset(e){let t,i=this.tilesets[e];if(i.length){if(t=i[0],t.nextTileIndex<=t.maxTileIndex)return t;if(i.length>1&&(t=i[i.length-1],this.seenIndex>=t.retireIndex))return i.unshift(i.pop()),i[0].reset(),i[0]}return t=new Yh(e,this.lods[e].res,this.lods[e].tileSize,i.length,this.groundMaterial),this.container.add(t.mesh),i.unshift(t),tn["nearcell-"+e]=i.length,i[0]}initialise(){let e,t;for(this.despawnBarrier.position.copy(ii.head.p),this.despawnBarrier.position.y+=1,this.despawnBarrier.rotation.y=.5*Math.PI-ii.head.a,e=1;e>=0;e--){let i,s,n,a,o,r;t=this.lods[e],t.node=ii.head,i=this.getCoords(t.node.p);let h=t.tiles;for(s=-h;s<=h;s++)for(a=i.x+s,n=-h;n<=h;n++)o=i.z+n,a in this.loadedCells||(this.loadedCells[a]={}),o in this.loadedCells[a]&&this.loadedCells[a][o].lod,r=this.getCell(e),r.initGeneration(t.node,{x:a,z:o},this.getTileset(e),!0,this.heightmap),this.cells[e].unshift(r),this.loadedCells[a][o]=r,a in this.activeCells||(this.activeCells[a]={}),this.activeCells[a][o]=r;t.prevCheck.x=i.x,t.prevCheck.z=i.z}}progressNodes(e=!1,t=0,i=1){let s,n;for(Uh.finished=0,Uh.l=i;Uh.l>=t;Uh.l--)if(Uh.lod=this.lods[Uh.l],Uh.lod.node.i>=this.seenIndex+Uh.lod.horizon)Uh.finished++;else if(Uh.lod.node=Uh.lod.node.next,Uh.cs=this.getCoords(Uh.lod.node.p),Uh.cs.x!=Uh.lod.prevCheck.x||Uh.cs.z!=Uh.lod.prevCheck.z){for(Uh.dx=Uh.cs.x-Uh.lod.prevCheck.x,Uh.dz=Uh.cs.z-Uh.lod.prevCheck.z,Uh.tf=Uh.lod.tiles,Uh.i=-Uh.tf;Uh.i<=Uh.tf;Uh.i++)0!==Uh.dx&&(s=Uh.cs.x+Uh.dx*Uh.tf,n=Uh.cs.z+Uh.i,s in this.loadedCells||(this.loadedCells[s]={}),(!(n in this.loadedCells[s])||this.loadedCells[s][n].lod<Uh.l)&&(Uh.c=this.getCell(Uh.l,s),Uh.c.initGeneration(Uh.lod.node,{x:s,z:n},this.getTileset(Uh.l),e,this.heightmap),this.hadLoadedLod=!1,this.loadedCells[s][n]&&this.loadedCells[s][n].lod<Uh.l&&(this.hadLoadedLod=!0),this.loadedCells[s][n]=Uh.c,e?(this.hadLoadedLod,this.cells[Uh.l].unshift(Uh.c),s in this.activeCells?this.activeCells[s][n]&&Uh.c.tileset.registerRedrawCell(this.activeCells[s][n]):this.activeCells[s]={},this.activeCells[s][n]=Uh.c):this.stagedCells.unshift(Uh.c))),0!==Uh.dz&&(s=Uh.cs.x+Uh.i,n=Uh.cs.z+Uh.dz*Uh.tf,s in this.loadedCells||(this.loadedCells[s]={}),(!(n in this.loadedCells[s])||this.loadedCells[s][n].lod<Uh.l)&&(Uh.c=this.getCell(Uh.l,s),Uh.c.initGeneration(Uh.lod.node,{x:s,z:n},this.getTileset(Uh.l),e,this.heightmap),this.hadLoadedLod=!1,this.loadedCells[s][n]&&this.loadedCells[s][n].lod<Uh.l&&(this.hadLoadedLod=!0),this.loadedCells[s][n]=Uh.c,e?(this.hadLoadedLod,this.cells[Uh.l].unshift(Uh.c),s in this.activeCells?this.activeCells[s][n]&&Uh.c.tileset.registerRedrawCell(this.activeCells[s][n]):this.activeCells[s]={},this.activeCells[s][n]=Uh.c):this.stagedCells.unshift(Uh.c)));Uh.lod.prevCheck.x=Uh.cs.x,Uh.lod.prevCheck.z=Uh.cs.z}return Uh.finished<2-t}update(){if(this.seenIndex<ii.vehicleIndex)this.seenIndex++,this.progressNodes();else if(this.stagedCells.length)for(Uh.canPop=!0,Uh.max=this.stagedCells.length/2+3,Uh.s=this.stagedCells.length-1;Uh.s>=0&&!(--Uh.max<=0);Uh.s--)if(this.stagedCells[Uh.s].generate()&&Uh.canPop){if(Uh.c=this.stagedCells.pop(),this.cells[Uh.c.lod].unshift(Uh.c),this.activeCells[Uh.c.coords.x]){if(this.activeCells[Uh.c.coords.x][Uh.c.coords.z]){if(!(this.activeCells[Uh.c.coords.x][Uh.c.coords.z].lod<Uh.c.lod)){Uh.c.retire();continue}Uh.c.tileset.registerRedrawCell(this.activeCells[Uh.c.coords.x][Uh.c.coords.z])}}else this.activeCells[Uh.c.coords.x]={};Uh.c.display(),this.activeCells[Uh.c.coords.x][Uh.c.coords.z]=Uh.c}else Uh.canPop=!1;tn["nearcell-staged"]=this.stagedCells.length}};let Jh=250,qh=50;const Kh=Math.floor(2),_h={},$h={},el={},tl={};class il{constructor(e,t,i){this.retiredCells=[],this.loadedCells={},this.seenCells={},this.tf=Math.floor(2.5),this.prevTile={x:-99999,z:-99999},this.overlapCheckTile={x:0,z:0},this.overlapPrevCheck={x:-99999,z:-99999},this.overlapRedrawTiles=[],this.stagedTilesets=[],this.stagingCells=[],this.preStagedCells=[],this.upcomingTilesets=[],this.loadState={init:!1,overlap:!1,tileset:!1},this.preStagedCellMap={},this.cellCount=0,this.heightmap=e,this.groundMaterial=t,this.container=new r.G,this.cellClass=i,this.container.matrixAutoUpdate=!1,this.seenIndex=ii.vehicleIndex-1,this.initialise()}destroy(){this.container.traverse((e=>{e.isMesh&&e.geometry.dispose()})),this.container.clear()}reset(e){this.heightmap=e,this.seenIndex=ii.head.i;let t=Object.keys(_h);for(let s of t)delete _h[s];this.upcomingTilesets.length=0,this.stagedTilesets.length=0,this.prevTile.x=-9999,this.prevTile.z=-9999;let i=Object.keys(this.loadedCells);for(let s of i){let e=Object.keys(this.loadedCells[s]);for(let t of e)this.retireCell(s,t)}this.stagingCells.length=0,this.initialise()}loader(){return this.stagingCells.length?(this.stagingCells[0].generate()&&this.stagingCells.shift(),(this.stageInitCount-this.stagingCells.length)/this.stageInitCount):1}initialise(){Jh=Math.min(St/10*2.5,990),qh=Math.max(10,Jh/4);let e=Object.keys(_h);for(let i of e)delete _h[i];let t=Object.keys($h);for(let i of t)delete $h[i],delete el[i];for(this.checkNode=ii.vehicleNode,this.checkIndex=this.checkNode.i,this.seenIndex=ii.vehicleIndex-1,this.initialiseOverlapMap(),this.checkInitialTileset(this.checkNode),this.checkStageTileset();this.preStagedCells.length;)tl.psc=this.preStagedCells.shift(),delete this.preStagedCellMap[this.getCellKey(tl.psc[0],tl.psc[1])],this.stageCell(tl.psc);this.stageInitCount=this.stagingCells.length,this.checkDrawTileset()}handleMidlineReset(){if(this.checkIndex>ii.tail.i)throw console.error("Midline reset will affect fargrid lookahead"),this.checkNode=ii.vehicleNode,this.checkIndex=ii.vehicleIndex,new Error("Midline stuck at node "+ii.tail.i);if(this.overlapCheckNode.i>=ii.tail.i){let e=Object.keys($h);for(let t of e){let e=Object.keys($h[t]);for(let i of e)$h[t][i].i>ii.tail.i&&(delete $h[t][i],delete el[t][i])}this.overlapCheckNode=ii.tail}this.seenIndex=Math.min(ii.vehicleIndex,this.seenIndex)}retireCell(e,t){var i;if(this.seenCells[e]&&(delete this.seenCells[e][t],0==Object.keys(this.seenCells[e]).length&&delete this.seenCells[e]),null===(i=this.loadedCells[e])||void 0===i?void 0:i[t]){let i=this.loadedCells[e][t];delete this.loadedCells[e][t],0==Object.keys(this.loadedCells[e]).length&&delete this.loadedCells[e],i.retire(),this.retiredCells.push(i)}}checkActiveCell(e,t){var i,s;let n=Math.floor(e/St),a=Math.floor(t/St);return!!(null===(i=this.loadedCells[n])||void 0===i||null===(s=i[a])||void 0===s?void 0:s.mesh.visible)}addOverlap(e,t,i,s,n=null,a=1){_h[e]||(_h[e]={}),_h[e][t]||(_h[e][t]={}),_h[e][t][i]||(_h[e][t][i]={}),(!_h[e][t][i][s]||_h[e][t][i][s]<a)&&(_h[e][t][i][s]=a),null!==n&&(!_h[e][t][i][n]||_h[e][t][i][n]<a)&&(_h[e][t][i][n]=a),$h[e]||($h[e]={},el[e]={}),$h[e][t]||($h[e][t]=this.overlapCheckNode),el[e][t]=this.overlapCheckNode}applyTileOverlap(e,t,i,s,n){let a=i+1,o=s+1;this.addOverlap(e,t,i,s,o,n),this.addOverlap(e,t,a,s,o,n),0==i?(this.addOverlap(e-1,t,Mt,s,s+1,n),0==s?this.addOverlap(e-1,t-1,Mt,Mt,null,n):o==Mt&&this.addOverlap(e-1,t+1,Mt,0,null,n)):a==Mt&&(this.addOverlap(e+1,t,0,s,s+1,n),0==s?this.addOverlap(e+1,t-1,0,Mt,null,n):o==Mt&&this.addOverlap(e+1,t+1,0,0,null,n)),0==s?(this.addOverlap(e,t-1,i,Mt,null,n),this.addOverlap(e,t-1,i+1,Mt,null,n)):o==Mt&&(this.addOverlap(e,t+1,i,0,null,n),this.addOverlap(e,t+1,i+1,0,null,n))}initialiseOverlapMap(){this.overlapCheckNode=ii.head;let e=Math.floor(this.overlapCheckNode.p.x/zt),t=Math.floor(this.overlapCheckNode.p.z/zt);this.overlapPrevCheck.x=e,this.overlapPrevCheck.z=t;let i,s,n,a,o,r,h=Math.floor(2);for(let l=-h;l<=h;l++)for(let d=-h;d<=h;d++)i=(e+l)*zt/St,s=(t+d)*zt/St,n=Math.floor(i),a=Math.floor(s),o=(e+l)%Mt,r=(t+d)%Mt,o<0&&(o+=Mt),r<0&&(r+=Mt),l==-h||l==h||d==-h||d==h?this.applyTileOverlap(n,a,o,r,-1):this.applyTileOverlap(n,a,o,r,Math.abs(this.overlapCheckNode.g));for(this.overlapCheckNode=this.overlapCheckNode.next;this.overlapCheckNode.i<ii.vehicleIndex+1e3;)this.updateOverlapMap()}updateOverlapRedraw(){for(tl.fz2=St/2,tl.oci=this.overlapRedrawTiles.length-1;tl.oci>=0;tl.oci--){var e,t,i,s,n;if(tl.ocx=this.overlapRedrawTiles[tl.oci][0],tl.ocz=this.overlapRedrawTiles[tl.oci][1],tl.cx=el[tl.ocx][tl.ocz].p.x,tl.cz=el[tl.ocx][tl.ocz].p.z,(tl.cx-this.overlapCheckNode.p.x)*(tl.cx-this.overlapCheckNode.p.x)+(tl.cz-this.overlapCheckNode.p.z)*(tl.cz-this.overlapCheckNode.p.z)>4e4)if(this.overlapRedrawTiles.splice(tl.oci,1),null===(e=this.loadedCells[tl.ocx])||void 0===e?void 0:e[tl.ocz])if(this.loadedCells[tl.ocx][tl.ocz].resetOverlapMap(null===(t=el[tl.ocx])||void 0===t?void 0:t[tl.ocz],null===(i=_h[tl.ocx])||void 0===i?void 0:i[tl.ocz]),this.loadedCells[tl.ocx][tl.ocz].ready)this.stagingCells.push(this.loadedCells[tl.ocx][tl.ocz]);else{let e=this.loadedCells[tl.ocx][tl.ocz];console.log(e.genRow,e.overlapIndex,e.treeGenIndex,e.farWallRenderer.ready)}else console.log(null===(s=this.loadedCells[tl.ocx])||void 0===s||null===(n=s[tl.ocz])||void 0===n?void 0:n.ready)}}updateOverlapMap(){if(tl.nx=Math.floor(this.overlapCheckNode.p.x/zt),tl.nz=Math.floor(this.overlapCheckNode.p.z/zt),tl.nx==this.overlapPrevCheck.x&&tl.nz==this.overlapPrevCheck.z&&this.overlapCheckNode.next)return void(this.overlapCheckNode=this.overlapCheckNode.next);let e,t,i,s;this.overlapRedrawTiles.length&&this.updateOverlapRedraw(),tl.dx=tl.nx-this.overlapPrevCheck.x,tl.dz=tl.nz-this.overlapPrevCheck.z,this.overlapPrevCheck.x=tl.nx,this.overlapPrevCheck.z=tl.nz;let n,a,o,r=Kh;for(o=1-r;o<=r;o++){var h,l;if(0!=tl.dx)n=this.overlapCheckNode.p.x+tl.dx*r*zt,a=this.overlapCheckNode.p.z+o*zt,e=Math.floor(n/St),t=Math.floor(a/St),e in this.seenCells||(this.seenCells[e]={}),this.seenCells[e][t]=this.overlapCheckNode.i,(null===(h=this.loadedCells[e])||void 0===h?void 0:h[t])&&!this.loadedCells[e][t].needsOverlapRedraw&&(this.loadedCells[e][t].needsOverlapRedraw=!0,this.overlapRedrawTiles.push([e,t])),i=Math.floor((n-e*St)/zt),s=Math.floor((a-t*St)/zt),this.applyTileOverlap(e,t,i,s,-1);if(0!==tl.dz)n=this.overlapCheckNode.p.x+o*zt,a=this.overlapCheckNode.p.z+tl.dz*r*zt,e=Math.floor(n/St),t=Math.floor(a/St),e in this.seenCells||(this.seenCells[e]={}),this.seenCells[e][t]=this.overlapCheckNode.i,(null===(l=this.loadedCells[e])||void 0===l?void 0:l[t])&&!this.loadedCells[e][t].needsOverlapRedraw&&(this.loadedCells[e][t].needsOverlapRedraw=!0,this.overlapRedrawTiles.push([e,t])),i=Math.floor((n-e*St)/zt),s=Math.floor((a-t*St)/zt),this.applyTileOverlap(e,t,i,s,-1)}for(r-=1,o=-r;o<=r;o++)0!=tl.dx&&(n=this.overlapCheckNode.p.x+tl.dx*r*zt,a=this.overlapCheckNode.p.z+o*zt,e=Math.floor(n/St),t=Math.floor(a/St),e in this.seenCells||(this.seenCells[e]={}),this.seenCells[e][t]=this.overlapCheckNode.i,i=Math.floor((n-e*St)/zt),s=Math.floor((a-t*St)/zt),this.applyTileOverlap(e,t,i,s,Math.abs(this.overlapCheckNode.g))),0!==tl.dz&&(n=this.overlapCheckNode.p.x+o*zt,a=this.overlapCheckNode.p.z+tl.dz*r*zt,e=Math.floor(n/St),t=Math.floor(a/St),e in this.seenCells||(this.seenCells[e]={}),this.seenCells[e][t]=this.overlapCheckNode.i,i=Math.floor((n-e*St)/zt),s=Math.floor((a-t*St)/zt),this.applyTileOverlap(e,t,i,s,Math.abs(this.overlapCheckNode.g)));this.overlapCheckNode.next&&(this.overlapCheckNode=this.overlapCheckNode.next)}checkInitialTileset(e){let t,i,s,n,a=this.getCoords(e.p),o=a.x,r=a.z,h={node:e,originIndex:e.i,newTiles:[],deadTiles:[]};for(t=-this.tf;t<=this.tf;t++)for(s=t+o,i=-this.tf;i<=this.tf;i++)n=i+r,h.newTiles.push([s,n]),s in this.seenCells||(this.seenCells[s]={}),(!(n in this.seenCells)||e.i>this.seenCells[s][n])&&(this.seenCells[s][n]=e.i);this.upcomingTilesets.push(h),this.prevTile.x=o,this.prevTile.z=r}checkTilesetForNode(e){let t=this.getCoords(e.p),i=t.x,s=t.z;if(i===this.prevTile.x&&s===this.prevTile.z)return;let n,a,o,r,h,l,d,c,p=i-this.prevTile.x,u=s-this.prevTile.z,g={node:e,originIndex:this.checkIndex,newTiles:[],deadTiles:[]};for(0!==p&&(h=this.prevTile.x+p*(this.tf+1),l=this.prevTile.x-p*this.tf),0!==u&&(d=this.prevTile.z+u*(this.tf+1),c=this.prevTile.z-u*this.tf),n=-this.tf;n<=this.tf;n++)for(o=n+i,a=-this.tf;a<=this.tf;a++)r=a+s,0!==p&&(o==h&&g.newTiles.push([h,r]),o-p==l&&g.deadTiles.push([l,r-u])),0!==u&&(r==d&&g.newTiles.push([o,d]),r-u==c&&(void 0!==l&&o-p===l||g.deadTiles.push([o-p,c]))),o in this.seenCells||(this.seenCells[o]={}),(!(r in this.seenCells[o])||this.checkIndex>this.seenCells[o][r])&&(this.seenCells[o][r]=this.checkIndex);this.upcomingTilesets.push(g),this.prevTile.x=i,this.prevTile.z=s}getCellKey(e,t){return e+":"+t}checkStageTileset(){if(this.upcomingTilesets[0].originIndex<ii.vehicleIndex+qh){let e,t,i,s,n=this.upcomingTilesets.shift();for(i of n.newTiles)e=i[0],t=i[1],s=this.getCellKey(e,t),e in this.loadedCells&&t in this.loadedCells[e]||s in this.preStagedCellMap||(this.preStagedCellMap[s]=!0,this.preStagedCells.push([e,t]));this.stagedTilesets.push(n)}}stageCell(e){var t,i,s,n;tl.c=this.getCell(),tl.x=e[0],tl.z=e[1],tl.x in this.loadedCells||(this.loadedCells[tl.x]={}),tl.redraw=!!(null===(t=this.loadedCells[tl.x][tl.z])||void 0===t?void 0:t.needsOverlapRedraw),tl.c.initGeneration(tl.x,tl.z,null===(i=$h[tl.x])||void 0===i?void 0:i[tl.z],null===(s=el[tl.x])||void 0===s?void 0:s[tl.z],null===(n=_h[tl.x])||void 0===n?void 0:n[tl.z],this.heightmap,tl.redraw),this.loadedCells[tl.x][tl.z]=tl.c,this.stagingCells.push(tl.c)}checkDrawTileset(){if(ii.vehicleIndex>=this.stagedTilesets[0].originIndex){let s,n=this.stagedTilesets[0];for(s of n.newTiles){var e,t;if(!(null===(e=this.loadedCells[s[0]])||void 0===e||null===(t=e[s[1]])||void 0===t?void 0:t.ready))return;this.loadedCells[s[0]][s[1]].display()}for(s of n.deadTiles){var i;let e=s[0],t=s[1];e in this.seenCells&&this.seenCells[e][t]<n.originIndex?(this.retireCell(e,t),_h[e]&&(delete _h[e][t],0==Object.keys(_h[e]).length&&delete _h[e]),$h[e]&&(delete $h[e][t],delete el[e][t],0==Object.keys($h[e]).length&&(delete $h[e],delete el[e]))):(null===(i=this.loadedCells[e])||void 0===i?void 0:i[t])&&this.loadedCells[e][t].hide()}this.stagedTilesets.shift()}}update(){if(this.checkIndex<ii.vehicleIndex+Jh&&this.checkNode.next)this.checkNode=this.checkNode.next,this.checkIndex=this.checkNode.i,this.checkTilesetForNode(this.checkNode);else if(this.overlapCheckNode.i<ii.vehicleIndex+1e3)this.updateOverlapMap();else if(this.preStagedCells.length)tl.psc=this.preStagedCells.shift(),delete this.preStagedCellMap[this.getCellKey(tl.psc[0],tl.psc[1])],this.stageCell(tl.psc);else if(this.stagingCells.length){for(tl.max=this.stagingCells.length/2+2,tl.c=0;tl.c<this.stagingCells.length&&!(--tl.max<=0);tl.c++)this.stagingCells[tl.c].generate()&&(this.stagingCells.splice(tl.c,1),tl.c--);tn["farcells-staged"]=this.stagingCells.length}this.seenIndex<ii.vehicleIndex&&(this.upcomingTilesets.length&&this.checkStageTileset(),this.stagedTilesets.length&&this.checkDrawTileset(),this.seenIndex++)}getCoords(e){return{x:Math.floor(e.x/St),y:0,z:Math.floor(e.z/St)}}getOrigin(e){return{x:Math.floor(e.x/St)*St,y:0,z:Math.floor(e.z/St)*St}}getCell(){if(this.retiredCells.length)return this.retiredCells.pop();this.cellCount++;let e=new this.cellClass(this.heightmap,this.groundMaterial);return tn.farcells=this.cellCount,this.container.add(e.mesh),e}}var sl=new class{constructor(){this.arng=new window.alea(Ee),this.container=new r.G,this.scene=null,this.envLayer=new r.G,this.vehicleOrigin=new r.W,this.loadProg=0,this.sceneReady=!1,this.checkPerformance=!1,this.topographyLoaderInit=this._topographyLoaderInit.bind(this),this.topographyReset=this._topographyReset.bind(this),this.topographyLoader=this._topographyLoader.bind(this),this.sceneReset=this._sceneReset.bind(this),this.sceneLoaderInit=this._sceneLoaderInit.bind(this),this.sceneLoader=this._sceneLoader.bind(this),this.updateConfig=this._updateConfig.bind(this),this.farGridLoaderInit=this._farGridLoaderInit.bind(this),this.farGridReset=this._farGridReset.bind(this),this.farGridLoader=this._farGridLoader.bind(this),this.nearGridReset=this._nearGridReset.bind(this),this.nearGridLoaderInit=this._nearGridLoaderInit.bind(this),this.nearGridLoader=this._nearGridLoader.bind(this),this.postGridLoader=this._postGridLoader.bind(this),this.setSceneTopographyBound=this.setSceneToplogy.bind(this),this.setSceneSkinBound=this.setSceneSkin.bind(this),this.setSceneWeatherIndexBound=this.setSceneWeatherIndex.bind(this),this.sunOffset=new r.W,this.checkTimer=.2,this.lastCheckTime=-1,this.skySpeed=5,this.skyOffset=225,Sh.addListener("topography",this.setSceneTopographyBound),Sh.addListener("skin",this.setSceneSkinBound),Sh.addListener("weatherIndex",this.setSceneWeatherIndexBound),this.container.add(this.envLayer),dt(Sh.value.viewLodIndex),ct(Sh.value.detailLodIndex)}nextSkin(){let e=Sh.value.sceneName,t=Sh.value.skin,i=Sh.value.weatherIndex,s=Sh.sceneMeta.scenes[e];if(i++,s.skinWeathers[t].length>i)Sh.set("weatherIndex",i);else{let e=s.skins.indexOf(t);Sh.set("weatherIndex",0),Sh.set("skin",s.skins[(e+1)%s.skins.length])}}prevSkin(){let e=Sh.value.sceneName,t=Sh.value.skin,i=Sh.value.weatherIndex,s=Sh.sceneMeta.scenes[e],n=s.skinWeathers[t];if(i--,i>=0)Sh.set("weatherIndex",i);else{let e=s.skins.indexOf(t)-1;e<0&&(e=s.skins.length-1),Sh.set("weatherIndex",n.length-1),Sh.set("skin",s.skins[e])}}initScene(e){let t=e;this.scene&&(this.envLayer.remove(this.scene.container),this.scene.destroy(),delete this.scene),this.scene=new t(this.getNearGridHeightAt.bind(this)),this.envLayer.add(this.scene.container),this.scene.sanitiseConfig(Sh),this.scene.initialise(Ee,Sh.value,(()=>this.onSceneReady()))}onSceneReady(){this.loadProg=0,this.sceneReady=!0,this.heightmap=this.scene.heightmap,this.midline&&(this.container.remove(this.midline.container),this.midline.destroy()),this.midline=new Wh,this.getOriginPose(),this.midline.initialise(Ee,this.heightmap,this.vehicleOrigin),this.midlineAttempts=0,function(){let e=window,t=atob("c2xvd3JvYWRzLmlv");e.location.host.indexOf(t)<0||(e.location.host.length,t.length)}()}_topographyLoaderInit(){this.sceneReady=!1,this.loadProg=0,this.loadTime=Date.now(),window.localStorage.getItem("seed_failed")&&(console.log("BAD SEED"),window.localStorage.removeItem("seed_failed")),this.checkPerformance=!1,window.localStorage.getItem("analytics_returningPlayer")||(console.log("Env: Analysing performance for dynamic config"),this.checkPerformance=!0),this.initScene(xh[Sh.value.sceneName])}_topographyReset(){this.sceneReady=!1,this.scene.reset(Ee,Sh.value,(()=>this.onSceneReady))}_topographyLoader(){return this.sceneReady?this.buildMidline():0}_sceneReset(){}_sceneLoaderInit(){console.log(" - Topography initialised in",Date.now()-this.loadTime)}_sceneLoader(){return this.loadProg=this.scene.loader(),this.loadProg>=1&&(this.scene.setScene(Sh.value),this.initSky(),this.initRoad()),this.loadProg}_updateConfig(){dt(Sh.value.viewLodIndex),ct(Sh.value.detailLodIndex),this.scene.updateConfig(Sh.value.viewLodIndex,Sh.value.detailLodIndex),this.scene.setScene(Sh.value);let e=2*Nt;this.sky.scale.set(e,e,e),Sh.value.detailLodIndex*Sh.value.viewLodIndex==0?this.sky.visible=!1:this.sky.visible=!0,Us.far=Nt,Us.updateProjectionMatrix()}_farGridLoaderInit(){this.loadTime=Date.now(),this.farGrid&&(this.farGrid.destroy(),this.envLayer.remove(this.farGrid.container),delete this.farGrid),this.farGrid=new il(this.heightmap,this.scene.groundMaterial,this.scene.farGridCell),this.envLayer.add(this.farGrid.container)}_farGridReset(){this.farGrid.reset(this.heightmap)}_farGridLoader(){return this.loadProg=this.farGrid.loader(),this.loadProg}_nearGridReset(){this.nearGrid.reset(this.heightmap)}_nearGridLoaderInit(){console.log(" - Far grid initialised in",Date.now()-this.loadTime),this.nearGrid&&(this.nearGrid.destroy(),this.envLayer.remove(this.nearGrid.container),delete this.nearGrid),this.nearGrid=new Xh(this.heightmap,this.scene.groundMaterial,this.scene.nearGridCell),this.envLayer.add(this.nearGrid.container)}_nearGridLoader(){return this.loadProg=this.nearGrid.loader(),1==this.loadProg&&console.log(" - Both grids initialised in",Date.now()-this.loadTime),this.loadProg}_postGridLoader(){return this.scene.onGridReady(),1}buildMidline(){return this.loadProg=this.midline.loader(),this.loadProg<1?this.loadProg<0?(this.midlineAttempts++,this.midlineAttempts>=25||0==Sh.initialNode&&this.midlineAttempts>=4?(console.log("Too many failed - reloading"),Ye(null,!0),void(this.midlineAttempts=0)):(this.getOriginPose(this.midlineAttempts),this.vehicleOrigin.x+this.vehicleOrigin.z>1e6?void Ye(Date.now(),!0):(this.midline.initialise(Ee,this.heightmap,this.vehicleOrigin),0))):this.loadProg:(this.midline.finalise(),this.scene.onMidlineReady(),this.loadProg=0,1)}setSceneToplogy(e){this.scene.setTopography(e)}setSceneSkin(e){this.scene.setSkin(e)}setSceneWeatherIndex(e){this.scene.setWeatherIndex(e)}initSky(){if(this.sky)return;let e=2*Nt;this.sky=new r.B(new r.J(1,1,10,10),Kt),this.sky.rotation.x=Math.PI/2,this.sky.position.y=200,this.sky.renderOrder=-100,this.sky.scale.set(e,e,e),this.sky.frustumCulled=!1,this.envLayer.add(this.sky)}initRoad(){this.roadController&&(this.roadController.destroy(),this.container.remove(this.roadController.container),delete this.roadController),this.roadController=new Eh,this.container.add(this.roadController.container)}getHeightAt(e,t,i){return this.heightmap.getXZ(e,t,i)}getNearGridHeightAt(e,t){return this.nearGrid.testHeight(e,t)}testGround(e,t){return this.nearGrid.testGround(e.x,e.z,t)}testFarGrid(e,t){return this.farGrid.checkActiveCell(e,t)}getHeight(e,t,i){let s=this.nearGrid.testHeight(e.x,e.z);return s||this.heightmap.getXZ(e.x,e.z,i)}getOriginPose(e=0){let t=new window.alea(Ee),i=0+500*e,s=500*e,n=this.getHeightAt(i,s),a=this.getHeightAt(i+1,s+1),o=Math.abs((a-n)/1.414);for(;n<20||o>.5;)i+=100*Math.abs(t()),s+=100*Math.abs(t()),n=this.getHeightAt(i,s),a=this.getHeightAt(i+1,s+1),o=Math.abs((a-n)/1.414);return n=this.getHeightAt(i,s),this.vehicleOrigin.set(i,n,s),this.vehicleOrigin}update(e,t){if(this.midline.update()){try{this.roadController.update()}catch(eu){throw eu.cause="roadController",eu}try{this.scene.update(e,t)}catch(eu){throw eu.cause="sceneController",eu}try{this.nearGrid.update()}catch(eu){throw eu.cause="nearGrid",eu}try{this.farGrid.update()}catch(eu){throw eu.cause="farGrid",eu}}else this.roadController.handleMidlineReset(),this.scene.handleMidlineReset(),this.nearGrid.handleMidlineReset(),this.farGrid.handleMidlineReset();this.scene.updateAudio(),this.updateSky(e,t)}updateSky(e,t){yt.position.x=be.position.x+yt.sunOffset.x,yt.position.y=be.position.y+yt.sunOffset.y,yt.position.z=be.position.z+yt.sunOffset.z,this.sky.position.x=be.position.x,this.sky.position.y=be.position.y+this.skyOffset,this.sky.position.z=be.position.z,Kt.userData.time.value=t*this.skySpeed,Kt.uniformsNeedUpdate=!0}};const nl={Chase:{name:"Near Chase",i:0,pitch:{near:.3,far:.2},yOffset:{near:.8,far:1},posOffset:new r.W(0,0,1.4),range:{near:3.5,far:4.5},farSpeed:45,smoothFactor:1.5},ChaseFar:{name:"Far Chase",i:1,pitch:{near:.25,far:.15},yOffset:{near:1,far:2},posOffset:new r.W(0,0,0),range:{near:7,far:10},farSpeed:45,smoothFactor:1.25},FirstPerson:{name:"First Person",i:2,pitch:{near:.05,far:.05},yOffset:{near:.7,far:.7},posOffset:new r.W(0,.6,1.4),smoothFactor:.33,range:{near:.75,far:.75},farSpeed:45,rollFactor:-.75},Hood:{name:"Hood",i:5,pitch:{near:.05,far:.05},yOffset:{near:.7,far:.7},posOffset:new r.W(0,.45,3.2),range:{near:.75,far:.75},farSpeed:45,smoothFactor:.3,rollFactor:-.75},Bonnet:{name:"Bonnet",i:3,posOffset:new r.W,rollFactor:-.75},Debug:{name:"Debug",i:4,pitch:{near:.5,far:.5},yOffset:{near:10,far:20},posOffset:new r.W(0,0,0),smoothFactor:1.5,range:{near:40,far:40},farSpeed:45}};let al=["Chase","ChaseFar","FirstPerson"];const ol="config-camera-mode";var rl=class{smoothLerp(e){return-1*(3-2*(e=Math.min(1,e)))*e*e+1}smootherLerp(e){return((e=Math.min(1,e))*(6*e-15)+10)*e*e*e*-1+1}constructor(e){if(this.onViewChange=()=>{},this.mode=nl[al[Dh]],this.modeIndex=0,this.boosting=!1,this.targetFOV=0,this.curFOV=Dt,this.boostFOV=Dt+3,this.onFovBound=this.onFov.bind(this),this.posOffsetX=1,this.setVehicleSideBound=this.setVehicleSide.bind(this),this.setSeatBound=this.setSeat.bind(this),this.orientation=new r.m(0,0,0,"YXZ"),this.targets={y:0,x:0},this.vCenter=new r.W,this.camFwd=new r.W,this.uLerpA=0,this.uLerpB=0,this.uDist=0,this.uSmoothA=0,this.uSmoothB=0,this.uH=0,this.uCollisionCheck=1,this.randFrame=!1,this.onViewChange=e,this.camera=Us,this.camera.zoom=1,this.camera.updateProjectionMatrix(),this.camera.add(me.listener),be.addListener(xe,this.reset.bind(this)),be.addListener(ve,this.initVehicleAngles.bind(this)),We.addListener("side",this.setVehicleSideBound),We.addListener("seat",this.setSeatBound),this.setVehicleSide(We.value.side),this.setSeat(We.value.seat),Sh.addListener("verticalFov",this.onFovBound),window.localStorage.getItem(ol))try{this.modeIndex=JSON.parse(window.localStorage.getItem(ol))}catch{console.log("Camera: Failed to load mode from memory")}this.initVehicleAngles(!0)}onFov(){this.camera.fov=Dt,this.camera.updateProjectionMatrix()}setVehicleSide(e){0==We.seat?this.posOffsetX=0==e?-1:1:this.posOffsetX=1==e?-1:1}setSeat(e){0==We.side?this.posOffsetX=0==e?-1:1:this.posOffsetX=1==e?-1:1}initVehicleAngles(e=!1){if(!be.cameras)return;al=Object.keys(be.cameras);let t=be.cameras;for(let i in t){let e=nl[i],s=t[i];e.isFirstPerson=!!s.isFirstPerson,e.nearPlane=s.nearPlane||.35,e.pitch=s.pitch,e.yOffset=s.yOffset,e.posOffset.fromArray(s.posOffset),e.range=s.range,e.farSpeed=s.farSpeed,e.smoothFactor=s.smoothFactor,e.hideVehicle=s.hideVehicle}this.modeIndex%=al.length,this.mode=nl[al[this.modeIndex]],e||window.localStorage.setItem(ol,this.modeIndex),this.reset()}updateViewDist(){this.camera.far=Ct,this.camera.updateProjectionMatrix()}reset(){let e=0;isNaN(this.orientation.y+this.targets.y)||(e=this.targets.y-this.orientation.y),e%=2*Math.PI,this.uLerpA=this.smoothLerp(be.speed/this.mode.farSpeed),this.uLerpB=1-this.uLerpA,this.targets.x=this.mode.pitch.near*this.uLerpA+this.mode.pitch.far*this.uLerpB+be.pitch,this.targets.x*=-1,this.targets.y=be.heading-Math.PI,this.targets.z=0,this.mode.rollFactor&&(this.targets.z=be.roll*this.mode.rollFactor),this.orientation.x=this.targets.x,this.orientation.y=this.targets.y-e,this.orientation.z=this.targets.z,be.geo.visible=!this.mode.hideVehicle,this.camera.near=this.mode.nearPlane||.35,this.camera.fov=Dt,this.mode.isFirstPerson?(Xs.set(!0),this.camera.fov*=.95):Xs.set(!1),this.camera.updateProjectionMatrix()}setSize(e,t){this.camera.aspect=e/t,this.camera.updateProjectionMatrix(),this.onViewChange()}updateFirstPerson(e){this.camera.position.set(this.mode.posOffset.x*this.posOffsetX,this.mode.posOffset.y+We.value.seatHeight,this.mode.posOffset.z+We.value.seatAdjustment).applyQuaternion(be.quaternion).add(be.position);let t=be.heading-Math.PI;w.mouseAxis.y>0&&1!=D.value&&te.value.MouseLook&&(Math.sign(this.posOffsetX)==Math.sign(w.mouseScreen.x)?t-=.8*w.mouseScreen.x:t-=1*w.mouseScreen.x),this.targets.y<-2&&t>2?this.orientation.y+=2*Math.PI:this.targets.y>2&&t<-2&&(this.orientation.y-=2*Math.PI),this.targets.y=t,this.orientation.y=.8*this.orientation.y+.2*this.targets.y,this.orientation.x=.9*this.orientation.x+.8*-be.pitch*.1,this.orientation.z=.9*this.orientation.z+.5*-be.roll*.1,this.updateCamState()}update(e){if(Y.signal.CameraMode&&(this.modeIndex=(this.modeIndex+1)%al.length,this.mode=nl[al[this.modeIndex]],window.localStorage.setItem(ol,this.modeIndex),this.reset()),this.mode.isFirstPerson)return this.updateFirstPerson(e);this.uLerpA=this.smoothLerp(be.speed/this.mode.farSpeed),this.uLerpB=1-this.uLerpA,this.uSmoothA=Math.min(e/(Mh*this.mode.smoothFactor),1),this.uSmoothC=this.uSmoothA/2,this.uSmoothB=1-this.uSmoothA,this.uSmoothD=1-this.uSmoothC,this.vCenter.set(this.mode.posOffset.x*this.posOffsetX,this.mode.posOffset.y,this.mode.posOffset.z).applyQuaternion(be.quaternion).add(be.position),this.vCenter.y+=this.mode.yOffset.near*this.uLerpA+this.mode.yOffset.far*this.uLerpB,this.camera.position.copy(this.vCenter);let t=be.heading-Math.PI;this.targets.y<-2&&t>2?this.orientation.y+=2*Math.PI:this.targets.y>2&&t<-2&&(this.orientation.y-=2*Math.PI),this.targets.y=t,this.mode.rollFactor?(this.targets.x=this.mode.pitch.near*this.uLerpA+this.mode.pitch.far*this.uLerpB+be.pitch,this.targets.z=be.roll*this.mode.rollFactor,this.orientation.z=this.targets.z*this.uSmoothA+this.orientation.z*this.uSmoothB):(this.targets.x=this.mode.pitch.near*this.uLerpA+this.mode.pitch.far*this.uLerpB+be.pitch,this.targets.x=Math.max(-.2,this.targets.x)),this.targets.x*=-1,this.orientation.x=this.targets.x*this.uSmoothC+this.orientation.x*this.uSmoothD,this.orientation.y=this.targets.y*this.uSmoothA+this.orientation.y*this.uSmoothB,this.updateCamState(),this.uDist=this.mode.range.near*this.uLerpA+this.mode.range.far*this.uLerpB,this.camera.position.add(this.camFwd.multiplyScalar(-this.uDist)),this.uCollisionCheck-=e,this.mode.i<2&&this.uCollisionCheck<0&&(this.uH=sl.getHeight(this.camera.position)+1.5,this.uH>this.camera.position.y?(this.camera.position.y=this.uH,this.camera.lookAt(this.vCenter)):this.uH<this.camera.position.y+2?this.uCollisionCheck=(this.uH-this.camera.position.y)/2:this.collisionCheck=1)}updateCamState(){this.camera.setRotationFromEuler(this.orientation),this.camera.getWorldDirection(this.camFwd),Us.fwd.copy(this.camFwd).normalize().multiplyScalar(-1),this.camera.speed=be.speed}updateConfig(){}destroy(){this.camera&&this.camera.clear(),be.geo&&(be.geo.visible=!0),We.removeListener("side",this.setVehicleSideBound),Sh.removeListener("verticalFov",this.onFovBound)}};const hl=75,ll=.001,dl=2.5;var cl=class{smoothLerp(e){return-1*(3-2*(e=Math.min(1,e)))*e*e+1}smootherLerp(e){return((e=Math.min(1,e))*(6*e-15)+10)*e*e*e*-1+1}pass(){}constructor(e,t){this.onViewChange=()=>{},this.modeIndex=0,this.onSettingsChangedBound=this.onSettingsChanged.bind(this),this.lockChangeAlertBound=this.lockChangeAlert.bind(this),this.onMouseMoveBound=this.onMouseMove.bind(this),this.orientation=new r.m(0,0,0,"YXZ"),this.targets={y:0,x:0},this.vCenter=new r.W,this.camFwd=new r.W,this.uLerpA=0,this.uLerpB=0,this.uDist=0,this.uSmoothA=0,this.uSmoothB=0,this.uH=0,this.uCollisionCheck=1,this.randFrame=!1,this.dir=new r.W,this.leftVec=new r.W(0,0,1),this.upVec=new r.W(0,1,0),this.camUp=new r.W,this.camLeft=new r.W,this.trackPosition=new r.W,this.targetPosition=new r.W,this.targetSmoothing=.025,this.posVec=new r.W,this.sX=0,this.sZ=1,this.targetSpeed=0,this.speed=0,this.baseSpeed=75,this.targetElevSpeed=0,this.elevSpeed=0,this.baseElevSpeed=25,this.targetRotSpeed=0,this.rotSpeed=0,this.baseRotSpeed=1,this.targetRotX=0,this.targetRotY=0,this.mouseSense=.001,this.targetZoom=1,this.curZoom=1,this.maxZoom=Math.sqrt(8),this.minZoom=Math.sqrt(.75),this.zoomSpeed=2.5,this.xSmooth=.003,this.rotSmooth=.02,this.scrollInput=0,this.matchSpeed=!1,this.track=!1,this.camPrevPos=new r.W,this.onViewChange=e,this.camera=Us,this.camContainer=new r.G,this.camContainer.add(this.camera),this.camContainer.rotation.order="ZYX",this.camera.rotation.set(0,0,0),this.camera.rotation.y=Math.PI,this.camera.fov=68,this.camera.updateProjectionMatrix(),this.camera.position.set(0,0,0),this.camera.speed=0,this.canvas=t,this.canvas.requestPointerLock=t.requestPointerLock||t.mozRequestPointerLock,document.exitPointerLock=document.exitPointerLock||document.mozExitPointerLock||this.pass,this.canvas.onclick=()=>{this.canvas.requestPointerLock()},document.addEventListener("pointerlockchange",this.lockChangeAlertBound,!1),me.listener.frustumCulled=!1,w.lockScroll("cinecam"),N.addListener("any",this.onSettingsChangedBound),this.onSettingsChanged(),this.camera.add(me.listener),X&&(this.debug=new r.B(new r.S(2,32,16),new r.C({color:110832})),Ch.add(this.debug)),this.reset()}onSettingsChanged(){this.baseSpeed=hl*N.value.baseSpeed,this.baseElevSpeed=hl*N.value.elevationSpeed,this.mouseSense=ll*N.value.mouseSense,this.zoomSpeed=dl*N.value.zoomSpeed,0==N.value.smoothing?this.rotSmooth=0:this.rotSmooth=.84+.15*Math.cbrt(N.value.smoothing),this.boostFactor=N.value.boostFactor}lockChangeAlert(){document.pointerLockElement===this.canvas||document.mozPointerLockElement===this.canvas?document.addEventListener("mousemove",this.onMouseMoveBound,!1):document.removeEventListener("mousemove",this.onMouseMoveBound,!1)}onMouseMove(e){this.targetRotY-=e.movementX*this.mouseSense/this.curZoom,this.targetRotX+=e.movementY*this.mouseSense*this.camera.aspect/this.curZoom}updateViewDist(){this.camera.far=Ct,this.camera.updateProjectionMatrix()}reset(){this.camContainer.position.copy(be.position),this.camContainer.position.y+=5,this.camContainer.rotation.y=be.heading,this.camContainer.rotation.x=.2,this.curZoom=1,this.targetZoom=1,this.sX=Math.sin(this.camContainer.rotation.y+Math.PI),this.sZ=Math.cos(this.camContainer.rotation.y+Math.PI),this.targetPosition.copy(this.camContainer.position),this.targetRotX=this.camContainer.rotation.x,this.targetRotY=this.camContainer.rotation.y}setSize(e,t){this.camera.aspect=e/t,this.camera.updateProjectionMatrix(),this.onViewChange()}update(e){if(w.key[V.CameraMatchSpeed]&&(w.key[V.CameraMatchSpeed]=!1,this.matchSpeed=!this.matchSpeed),X&&w.key[V.NodeDebug]){let e=ei(this.camContainer.position.x,this.camContainer.position.z,ii.vehicleNode,!0).n,t=ti(this.camContainer.position.x,this.camContainer.position.z,e);console.log("Near node is "+t.n.i+" at dist "+t.d),this.debug.position.copy(t.n.p),w.key[V.NodeDebug]=!1}this.matchSpeed?this.targetSpeed=Math.max(1,be.speed):(this.speed=.9*this.speed,this.targetSpeed=0),this.targetElevSpeed=0,this.posVec.set(0,0,0),this.dir.x=0,this.hadInput=!1,w.key[V.Forward]&&(this.hadInput=!0,this.posVec.x-=e*this.speed*this.sX,this.posVec.z-=e*this.speed*this.sZ),w.key[V.Backward]&&(this.hadInput=!0,this.posVec.x+=e*this.speed*this.sX,this.posVec.z+=e*this.speed*this.sZ),this.dir.z=0,w.key[V.Left]&&(this.hadInput=!0,this.posVec.x-=e*this.speed*this.sZ,this.posVec.z+=e*this.speed*this.sX),w.key[V.Right]&&(this.hadInput=!0,this.posVec.x+=e*this.speed*this.sZ,this.posVec.z-=e*this.speed*this.sX),this.hadElev=!1,w.click.right?(this.hadElev=!0,this.posVec.y-=e*this.elevSpeed):w.click.left&&(this.hadElev=!0,this.posVec.y+=e*this.elevSpeed),this.hadInput&&!this.matchSpeed&&(this.targetSpeed=this.baseSpeed),this.hadElev&&(this.targetElevSpeed=this.baseElevSpeed),this.speedMult=1,w.key[V.BoostAccel]&&(this.speedMult=this.boostFactor,this.targetSpeed*=this.boostFactor),this.speed=.9*this.speed+.1*this.targetSpeed,this.elevSpeed=.95*this.elevSpeed+.05*this.targetElevSpeed,this.hadRot=!1,this.targetRotSpeed=0,w.key[V.LeftArrow]?(this.hadRot=!0,this.targetRotY+=e*this.rotSpeed):w.key[V.RightArrow]&&(this.hadRot=!0,this.targetRotY-=e*this.rotSpeed),w.key[V.UpArrow]?(this.hadRot=!0,this.targetRotX-=e*this.rotSpeed*.5):w.key[V.DownArrow]&&(this.hadRot=!0,this.targetRotX+=e*this.rotSpeed*.5),this.hadRot&&(this.targetRotSpeed=1*this.baseRotSpeed/this.curZoom),this.rotSpeed=.98*this.rotSpeed+.02*this.targetRotSpeed,this.camContainer.rotation.x=this.camContainer.rotation.x*this.rotSmooth+this.targetRotX*(1-this.rotSmooth),this.camContainer.rotation.y=this.camContainer.rotation.y*this.rotSmooth+this.targetRotY*(1-this.rotSmooth),this.sX=Math.sin(this.camContainer.rotation.y+Math.PI),this.sZ=Math.cos(this.camContainer.rotation.y+Math.PI),this.scrollInput=.9*this.scrollInput+.1*w.scrollDelta,0!=this.scrollInput&&(this.targetZoom-=this.scrollInput*e*this.zoomSpeed*this.speedMult,this.targetZoom=Math.max(Math.min(this.maxZoom,this.targetZoom),this.minZoom),w.scrollDelta=0),this.curZoom=.95*this.curZoom+.05*this.targetZoom,this.curZoom!=this.camera.zoom&&(this.camera.zoom=this.curZoom*this.curZoom,this.camera.updateProjectionMatrix()),this.track&&(this.trackPosition.copy(be.frontAxlePosition),this.trackPosition.y+=.5,this.camContainer.lookAt(this.trackPosition)),w.key[V.ResetCamera]&&(this.reset(),w.key[V.ResetCamera]=!1),this.camera.getWorldDirection(this.camFwd),this.targetPosition.add(this.posVec),this.camContainer.position.lerp(this.targetPosition,this.targetSmoothing),this.camPrevPos.copy(this.camContainer.position),this.uCollisionCheck-=e,this.uCollisionCheck<0&&(this.uH=sl.getHeight(this.targetPosition)+.5,this.uH>this.targetPosition.y?this.targetPosition.y=this.uH:this.uH<this.targetPosition.y+2?this.uCollisionCheck=(this.uH-this.targetPosition.y)/2:this.collisionCheck=1)}updateConfig(){}destroyCinecam(){this.camContainer&&this.camContainer.clear(),this.camera&&this.camera.clear(),document.removeEventListener("mousemove",this.onMouseMoveBound,!1),document.exitPointerLock&&document.exitPointerLock(),this.canvas&&(this.canvas.onclick=()=>{}),Ch.remove(this.debug),N.removeListener(this.onSettingsChangedBound),w.unlockScroll("cinecam")}destroy(){this.destroyCinecam()}};function pl(e,t){return 0==t?e>0?Math.PI/2:3*Math.PI/2:0==e?t>0?0:Math.PI:e>0?t>0?Math.atan(e/t):Math.PI+Math.atan(e/t):t<0?Math.PI+Math.atan(e/t):2*Math.PI+Math.atan(e/t)}var ul=new class extends l{constructor(...e){super(...e),this.default=-9.81,this.value=-9.81}};const gl=[.44704,.277778],ml=[60*gl[0],100*gl[1]],xl=0,vl=1;var wl=new class extends p{getConversion(e){this.conversion=gl[e],this.default.speed=ml[e],null!=this.value.speed&&this.set("speed",5*Math.round(this.value.speed/this.conversion/5)*this.conversion)}toggleMode(){this.set("control",(this.value.control+1)%2)}constructor(){super(),this.default={enabled:!1,speed:ml[0],control:xl},this.value={enabled:!1,speed:ml[0],control:xl},this.conversion=gl[te.Units],this.getConversionBound=this.getConversion.bind(this),this.vehicleTypeChangedBound=this.vehicleTypeChanged.bind(this);try{null!==window.localStorage.getItem("speed-control_enabled")&&(this.value.enabled=!!JSON.parse(window.localStorage.getItem("speed-control_enabled"))),null!==window.localStorage.getItem("speed-control_speed")&&(this.value.speed=JSON.parse(window.localStorage.getItem("speed-control_speed"))),null!==window.localStorage.getItem("speed-control_control")&&(this.value.control=JSON.parse(window.localStorage.getItem("speed-control_control")))}catch(eu){console.warn("Failed to load speed control settings")}he.cruisecontrol&&!isNaN(he.cruisecontrol)&&(this.value.speed=he.cruisecontrol/3.6,this.value.enabled=!0,this.value.control=xl),te.addListener(J.Units,this.getConversionBound),Y.addListener("IncSpeedControl",this.inc5.bind(this)),Y.addListener("DecSpeedControl",this.dec5.bind(this)),We.addListener("type",this.vehicleTypeChangedBound)}vehicleTypeChanged(e){this.default.speed=Math.min(ml[te.Units],ke[e].metrics.topSpeed),this.set("speed",Math.min(ke[e].metrics.topSpeed,this.value.speed))}reset(){this.setMany({enabled:!0,speed:ml[te.Units]})}set(e,t,i=!1){if(e in this.value&&this.value[e]!==t){if("speed"==e){if(be.metrics&&t>be.metrics.topSpeed*We.speedFactor)t=be.metrics.topSpeed*We.speedFactor;else if(t<=0)return;null!=t&&(t=Math.max(Math.min(be.metrics.topSpeed*We.speedFactor,t),0),t=5*Math.round(t/this.conversion/5)*this.conversion),window.localStorage.setItem("speed-control_speed",t)}else"control"==e?window.localStorage.setItem("speed-control_control",t):"enabled"==e&&window.localStorage.setItem("speed-control_enabled",t);this.value[e]=t,i||this.onChanged(e,this.value[e])}}inc5(){this.set("speed",this.value.speed+5*this.conversion)}dec5(){this.set("speed",this.value.speed-5*this.conversion)}},fl=i.p+"static/media/achievement.97104f4a.mp3";const bl={edge:!1},Al={edge:"achievement-edge"};var yl=new class extends p{constructor(...e){super(...e),this.value=bl,this.hasLoaded=!1,this.sound=null,this.loadAchievements(),this.hasLoaded=!0,me.hasInit?this.onAudioInit():me.addInitListener(this.onAudioInit.bind(this))}onAudioInit(){me.getAudio(fl,(e=>{this.sound=e}))}set(e,t){var i;e in this.value&&!this.value[e]&&1==t&&(null===(i=this.sound)||void 0===i||i.play(),window.localStorage.setItem(Al[e],t));super.set(e,t)}loadAchievements(){let e,t;for(t in this.value)e=JSON.parse(window.localStorage.getItem(Al[t])||bl[t]),this.value[t]=e}};const Il=new p({steerSpeedFactor:.75},"controls_global_settings"),Sl={steerSpeedFactor:{readable:"Top speed steer limiter",desc:"Narrows the maximum steer angle as speed increases",type:u.FloatRange,default:.75,min:0,max:.9,precision:2}};var Ml=Il;const Dl=Object.keys(ke),Cl=()=>({personal:Nl(),global:{daily:Nl(),allTime:Nl()}}),Nl=()=>{let e={};for(let t of wh){e[t]={};for(let i of Dl)e[t][i]=-1}return e},kl=Cl();var zl=new class extends p{}({...kl,key:"fastestMile",seconds:-1,live:{value:-1,progress:0,prev:0},liveInterval:{startTime:0,startNode:0,endNode:160}});const jl=[{key:"fastestMile",label:"Fastest Any Mile",unit:"seconds",state:zl,stateKey:"seconds"},{key:"fastestFirstFive",label:"Fastest First Five Miles",unit:"seconds"},{key:"furthestJourney",label:"Furthest Single Journey",unit:"meters"},{key:"furthestOnRoad",label:"Furthest On-Road",unit:"meters"}];var Ll=new class extends p{constructor(e){super(e),this.updateView(),this.loadRecords(),this.listenRecords(),We.addListener("type",this.onVehicleChanged.bind(this))}switchBoard(){"global"==this.view.board?this.set("view",{...this.view,board:"personal"}):this.set("view",{...this.view,board:"global"})}switchTime(){"daily"==this.view.time?this.set("view",{...this.view,time:"allTime"}):this.set("view",{...this.view,time:"daily"})}loadRecords(){for(let e of jl)e.state&&e.state.set("personal",this.getRecords("records_"+e.key))}updateView(){this.set("view",{...this.view,topography:Sh.initialValue.topography,vehicle:We.value.type})}onVehicleChanged(e){this.updateView()}listenRecords(){}getRecords(e){let t=null;try{t=JSON.parse(window.localStorage.getItem(e))}catch(eu){console.warn("Could not load record "+e+" from local storage")}if(null==t){t=Cl().personal}return t}storeRecords(e,t){window.localStorage.setItem("records_"+e,JSON.stringify(t))}getStorage(e){let t=null;try{t=JSON.parse(window.localStorage.getItem(e))}catch(eu){console.warn("Could not load record "+e+" from local storage")}return t}encodeKey(e){return"records_"+Sh.initialValue.topography+"_"+We.value.type+"_"+e}store(e,t){isNaN(t)?console.warn("Avoiding record of NaN value ",t):t<0?console.warn("Avoiding record of default value ",t):window.localStorage.setItem(this.encodeKey(e),t)}}({view:{topography:"normal",vehicle:"Roadster",time:"daily",board:"personal"},global:null});var Ol=new class extends l{};var Rl=new class extends l{constructor(...e){super(...e),this.default=!1,this.value=!1}};var Tl=new class{constructor(){this.onDisplayBound=this.onDisplay.bind(this),this.onSocketBound=this.onSocket.bind(this),this.hasInit=!1,this.updateViewBound=this.updateView.bind(this),this.seenIndex=0,this.updateBound=this.update.bind(this),this.endNodeOffset=0,this.endNodeTracker=0,null!==Ol.value?this.onSocket(Ol.value):Ol.addListener(this.onSocketBound),Ll.addListener("view",this.updateViewBound),Rl.addListener(this.onDisplayBound)}onDisplay(e){e?(this.resetFastestMile(),ae.addSlowListener(this.updateBound)):ae.addSlowListener(this.updateBound)}onSocket(e){e.on("leaderboard",this.onNewLeaderboard.bind(this)),e.on("partialLeaderboard",this.onPartialLeaderboard.bind(this)),e.on("newRecord",this.onNewRecord.bind(this)),e.emit("requestLeaderboard")}onNewLeaderboard(e){Ll.set("global",e)}onPartialLeaderboard(e){}onNewRecord(e){console.log("Got a new record!")}submitRecord(e,t,i,s,n="Anonymous"){Ol.value&&Ol.value.emit("challengeRecord",{key:i,topography:e,vehicle:t,value:s,name:n})}updateView(e){this.resetFastestMile()}pause(){this.paused=!0}resume(){this.paused=!1,this.hasInit||this.resetFastestMile(),this.hasInit=!0}init(){Ll.updateView(),this.resetFastestMile(),this.paused=!0,this.hasInit=!1}resetFastestMile(){zl.set("liveInterval",{startTime:ae.playTime,startNode:ii.vehicleIndex,endNode:ii.vehicleIndex+160}),zl.set("live",{value:0,prev:zl.live.prev,progress:0})}nodeDidChange(){Sh.saveProgress(ii.vehicleIndex)}update(e){this.paused||(this.updateFastestMile(e),this.seenIndex=ii.vehicleIndex)}checkRecordBreak(e,t,i){return!(e<1)&&(this.tr=t.personal[Ll.view.topography][Ll.view.vehicle],(e<this.tr||this.tr<0)&&(t.personal[Ll.view.topography][Ll.view.vehicle]=e,!0))}updateFastestMile(e){zl.live.value+=1e3*e/1e3,this.seenIndex!==ii.vehicleIndex&&(zl.live.progress=(ii.vehicleIndex-zl.liveInterval.startNode)/160,zl.liveInterval.endNode<=ii.vehicleIndex&&(this.checkRecordBreak(zl.live.value,zl)&&(zl.onChanged("personal",zl.personal),Ll.storeRecords(zl.key,zl.personal)),this.submitRecord(Ll.view.topography,Ll.view.vehicle,zl.key,zl.live.value),zl.set("liveInterval",{startTime:ae.playTime,startNode:ii.vehicleIndex,endNode:ii.vehicleIndex+160}),zl.live.prev=zl.live.value,zl.live.value=0,zl.live.progress=0)),zl.onChanged("live",zl.live)}};var Pl=new class{constructor(){this.speed=0,this.dist=0}cosntructor(){this.reset()}reset(){this.speed=0,this.dist=0}};const Gl="analytics_returningPlayer",Bl="analytics_lastActive",Wl={newUser:null==localStorage.getItem(Gl),lastActiveTime:localStorage.getItem(Bl)};var Fl=Wl;const El={None:0,Basic:1,Reset:2,Boost:3,UTurn:4,Reverse:5},Zl={Reset:"seen-reset",Boost:"seen-boost"},Hl={Basic:Fl.newUser,Reset:null==localStorage.getItem(Zl.Reset),Boost:null==localStorage.getItem(Zl.Boost)},Ql=e=>{e in Hl&&(Hl[e]=!1,localStorage.setItem(Zl[e],!0),Yl.value==El[e]&&Yl.set(El.None))},Yl=new l(Fl.newUser?El.Basic:El.None);var Vl=Yl,Ul=i.p+"static/media/tyres_01_m.2ec57852.mp3",Xl=i.p+"static/media/tyres_01_m_int.5d27166a.mp3",Jl=i.p+"static/media/sus_01.7d5083fe.mp3",ql=i.p+"static/media/veh_brake_02.a97daa47.mp3",Kl=i.p+"static/media/rolling_offroad_04.2c2c84b8.mp3",_l=i.p+"static/media/rolling_offroad_04_int.83dac2e0.mp3",$l=i.p+"static/media/rolling_06_int.d04bedc2.mp3",ed=i.p+"static/media/veh_scrape_01.3499a87a.mp3",td=i.p+"static/media/hit_01.377ae224.mp3",id=i.p+"static/media/hit_02.6113c161.mp3",sd=i.p+"static/media/hit_03.44417d70.mp3",nd=i.p+"static/media/veh_scrape_01_int.2d544904.mp3",ad=i.p+"static/media/hit_01_int.5eb83eb2.mp3",od=i.p+"static/media/hit_02_int.f90043d1.mp3",rd=i.p+"static/media/hit_03_int.b6faf4a8.mp3";const hd="roll",ld="engine",dd="engine2",cd="brake",pd="boost",ud=.8;let gd=.8;const md={brake:ql,boost:ye,engine2:ql},xd={sus:Jl,tyre:Ul,tyreInt:Xl,roll:null,rollInt:$l,offroad:Kl,offroadInt:_l},vd={hits:[td,id,sd],hitsInt:[ad,od,rd],scrape:ed,scrapeInt:nd};var wd=class{constructor(e){this.sounds={tyres:[],tyresExt:[],tyresInt:[],sus:[],rolls:[],rollsExt:[],rollsInt:[],offroads:[],offroadsExt:[],offroadsInt:[]},this.worldSounds={hits:[],hitsInt:[],hitsExt:[],scrape:null,scapeInt:null,scrapeExt:null},this.audioReady=!1,this.paved=!0,this.interior=!1,this.updateNull=()=>{},this.vol=0,this.decel=!1,this.lerpTarget=2,this.speedTarget=0,this.accelPower=0,this.boostT=0,this.brakeT=0,this.tls=[0,0,0,0],this.coll=!1,this.hitIndex=0,this.vc=e,this.update=this.updateNull,"Planet"==Sh.sceneName&&(this.paved=!1),Sh.addListener("sceneName",(e=>this.paved="Planet"!==e)),Xs.addListener(this.onInteriorChanged.bind(this))}onInteriorChanged(e){if(this.audioReady)if(e){for(let e of this.worldSounds.hits)e.setVolume(0);this.worldSounds.hits=this.worldSounds.hitsInt,this.worldSounds.scrape.setVolume(0),this.worldSounds.scrape.stop(),this.worldSounds.scrape=this.worldSounds.scrapeInt;for(let e of this.sounds.offroadsExt)e.setVolume(0);this.sounds.offroads=this.sounds.offroadsInt;for(let e of this.sounds.rollsExt)e.setVolume(0);this.sounds.rolls=this.sounds.rollsInt}else{for(let e of this.worldSounds.hits)e.setVolume(0);this.worldSounds.hits=this.worldSounds.hitsExt,this.worldSounds.scrape.setVolume(0),this.worldSounds.scrape.stop(),this.worldSounds.scrape=this.worldSounds.scrapeExt;for(let e of this.sounds.offroadsInt)e.setVolume(0);this.sounds.offroads=this.sounds.offroadsExt;for(let e of this.sounds.rollsInt)e.setVolume(0);this.sounds.rolls=this.sounds.rollsExt}}suspend(){var e;for(let i in this.sounds){var t;if(Array.isArray(this.sounds[i]))for(let e of this.sounds[i])e.setVolume(0);else null===(t=this.sounds[i])||void 0===t||t.setVolume(0)}for(let i of this.worldSounds.hits)i.setVolume(0);null===(e=this.worldSounds.scrape)||void 0===e||e.setVolume(0)}initForVehicle(e,t,i){this.update=this.updateNull,this.inputs=t,this.wheels=i,this.soundCount=0,this.soundLoaded=0,this.soundsHaveInit=!1;for(let o in e.audio)this.loadSound(o,e.audio[o]);for(let o in md)e.audio[o]||this.loadSound(o,md[o]);xd.roll=e.audio.roll,this.loadWorldSounds();for(let o in this.sounds){var s,n;for(let e=0;e<this.sounds[o].length;e++)this.sounds[o][e].stop();null===(s=(n=this.sounds[o]).stop)||void 0===s||s.call(n)}let a=[];e.bike?(gd=.8,a.push({x:0,z:e.wheels.length},{x:0,z:0})):(gd=.64,a.push({x:e.wheels.width/2,z:e.wheels.length},{x:-e.wheels.width/2,z:e.wheels.length},{x:e.wheels.width/2,z:0},{x:-e.wheels.width/2,z:0}));for(let o=0;o<a.length;o++)this.loadTyre(o,a[o]);this.lerpTarget=0,this.speedTarget=0,this.soundsHaveInit=!0}soundDidLoad(){this.soundLoaded++,this.soundsHaveInit&&this.soundLoaded>=this.soundCount&&(this.audioReady=!0,Xs.value?(this.worldSounds.scrape=this.worldSounds.scrapeInt,this.sounds.rolls=this.sounds.rollsInt):(this.worldSounds.scrape=this.worldSounds.scrapeExt,this.sounds.rolls=this.sounds.rollsExt),this.update=this.updateLive)}loadHit(e){this.soundCount++,me.getPositionalAudio(vd.hits[e],(t=>{this.worldSounds.hitsExt[e]=t,t.setRefDistance(5),t.setRolloffFactor(3*ud),t.setVolumeStoppable(0),be.add(t),t.onEnded=()=>{t.stop()},this.soundDidLoad()}),this.worldSounds.hitsExt[e]),this.soundCount++,me.getPositionalAudio(vd.hitsInt[e],(t=>{this.worldSounds.hitsInt[e]=t,t.setRefDistance(5),t.setRolloffFactor(3*ud),t.setVolumeStoppable(0),be.add(t),t.onEnded=()=>{t.stop()},this.soundDidLoad()}),this.worldSounds.hitsInt[e])}loadWorldSounds(){for(let e=0;e<vd.hits.length;e++)this.loadHit(e);this.worldSounds.hits=Xs.value?this.worldSounds.hitsInt:this.worldSounds.hitsExt,this.soundCount++,me.getPositionalAudio(vd.scrape,(e=>{this.worldSounds.scrapeExt&&(this.worldSounds.scrapeExt.stop(),be.remove(this.worldSounds.scrapeExt)),this.worldSounds.scrapeExt=e,e.setLoop(!0),e.setLoopStart(.1),e.setLoopEnd(e.buffer.duration-.1),e.setVolumeStoppable(0),e.setRefDistance(8),e.setRolloffFactor(ud),e.position.set(0,.5,be.wheels.length/2),be.add(this.worldSounds.scrapeExt),this.soundDidLoad()})),this.soundCount++,me.getPositionalAudio(vd.scrapeInt,(e=>{this.worldSounds.scrapeInt&&(this.worldSounds.scrapeInt.stop(),be.remove(this.worldSounds.scrapeInt)),this.worldSounds.scrapeInt=e,e.setLoop(!0),e.setLoopStart(.1),e.setLoopEnd(e.buffer.duration-.1),e.setVolumeStoppable(0),e.setRefDistance(8),e.setRolloffFactor(ud),e.position.set(0,.5,be.wheels.length/2),be.add(this.worldSounds.scrapeInt),this.soundDidLoad()}))}loadTyre(e,t){let i=.1*Math.random()+.25*e;this.soundCount++,me.getPositionalAudio(xd.tyre,(s=>{this.sounds.tyres[e]&&(this.sounds.tyres[e].stop(),this.sounds.tyres[e].removeFromParent(),delete this.sounds.tyres[e]),this.sounds.tyres[e]=s,s.setLoop(!0),s.setLoopStart(.1),s.setLoopEnd(s.buffer.duration-.1),s.setRefDistance(2*be.wheels.length),s.setRolloffFactor(4),s.setVolumeStoppable(0),s.offset=i*s.buffer.duration,s.detune=-400*Math.random(),s.position.x=t.x,s.position.z=t.z,be.add(s),this.soundDidLoad()}),this.sounds.tyres[e]),this.soundCount++,me.getPositionalAudio(xd.tyreInt,(s=>{this.sounds.tyresInt[e]&&(this.sounds.tyresInt[e].stop(),this.sounds.tyresInt[e].removeFromParent(),delete this.sounds.tyresInt[e]),this.sounds.tyresInt[e]=s,s.setLoop(!0),s.setLoopStart(.1),s.setLoopEnd(s.buffer.duration-.1),s.setRefDistance(2*be.wheels.length),s.setRolloffFactor(4),s.setVolumeStoppable(0),s.offset=i*s.buffer.duration,s.detune=-400*Math.random(),s.position.x=t.x,s.position.z=t.z,be.add(s),this.soundDidLoad()}),this.sounds.tyresInt[e]),this.soundCount++,me.getPositionalAudio(xd.roll,(s=>{this.sounds.rollsExt[e]&&(this.sounds.rollsExt[e].stop(),this.sounds.rollsExt[e].removeFromParent(),delete this.sounds.rollsExt[e]),this.sounds.rollsExt[e]=s,s.setLoop(!0),s.setLoopStart(.1),s.setLoopEnd(s.buffer.duration-.1),s.setVolumeStoppable(0),s.setRefDistance(2*be.wheels.length),s.setRolloffFactor(3*ud),s.offset=i*s.buffer.duration,s.position.x=t.x,s.position.z=t.z,be.add(s),this.soundDidLoad()}),this.sounds.rollsExt[e]),this.soundCount++,me.getPositionalAudio(xd.rollInt,(s=>{this.sounds.rollsInt[e]&&(this.sounds.rollsInt[e].stop(),this.sounds.rollsInt[e].removeFromParent(),delete this.sounds.rollsInt[e]),this.sounds.rollsInt[e]=s,s.setLoop(!0),s.setLoopStart(.1),s.setLoopEnd(s.buffer.duration-.1),s.setVolumeStoppable(0),s.setRefDistance(2*be.wheels.length),s.setRolloffFactor(3*ud),s.offset=i*s.buffer.duration,s.position.x=t.x,s.position.z=t.z,be.add(s),this.soundDidLoad()}),this.sounds.rollsInt[e]),this.soundCount++,me.getPositionalAudio(xd.offroad,(s=>{this.sounds.offroadsExt[e]&&(this.sounds.offroadsExt[e].stop(),this.sounds.offroadsExt[e].removeFromParent(),delete this.sounds.offroadsExt[e]),this.sounds.offroadsExt[e]=s,s.setLoop(!0),s.setLoopStart(.1),s.setLoopEnd(s.buffer.duration-.1),s.setVolumeStoppable(0),s.setRefDistance(2*be.wheels.length),s.setRolloffFactor(3*ud),s.offset=i*s.buffer.duration,s.detune=800*Math.random(),s.position.x=t.x,s.position.z=t.z,e<2&&(s.position.z=be.wheels.length),be.add(s),this.soundDidLoad()}),this.sounds.offroadsExt[e]),this.soundCount++,me.getPositionalAudio(xd.offroadInt,(s=>{this.sounds.offroadsInt[e]&&(this.sounds.offroadsInt[e].stop(),this.sounds.offroadsInt[e].removeFromParent(),delete this.sounds.offroadsInt[e]),this.sounds.offroadsInt[e]=s,s.setLoop(!0),s.setLoopStart(.1),s.setLoopEnd(s.buffer.duration-.1),s.setVolumeStoppable(0),s.setRefDistance(2*be.wheels.length),s.setRolloffFactor(3*ud),s.offset=i*s.buffer.duration,s.detune=800*Math.random(),s.position.x=t.x,s.position.z=t.z,e<2&&(s.position.z=be.wheels.length),be.add(s),this.soundDidLoad()}),this.sounds.offroadsInt[e]),this.sounds.offroads=Xs.value?this.sounds.offroadsInt:this.sounds.offroadsExt,this.soundCount++,me.getPositionalAudio(xd.sus,(s=>{this.sounds.sus[e]&&(this.sounds.sus[e].stop(),this.sounds.sus[e].removeFromParent(),delete this.sounds.sus[e]),this.sounds.sus[e]=s,s.setLoop(!0),s.setLoopStart(.1),s.setLoopEnd(s.buffer.duration-.1),s.setRefDistance(.64*be.wheels.width),s.setRolloffFactor(ud),s.setVolumeStoppable(0),s.offset=i*s.buffer.duration,s.detune=-400*Math.random(),s.position.x=t.x,s.position.z=t.z,be.add(s),this.soundDidLoad()}),this.sounds.sus[e])}loadSound(e,t){this.soundCount++,me.getPositionalAudio(t,(t=>{this.sounds[e]&&(this.sounds[e].stop(),this.sounds[e].removeFromParent(),delete this.sounds[e]),this.sounds[e]=t,e==hd&&(t.setLoop(!0),t.setLoopStart(.1),t.setLoopEnd(t.buffer.duration-.1),t.setVolumeStoppable(0),t.setRefDistance(2*be.wheels.length),t.setRolloffFactor(ud),t.position.set(0,.5,be.wheels.length/2)),e!=ld&&e!=dd||(t.setLoop(!0),t.setLoopStart(.1),t.setLoopEnd(t.buffer.duration-.1),t.setRefDistance(2*be.wheels.length),t.setRolloffFactor(ud),t.position.set(0,.5,be.wheels.length),t.setVolume(0),t.play()),e!=cd&&e!=pd||(t.setLoop(!0),t.setLoopStart(.1),t.setLoopEnd(t.buffer.duration-.1),t.setRefDistance(2*be.wheels.length),t.setRolloffFactor(ud),t.position.set(0,.5,be.wheels.length/2),t.setVolumeStoppable(0)),be.add(this.sounds[e]),this.soundDidLoad()}),this.sounds[e])}updateLive(e,t,i){this.interiorVol=Xs.value?.5:1,this.updateEngine(e,this.inputs),this.updateBoost(),this.updateBrakes(),this.updateTyres(e,this.wheels),this.updateCollisions()}reset(){this.vol=0,this.lerpTarget=2}updateEngine(e,t){let i=this.sounds.engine,s=this.sounds.engine2,n=.8*be.powerLerp;n=n<.5?n*n*2:2*(1-n),this.vc.inputs.accel<0&&be.direction>0&&(n=0),this.accelPower=.4+Math.abs(this.vc.inputs.accel)/be.metrics.accel*.6,0!=t.accel?(this.decel&&(this.vol+=.2,this.decel=!1),this.vol+=2*e,this.vol=Math.min(1,this.vol,this.accelPower),this.speedTarget=Math.min(be.speed,be.metrics.topSpeed+10)/15+2,this.lerpTarget=.95*this.lerpTarget+.05*this.speedTarget,i.setPlaybackRate(4*this.lerpTarget),s.setPlaybackRate(.06+this.lerpTarget/16),this.t1=.6*(1-this.smoothstep(this.vol)),i.setVolume(this.t1*this.interiorVol*$s.engine),s.setVolume(this.t1*n*this.interiorVol*$s.engine)):this.vol>0?(0==this.decel&&(this.lerpTarget-=.05),this.decel=!0,this.vol-=e,this.vol=Math.max(0,this.vol),this.t1=.6*this.vol,i.setVolume(this.t1*this.interiorVol*$s.engine),s.setVolume(this.t1*n*this.interiorVol*$s.engine)):(i.setVolume(0),s.setVolume(0))}updateBoost(){if(this.sounds.boost){if(this.boostV=0,this.vc.hasAccel&&this.vc.hasBoost){let e=1-be.powerLerp;this.boostV=.5+be.powerLerp/2,this.boostT=.9*this.boostT+.1*e,e=1+(1-e)/2,this.sounds.boost.setPlaybackRate(1+5*e)}else this.boostT*=.95;this.sounds.boost.setVolumeStoppable(.75*this.boostV*this.accelPower*this.interiorVol*$s.engine)}}updateBrakes(){be.braking?(this.brakeT=.9*this.brakeT+.1*Math.min(1,Math.max(0,(be.speed-10)/20)),this.sounds.brake.setPlaybackRate(1),this.sounds.brake.setVolumeStoppable(.5*this.brakeT*be.brakeLerp*this.interiorVol*$s.brakes)):this.sounds.brake.setVolumeStoppable(0)}updateTyres(e,t){let i=Math.max(0,Math.min(1,be.speedLerp-.01))*gd*$s.tyres;for(let n of t){if(n.i>=this.sounds.tyres.length)break;var s;if(this.maxAud=Math.max(0,Math.min(1,((Math.abs(n.latDirDot)-.05)*n.speed-2)/4)),be.handbrake&&n.i>1&&(this.maxAud=Math.max(this.maxAud,Math.min(1,(Math.abs(n.lonDirDot*n.speed)-2)/4))),be.braking&&n.speed>40&&(this.maxAud=Math.max(this.maxAud,.5*Math.abs(n.lonDirDot))),this.tl=this.tls[n.i],this.maxAud>0?this.tl=.95*this.tl+.05*this.maxAud:this.tl=.8*this.tl,n.shockPos<.25&&(this.tl*=4*n.shockPos),n.onRoad&&this.paved)Xs.value?(this.sounds.tyresInt[n.i].setVolumeStoppable(this.tl*$s.skidding),this.sounds.tyres[n.i].stop()):(this.sounds.tyresInt[n.i].stop(),this.sounds.tyres[n.i].setVolumeStoppable(this.tl*$s.skidding)),null===(s=this.sounds.offroads[n.i])||void 0===s||s.setVolumeStoppable(0),this.sounds.rolls[n.i].setVolumeStoppable(i),this.sounds.rolls[n.i].setPlaybackRate(.6+.4*be.speedLerp);else this.sounds.tyres[n.i].setVolumeStoppable(0),this.sounds.tyresInt[n.i].setVolumeStoppable(0),this.sounds.rolls[n.i].setVolumeStoppable(0),n.shockPos<.25?this.sounds.offroads[n.i].setVolumeStoppable(Math.max(i*n.shockPos*4,this.tl*$s.skidding)):this.sounds.offroads[n.i].setVolumeStoppable(Math.max(i,this.tl*$s.skidding)),this.sounds.offroads[n.i].setPlaybackRate(.5+be.speedLerp);this.tls[n.i]=this.tl,this.tl=Math.max(Math.min(1,Math.abs(40*n.dShockPos)),0),this.tl*=n.shockPos<.5?0:2*n.shockPos-1,this.sounds.sus[n.i].setVolumeStoppable(.6*this.tl*this.interiorVol*$s.tyres)}}updateCollisions(){this.vc.didCollide&&!this.vc.collisionsDisabled?this.coll?(this.worldSounds.scrape.position.copy(this.vc.collisionPos),be.speed>1?this.worldSounds.scrape.setVolumeStoppable(Math.min(1,2*this.vc.collisionStrength)*$s.collisions):this.worldSounds.scrape.setVolumeStoppable(Math.min(1,2*this.vc.collisionStrength*be.speed)*$s.collisions),this.worldSounds.scrape.isPlaying||this.worldSounds.scrape.play()):(this.coll=!0,this.hitSound=this.worldSounds.hits[this.hitIndex],this.hitSound.isPlaying||(this.hitSound.position.copy(this.vc.collisionPos),this.hitSound.detune=-1200*Math.random()+600,this.hitSound.setVolume(Math.min(1,.6*this.vc.collisionStrength)*$s.collisions),this.hitSound.play()),this.hitIndex=(this.hitIndex+1)%2):this.coll&&(this.coll=!1,this.worldSounds.scrape.setVolumeStoppable(0))}smoothstep(e){return-1*(3-2*e)*e*e+1}};const fd=2*Math.PI,bd=2.5*Math.PI,Ad={straight:.6,casual:.6,easy:.6,normal:.75,hard:.6},yd={straight:.55,casual:.55,easy:.55,normal:.55,hard:.4},Id={};var Sd=class{constructor(e){this.inputs={accel:0,steer:0,brake:0},this.targetNode=null,this.targetFineIndex=0,this.targetPos=new r.W,this.targetSpeed=0,this.targetRoadHeading=0,this.targetDist=10,this.dH=0,this.angleDif=0,this.angleDifAbs=0,this.lookahead=20,this.bendiness=0,this.bendyAngles=[],this.bendyLookahead=4,this.bendyFactor=1,this.bendinessVal=0,this.lateralOffsetFactor=2,this.debugShape=null,this.doNotResetIfOffroad=!1,this.updateIndex=0,this.vehicleIndex=0,this.vehicleAccel=0,this.pVehicleSpeed=0,this.vehicleFrontAxel=new r.W,this.pRoadEdgeProximity=0,this.dRoadEdgeProximity=0,this.pSteer=0,this.lerpIndex=0,this.resetVehicle=e||(()=>{}),this.debugShape=new r.B(new r.S(.5,32,16),new r.C({color:16711935})),this.bendinessShape=new r.B(new r.S(.5,32,16),new r.C({color:65535})),this.targetShape=new r.B(new r.S(.3,32,16),new r.C({color:16776960})),Sh.addListener("topography",(()=>this.onTopographyChanged())),Sh.addListener("sceneName",(()=>this.onTopographyChanged())),this.onTopographyChanged()}onTopographyChanged(){"Planet"==Sh.value.sceneName?this.bendyFactor=yd[Sh.value.topography]:this.bendyFactor=Ad[Sh.value.topography]}initialise(){this.doNotResetIfOffroad=!be.onRoad,this.vehicleIndex=ii.vehicleIndex,this.targetNode=ii.vehicleNode,this.bendyAngles.length=0,this.bendyRoot=ii.vehicleNode.next.next,this.bendyTail=ii.vehicleNode.next.next,this.bendiness=this.targetNode.da,this.bendyAngles.push(this.targetNode.da),this.bendinessMax=0;for(let e=0;e<this.bendyLookahead;e++)this.bendyTail=this.bendyTail.next,this.bendiness+=this.bendyTail.da,this.bendyAngles.push(Math.abs(this.bendyTail.da))}reset(){this.pDeltaSteer=0,this.pSteer=0,this.steerSpeed=0}update(e){for(this.vehicleAccel=(be.speed-this.pVehicleSpeed)/e,this.pVehicleSpeed=be.speed,Id.m=ti(be.frontAxlePosition.x,be.frontAxlePosition.z,ii.vehicleNode,!0),this.roadEdgeProximity=Id.m.d/(Qt-be.wheels.width/2)*Id.m.s,this.roadEdgeProximity<0?this.roadEdgeProximity=Math.max(-1,Math.min(0,2*(this.roadEdgeProximity+.5))):this.roadEdgeProximity=Math.min(1,Math.max(0,2*(this.roadEdgeProximity-.5))),this.roadEdgeProximityAbs=Math.abs(this.roadEdgeProximity),this.dRoadEdgeProximity=this.roadEdgeProximityAbs-this.pRoadEdgeProximity,this.pRoadEdgeProximity=this.roadEdgeProximityAbs,this.bendyMargin=Math.floor(be.speed/10);this.bendyRoot.i<ii.vehicleIndex+this.bendyMargin;)this.bendiness-=this.bendyRoot.da,this.bendyAngles.shift(),this.bendyRoot=this.bendyRoot.next,this.bendyTail=this.bendyTail.next,this.bendiness+=this.bendyTail.da,this.bendyAngles.push(Math.abs(this.bendyTail.da)),this.bendinessShape.position.copy(this.bendyTail.p),this.targetShape.position.copy(this.bendyRoot.p);if(be.onRoad)null!=this.offRoadTime&&(this.offRoadTime=null),this.doNotResetIfOffroad=!1;else if(!this.doNotResetIfOffroad)if(null==this.offRoadTime)this.offRoadTime=Date.now(),this.offRoadMidlineDist=Id.m.d;else if(Date.now()-this.offRoadTime>5e3){if(Id.m.d>this.offRoadMidlineDist-5)return void this.resetVehicle();this.offRoadTime=Date.now()}if(be.speed<1){if(null==this.stuckTime)this.stuckTime=Date.now();else if(Date.now()-this.stuckTime>3e3)return console.log("Autodrive stuck; forcing a reset"),this.stuckTime=null,void this.resetVehicle()}else null!==this.stuckTime&&(this.stuckTime=null);this.updateTarget(),Id.dist=this.targetPos.distanceTo(be.position),Id.steerRadius=Id.dist/2/Math.sin(this.angleDifAbs),this.inputs.steer=Math.atan(be.wheels.length/Id.steerRadius),this.angleDif>0&&(this.inputs.steer*=-1),Id.angleOfArrival=-2*this.angleDif+be.heading,Id.vnHeading=be.heading-(bd-ii.vehicleNode.a)%fd,Id.vnHeading>3?Id.vnHeading-=fd:Id.vnHeading<-3&&(Id.vnHeading+=fd),Id.vnHeading=Math.abs(Id.vnHeading),Id.targetArrivalDif=this.targetRoadHeading-Id.angleOfArrival,Id.targetArrivalDif>3?Id.targetArrivalDif-=fd:Id.targetArrivalDif<-3&&(Id.targetArrivalDif+=fd),Id.targetArrivalDif=Math.abs(Id.targetArrivalDif),Id.beelineAssessment=1.5*Id.targetArrivalDif,Id.beelineAssessment+=4*Math.abs(be.slip),Id.beelineAssessment+=Id.vnHeading,this.beelineFactor=1-Math.max(0,Math.min(1,Math.cos(Id.beelineAssessment))),0!=We.value.autodriveSide&&(this.beelineFactor=.5+.5*this.beelineFactor),this.dRoadEdgeProximity>0&&Math.sign(this.roadEdgeProximity)!=Math.sign(this.inputs.steer)&&(this.beelineFactor+=this.roadEdgeProximityAbs/4,this.beelineFactor=Math.max(0,Math.min(1,this.beelineFactor))),this.beelineSteer=-this.angleDif,this.inputs.steer=this.inputs.steer*(1-this.beelineFactor)+this.beelineSteer*this.beelineFactor,this.roadEdgeProximityAbs>0&&(this.inputs.steer<0&&this.roadEdgeProximity<0&&ii.vehicleNode.rWallDist||this.inputs.steer>0&&this.roadEdgeProximity>0&&ii.vehicleNode.lWallDist)&&(this.inputs.steer/=1+this.roadEdgeProximityAbs*this.roadEdgeProximityAbs*this.roadEdgeProximityAbs),this.inputs.steer=Math.max(Math.min(be.metrics.maxSteer,this.inputs.steer),-be.metrics.maxSteer),this.targetSpeed=this.lookahead,be.speed>this.targetSpeed?(this.targetDecel=(this.targetSpeed*this.targetSpeed-be.speed*be.speed)/(2*Id.dist),this.inputs.accel=0,this.inputs.brake>0?this.brakeThreshold=Math.max(1,1.5-this.bendinessMax*be.metrics.brake/4):this.brakeThreshold=Math.max(1.05,1.5-this.bendinessMax*be.metrics.brake/4),this.brakeFactor=1+3*this.bendinessMax,this.brakeFactor*=1-(5*be.slip+3*Math.abs(this.inputs.steer)),be.speed/this.targetSpeed>this.brakeThreshold?(this.inputs.brake=be.speed/this.targetSpeed-1,this.inputs.brake*=this.brakeFactor,this.inputs.brake=Math.min(1,this.inputs.brake)):this.inputs.brake=0):0==this.inputs.accel&&be.speed>.95*this.targetSpeed?(this.inputs.accel=0,this.inputs.brake=0):(be.speed>.8*this.targetSpeed?this.inputs.accel=be.metrics.accel*(1-Math.max(.1,(be.speed-.8*this.targetSpeed)/(.2*this.targetSpeed))):this.inputs.accel=be.metrics.accel,this.inputs.brake=0),this.updateIndex++,this.updateIndex>=7&&(this.updateIndex=0),be.bike?this.steerLerp=7*e:this.steerLerp=.5,this.inputs.steer=this.pSteer*(1-this.steerLerp)+this.inputs.steer*this.steerLerp,this.pSteer=this.inputs.steer}updateTarget(){if(0==We.value.autodriveSide?(this.lookahead=15+this.bendinessVal*(.8*be.metrics.topSpeed-15),this.maxTargetDist=10+Math.max(0,Math.min(this.lookahead,be.speed)-10)):(this.lookahead=15+this.bendinessVal*(.6*be.metrics.topSpeed-15),this.maxTargetDist=be.wheels.length+2+be.speed/4),this.targetPos.distanceTo(be.position)<this.maxTargetDist&&this.lerpIndex++,(this.targetNode.i<ii.vehicleIndex||this.lerpIndex>=10)&&(this.targetNode=this.targetNode.next,this.lerpIndex=0,this.dH=this.targetNode.p.y-ii.vehicleNode.p.y,this.bendinessVal=Math.abs(this.bendiness/this.bendyLookahead),this.bendinessMax=Math.max(...this.bendyAngles),this.bendinessLerp=Math.min(1,(this.bendinessMax-this.bendinessVal)/.75),this.bendinessVal=this.bendinessVal*(1-this.bendinessLerp)+this.bendinessMax*this.bendinessLerp,this.bendinessVal-=.025,this.bendinessVal=Math.min(1,Math.max(0,this.bendyFactor-this.bendinessVal)/this.bendyFactor),this.bendinessVal*=this.bendinessVal,this.bendinessVal*=this.bendinessVal),this.lerpIndex<10){this.targetPos.copy(this.targetNode.ps[this.lerpIndex]);let e=this.targetNode.a-this.targetNode.next.a;e=e>3?this.targetNode.next.a+fd:e<-3?this.targetNode.next.a-fd:this.targetNode.next.a;let t=1-this.lerpIndex/10;this.targetRoadHeading=this.targetNode.a*t+e*(1-t);let i=this.targetNode.next.n;this.targetPos.x+=i.x*Qt*We.value.autodriveSide/2,this.targetPos.z+=i.z*Qt*We.value.autodriveSide/2}else{this.targetPos.copy(this.targetNode.next.p);let e=this.targetNode.next.n;this.targetPos.x+=e.x*Qt*We.value.autodriveSide/2,this.targetPos.z+=e.z*Qt*We.value.autodriveSide/2,this.targetRoadHeading=this.targetNode.next.a}this.targetRoadHeading=(bd-this.targetRoadHeading)%fd;let e=pl(this.targetPos.x-be.position.x,this.targetPos.z-be.position.z);this.angleDif=be.heading-e,this.angleDif>Math.PI?this.angleDif-=fd:this.angleDif<-Math.PI&&(this.angleDif+=fd),this.angleDifAbs=Math.abs(this.angleDif),this.debugShape.position.copy(this.targetPos)}};const Md=[2.23694,3.59999],Dd=[1/1604,.001],Cd=new r.W(0,1,0),Nd=2*Math.PI,kd=Math.PI/180,zd={default:new r.E({color:8947848}),grey:new r.D({color:6710886}),wheel:new r.D({color:4473924}),white:new r.D({color:15658734}),black:new r.D({color:3355443}),tire:new r.D({color:2236962}),body:new r.F({color:16316664,roughness:.5}),map:new r.F({color:16777215,roughness:.5,map:st(null)}),metal:new r.D({color:16777215}),redlight:new r.F({color:6702148,emissive:16711680,roughness:.5}),rearlight:new r.F({color:6702148,emissive:16711680,roughness:.5,emissiveIntensity:0}),reverselight:new r.F({color:6710852,emissive:16777096}),headlight:new r.F({color:6710886,emissive:16777181}),window:new r.E({color:6712183,specular:2236962}),shadow:new r.C({color:0,colorWrite:!1,depthWrite:!1,side:r.k}),null:new r.D({color:16711935})},jd={turnSpeed:0,turnAccel:0,pTurnSpeed:0};var Ld=class{constructor(){this.inputs={accel:0,steer:0,controllerSteer:0,brake:0,handbrake:0,stiffSteer:0},this.sounds={},this.inputDisabled=!1,this.orientation=new r.m(0,0,0,"YXZ"),this.steerOrientation=new r.m(0,0,0,"YXZ"),this.vehicleDef=null,this.selectedVehicleIndex=0,this.driveModeIndex=0,this.driveForceFactor=1,this.insideWall=!0,this.wasInsideWall=!0,this.tiltX=0,this.tiltZ=0,this.body=null,this.wheels=new r.G,this.dashboard=null,this.wheelEulers=[],this.tV=new r.W,this.tVec=new r.W,this.wheelHeights=[],this.groundHeights=[],this.wheelFwd=new r.W(0,0,1),this.wheelVelDir=new r.W,this.wheelVelMag=0,this.targetHeading=0,this.pOrientation=0,this.motionDir=new r.W,this.pPos=new r.W,this.analytics={resetCount:0,rawDS:0},this.promptResetTimer=null,this.update=()=>{},this.dom={},this.hasInit=!1,this.canCancelAutodrive=!1,this.canEnableAutodrive=!0,this.hasCruiseTarget=!1,this.hasSpeedLimit=!1,this.onSpeedControlChangedBound=this.onSpeedControlChanged.bind(this),this.changeVehicleBound=this.changeVehicle.bind(this),this.changeModeBound=this.changeMode.bind(this),this.changeSideBound=this.changeSide.bind(this),this.changeGripBound=this.changeGrip.bind(this),this.changeShowWheelBound=this.changeShowWheel.bind(this),this.wasUsingCruise=!1,this.headlights={left:{},right:{}},this.pdT=.1,this.holdHandbrake=!1,this.uiTimer=0,this.speedFactor=1,this.distFactor=1,this.onUnitsChangedBound=this.onUnitsChanged.bind(this),this.onControllerChangedBound=this.onControllerChanged.bind(this),this.groundAngleLat=0,this.groundAngleLon=0,this.wheelDown=new r.W,this.didCollide=!1,this.collisionSide=0,this.collisionPos=new r.W,this.printDebug=!1,this.v1=new r.W,this.v2=new r.W,this.v3=new r.W,this.v4=new r.W,this.v5=new r.W,this.didCrash=!1,this.curWallIndex=null,this.collisionStrength=0,this.wrongWay=!1,this.nodeCheckFrame=60,this.targetVehicleNodeIndex=0,this.nextUpdateDistance=25,this.nextUpdateIncrement=25,this.maxUpdateIncrement=250,this.nextAnalyticsUpdate={},this.steerSpeed=0,this.steerMode=1,this.lastAccel=0,this.hasBoost=!1,this.hasAccel=!1,this.boostFromTap=!1,this.useMouse=!0,this.maxSteerSpeed=4,this.prevSteer=0,this.scrollSteer=!1,this.scrollAccel=!1,this.mouse={x:0,y:0},this.prevMouse={x:0,y:0},this.mouseDist=0,this.mouseCruiseSpeed=wl.default.speed,this.autodrive=de.value,this.limitBrake=!1,this.softStiff=!1,this.softTurnInterval=.75,this.softInterval=1,this.softTimer=0,this.softLerp=0,this.softTurning=!1,this.softTurningDir=0,this.softStartPoint=0,this.softSteerFactor=1,this.softSteerTimeFactor=1,this.softMaxSteer=1,this.softSlip=1,this.softSlipB=1,this.stickyTurning=!1,this.stickyTimer=0,this.initialise()}initialise(){this.autoDriver=new Sd((()=>{this.resetToNode(ii.vehicleNode)})),wl.addListener("enabled",this.onSpeedControlChangedBound),wl.addListener("control",this.onSpeedControlChangedBound),this.onSpeedControlChanged(),this.dom.speed=document.getElementById("ui-speed-val"),this.dom.dist=document.getElementById("ui-dist-val"),this.initialisePosition(),this.audio=new wd(this),We.addListener("type",this.changeVehicleBound),We.addListener("mode",this.changeModeBound),We.addListener("side",this.changeSideBound),We.addListener("gripFactor",this.changeGripBound),We.addListener("slipFactor",this.changeGripBound),We.addListener("showWheel",this.changeShowWheelBound),te.addListener("Units",this.onUnitsChangedBound),this.onUnitsChanged(te.Units),D.addListener(this.onControllerChangedBound),this.onControllerChanged(D.value,!0),this.initVehicle(ke[We.value.type]),this.changeGrip(),this.dom.mouseMarker=document.getElementById("ui-mouse-bar-marker"),this.dom.mousePrompt=document.getElementById("ui-mouse-prompt"),be.addListener(we,this.onHeadlightsChanged.bind(this)),this.onHeadlightsChanged(),Pl.dist=10*(ii.vehicleNode.i-ii.initIndex+Sh.accumulatedProgress),Sh.addListener("weatherIndex",(()=>this.updateHeadlights())),de.addListener((()=>{this.onAutodrive()})),this.onAutodrive(),this.headlights=be.headlights,this.hasInit=!0}onSpeedControlChanged(){this.hasCruiseTarget=wl.value.enabled&&wl.value.control==xl,this.hasSpeedLimit=wl.value.enabled&&wl.value.control==vl}onAutodrive(){this.autodrive=de.value,be.handbrake=!1,this.holdHandbrake=!1,this.autodrive&&(this.canCancelAutodrive=!1,this.autoDriver.initialise())}initialisePosition(){ii.initIndex=ii.vehicleNode.i-Sh.initialNode;let e=ii.vehicleNode.a-ii.vehicleNode.next.da/2;this.setPose(ii.vehicleNode.p.x,ii.vehicleNode.p.y,ii.vehicleNode.p.z,Math.PI/2-e,!0),this.autoDriver.initialise()}detatch(){We.removeListener("type",this.changeVehicleBound),We.removeListener("mode",this.changeVehicleBound),We.removeListener("side",this.changeSideBound),te.removeListener("Units",this.onUnitsChangedBound),be.removeListener(we,this.onHeadlightsChanged.bind(this))}setDriveMode(e){if(this.driveModeFactor=.5,this.wheels.children[0].hasDrive=!0,this.wheels.children[1].hasDrive=!0,this.driveMode=e,be.bike)switch(e){case Le:this.driveModeFactor=1,this.wheels.children[0].hasDrive=!0,this.wheels.children[1].hasDrive=!1;break;case Oe:this.driveModeFactor=1,this.wheels.children[0].hasDrive=!1,this.wheels.children[1].hasDrive=!0}else switch(this.wheels.children[2].hasDrive=!0,this.wheels.children[3].hasDrive=!0,e){case Le:this.driveModeFactor=1,this.wheels.children[2].hasDrive=!1,this.wheels.children[3].hasDrive=!1;break;case Oe:this.driveModeFactor=1,this.wheels.children[0].hasDrive=!1,this.wheels.children[1].hasDrive=!1}}setDriveSide(e){be.steeringWheel&&(1==e?(be.steeringWheel.position.x=be.metrics.steeringPos.x,be.dashboard.position.x=be.metrics.steeringPos.x):(be.steeringWheel.position.x=-be.metrics.steeringPos.x,be.dashboard.position.x=-be.metrics.steeringPos.x))}onHeadlightsChanged(){this.setLights(be.headlights)}changeVehicle(e){this.initVehicle(ke[e]),this.changeGrip()}changeMode(e){this.setDriveMode(e)}changeSide(e){this.setDriveSide(e)}changeGrip(){jd.slipBase=be.metrics.slipBase*We.gripFactor,jd.slipMod=be.metrics.slipMod*We.gripFactor}changeShowWheel(e){be.steeringWheel&&(be.steeringWheel.visible=e)}setLights(e){e?(zd.rearlight.emissiveIntensity=.5,zd.headlight.emissiveIntensity=.5):(zd.rearlight.emissiveIntensity=0,zd.headlight.emissiveIntensity=0)}updateHeadlights(){let e=3.25-2.5*(yt.intensity+At.intensity),t=Math.max(.25,e);be.setHeadlightIntensity(t)}setBrake(e,t=0){e?(be.braking||(be.brakeLerp=0),be.braking=!0,zd.redlight.emissiveIntensity=.5):(be.braking=!1,zd.redlight.emissiveIntensity=0),this.inputs.brake=t}positionHeadlights(){}initVehicle(e){var t;if((null===(t=this.vehicleDef)||void 0===t?void 0:t.name)==e.name)return;for(this.update=this.updatePass;be.geo.children.length;)be.geo.remove(be.geo.children[be.geo.children.length-1]);this.vehicleDef=e,this.softSteerTimeFactor=1,be.setModel(e),e.map&&(zd.map.map=st(e.map));let i=e.bodyObj,s=e.wheelObj,n=e.steerObj,a=e.dashObj;const o=new sn.a;let r=zd;if(e.skins){let t=Object.keys(e.skins)[0];for(let i in e.skins[t])r[i].color.setHex(e.skins[t][i])}if(o.load(i.default,(e=>{e.traverse((e=>{if(e.isMesh){let t=zd.default,i=e.name.split("_")[1];i in zd&&(t=zd[i]),"dash"==i&&(this.dashboard=e),e.material=t,"shadow"==i&&(e.castShadow=!0)}})),this.positionHeadlights(),this.updateHeadlights(),e.rotation.y=-Math.PI/2,be.geo.add(e)})),o.load(s.default,(t=>{t.traverse((e=>{if(e.isMesh){let t=zd.wheel,i=e.name.split("_")[1];i in zd&&(t=zd[i]),e.material=t,"shadow"==i&&(e.castShadow=!0),e.position.z-=be.wheels.tyreWidth}})),this.initWheels(t,be.bike),this.setDriveMode(We.value.mode),this.audio.initForVehicle(e,this.inputs,this.wheels.children),this.resetToNode(ii.vehicleNode),this.update=this.updateStationed,Tl.pause()})),n)o.load(n.default,(e=>{e.traverse((e=>{if(e.isMesh){let t=zd.default,i=e.name.split("_")[1];i in zd&&(t=zd[i]),e.material=t}})),e.rotation.order="YZX",e.rotation.y=-Math.PI/2,e.rotation.z=-be.metrics.steeringAngle,e.position.copy(be.metrics.steeringPos),0==We.value.side&&(e.position.x*=-1),be.steeringWheel=e,be.steeringWheel.visible=We.value.showWheel,be.geo.add(e)}));else if(be.steeringWheel){var h;null===(h=be.steeringWheel.geometry)||void 0===h||h.dispose(),be.steeringWheel=null}if(a)o.load(a.default,(e=>{e.traverse((e=>{if(e.isMesh){let t=zd.default,i=e.name.split("_")[1];i in zd&&(t=zd[i]),e.material=t}})),e.rotation.y=-Math.PI/2,e.position.copy(be.metrics.steeringPos),0==We.value.side&&(e.position.x*=-1),be.dashboard=e,be.geo.add(e)}));else if(be.dashboard){var l;null===(l=be.dashboard.geometry)||void 0===l||l.dispose(),be.dashboard=null}}initLights(){be.setHeadlightColour(be.headlightColour)}setPose(e,t,i,s,n=!1){for(var a;s<0;)s+=2*Math.PI;let o=0;if(n&&(null===(a=be.wheels)||void 0===a?void 0:a.length)){let n=new r.W(e+Math.sin(s)*be.wheels.length,t,i+Math.cos(s)*be.wheels.length),a=sl.getHeight(n);o=-Math.tan((a-t)/be.wheels.length),t+=be.wheels.travel/2}be.position.set(e,t,i),this.orientation.x=o,this.orientation.z=0,this.orientation.y=s,be.heading=this.orientation.y,be.motionHeading=be.heading,be.setRotationFromEuler(this.orientation),be.updateMatrix(),be.updateMatrixWorld(),this.updateVehicleNode(),ii.vehicleIndexDidChange=!0}initWheels(e,t=!1){let i,s=this.vehicleDef.wheels;for(;this.wheels.children.length;)this.wheels.remove(this.wheels.children[this.wheels.children.length-1]);this.wheelEulers.length=0,i=e.clone(),this.prepWheelState(i,s),i.i=0,i.name="fl",i.front=!0,i.relPos=new r.W(t?0:s.width/2,s.radius,s.length),i.hasDrive=!0,i.position.copy(i.relPos),i.rotation.y=Math.PI/2,this.wheelEulers.push(new r.m(0,Math.PI/2,0,"YXZ")),this.wheels.add(i),this.updateWheelWorldPos(i),i.pPos.copy(i.worldPos),i=e.clone(),this.prepWheelState(i,s),i.i=1,i.front=!t,i.name="fr",i.relPos=new r.W(t?0:-s.width/2,s.radius,t?0:s.length),i.hasDrive=!0,i.position.copy(i.relPos),i.rotation.y=-Math.PI/2,this.wheelEulers.push(new r.m(0,-Math.PI/2,0,"YXZ")),this.wheels.add(i),this.updateWheelWorldPos(i),i.pPos.copy(i.worldPos),t||(i=e.clone(),this.prepWheelState(i,s),i.i=2,i.front=!1,i.name="rl",i.relPos=new r.W(s.width/2,s.radius,0),i.hasDrive=!1,i.position.copy(i.relPos),i.rotation.y=Math.PI/2,this.wheels.add(i),this.updateWheelWorldPos(i),i.pPos.copy(i.worldPos),i=e.clone(),this.prepWheelState(i,s),i.i=3,i.front=!1,i.name="rr",i.relPos=new r.W(-s.width/2,s.radius,0),i.hasDrive=!1,i.position.copy(i.relPos),i.rotation.y=-Math.PI/2,this.wheels.add(i),this.updateWheelWorldPos(i),i.pPos.copy(i.worldPos)),be.geo.add(this.wheels)}prepWheelState(e,t){e.shockPos=.5,e.dShockPos=0,e.shockFactor=.5,e.shockExcess=0,e.groundHeight=0,e.pHeight=0,e.worldPos=new r.W,e.tPos=new r.W,e.tVel=new r.W,e.pVel=new r.W,e.pPos=new r.W,e.height=0,e.pSus=0,e.vel=new r.W,e.velDir=new r.W,e.acc=new r.W,e.groundCollide=0,e.groundNorm=new r.W,e.groundState={n:[0,1,0]},e.speed=0,e.lonDirDot=0,e.latDirDot=0,e.friction=1,e.wd=0,e.collisionFactor=0,e.radius=t.radius,e.travel=t.travel}updateWheelWorldPos(e){e.worldPos.copy(e.relPos),e.worldPos.applyMatrix4(be.matrixWorld)}destroy(){}suspend(){this.audio.suspend(),this.update=this.updateStationed,Tl.pause()}reload(){this.initialisePosition(),this.resetToNode(ii.vehicleNode)}updateStationed(e){if(ii.vehicleIndexDidChange=!1,be.pPosition.copy(be.position),Y.signal.Handbrake=1,this.handleInput(e),be.handbrake=!0,this.useMouse&&Y.controllerSignal.Forward>0||Y.signal.Backward+Y.signal.Forward>0||!this.useMouse&&this.hasCruiseTarget||this.autodrive)return be.handbrake=!1,this.holdHandbrake=!this.hasCruiseTarget,this.update=this.updateLive,Tl.resume(),void(this.dom.mousePrompt.style.display="none");this.inputs.accel=0,this.updateWheelMotion(e),this.updateChassisMotion(e),this.updateWheelState(e),this.audio.update(e),this.pdT=e}updatePass(e,t){}updateLive(e,t){be.pPosition.copy(be.position),this.handleInput(e),this.updateWheelMotion(e),this.updateChassisMotion(e),this.updateWheelState(e),this.didCollide&&!this.collisionsDisabled&&(this.updateChassisMotion(e),this.updateWheelState(e),this.didCollide=!0),this.updateVehicleState(e),this.uiTimer+=e,this.uiTimer>.033&&(this.uiTimer-=.033,this.updateUI()),this.pdT=e,ii.vehicleIndexDidChange=!1,this.updateVehicleNode();try{this.audio.update(e)}catch(eu){if(this.handleCrash(),this.didCrash)throw eu.cause="vehicle_matrix",eu.data=this.wheels.children[0],eu}}updateVehicleState(e){var t,i,s,n;for(jd.w of(this.dS=(t=be.pPosition.x,i=be.pPosition.z,s=be.position.x,n=be.position.z,Math.sqrt((s-t)*(s-t)+(n-i)*(n-i))),this.analytics.rawDS+=this.dS,be.vel.subVectors(be.pPosition,be.position).multiplyScalar(1/e),be.speed=this.dS/e,be.speedLerp=Math.min(1,be.speed/be.metrics.topSpeed),be.powerLerp=Math.min(1,be.speed/(be.metrics.topSpeed*We.speedFactor)),Pl.speed=be.speed,be.accel.set(0,0,0),this.wheels.children))be.accel.add(jd.w.acc.multiplyScalar(1/e));if(be.accel.multiplyScalar(.25),be.accel.applyAxisAngle(Cd,-this.orientation.y),be.pVel.copy(be.vel),!isFinite(be.speed)){let e={wheelHeights:this.wheelHeights,tiltX:this.tiltX,tiltZ:this.tiltZ,dS:this.dS,speed:be.speed,pos:be.position,pPos:be.pPosition,nodeIndex:ii.vehicleIndex,onRoad:be.onRoad};throw new Error(JSON.stringify(e))}}onUnitsChanged(e){this.speedFactor=Md[e],this.distFactor=Dd[e]}onControllerChanged(e,t=!1){this.controller=M[e],this.useMouse=1==e,this.useMouse?this.hasCruiseTarget||t?t||(this.wasUsingCruise=!0):(wl.reset(),this.resetToNode(ii.vehicleNode)):this.wasUsingCruise||t?this.wasUsingCruise=!1:wl.set("enabled",!1),t||de.set(!1)}updateUI(){this.dom.speed.innerHTML=(Pl.speed*this.speedFactor).toFixed(1),this.dom.dist.innerHTML=(Math.floor(Pl.dist*this.distFactor*10)/10).toFixed(1)}updateBasic(e){be.speed+=this.inputs.accel*e,be.steer+=this.inputs.steer*e,be.steer=Math.max(Math.min(be.metrics.maxSteer,be.steer),-be.metrics.maxSteer),be.position.x+=Math.cos(be.rotation.y)*be.speed*e,be.position.z-=Math.sin(be.rotation.y)*be.speed*e,be.rotation.y+=be.steer*e}updateWheelMotion(e){let t;for(t of(this.printDebug=!this.printDebug,this.wheelDown.set(0,-be.wheels.radius,0).applyEuler(this.orientation),be.rockLonTarget=be.accel.z+this.sinTiltX*ul.value,be.rockLonTarget>0?be.rockLonTarget/=Math.max(be.rockLonTarget,14):be.rockLonTarget/=-1*Math.min(be.rockLonTarget,-14),be.rockLonTarget*=be.metrics.rockFactor,jd.l=Math.min(1,15*e),be.rockLon=be.rockLon*(1-jd.l)+be.rockLonTarget*jd.l,this.vehicleDef.bike||(be.rockLatTarget=be.accel.x-this.sinTiltZ*ul.value,be.rockLatTarget>0?be.rockLatTarget/=Math.max(be.rockLatTarget,20):be.rockLatTarget/=-1*Math.min(be.rockLatTarget,-20),be.rockLatTarget*=be.metrics.rockFactor,be.rockLat=be.rockLat*(1-jd.l)+be.rockLatTarget*jd.l),this.wheels.children))t.front&&(this.steerOrientation.copy(this.orientation),be.bike?this.steerOrientation.y+=be.steer:0==t.i?this.steerOrientation.y+=be.steerL:this.steerOrientation.y+=be.steerR),t.vel.subVectors(t.worldPos,t.pPos),t.tVel.subVectors(t.tPos,t.pPos),jd.steepness=0,t.shockPos>0&&t.dH>0&&(jd.steepness=t.dH/t.vel.length()),t.dXZ=Math.sqrt(t.vel.x*t.vel.x+t.vel.z*t.vel.z),t.dH=t.groundHeight-t.pHeight,t.collisionFactor=0,t.pdH=(t.vel.y-t.tVel.y)/t.dXZ,!t.onRoad&&t.dH>0&&t.pdH>0&&t.pdH<1&&(jd.m=1-2*t.pdH,jd.m<1&&(t.vel.x*=jd.m,t.vel.z*=jd.m)),t.velDir.copy(t.vel).normalize(),0==t.shockPos?t.dS=.98*t.dS:t.dS=t.vel.length(),t.vel.divideScalar(this.pdT),t.speed=t.vel.length(),t.pPos.copy(t.worldPos),t.front?(this.tV.set(0,0,1).applyEuler(this.steerOrientation),t.lonDirDot=t.velDir.dot(this.tV),t.direction=t.lonDirDot<0?-1:1,this.tV.set(1,0,0).applyEuler(this.steerOrientation),t.latDirDot=t.velDir.dot(this.tV)):(this.tV.set(0,0,1).applyEuler(this.orientation),t.lonDirDot=t.velDir.dot(this.tV),t.direction=t.lonDirDot<0?-1:1,this.tV.set(1,0,0).applyEuler(this.orientation),t.latDirDot=t.velDir.dot(this.tV)),t.dXZ>.001?t.groundAngle=-Math.atan(t.dH/t.dXZ)||0:t.groundAngle=this.tiltX*t.lonDirDot+this.tiltZ*t.latDirDot,t.acc.set(0,0,0),be.braking?(be.brakeLerp+=e/.25,be.brakeLerp>1&&(be.brakeLerp=1),be.brakeForce=be.brakeLerp*be.metrics.brake*this.inputs.brake,this.autodrive&&(be.brakeForce=this.autoDriver.inputs.brake*be.metrics.brake),jd.maxDecel=t.speed*t.lonDirDot/e*-1,jd.maxDecel<0?t.acc.z=Math.max(jd.maxDecel,-be.brakeForce):t.acc.z=Math.min(jd.maxDecel,be.brakeForce),t.speed<.1&&(be.braking=!1)):t.hasDrive&&(t.acc.z=be.drive*this.driveModeFactor,be.bike?t.front?t.acc.z*=be.frSteerDifferential:t.acc.z/=be.frSteerDifferential:0==t.i?t.acc.z*=be.steerDifferential:1==t.i?t.acc.z/=be.steerDifferential:2==t.i?t.acc.z*=be.rearSteerDifferential:t.acc.z/=be.rearSteerDifferential),t.friction<1&&(t.acc.z*=t.friction),be.bike&&(t.friction*=2),!t.front&&be.handbrake&&(t.acc.z=0),jd.wheelWeight=2*t.shockFactor,jd.frictionMultiplier=this.hasBoost&&!this.autodrive?Math.max(.75,Math.abs(t.lonDirDot)):1,jd.latNorm=jd.wheelWeight*Math.cos(t.groundAngle*Math.abs(t.latDirDot))*-ul.value*t.friction*jd.frictionMultiplier,this.useMouse||this.autodrive?be.bike||this.autodrive?jd.maxLat=t.speed*t.latDirDot/e*-1-ul.value*this.sinTiltZ:jd.maxLat=t.speed*t.latDirDot/e*-.5-ul.value*this.sinTiltZ:(jd.maxLat=t.speed/e*-t.latDirDot,t.hasDrive&&this.hasBoost?(We.mode==je&&(jd.maxLat*=jd.slipBase-1.25*jd.slipMod*(be.speedLerp*be.speedLerp)),(We.mode==Le||We.mode==Oe)&&(jd.maxLat*=jd.slipBase-jd.slipMod*(be.speedLerp*be.speedLerp))):t.speed>1&&(jd.maxLat*=jd.slipBase-jd.slipMod*(be.speedLerp*be.speedLerp)),jd.maxLat-=ul.value*this.sinTiltZ),t.slip=0,jd.maxLat<0?jd.maxLat<-jd.latNorm?(t.spin=t.acc.z>0&&t.latDirDot>.3,t.slip=t.latDirDot,t.acc.x+=-jd.latNorm):(t.spin=!1,t.acc.x+=jd.maxLat):jd.maxLat>jd.latNorm?(t.spin=t.acc.z>0&&t.latDirDot<-.3,t.slip=-t.latDirDot,t.acc.x+=jd.latNorm):(t.spin=!1,t.acc.x+=jd.maxLat),!t.front&&be.handbrake&&(jd.lonNorm=jd.wheelWeight*Math.cos(t.groundAngle*t.lonDirDot)*-ul.value*t.friction*jd.frictionMultiplier,jd.maxLon=t.speed*t.lonDirDot/e*-1+ul.value*this.sinTiltX*2,t.acc.z+=Math.max(Math.min(jd.maxLon,jd.lonNorm),-jd.lonNorm)),(t.onRoad||1==t.groundNorm.y)&&(t.acc.x+=jd.wheelWeight*ul.value*this.sinTiltZ,t.acc.z-=jd.wheelWeight*ul.value*this.sinTiltX),jd.rawSpeed=t.speed*t.lonDirDot,!(t.i>1&&be.handbrake)&&Math.abs(jd.rawSpeed)>0&&(jd.rollResistance=jd.rawSpeed*be.metrics.rollResistance,jd.rawSpeed<0?jd.rollResistance+=Math.max(-.1,jd.rawSpeed/e):jd.rollResistance+=Math.min(.1,jd.rawSpeed/e),t.acc.z-=jd.rollResistance),t.acc.y+=be.downforce*ul.value,t.acc.z*=Math.min(1,3*t.shockFactor),t.front?t.acc.applyEuler(this.steerOrientation):t.acc.applyEuler(this.orientation),t.acc.y+=ul.value,t.onRoad||1==t.groundNorm.y||(t.acc.x-=jd.wheelWeight*ul.value*t.groundNorm.x*1.5,t.acc.z-=jd.wheelWeight*ul.value*t.groundNorm.z*1.5),t.shockPos>0&&(t.front?t.acc.y+=be.rockLon:t.acc.y-=be.rockLon,be.bike||(t.i%2==0?t.acc.y+=be.rockLat:t.acc.y-=be.rockLat)),t.acc.y-=jd.wheelWeight*ul.value,t.dSus=(t.pSus-t.acc.y)/e,t.pSus=t.acc.y,t.dSus<0?t.dSus*=be.metrics.dampening:be.bike?t.dSus*=.5*be.metrics.dampening:t.dSus*=1.5*be.metrics.dampening,t.acc.y-=t.dSus,t.vel.add(t.acc.multiplyScalar(e)),t.tPos.addVectors(t.worldPos,t.vel.multiplyScalar(e)),t.pVel.copy(t.vel),this.wheelHeights[t.i]=t.tPos.y,this.groundHeights[t.i]=t.groundHeight,t.shockPos>0&&(t.hasDrive&&t.spin?t.dS*=1+be.slip:t.dS*=Math.abs(t.lonDirDot))}updateChassisMotion(e){if(jd.wheelWidth=this.vehicleDef.wheels.width,jd.wheelLength=this.vehicleDef.wheels.length,jd.axleFPos=this.v1,jd.axleFDir=this.v2,jd.axleRPos=this.v3,jd.axleRDir=this.v4,jd.chassisDir=this.v5,be.bike)jd.axleFPos.copy(this.wheels.children[0].tPos),jd.axleRPos.copy(this.wheels.children[1].tPos),jd.shockF=this.wheels.children[0].collisionFactor+this.wheels.children[0].shockPos,jd.shockR=this.wheels.children[1].collisionFactor+this.wheels.children[1].shockPos,jd.shockSum=jd.shockF+jd.shockR,jd.shockRatio=0==jd.shockSum?.5:jd.shockR/jd.shockSum;else{if(jd.wL=this.wheels.children[0],jd.wR=this.wheels.children[1],jd.d=jd.wL.tPos.distanceTo(jd.wR.tPos),jd.wL.collisionFactor+=jd.wL.shockPos+.25,jd.wR.collisionFactor+=jd.wR.shockPos+.25,jd.shockSum=jd.wL.collisionFactor+jd.wR.collisionFactor,jd.shockRatio=0==jd.shockSum?.5:jd.wL.collisionFactor/jd.shockSum,jd.discrepency=jd.d-jd.wheelWidth,jd.leftOffset=jd.discrepency*(1-jd.shockRatio),jd.axleFDir.subVectors(jd.wR.tPos,jd.wL.tPos).normalize(),jd.axleFPos.copy(jd.axleFDir),jd.axleFPos.multiplyScalar(jd.wheelWidth/2+jd.leftOffset),jd.axleFPos.add(jd.wL.tPos),jd.wL=this.wheels.children[2],jd.wR=this.wheels.children[3],void 0===jd.wL)throw new Error("Missing third wheel, count is "+this.wheels.children.length);jd.d=jd.wL.tPos.distanceTo(jd.wR.tPos),jd.wL.collisionFactor+=jd.wL.shockPos+.25,jd.wR.collisionFactor+=jd.wR.shockPos+.25,jd.shockSum=jd.wL.collisionFactor+jd.wR.collisionFactor,jd.shockRatio=0==jd.shockSum?.5:jd.wL.collisionFactor/jd.shockSum,jd.discrepency=jd.d-jd.wheelWidth,jd.leftOffset=jd.discrepency*(1-jd.shockRatio),jd.axleRDir.subVectors(jd.wR.tPos,jd.wL.tPos).normalize(),jd.axleRPos.copy(jd.axleRDir),jd.axleRPos.multiplyScalar(jd.wheelWidth/2+jd.leftOffset),jd.axleRPos.add(jd.wL.tPos),jd.shockF=this.wheels.children[0].collisionFactor+this.wheels.children[1].collisionFactor,jd.shockR=this.wheels.children[2].collisionFactor+this.wheels.children[3].collisionFactor,jd.shockSum=jd.shockF+jd.shockR,jd.shockRatio=0==jd.shockSum?.5:jd.shockR/jd.shockSum}jd.d=jd.axleFPos.distanceTo(jd.axleRPos),jd.discrepency=jd.d-jd.wheelLength,jd.leftOffset=jd.discrepency*(1-jd.shockRatio),jd.chassisDir.subVectors(jd.axleFPos,jd.axleRPos).normalize(),be.position.copy(jd.chassisDir),be.position.multiplyScalar(jd.leftOffset),be.position.add(jd.axleRPos),be.frontAxlePosition.copy(jd.axleFPos),this.pOrientation=be.heading,this.orientation.y=pl(jd.chassisDir.x,jd.chassisDir.z),jd.deltaHeading=this.orientation.y-be.heading,jd.deltaHeading>3?be.heading+=Nd:jd.deltaHeading<-3&&(be.heading-=Nd),jd.deltaHeading=this.orientation.y-be.heading,be.speedLerp=Math.min(1,be.speed/be.metrics.topSpeed),be.powerLerp=Math.min(1,be.speed/(be.metrics.topSpeed*We.speedFactor)),jd.turnSpeed=(this.orientation.y-be.heading)/e,jd.turnAccel=(jd.turnSpeed-jd.pTurnSpeed)/e,jd.maxTurnAccel=5-2*be.speedLerp,this.didCollide||(jd.turnAccel<-jd.maxTurnAccel?jd.turnSpeed=jd.pTurnSpeed-jd.maxTurnAccel*e:jd.turnAccel>jd.maxTurnAccel&&(jd.turnSpeed=jd.pTurnSpeed+jd.maxTurnAccel*e)),this.orientation.y=be.heading+jd.turnSpeed*e,jd.pTurnSpeed=jd.turnSpeed,this.orientation.y>Nd?this.orientation.y-=Nd:this.orientation.y<-Nd&&(this.orientation.y+=Nd),be.heading=this.orientation.y,be.fwd.set(Math.sin(be.heading),-be.pitch,Math.cos(be.heading)).normalize(),be.position.y>0?this.tVec.subVectors(be.pPosition,be.position).normalize().multiplyScalar(be.metrics.drag*be.speed*be.speed*e*e):this.tVec.subVectors(be.pPosition,be.position).normalize().multiplyScalar(.25*be.speed*be.speed*e*e),be.position.add(this.tVec),be.bike?(jd.d1=this.wheels.children[0].tPos.distanceTo(this.wheels.children[1].tPos),jd.r1=Math.asin((this.wheelHeights[0]-this.wheelHeights[1])/jd.d1),this.tiltX=-jd.r1||0,this.tiltX=Math.max(Math.min(1.2,this.tiltX),-1.2),this.sinTiltX=Math.sin(this.tiltX),be.pitch=this.tiltX,this.orientation.x=this.tiltX,jd.r1=Math.asin((this.groundHeights[0]-this.groundHeights[1])/jd.d1),this.gradientX=-jd.r1||0,jd.vs=be.steer/(be.metrics.maxSteer*this.softSteerFactor)*be.speedLerp,this.tiltZ=1.3*-jd.vs,be.slip=this.wheels.children[1].slip):(jd.d1=this.wheels.children[0].tPos.distanceTo(this.wheels.children[2].tPos),jd.d2=this.wheels.children[1].tPos.distanceTo(this.wheels.children[3].tPos),jd.r1=Math.asin((this.wheelHeights[0]-this.wheelHeights[2])/jd.d1),jd.r2=Math.asin((this.wheelHeights[1]-this.wheelHeights[3])/jd.d2),jd.tiltX=-(jd.r1+jd.r2)/2||this.tiltX,jd.tiltLerp=3*(1+be.speedLerp),Math.abs(jd.tiltX-this.tiltX)/e<jd.tiltLerp?this.tiltX=jd.tiltX:jd.tiltX<this.tiltX?this.tiltX-=jd.tiltLerp*e:this.tiltX+=jd.tiltLerp*e,this.tiltX=Math.max(Math.min(1.3,this.tiltX),-1.3),this.sinTiltX=Math.sin(this.tiltX),be.pitch=this.tiltX,this.orientation.x=this.tiltX,jd.r1=Math.asin((this.groundHeights[0]-this.groundHeights[2])/jd.d1),jd.r2=Math.asin((this.groundHeights[1]-this.groundHeights[3])/jd.d2),this.gradientX=-(jd.r1+jd.r2)/2||0,jd.d2=jd.wheelWidth*Math.cos(this.tiltX),jd.d1=this.wheelHeights[1]-this.wheelHeights[0],jd.r1=Math.asin(jd.d1/jd.d2),jd.d1=this.wheelHeights[3]-this.wheelHeights[2],jd.r2=Math.asin(jd.d1/jd.d2),jd.shockF=this.wheels.children[0].shockPos+this.wheels.children[1].shockPos,jd.shockR=this.wheels.children[2].shockPos+this.wheels.children[3].shockPos,jd.shockSum=jd.shockF+jd.shockR,jd.shockRatio=0==jd.shockSum?.5:jd.shockF/jd.shockSum,jd.tiltZ=-(jd.r1*jd.shockRatio+jd.r2*(1-jd.shockRatio))||this.tiltZ,Math.abs(jd.tiltZ-this.tiltZ)/e<jd.tiltLerp?this.tiltZ=jd.tiltZ:jd.tiltZ<this.tiltZ?this.tiltZ-=jd.tiltLerp*e:this.tiltZ+=jd.tiltLerp*e,be.slip=(this.wheels.children[0].slip+this.wheels.children[1].slip+this.wheels.children[2].slip+this.wheels.children[3].slip)/4),be.gradient=this.gradientX,this.tiltZ=Math.max(Math.min(1.3,this.tiltZ),-1.3),this.orientation.z=this.tiltZ,be.roll=this.tiltZ,this.sinTiltZ=Math.sin(this.tiltZ),this.tVec.set(0,-be.wheels.radius,0).applyEuler(this.orientation),be.position.add(this.tVec),this.motionDir.copy(be.position).sub(this.pPos).normalize(),!this.didCollide&&be.direction>0?(jd.trueHeading=pl(this.motionDir.x,this.motionDir.z),jd.trueHeading-be.motionHeading>3?be.motionHeading+=Nd:jd.trueHeading-be.motionHeading<-3&&(be.motionHeading-=Nd),be.motionHeading=0*be.motionHeading+1*pl(this.motionDir.x,this.motionDir.z),be.speed<5&&(be.motionHeading=be.motionHeading*(be.speed/5)+be.heading*(1-be.speed/5))):be.motionHeading=be.heading,this.pPos.copy(be.position),be.setRotationFromEuler(this.orientation);try{be.updateMatrix(),be.updateMatrixWorld(),this.didCrash=!1}catch(eu){if(this.handleCrash(),this.didCrash)throw eu.cause="vehicle_matrix",eu;this.didCrash=!0}}handleCrash(){this.resetToNode(ii.vehicleNode)}updateWheelState(e){let t;for(t of(jd.wheelCirc=this.vehicleDef.wheels.circumference,be.downforce=be.speedLerp,be.downforce*=be.downforce*be.metrics.aeroFactor,be.bike?(jd.r=0,jd.r=this.wheels.children[0].dS/jd.wheelCirc*6.28*this.wheels.children[0].direction,this.wheelEulers[0].z+=jd.r,this.wheelEulers[0].y=be.steer*(1-Math.sin(Math.abs(this.tiltZ)))+1.57,this.wheels.children[0].setRotationFromEuler(this.wheelEulers[0]),be.handbrake||(jd.r=this.wheels.children[1].dS/jd.wheelCirc*6.28*this.wheels.children[1].direction,this.wheels.children[1].rotation.x=this.wheels.children[1].rotation.x+jd.r)):(jd.r=0,jd.r=this.wheels.children[0].dS/jd.wheelCirc*6.28*this.wheels.children[0].direction,this.wheelEulers[0].z+=jd.r,this.wheelEulers[0].y=be.steerL+1.57,this.wheels.children[0].setRotationFromEuler(this.wheelEulers[0]),jd.r=this.wheels.children[1].dS/jd.wheelCirc*6.28*this.wheels.children[1].direction,this.wheelEulers[1].z-=jd.r,this.wheelEulers[1].y=be.steerR-1.57,this.wheels.children[1].setRotationFromEuler(this.wheelEulers[1]),be.handbrake||(jd.r=this.wheels.children[2].dS/jd.wheelCirc*6.28*this.wheels.children[2].direction,this.wheels.children[2].rotation.x=this.wheels.children[2].rotation.x+jd.r,jd.r=this.wheels.children[3].dS/jd.wheelCirc*6.28*this.wheels.children[3].direction,this.wheels.children[3].rotation.x=this.wheels.children[3].rotation.x+jd.r)),jd.d=be.wheels.radius,jd.airborne=!1,jd.grounded=!1,this.didCollide||(this.collisionStrength=0,this.collisionsDisabled=!1),this.didCollide=!1,be.onRoad=!1,this.wheelsInside={},this.wheels.children))this.updateWheelWorldPos(t),t.pHeight=t.groundHeight,this.tVec.copy(t.worldPos).add(this.wheelDown),t.groundState.insideWall=t.insideWall,t.groundState.debug=1==t.i,jd.ground=sl.testGround(this.tVec,t.groundState),t.groundNorm.set(jd.ground.n[0],jd.ground.n[1],jd.ground.n[2]),t.groundHeight=jd.ground.h,t.friction=jd.ground.f,t.onRoad=jd.ground.r,be.onRoad=be.onRoad||t.onRoad,jd.airborne=jd.airborne||t.groundHeight<t.worldPos.y-1,jd.grounded=jd.grounded||t.onRoad&&t.worldPos.y<t.groundHeight+.1,jd.ground.w&&te.Barriers?(t.wd=jd.ground.wd,t.wn=jd.ground.wn,t.ws=jd.ground.ws,null==t.wi||t.wi!=jd.ground.wi?(t.wi=jd.ground.wi,t.insideWall=t.wd<0,t.mayCollide=!0,null==this.wheelsInside[jd.ground.wi]&&(this.wheelsInside[jd.ground.wi]=t.insideWall),this.wheelsInside[t.wi]!==t.insideWall&&(this.collideWallEnd(t),this.didCollide=!0,this.collisionSide=t.front?0:2,this.collisionPos.set(0,t.relPos.y,t.relPos.z))):(null==this.wheelsInside[jd.ground.wi]&&(this.wheelsInside[jd.ground.wi]=this.collisionsDisabled?t.wd<0:t.insideWall),this.wheelsInside[t.wi]!==t.insideWall&&(this.collideWallEnd(t),this.didCollide=!0,this.collisionSide=t.front?0:2,this.collisionPos.set(0,t.relPos.y,t.relPos.z)),this.collisionsDisabled?this.wheelsInside[t.wi]!==t.wd<0?(this.didCollide=!0,this.collisionSide=jd.ground.ws>0?3:1,this.collisionPos.copy(t.relPos)):t.insideWall=t.wd<0:t.insideWall!==t.wd<0?(this.collideWallEdge(t),this.didCollide=!0,this.collisionSide=jd.ground.ws>0?3:1,this.collisionPos.copy(t.relPos)):t.insideWall=t.wd<0)):(t.wi=null,t.insideWall=null),jd.shockDist=-(t.worldPos.y-t.groundHeight-jd.d)+t.travel,t.shockFactor=Math.max(jd.shockDist/(2*t.travel),0),t.prevShockPos=t.shockPos,t.shockPos=t.shockFactor,t.shockExcess=0,t.shockPos>1&&(t.shockExcess=t.shockPos-1,t.shockExcess=Math.min(1,t.shockExcess),t.worldPos.y+=t.shockExcess*t.travel*2,t.shockPos=1),t.dShockPos=t.shockPos-t.prevShockPos,t.position.y=t.radius+t.shockPos*t.travel*2-t.travel;!Hl.Reset||be.onRoad||this.promptResetTimer?this.promptResetTimer&&be.onRoad&&(Vl.value==El.Reset&&Vl.set(El.None),clearTimeout(this.promptResetTimer),this.promptResetTimer=null):this.promptResetTimer=setTimeout((()=>{Vl.set(El.Reset),setTimeout((()=>{Vl.value==El.Reset&&Vl.set(El.None)}),15e3)}),5e3),!this.autodrive&&Hl.Boost&&Vl.value==El.None&&be.onRoad&&be.speed>5&&this.tiltX<-.11&&(Vl.set(El.Boost),setTimeout((()=>{Ql("Boost")}),[3e3])),jd.airborne&&!jd.grounded&&(this.collisionsDisabled=!0),be.bike?be.direction=this.wheels.children[1].direction:be.direction=Math.min(this.wheels.children[2].direction,this.wheels.children[3].direction),t.speed<.5&&(be.direction=0),be.steeringWheel&&(this.autodrive?be.steeringWheel.rotation.x=.95*be.steeringWheel.rotation.x+We.value.steerRotation*kd*(-be.steer/be.metrics.maxSteer)*.05:be.steeringWheel.rotation.x=We.value.steerRotation*kd*(-be.steer/be.metrics.maxSteer))}collideTerrain(e,t){be.bike,e.collisionFactor=10,this.wheelHeights[e.i]=e.tPos.y,this.collisionStrength=0}collideWallEnd(e){this.collisionsDisabled||(this.tVec.copy(e.tPos),e.tPos.copy(e.pPos),e.pPos.copy(this.tVec),be.bike||(this.tVec.copy(e.vel),this.tVec.y=0,e.tPos.add(this.tVec.multiplyScalar(-.8))),e.collisionFactor=10,this.wheelHeights[e.i]=e.tPos.y,this.collisionStrength=be.speed/10)}collideWallEdge(e,t=1){this.collisionsDisabled||(this.tVec.set(e.wn.x,.01,e.wn.z),e.tPos.add(this.tVec.multiplyScalar(e.wd*e.ws)),this.collTemp=(e.velDir.x*-e.wn.z+e.velDir.z*e.wn.x)*Math.abs(e.wd)*.75,this.tVec.set(-e.wn.z,0,e.wn.x).multiplyScalar(this.collTemp),e.tPos.sub(this.tVec),e.collisionFactor=10,this.collisionStrength=Math.max(this.collisionStrength,Math.abs(this.collTemp/this.pdT)),this.wheelHeights[e.i]=e.tPos.y)}updateVehicleNode(){if(ii.vehicleNode.next){if(ii.vehicleNode.i<this.targetVehicleNodeIndex)return be.wrongWay=!1,Vl.value==El.UTurn&&Vl.set(El.None),ii.vehicleNode=ii.vehicleNode.next,ii.vehicleIndex=ii.vehicleNode.i,ii.vehicleIndexDidChange=!0,void Tl.nodeDidChange();jd.d1=be.position.distanceToSquared(ii.vehicleNode.p),jd.d2=be.position.distanceToSquared(ii.vehicleNode.next.next.p),jd.d2>14400?(this.nodeCheckFrame--,this.nodeCheckFrame<=0&&(this.nodeCheckFrame=60,jd.closest=ei(be.position.x,be.position.z,ii.vehicleNode,!0),jd.closest.n.i>ii.vehicleNode.i&&(this.targetVehicleNodeIndex=jd.closest.n.i),yl.value.edge||sl.testFarGrid(be.position.x,be.position.z)||yl.set("edge",!0))):jd.d2<jd.d1?(be.wrongWay=!1,Vl.value!=El.UTurn&&Vl.value!=El.Reverse||Vl.set(El.None),ii.vehicleNode=ii.vehicleNode.next,ii.vehicleIndex=ii.vehicleNode.i,ii.vehicleIndexDidChange=!0,Tl.nodeDidChange()):jd.d1>400&&be.onRoad?(be.wrongWay||(jd.transformedNodeAngle=(2.5*Math.PI-ii.vehicleNode.a)%(2*Math.PI),jd.angleDif=Math.abs(be.heading-jd.transformedNodeAngle),jd.angleDif>2&&jd.angleDif<4.3&&(be.wrongWay=!0,Vl.set(El.UTurn))),!be.wrongWay&&be.direction<0&&(be.reversingTooFar=!0,Vl.set(El.Reverse))):be.wrongWay?(jd.transformedNodeAngle=(2.5*Math.PI-ii.vehicleNode.a)%(2*Math.PI),jd.angleDif=Math.abs(be.heading-jd.transformedNodeAngle),(jd.angleDif<1.4||jd.angleDif>4.9)&&(be.wrongWay=!1,Vl.value==El.UTurn&&Vl.set(El.None))):be.reversingTooFar&&(be.reversingTooFar=!1,Vl.value==El.Reverse&&Vl.set(El.None)),Pl.dist=10*(ii.vehicleNode.i-ii.initIndex+Sh.accumulatedProgress),this.analytics.rawDS>this.nextUpdateDistance&&(this.nextUpdateDistance=this.analytics.rawDS+this.nextUpdateIncrement,this.nextUpdateIncrement<this.maxUpdateIncrement&&(this.nextUpdateIncrement=Math.min(this.maxUpdateIncrement,2*this.nextUpdateIncrement)),this.nextAnalyticsUpdate.distance=Pl.dist,this.nextAnalyticsUpdate.rawDistance=this.analytics.rawDS,this.nextAnalyticsUpdate.speed=Pl.speed,this.nextAnalyticsUpdate={})}}handleInput(e){this.hasBoost=this.hasBoost&&(this.hasAccel||this.hasCruiseTarget),this.inputs.accel=0,this.inputs.drive=0,Y.signal.Autodrive&&de.set(!this.autodrive),Y.signal.Headlights&&be.setHeadlights(!be.headlights,!0),Y.signal.ToggleSpeedControl&&wl.set("enabled",!wl.value.enabled),Y.signal.Reset&&(this.resetToNode(ii.vehicleNode),Hl.Reset&&Ql("Reset"),this.analytics.resetCount++,this.holdHandbrake=!this.hasCruiseTarget),this.autodrive?(this.autoDriver.update(e),this.inputs.accel=this.autoDriver.inputs.accel,this.inputs.steer=this.autoDriver.inputs.steer,(this.hasCruiseTarget||this.hasSpeedLimit)&&(be.speed>wl.value.speed&&(this.inputs.accel=0,be.speed>wl.value.speed+1&&(this.autoDriver.inputs.brake=Math.max(this.autoDriver.inputs.brake,be.speed/wl.value.speed-1))),this.inputs.accel=Math.min(be.metrics.accel,(wl.value.speed-be.speed)/e),0==wl.value.speed?(this.inputs.accel=0,this.autoDriver.inputs.brake=1):be.handbrake&&(be.handbrake=!1)),this.autoDriver.inputs.brake>0?(be.braking||(be.brakeLerp=0),be.braking=!0,zd.redlight.emissiveIntensity=.5):(be.braking=!1,zd.redlight.emissiveIntensity=0),Y.controllerSignal.Forward||Y.controllerSignal.Backward||Y.signal.Forward||Y.signal.Backward||Y.signal.Left||Y.signal.Right?this.canCancelAutodrive&&de.set(!1):this.canCancelAutodrive=!0,be.steer=this.inputs.steer):(this.hasBoost=!1,this.isDriven=!1,Y.signal.Forward&&(this.hasBoost=!!Y.signal.Boost,this.isDriven=!0,this.useMouse&&!this.hasCruiseTarget&&(this.hasBoost=!1),Hl.Boost&&this.hasBoost&&Ql("Boost"),this.hasAccel=!0,this.lastAccel=ae.appTime,!this.hasBoost&&be.direction<0?this.setBrake(!0,Y.signal.Forward):(this.setBrake(!1),this.inputs.accel=Y.signal.Forward*be.metrics.accel),this.holdHandbrake=!1),Y.signal.Backward&&(this.hasAccel=!1,this.isDriven=!0,be.direction>0?this.setBrake(!0,Y.signal.Backward):(this.setBrake(!1),this.inputs.accel=Y.signal.Backward*-be.metrics.accel),this.holdHandbrake=!1),this.isDriven||(this.hasAccel=!1,this.setBrake(!1)),this.inputs.stickySteer=Y.signal.StickySteer>0?1:0,this.inputs.stickySteer&&Y.signal.Handbrake&&!this.inputs.handbrake&&(this.holdHandbrake=!0),this.inputs.handbrake=Y.signal.Handbrake>0,be.handbrake=this.inputs.handbrake||this.holdHandbrake,!this.hasCruiseTarget||this.autodrive||be.braking||be.handbrake||0!=this.inputs.accel&&!this.useMouse||(this.inputs.accel=Math.min(be.metrics.accel,Math.max(-be.metrics.reverse,(wl.value.speed-be.direction*be.speed)/e)),this.useMouse&&this.hasBoost&&(this.inputs.accel=be.metrics.accel)),this.hasSpeedLimit&&(this.hasAccel=this.inputs.accel>0,this.inputs.accel=Math.max(-be.metrics.accel,Math.min(this.inputs.accel,(wl.value.speed-be.speed)/e))),this.hasBoost?this.inputs.accel+=be.metrics.accel*Math.max(0,1-be.speedLerp):this.inputs.accel>0&&be.speedLerp<.5&&(this.inputs.accel+=be.metrics.accel*Math.max(0,.5*(1-2*be.speedLerp))),X&&(w.key[V.PageUp]&&ii.vehicleNode.next?(this.resetToNode(ii.vehicleNode.next),this.holdHandbrake=!0,w.key[V.PageUp]=!1):w.key[V.PageDown]&&ii.vehicleNode.prev&&(this.resetToNode(ii.vehicleNode.prev),this.holdHandbrake=!0,w.key[V.PageDown]=!1)),0==D.value?(A.softSteer?this.smoothKeySteerSoft(e):this.smoothKeySteerQuick(e),be.steer=this.inputs.steer):(this.smoothKeySteerQuick(e),this.smoothControllerSteer(e),be.steer=Math.max(Math.min(jd.maxSteer,this.inputs.steer+this.inputs.controllerSteer),-jd.maxSteer)),this.inputs.accel*=We.speedFactor),be.updateSteer(),this.getDriveState(e),be.hasBoost=this.hasBoost,0!=w.scrollDelta&&wl.value.enabled&&null==w.scrollLock&&(w.scrollDelta<0?wl.inc5():wl.dec5()),this.inputDisabled||(w.scrollDelta=0)}checkAutodriveProgress(){}resetToNode(e){let t=e.a-e.next.da/2;this.autodrive?this.setPose(e.p.x+e.n.x*Qt/2*We.value.autodriveSide,e.p.y,e.p.z+e.n.z*Qt/2*We.value.autodriveSide,Math.PI/2-t,!0):this.setPose(e.p.x,e.p.y,e.p.z,Math.PI/2-t,!0),this.inputs.accel=0,this.inputs.steer=0,this.inputs.brake=0,this.inputs.handbrake=0,this.inputs.stickySteer=0,this.hasBoost=!1;let i=0;for(let s of this.wheels.children)s.shockPos=.5,s.groundHeight=0,s.vel.set(0,0,0),s.velDir.set(0,0,0),s.acc.set(0,0,0),s.dSus=0,s.pSus=0,s.dS=0,s.tPos.set(0,0,0),s.prevShockPos=.5,s.insideWall=!0,s.i%2==0?s.rotation.set(0,Math.PI/2,0):s.rotation.set(0,-Math.PI/2,0),s.collisionFactor=0,s.wd=0,this.wheelHeights[i]=0,i++,this.updateWheelWorldPos(s),s.pPos.copy(s.worldPos);i=0;for(let s of this.wheelEulers)i%2==0?s.set(0,Math.PI/2,0):s.set(0,-Math.PI/2,0);this.pPos.copy(be.position),be.pitch=this.orientation.x,be.reset(),Vl.value==El.UTurn&&Vl.set(El.None),Pl.speed=be.speed,jd.turnSpeed=0,jd.pTurnSpeed=0,this.targetHeading=0,this.update=this.updateStationed,Tl.pause(),this.tiltX=this.orientation.x,this.sinTiltX=Math.sin(this.tiltX),this.tiltZ=this.orientation.z,this.sinTiltZ=Math.sin(this.tiltZ),this.dS=0,this.didCollide=!1,this.collisionSide=0,this.collisionsDisabled=!1,this.hasInit&&this.updateUI(),ii.vehicleNode=e,ii.vehicleIndex=e.i,ii.vehicleIndexDidChange=!0,this.targetVehicleNodeIndex=ii.vehicleIndex,this.motionDir.set(0,0,1),this.steerOrientation.copy(this.orientation),this.autoDriver.reset(),this.useMouse&&(this.dom.mousePrompt.style.display="block"),this.audio.reset()}getDriveState(e){this.inputs.accel>0?be.drive<this.inputs.accel?(be.drive+=be.metrics.jerk*e,be.drive>this.inputs.accel&&(be.drive=this.inputs.accel)):be.drive=this.inputs.accel:be.drive>this.inputs.accel?(be.drive-=be.metrics.jerk*e,be.drive<this.inputs.accel&&(be.drive=this.inputs.accel)):be.drive=this.inputs.accel}smootherLerp(e){return(e*(6*e-15)+10)*e*e*e}smoothLerp(e){return(3-2*e)*e*e}halfLerp(e){return 2*((3-2*(e=e/2+.5))*e*e-.5)}smoothKeySteerSoft(e){if(jd.maxSteer=be.metrics.maxSteer,this.softSteerFactor=1-be.speedLerp*Ml.steerSpeedFactor,be.bike?(this.softTurnInterval=be.metrics.steerInterval,this.softSteerTimeFactor=1+be.speedLerp*be.speedLerp):(this.softTurnInterval=be.metrics.steerInterval,this.softSteerTimeFactor=1+.5*be.speedLerp,be.slip>0&&!Y.signal.StickySteer&&(this.softSlip=1-be.slip,this.softSlip*=this.softSlip,this.softSlipB=Math.max(.5,this.softSlip),this.softSteerTimeFactor*=this.softSlipB,this.softSteerFactor=1-be.speedLerp*Ml.steerSpeedFactor*this.softSlipB)),jd.maxSteer*=this.softSteerFactor,jd.steerInput=Y.signal.Left-Y.signal.Right,jd.steerDir=jd.steerInput<0?-1:1,jd.steerTarget=jd.steerInput*jd.maxSteer,Y.signal.StickySteer)return this.softStiff||(this.softStiff=!0),0==jd.steerInput?(Y.signal.Left=0,Y.signal.Right=0,void(this.softTurning=!1)):(jd.stickySpeed=0,this.softTurning?this.softTimer<.15&&(this.softTimer+=e,this.softTimer>.15&&(this.softTimer=.15)):(this.softTimer=e,this.softTurning=!0),jd.stickySpeed=this.softTimer*(A.lockedSteerSpeed/.15),be.bike?this.inputs.steer+=jd.steerInput*e*this.softSteerFactor*jd.stickySpeed*.5:this.inputs.steer+=jd.steerInput*e*this.softSteerFactor*jd.stickySpeed,void(this.inputs.steer>0?this.inputs.steer=Math.min(jd.maxSteer,this.inputs.steer):this.inputs.steer=Math.max(-jd.maxSteer,this.inputs.steer)));this.softStiff&&(this.softStiff=!1,this.softTimer=0,this.softStartPoint=be.steer),0!=jd.steerInput?this.softTurning&&this.softTurningDir==jd.steerInput||(this.softTimer=0,this.softStartPoint=be.steer,this.softInterval=this.softTurnInterval/(Math.abs(jd.steerTarget-be.steer)/jd.maxSteer)/A.steerSpeed,be.bike&&Math.abs(jd.steerTarget-be.steer)>jd.maxSteer&&(this.softInterval*=1-be.speedLerp/2),this.softTurning=!0,this.softTurningDir=jd.steerInput<0?-1:1):this.softTurning&&(this.softTurning=!1,be.bike?this.softInterval=this.softTurnInterval*Math.abs(be.steer/(jd.maxSteer*A.recenterSpeed)):this.softInterval=this.softSlipB*this.softTurnInterval*Math.abs(be.steer/(jd.maxSteer*A.recenterSpeed)),this.softTimer=0,this.softStartPoint=be.steer,this.softTurningDir=0),this.softTimer+=e/this.softSteerTimeFactor,this.softLerp=Math.min(1,this.softTimer/this.softInterval),this.softLerp=this.halfLerp(this.softLerp),this.softSteerOutput=this.softStartPoint*(1-this.softLerp)+jd.steerTarget*this.softLerp,this.inputs.steer=this.softSteerOutput}smoothControllerSteer(e){if(jd.contSteer=Y.controllerSignal.Left-Y.controllerSignal.Right,jd.steerLimiter=1-be.speedLerp*Ml.steerSpeedFactor*jd.slipFactor,1==D.value){jd.maxSteer=be.metrics.maxSteer*jd.steerLimiter*m.steerRange,jd.contSmoothing=1-m.steerSmoothing,jd.a=.02+jd.contSmoothing*jd.contSmoothing*jd.contSmoothing*.98;let e=jd.contSteer*m.linearity+jd.contSteer*jd.contSteer*(1-m.linearity);jd.contSteer<0&&(e=jd.contSteer*m.linearity-jd.contSteer*jd.contSteer*(1-m.linearity)),jd.contSteer=e*jd.maxSteer}else{jd.maxSteer=be.metrics.maxSteer*jd.steerLimiter*P.steerRange,jd.contSmoothing=1-P.steerSmoothing,jd.a=.02+jd.contSmoothing*jd.contSmoothing*jd.contSmoothing*.98;let e=jd.contSteer*P.linearity+jd.contSteer*jd.contSteer*(1-P.linearity);jd.contSteer<0&&(e=jd.contSteer*P.linearity-jd.contSteer*jd.contSteer*(1-P.linearity)),jd.contSteer=e*jd.maxSteer}jd.a=Math.min(1,jd.a),jd.nextSteer=this.inputs.controllerSteer*(1-jd.a)+jd.contSteer*jd.a,this.inputs.controllerSteer=jd.nextSteer}smoothKeySteerQuick(e){if(jd.slipFactor=1,be.slip>0&&!Y.signal.StickySteer&&(jd.slipFactor=Math.max(.5,(1-be.slip)*(1-be.slip))),jd.steerLimiter=1-be.speedLerp*Ml.steerSpeedFactor*jd.slipFactor,jd.maxSteer=be.metrics.maxSteer*jd.steerLimiter,Y.signal.StickySteer)return jd.steerInput=Y.signal.Left-Y.signal.Right,0==jd.steerInput?(Y.signal.Left=0,Y.signal.Right=0,void(this.stickyTurning=!1)):(jd.stickySpeed=0,this.stickyTurning?this.stickyTimer<.15&&(this.stickyTimer+=e,this.stickyTimer>.15&&(this.stickyTimer=.15)):(this.stickyTimer=e,this.stickyTurning=!0),jd.stickySpeed=this.stickyTimer*(A.lockedSteerSpeed/.15),be.bike?this.inputs.steer+=jd.steerInput*e*this.softSteerFactor*jd.stickySpeed*.5:this.inputs.steer+=jd.steerInput*e*this.softSteerFactor*jd.stickySpeed,void(this.inputs.steer>0?this.inputs.steer=Math.min(jd.maxSteer,this.inputs.steer):this.inputs.steer=Math.max(-jd.maxSteer,this.inputs.steer)));jd.steerInput=Y.signal.Left-Y.signal.Right,jd.steerDir=jd.steerInput<0?-1:1,jd.steerTarget=jd.steerInput*jd.maxSteer,jd.steerTemper=Math.max(be.slip,jd.maxSteer-Math.abs(this.inputs.steer)/jd.maxSteer),(jd.steerDir<0&&this.inputs.steer>0||jd.steerDir>0&&this.inputs.steer<0)&&(jd.steerTemper=1),jd.a=10*e/be.metrics.steerInterval/jd.slipFactor*A.steerSpeed*jd.steerTemper,0==jd.steerInput&&(jd.a=10*e/be.metrics.steerInterval/jd.slipFactor*A.recenterSpeed),jd.a=Math.min(1,jd.a),this.inputs.steer=this.inputs.steer*(1-jd.a)+jd.steerTarget*jd.a}};const Od={},Rd=(e,t)=>{if(isNaN(t))console.warn("Attempting to set nan config value for ",e);else{window.localStorage.setItem(Pd[e],t),Gd[e]=t;for(let i of Od[e]||[])i(t)}},Td={UseAckermann:!0,AudioLevel:1,Units:0},Pd={},Gd={UseAckermann:Td.UseAckermann,AudioLevel:Td.AudioLevel,Units:Td.Units};for(let tu in Gd){let e;Pd[tu]="config-"+tu;try{e=JSON.parse(window.localStorage.getItem(Pd[tu]))}catch(eu){console.warn("JSON Parsing exception"),console.warn(eu),Rd(tu,Td[tu]),e=Td[tu]}Gd[tu]=null===e?Td[tu]:e}var Bd=Gd;new class{constructor(){this.setBound=this.set.bind(this),this.ls=window.localStorage,this.loadConfig()}loadConfig(){let e;for(let t in Bd)e=this.get(t),Bd[t]=null==e?Td[t]:e}get(e){return JSON.parse(this.ls.getItem("config-"+e))}set(e,t){console.log("Set config '"+e+"' to "+t),Bd[e]=t,window.localStorage.setItem("config-"+e,t)}};const Wd="no_prompt_fps";var Fd=new class extends l{constructor(...e){super(...e),this.default=!1,this.value=!1,this.disabled=null!=window.localStorage.getItem(Wd)||null!=window.localStorage.getItem("analytics_didChangeQuality")||Sh.value.viewLodIndex*Sh.value.detailLodIndex==0}disable(){this.disabled=!0,window.localStorage.setItem(Wd,!0)}};var Ed=class{constructor(e,t,i,s){this.screenSize=new r.V,this.renderScale=1,this.onError=()=>{},this.onLoadProgress=()=>{},this.loadStages=[],this.isCineCam=!1,this.loadLoopBound=this.loadLoop.bind(this),this.maxLoadLoops=1e3,this.loadLoopCount=0,this.loadInactivityTimer=0,this.prevLoadProg=0,this.fineLoadProgress=0,this.initialised=!1,this.midlineDidReset=!0,this.onLoadedBound=this.onLoaded.bind(this),this.firstFrame=!0,this.basicPromptInterval=null,this.onAudioInitBound=this.onAudioInit.bind(this),this.onTickerStateBound=this.onTickerState.bind(this),this.lights={},this.fpsTracker=0,this.statsTimer=0,this.updateBound=this.update.bind(this),this.physDT=0,this.maxPhysDT=.02,this.minPhysDT=.001,this.checkNoGPU=0,this.lowFPSWaiter=0,this.canvas=e,this.onError=i,this.onLoadProgress=s,this.stats=new h.a,this.stats.dom.style.left="",this.stats.dom.style.right="0",this.pauseDom=document.getElementById("game-paused"),this.initScene(e),ae.addStateListener(this.onTickerStateBound),w.init(t,e),w.addListener(V.NodeDebug,(()=>console.log(ii.vehicleNode))),Y.addListener("Mute",(()=>{me.toggleMute()})),Y.addListener("ToggleCinecam",(()=>this.toggleCamera())),Y.addListener("NextScene",(()=>{sl.nextSkin()})),Y.addListener("PrevScene",(()=>{sl.prevSkin()})),Sh.addListener("seed",(()=>{this.regenerateAll()})),Sh.addListener("sceneName",(()=>{this.regenerateAll()})),Sh.addListener("topography",(()=>{this.regenerateTopography()})),Sh.addListener("viewLodIndex",(()=>{this.regenerateViewDist()})),Sh.addListener("detailLodIndex",this.regenerateDetail.bind(this)),Sh.addListener("renderScale",(e=>{this.renderScale=fh[e],this.setSize(this.screenSize.x,this.screenSize.y)})),this.renderScale=fh[Sh.value.renderScale],w.lockKeys(),be.addListener(ve,this.onVehicleChanged.bind(this)),this.generate()}pregenerate(){d.set(!0),Sh.loadProgress(),w.lockKeys(),this.vehicleController.suspend(),ae.removeListener(this.updateBound),this.midlineDidReset=!0,this.loadProgress=0,this.loadStages.length=0,this.onLoadProgress(0)}regenerateAll(){this.pregenerate(),this.scene.fog=ut(),this.generate()}regenerateSeed(){}regenerateTopography(){this.pregenerate(),this.loadStages.push({name:"topography",setup:sl.topographyLoaderInit,loader:sl.topographyLoader,portion:.25,frameIterations:50}),this.loadStages.push({name:"scene",setup:sl.sceneLoaderInit,loader:sl.sceneLoader,portion:.1,frameIterations:1}),this.loadStages.push({name:"farGrid",setup:sl.farGridReset,loader:sl.farGridLoader,portion:.35,frameIterations:10}),this.loadStages.push({name:"nearGrid",setup:sl.nearGridReset,loader:sl.nearGridLoader,portion:.28,frameIterations:10}),this.loadStages.push({name:"finalise",setup:()=>{},loader:sl.postGridLoader,portion:.02,frameIterations:10}),this.loadStage=this.loadStages[0],this.loadStage.setup(),ae.addListener(this.loadLoopBound)}regenerateViewDist(){sl.updateConfig(),this.camController.updateViewDist(),this.regenerateAll()}regenerateDetail(){sl.updateConfig(),this.regenerateAll();let e=512*(Sh.value.detailLodIndex+1);yt.shadow.mapSize.width=e,yt.shadow.mapSize.height=e,yt.shadow.map.dispose(),yt.shadow.map=null}generate(){this.loadProgress=0,this.midlineDidReset=!0,this.loadStages.push({name:"topography",setup:sl.topographyLoaderInit,loader:sl.topographyLoader,portion:.25,frameIterations:50}),this.loadStages.push({name:"scene",setup:sl.sceneLoaderInit,loader:sl.sceneLoader,portion:.1,frameIterations:1}),this.loadStages.push({name:"farGrid",setup:sl.farGridLoaderInit,loader:sl.farGridLoader,portion:.35,frameIterations:10}),this.loadStages.push({name:"nearGrid",setup:sl.nearGridLoaderInit,loader:sl.nearGridLoader,portion:.28,frameIterations:10}),this.loadStages.push({name:"finalise",setup:()=>{},loader:sl.postGridLoader,portion:.02,frameIterations:10}),this.loadStage=this.loadStages[0],this.loadStage.setup(),ae.addListener(this.loadLoopBound)}loadLoop(e){try{let t,i=1e3*e,s=Date.now()+i;for(this.fineLoadProgress=0,t=0;t<this.maxLoadLoops&&(this.fineLoadProgress=this.loadStage.loader(),!(this.fineLoadProgress>=1||Date.now()>=s));t++);if(this.fineLoadProgress>=1){let e=this.loadStages.shift();if(this.loadProgress+=e.portion,console.log("Loaded "+e.name+"..."),0==this.loadStages.length)return console.log("Loading complete"),ae.removeListener(this.loadLoopBound),void this.onLoaded();this.loadStage=this.loadStages[0],this.loadStage.setup(),this.fineLoadProgress=this.loadProgress,this.onLoadProgress(this.loadProgress)}else this.fineLoadProgress=this.loadProgress+this.loadStages[0].portion*this.fineLoadProgress,this.onLoadProgress(this.fineLoadProgress);if(this.prevLoadProg>=this.fineLoadProgress){if(this.loadInactivityTimer+=e,this.loadInactivityTimer>3){if(!Fl.NewPlayer)return this.onError("LOAD ERROR: Stuck at progress "+this.loadStage.name+", "+this.fineLoadProgress),void ae.retire();Ye(null,!0)}}else this.loadInactivityTimer=0;this.prevLoadProg=this.fineLoadProgress,this.loadLoopCount=0,this.render(),this.stats.update()}catch(eu){return console.error(eu),this.onError(eu.stack.toString()),void ae.retire()}}onLoaded(){this.initialised?(this.vehicleController.reload(this.midlineDidReset),w.unlockKeys()):(this.initVehicle(),window.addEventListener("keydown",this.onAudioInitBound),window.addEventListener("mousedown",this.onAudioInitBound),Tl.init(),Y.initialise(),this.initialised=!0),this.camController.updateViewDist(),d.set(!1),this.onLoadProgress(1),this.beginRender()}awaitVehicleMotion(){be.speed>1&&(Vl.set(El.None),clearInterval(this.basicPromptInterval))}beginGame(){var e,t;e=Gl,t=!0,localStorage.setItem(e,t),Vl.value!==El.None&&(this.basicPromptInterval=setInterval(this.awaitVehicleMotion.bind(this),3e3)),w.unlockKeys(),this.canvas.focus()}resetVehicle(){this.vehicleController.resetToNode(ii.vehicleNode)}onAudioInit(){me.init(),window.removeEventListener("keydown",this.onAudioInitBound),window.removeEventListener("mousedown",this.onAudioInitBound)}onTickerState(e){this.pauseDom.style.display=e?"block":"none"}initRenderer(e=!0,t=!0){this.renderer=new r.X({canvas:this.canvas,antialias:e,powerPreference:"high-performance",stencil:!1,logarithmicDepthBuffer:t}),console.log("Device pixel ratio: ",window.devicePixelRatio),this.renderer.setPixelRatio(Math.min(1,window.devicePixelRatio)),this.renderer.setClearColor(16777215,1),console.log("Antialias, logdepth ",e,t),this.renderer.shadowMap.enabled=!0}initScene(e){this.scene=Ch,this.scene.background=It,this.scene.fog=ut(),this.renderer=new r.X({canvas:this.canvas,antialias:Sh.value.antialias,powerPreference:"high-performance",stencil:!1,logarithmicDepthBuffer:!1}),console.log("Device pixel ratio: ",window.devicePixelRatio),this.renderer.setPixelRatio(Math.min(1,window.devicePixelRatio)),this.renderer.setClearColor(16777215,1),this.renderer.shadowMap.enabled=!0,this.lights.ambient=bt,this.scene.add(this.lights.ambient);let t=At;t.position.set(0,1,0),this.lights.hemi=t,this.scene.add(this.lights.hemi);let i=yt;i.position.set(0,10,0),i.castShadow=!0,i.shadow.radius=2,i.shadow.camera.left=-4,i.shadow.camera.right=4,i.shadow.camera.top=4,i.shadow.camera.bottom=-4,i.shadow.camera.updateProjectionMatrix();let s=512*(Sh.value.detailLodIndex+1);i.shadow.mapSize.width=s,i.shadow.mapSize.height=s,i.shadow.camera.near=.5,i.shadow.camera.far=300,i.target=be,this.lights.dir=i,this.scene.add(this.lights.dir),this.toggleCamera(),this.scene.add(sl.container),this.scene.add(be),this.setSize(e.offsetWidth,e.offsetHeight),this.render()}toggleCamera(){this.camController&&(this.camController.destroy(),this.camController.camContainer&&this.scene.remove(this.camController.camContainer),this.isCineCam=!this.isCineCam,this.vehicleController.inputDisabled=this.isCineCam),this.isCineCam?(this.camController=new cl(this.onViewChange.bind(this),this.canvas),this.scene.add(this.camController.camContainer)):this.camController=new rl(this.onViewChange.bind(this))}initVehicle(){this.vehicleController=new Ld,this.onVehicleChanged()}onVehicleChanged(){let e=this.lights.dir.shadow.camera,t=be.metrics.shadowMapSize;e.left=-t,e.right=t,e.top=t,e.bottom=-t,e.updateProjectionMatrix()}destroy(){for(this.camController.destroy(),this.vehicleController.destroy(),this.bikeController.destroy(),ae.removeListener(this.updateBound);this.scene.children.length;)console.log("Removing scene children"),this.scene.remove(this.scene.children[0]);for(;this.canvas.lastChild;)this.canvas.removeChild(this.canvas.lastChild);this.renderer.clear()}render(){this.renderer.render(this.scene,this.camController.camera)}beginRender(){be.headlights||(be.setHeadlights(!0),be.lightsContainer.position.y-=100,this.update(ae.dT,ae.appTime),be.setHeadlights(!1),be.lightsContainer.position.y+=100),ae.addListener(this.updateBound)}update(e,t){se.disabled||(t<20&&e>.07?(this.checkNoGPU+=1,this.checkNoGPU>10&&(se.set(!0),se.disable())):this.checkNoGPU>0&&(this.checkNoGPU-=1));try{if(this.physDT+=e,Y.update(e),this.physDT>this.maxPhysDT)for(this.vehicleController.update(this.maxPhysDT,t),this.physDT-=this.maxPhysDT;this.physDT>this.maxPhysDT;)this.vehicleController.update(this.maxPhysDT,t),this.physDT-=this.maxPhysDT;this.physDT>this.minPhysDT&&(this.vehicleController.update(this.physDT),this.physDT=0),this.camController.update(e),sl.update(e,t)}catch(eu){return console.error(eu),this.onError(eu.stack.toString()),void ae.retire()}this.render(),this.stats.update(),this.fpsTracker++,this.statsTimer+=e,this.statsTimer>=5&&this.updateStats()}updateStats(){this.curFPS=this.fpsTracker/this.statsTimer,this.fpsTracker=0,this.statsTimer=0,this.lowFPSWaiter>3&&this.curFPS<45&&this.curFPS>15&&!Fd.disabled&&(this.curFPS<20&&se.set(!0),Fd.set(!0),Fd.disable()),this.lowFPSWaiter++}onViewChange(){}setSize(e,t){this.screenSize.set(e,t),this.renderer.setSize(e*this.renderScale,t*this.renderScale),this.camController.setSize(e,t),w.setSize(e,t),this.render()}};i(16);var Zd=Zh.location.hostname;var Hd=["dW5ibG9ja2VkLWdhbWVzLnMzLmFtYXpvbmF3cy5jb20=","d3d3Lm9ubGluZWdhbWVzLmlv","bG9jYWxob3N0"],Qd=i.p+"static/media/warning.2f7f711f.svg",Yd=i.p+"static/media/u_turn.38a08a9e.svg",Vd=i.p+"static/media/arrow_up.fdd3dd06.svg",Ud=(i(43),i.p+"static/media/no_mobile_1.959d982f.svg"),Xd=i.p+"static/media/anslo_ico.77ddc9f9.svg",Jd=i.p+"static/media/splash-logo-placeholder-7b.2d60164d.png",qd=i.p+"static/media/freezenovagames.a1b24382.png",Kd=i(0);const _d=({loadProgress:e,gameHasBegun:t,onBegin:i})=>Object(Kd.jsx)("div",{id:"splash-loader",className:"splash-ready",onClick:e=>{e.preventDefault(),i()},children:t?"return":"begin"}),$d=()=>Object(Kd.jsxs)("div",{className:"splash-notsupported",children:[Object(Kd.jsx)("img",{className:"splash-notsupported-icon",src:Ud,alt:""}),Object(Kd.jsx)("br",{}),"Apologies, this game is not supported on mobile devices.",Object(Kd.jsx)("br",{})]});var ec=({onClose:e,supported:t,gameHasBegun:i,loadProgress:n})=>{const[a,o]=Object(s.useState)(!1);return Object(Kd.jsxs)("div",{id:"splash-container",children:[Object(Kd.jsx)("div",{id:"home-bg"}),Object(Kd.jsxs)("div",{id:"home",children:[t&&Object(Kd.jsxs)(Kd.Fragment,{children:[Object(Kd.jsxs)("div",{id:"splash-attributions",children:[Object(Kd.jsxs)("a",{id:"splash-anslo",href:"https://anslo.dev",target:"_blank",rel:"noopener noreferrer nofollow",children:[Object(Kd.jsx)("img",{src:Xd,id:"splash-anslo-img",alt:""}),Object(Kd.jsx)("div",{children:"from anslo.dev \xa9 2024"})]}),Object(Kd.jsx)("div",{children:"\xb7"}),Object(Kd.jsx)("div",{id:"splash-attributions-btn",onClick:()=>o(!a),children:"attributions"})]}),Object(Kd.jsx)("img",{id:"splash-license-logo",alt:"freezenova.games",src:qd}),Object(Kd.jsxs)("div",{id:"splash-license",children:["This build is licensed to ",Object(Kd.jsx)("a",{className:"splash-link",href:"https://freezenova.games",rel:"nofollow",children:"FreezeNova.Games"})]})]}),a&&Object(Kd.jsxs)("div",{id:"attributions",children:[Object(Kd.jsx)("div",{id:"attributions-close",onClick:()=>o(!1),children:"+"}),Object(Kd.jsx)("div",{style:{fontSize:"2.5vh",paddingBottom:"1vh",color:"#fff"},children:"Attributions"}),Object(Kd.jsxs)("div",{children:["Rendering library - ",Object(Kd.jsx)("a",{className:"about-link",href:"https://threejs.org/",children:"three.js"})]}),Object(Kd.jsxs)("div",{children:["Off-world textures - ",Object(Kd.jsx)("a",{className:"about-link",href:"https://mars.nasa.gov/mars2020/multimedia/raw-images/",rel:"nofollow",children:"Nasa Perseverance"})]}),Object(Kd.jsxs)("div",{children:["Brake audio - ",Object(Kd.jsx)("a",{className:"about-link",href:"https://freesound.org/people/WavJunction.com/sounds/456764/",rel:"nofollow",children:"WavJunction.com on freesound.org"})]}),Object(Kd.jsxs)("div",{children:["Ambient audio - ",Object(Kd.jsx)("a",{className:"about-link",href:"https://freesound.org/people/InspectorJ/sounds/401543/",rel:"nofollow",children:"InspectorJ on freesound.org"})]}),Object(Kd.jsxs)("div",{children:["Tyre audio - ",Object(Kd.jsx)("a",{className:"about-link",href:"https://freesound.org/people/fractanimal/sounds/614627/",rel:"nofollow",children:"fractanimal on freesound.org"})]}),Object(Kd.jsxs)("div",{children:["Gravel audio - ",Object(Kd.jsx)("a",{className:"about-link",href:"https://freesound.org/people/seth-m/sounds/341069/",rel:"nofollow",children:"seth-m on freesound.org"})]}),Object(Kd.jsxs)("div",{children:["Boost audio - ",Object(Kd.jsx)("a",{className:"about-link",href:"https://freesound.org/people/YleArkisto/sounds/342892/",rel:"nofollow",children:"YleArkisto on freesound.org"})]}),Object(Kd.jsxs)("div",{children:["Suspension audio - ",Object(Kd.jsx)("a",{className:"about-link",href:"https://freesound.org/people/ingudios/sounds/119468/",rel:"nofollow",children:"ingudios on freesound.org"})]}),Object(Kd.jsxs)("div",{children:["Collision sounds - ",Object(Kd.jsx)("a",{className:"about-link",href:"https://freesound.org/people/jakobthiesen/sounds/174836/",rel:"nofollow",children:"jakobthiesen on freesound.org"})]}),Object(Kd.jsxs)("div",{children:["Collision sounds - ",Object(Kd.jsx)("a",{className:"about-link",href:"https://freesound.org/people/SubwaySandwitch420/sounds/538947/",rel:"nofollow",children:"SubwaySandwitch420 on freesound.org"})]}),Object(Kd.jsxs)("div",{children:["Collision sounds - ",Object(Kd.jsx)("a",{className:"about-link",href:"https://freesound.org/people/jakobthiesen/sounds/174837/",rel:"nofollow",children:"jakobthiesen on freesound.org"})]}),Object(Kd.jsxs)("div",{children:["Barrier scrape sound - ",Object(Kd.jsx)("a",{className:"about-link",href:"https://freesound.org/people/eyenorth/sounds/464846/",rel:"nofollow",children:"eyenorth on freesound.org"})]}),Object(Kd.jsxs)("div",{children:["Misc sound effects - ",Object(Kd.jsx)("a",{className:"about-link",href:"https://freesound.org/people/HECKFRICKER/sounds/625312/",rel:"nofollow",children:"HECKFRICKER on freesound.org"})]})]}),Object(Kd.jsx)("div",{id:"splash-logo-placeholder"}),Object(Kd.jsx)("img",{id:"splash-logo",src:Jd,alt:""}),Object(Kd.jsx)("div",{id:"splash-header",children:"slow roads"}),Object(Kd.jsx)("div",{id:"splash-subheader",children:"endless driving zen"}),t?Object(Kd.jsx)(_d,{loadProgress:n,gameHasBegun:i,onBegin:e}):Object(Kd.jsx)($d,{})]})]})},tc=(i(45),i.p+"static/media/lock_open.2037b97e.svg"),ic=i.p+"static/media/lock_closed.2c30efba.svg",sc=i.p+"static/media/refresh.56c65653.svg",nc=i.p+"static/media/handbrake.9ce9ad46.svg";const ac=["mph","kmph"],oc=["miles","km"],rc=[.44704,.277778],hc=[60*rc[0],100*rc[1]],lc=({conversion:e,cruiseDefault:t})=>{const[i,n]=Object(s.useState)(wl.value.enabled),[a,o]=Object(s.useState)(wl.value.speed),[r,h]=Object(s.useState)(wl.value.control),[l,d]=Object(s.useState)(!1),[c,p]=Object(s.useState)(!1);return Object(s.useEffect)((()=>(wl.addListener("control",h),wl.addListener("enabled",n),wl.addListener("speed",o),()=>{wl.removeListener("control",h),wl.removeListener("enabled",n),wl.removeListener("speed",h)})),[h,n,o]),Object(Kd.jsxs)("div",{id:"ui-cruise-controls",onMouseEnter:()=>d(!0),onMouseLeave:()=>d(!1),children:[Object(Kd.jsx)("img",{id:"ui-cruise-toggle",title:"Toggle speed control",alt:"",src:i?ic:tc,onMouseDown:()=>{wl.set("enabled",!i)},onMouseEnter:()=>p(!0),onMouseLeave:()=>p(!1)}),i&&Object(Kd.jsxs)("div",{id:"ui-cruise-select",children:[Object(Kd.jsx)("div",{className:"ui-cruise-arrow",onMouseDown:()=>{wl.inc5()},children:"\u25b4"}),Object(Kd.jsx)("div",{id:"ui-cruise-value",children:Math.round(a/e)}),Object(Kd.jsx)("div",{className:"ui-cruise-arrow",onMouseDown:()=>{wl.dec5()},children:"\u25be"})]}),i&&l&&Object(Kd.jsxs)("div",{style:{marginLeft:"2vh"},id:"ui-cruise-select",children:[Object(Kd.jsx)("div",{className:"ui-cruise-arrow",onMouseDown:()=>{wl.toggleMode()},children:"\u25b4"}),Object(Kd.jsx)("div",{id:"ui-cruise-style",title:r==xl?"automatically maintains a cruise speed":"limits your max speed",children:r==xl?"cruise":"limit"}),Object(Kd.jsx)("div",{className:"ui-cruise-arrow",onMouseDown:()=>{wl.toggleMode()},children:"\u25be"})]}),null==a&&c&&Object(Kd.jsx)("div",{id:"ui-cruise-label",children:"speed control"})]})};var dc=()=>{const[e,t]=Object(s.useState)(te.Units),[i,n]=Object(s.useState)(!1),[a,o]=Object(s.useState)(!1),[r,h]=Object(s.useState)(!1);return Object(s.useEffect)((()=>(te.addListener(J.Units,t),()=>{te.removeListener(J.Units,t)})),[t]),Object(s.useEffect)((()=>(Y.addListener("ToggleHandbrake",h),()=>{Y.removeListener("ToggleHandbrake",h)})),[h]),Object(Kd.jsxs)("div",{id:"main-stats",children:[r&&Object(Kd.jsx)("img",{id:"ui-handbrake",src:nc,alt:"",title:"Handbrake Engaged"}),Object(Kd.jsxs)("div",{id:"ui-dist",className:"ui-stat",children:[Object(Kd.jsx)("span",{id:"ui-dist-val",className:"ui-stat-val",children:"0"}),Object(Kd.jsx)("div",{className:"ui-stat-unit",onMouseDown:()=>te.set(J.Units,(e+1)%2),children:oc[e]}),Object(Kd.jsxs)("div",{id:"ui-dist-reset",children:[Object(Kd.jsx)("img",{id:"ui-dist-reset-icon",alt:"",src:sc,onMouseEnter:()=>n(!0),onMouseLeave:()=>{n(!1),o(!1)},onClick:()=>{a?(Sh.revertProgress(),window.localStorage.setItem("reloading",!0),window.location.reload()):o(!0)}}),a&&Object(Kd.jsx)("div",{id:"ui-dist-reset-warning",children:"Click again to confirm..."}),i&&!a&&Object(Kd.jsx)("div",{id:"ui-dist-reset-warning",children:"Reset distance (page will reload)"})]})]}),Object(Kd.jsx)("div",{className:"ui-stat-spacer"}),Object(Kd.jsxs)("div",{id:"ui-speed",className:"ui-stat",children:[Object(Kd.jsx)("span",{id:"ui-speed-val",className:"ui-stat-val",children:"0"}),Object(Kd.jsx)("div",{className:"ui-stat-unit",onMouseDown:()=>te.set(J.Units,(e+1)%2),children:ac[e]}),Object(Kd.jsx)(lc,{conversion:rc[e],cruiseDefault:hc[e]})]})]})},cc=(i(21),i(17),i.p+"static/media/controls.0048d852.svg"),pc=i.p+"static/media/controls_mouse_icon.0ab0135a.svg",uc=i.p+"static/media/controls_controller.54e3c07e.svg",gc=i.p+"static/media/controls_camera.82fac4d7.svg";const mc=({value:e,meta:t,onSet:i})=>{var s,n;return Object(Kd.jsxs)("div",{className:"settings-input-bool",children:[Object(Kd.jsx)("div",{className:e?"settings-input-bool_option bool_selected":"settings-input-bool_option",onMouseDown:()=>i(!0),children:(null===(s=t.labels)||void 0===s?void 0:s[1])||"on"}),Object(Kd.jsx)("div",{className:e?"settings-input-bool_option":"settings-input-bool_option bool_selected",onMouseDown:()=>i(!1),children:(null===(n=t.labels)||void 0===n?void 0:n[0])||"off"})]})},xc=({container:e,prop:t,meta:i,onSetProportion:n,dragging:a,setDragging:o})=>{const r=Object(s.useCallback)((t=>{if(e.current){let i=e.current.getBoundingClientRect();n(Math.min(Math.max(0,(t.clientX-i.left)/i.width),1))}t.stopPropagation()}),[e,n]),h=Object(s.useCallback)((()=>{o(!1)}),[o]);return Object(s.useEffect)((()=>(a?(window.addEventListener("mousemove",r),window.addEventListener("mouseup",h)):(window.removeEventListener("mousemove",r),window.removeEventListener("mouseup",h)),()=>{window.removeEventListener("mousemove",r),window.removeEventListener("mouseup",h)})),[r,h,a]),Object(Kd.jsx)("div",{className:"settings-input-range_handle",style:{left:100*t+"%"},onMouseDown:e=>{r(e),o(!0),e.stopPropagation()}})},vc=[mc,({value:e,meta:t,onSet:i})=>{const[n,a]=Object(s.useState)(!1);return Object(Kd.jsxs)("div",{className:"settings-input-enum",onMouseEnter:()=>a(!0),onMouseLeave:()=>a(!1),children:[t.labels[e],Object(Kd.jsx)("div",{className:"settings-input-enum_arrow",children:"\u25be"}),n&&Object(Kd.jsx)("div",{className:"settings-input-enum_options",children:t.labels.map(((e,t)=>Object(Kd.jsx)("div",{className:"settings-input-enum_option",onMouseDown:()=>i(t),children:e},e+t)))})]})},mc,mc,mc,({value:e,meta:t,onSet:i})=>{const[n,a]=Object(s.useState)(!1),o=Object(s.useRef)(null),r=Object(s.useCallback)((e=>{i(t.min+e*(t.max-t.min))}),[t,i]);let h=(e-t.min)/(t.max-t.min);return Object(Kd.jsxs)("div",{className:"settings-input-range",children:[Object(Kd.jsx)("div",{className:"settings-input-range_value",children:0==t.precision?Math.round(e):e.toFixed(t.precision||1)}),Object(Kd.jsx)("div",{ref:o,className:"settings-input-range_bar",onMouseDown:e=>{let t=e.target.getBoundingClientRect();r((e.clientX-t.left)/t.width),a(!0),e.stopPropagation(),e.preventDefault()},children:Object(Kd.jsx)(xc,{container:o,prop:h,meta:t,onSetProportion:r,dragging:n,setDragging:a})})]})}],wc=["Left Click","Middle Click","Right Click"],fc={StickySteer:"Steer lock (hold)",NextScene:"Next scene",PrevScene:"Previous scene",CameraMode:"Change camera view",ToggleHandbrake:"Toggle handbrake",ToggleUI:"Toggle UI",ToggleCinecam:"Toggle free cam",ToggleDebug:"Toggle debug overlay",DoubleSpeed:"Double Speed (hold)",ResetCamera:"Reset Camera to Vehicle",MatchSpeed:"Lock to vehicle speed (toggle)",ToggleSpeedControl:"Toggle cruise control",IncSpeedControl:"Increase cruise speed",DecSpeedControl:"Decrease cruise speed"},bc=({ico:e,selected:t,onMouseDown:i})=>Object(Kd.jsx)("div",{className:t?"settings-sidebar_option option-selected":"settings-sidebar_option",onMouseDown:i,children:Object(Kd.jsx)("img",{className:"settings-sidebar_option-icon",src:e,alt:""})}),Ac=({settings:e,meta:t,isCinecam:i})=>{let s=Object.keys(e.value),n=Object.keys(Ml.value);return Object(Kd.jsxs)("div",{className:"settings-input-list",children:[s.map((i=>Object(Kd.jsx)(yc,{settings:e,label:i,meta:t[i],onSet:t=>e.set(i,t)},"setting_"+i))),!i&&Object(Kd.jsxs)(Kd.Fragment,{children:[Object(Kd.jsx)("div",{className:"settings-input-row settings-input-list_section",children:"global settings"}),n.map((e=>Object(Kd.jsx)(yc,{settings:Ml,label:e,meta:Sl[e],onSet:t=>Ml.set(e,t)},"setting_"+e)))]})]})},yc=({settings:e,label:t,meta:i,onSet:n})=>{const[a,o]=Object(s.useState)(e.value[t]);Object(s.useEffect)((()=>(e.addListener(t,o),()=>{e.removeListener(t,o)})),[e,t,o]);const r=vc[i.type];return Object(Kd.jsxs)("div",{className:"settings-input-row",children:[Object(Kd.jsx)("div",{className:i.desc?"settings-input-label help":"settings-input-label",title:i.desc||"",children:i.readable||t}),Object(Kd.jsx)(r,{value:a,meta:i,onSet:n})]})},Ic=({map:e})=>{const t=e.value,[i,n]=Object(s.useState)([]);return Object(s.useEffect)((()=>{let e,i=[];for(let n in t){var s;if(e=t[n],0==D.value)0==(null===(s=e)||void 0===s?void 0:s.indexOf("Key"))&&(e=e.slice(3));else 1==D.value&&(e=e>2?"Mouse btn "+e:wc[e]);i.push([n,e])}n(i)}),[t,n]),Object(Kd.jsxs)("div",{className:"settings-input-list",children:[i.map((e=>Object(Kd.jsx)(Sc,{label:[e[0]],signal:e[1],onRequestReset:()=>{}},e[0]+"_"+e[1]))),Object(Kd.jsx)("br",{}),Object(Kd.jsx)("div",{className:"settings-input-list_section",children:"Other key bindings are as set in your Keyboard controls. Exit free cam to modify them."})]})},Sc=({label:e,signal:t,awaitingReset:i,onRequestReset:s,onClearInput:n,tickTime:a=null})=>{let o=null==a?0:Y.controllerSignal[e]||0;return Object(Kd.jsxs)("div",{className:"settings-input-row",children:[Object(Kd.jsx)("div",{className:"settings-input-label",children:fc[e]||e}),n&&Object(Kd.jsx)("div",{className:"settings-input-signal-clear",onMouseDown:t=>{t.stopPropagation(),t.preventDefault(),i?s(!1):n(e)},children:"x"}),i?Object(Kd.jsx)("div",{className:"settings-input-signal settings-input-signal-reset",onClick:e=>{s(null)},children:0==D.value?"press a key...":1==D.value?"click a button...":"press a control..."}):Object(Kd.jsxs)("div",{className:"settings-input-signal",onClick:()=>{s(e)},title:"Click to remap",children:[t,null!==a&&Object(Kd.jsx)("div",{className:"settings-input-signal-val",style:{width:100*o+"%"}})]})]})},Mc=[{map:b,settings:A,settingsMeta:y,mapPanel:({map:e})=>{const[t,i]=Object(s.useState)(e.value),[n,a]=Object(s.useState)([]),[o,r]=Object(s.useState)(null),h=Object(s.useCallback)((t=>{e.set({...e.value,[t]:null})}),[e]),l=Object(s.useCallback)((t=>{if(null!=o){for(let i in e.value)e.value[i]==t.code&&(e.value[i]=null);e.set({...e.value,[o]:t.code}),r(null)}}),[o,r,e]);return Object(s.useEffect)((()=>(i(e.value),e.addListener(i),()=>{e.removeListener(i)})),[e,i]),Object(s.useEffect)((()=>(null!=o?(w.lockKeys(),window.addEventListener("keydown",l)):(w.unlockKeys(),window.removeEventListener("keydown",l)),()=>{w.unlockKeys(),window.removeEventListener("keydown",l)})),[o,l]),Object(s.useEffect)((()=>{let e,i=[];for(let n in t){var s;if(e=t[n],0==D.value)0==(null===(s=e)||void 0===s?void 0:s.indexOf("Key"))&&(e=e.slice(3));else 1==D.value&&(e=e>2?"Mouse btn "+e:wc[e]);i.push([n,e])}a(i)}),[t,a]),Object(Kd.jsx)("div",{className:"settings-input-list",children:n.map((e=>Object(Kd.jsx)(Sc,{label:[e[0]],signal:e[1],awaitingReset:e[0]==o,onRequestReset:e=>{r(e)},onClearInput:h},e[0]+"_"+e[1])))})}},{map:g,settings:m,settingsMeta:x,mapPanel:({map:e})=>{const[t,i]=Object(s.useState)(e.value),[n,a]=Object(s.useState)([]),[o,r]=Object(s.useState)(null),h=Object(s.useCallback)((t=>{e.set({...e.value,[t]:null})}),[e]),l=Object(s.useCallback)((t=>{null!=o&&(e.set({...e.value,[o]:t.button}),r(null),t.preventDefault(),t.stopPropagation())}),[o,r,e]);return Object(s.useEffect)((()=>(i(e.value),e.addListener(i),()=>{e.removeListener(i)})),[e,i]),Object(s.useEffect)((()=>(null!=o?(w.lockKeys(),window.addEventListener("mousedown",l)):(w.unlockKeys(),window.removeEventListener("mousedown",l)),()=>{w.unlockKeys(),window.removeEventListener("mousedown",l)})),[o,l]),Object(s.useEffect)((()=>{let e,i=[];for(let s in t)e=t[s],e=e>2?"Mouse btn "+e:wc[e],i.push([s,e]);a(i)}),[t,a]),Object(Kd.jsx)("div",{className:"settings-input-list",children:n.map((e=>Object(Kd.jsx)(Sc,{label:[e[0]],signal:e[1],awaitingReset:e[0]==o,onRequestReset:e=>{null!==e&&(0==e&&(e=null),r(e))},onClearInput:h},e[0]+"_"+e[1])))})}},{map:T,settings:P,settingsMeta:G,mapPanel:({map:e})=>{const[t,i]=Object(s.useState)(e.value),[n,a]=Object(s.useState)([]),[o,r]=Object(s.useState)(null),[h,l]=Object(s.useState)(!1),[d,c]=Object(s.useState)(null!=navigator.getGamepads()[0]),[p,u]=Object(s.useState)(0),g=Object(s.useCallback)((t=>{e.set({...e.value,[t]:null})}),[e]),m=Object(s.useCallback)((()=>{c(!0)}),[c]),x=Object(s.useCallback)((()=>{c(!1)}),[c]);return Object(s.useEffect)((()=>(window.addEventListener("gamepadconnected",m),window.addEventListener("gamepaddisconnected",x),()=>{window.removeEventListener("gamepadconnected",m),window.removeEventListener("gamepaddisconnected",x)})),[m,x,c]),Object(s.useEffect)((()=>(ae.addSlowListener(u),()=>{ae.removeSlowListener(u)})),[u]),Object(s.useEffect)((()=>(i(e.value),e.addListener(i),()=>{e.removeListener(i)})),[e,i]),Object(s.useEffect)((()=>{null!=o?Y.initGamepadRemap((()=>r(null)),o):Y.cancelGamepadRemap()}),[o,r]),Object(s.useEffect)((()=>{let e,i=[];for(let s in t)e="",t[s]&&(t[s].type==j?e="Btn "+t[s].index:(e="Axis "+t[s].index,t[s].sign>0?e+=" (+)":e+=" (-)")),i.push([s,e]);a(i)}),[t,a]),d?Object(Kd.jsx)("div",{className:"settings-input-list",children:n.map((e=>Object(Kd.jsx)(Sc,{label:[e[0]],signal:e[1],awaitingReset:e[0]==o,onRequestReset:e=>{r(e)},onClearInput:g,tickTime:p},e[0]+"_"+e[1])))}):Object(Kd.jsxs)("div",{className:"settings-input-missing",children:["No gamepad detected - check the connection then click below to re-attempt",Object(Kd.jsx)("br",{}),Object(Kd.jsx)("div",{className:"settings-input-missing-check",onClick:()=>{l(!1),null!==navigator.getGamepads()[0]?c(!0):setTimeout((()=>l(!0)),150)},children:"Try Again"}),h&&Object(Kd.jsx)("div",{className:"settings-input-missing-check-fail",children:"No gamepad found"})]})}}];var Dc=({onMouseEnter:e,onMouseLeave:t,onMouseDown:i})=>{const[n,a]=Object(s.useState)(D.value),[o,r]=Object(s.useState)(z.value),[h,l]=Object(s.useState)(0),[d,c]=Object(s.useState)(!1);Object(s.useEffect)((()=>(z.addListener(r),()=>{z.removeListener(r)})),[r]),Object(s.useEffect)((()=>(D.addListener(a),()=>{D.removeListener(a)})),[a]);let p=o?Ic:Mc[n].mapPanel;return Object(Kd.jsxs)("div",{className:"settings-sidebar",onMouseEnter:e,onMouseLeave:t,onMouseDown:i,children:[o?Object(Kd.jsx)("div",{className:"settings-sidebar_options",children:Object(Kd.jsx)(bc,{ico:gc,selected:0==n,onMouseDown:()=>{}})}):Object(Kd.jsxs)("div",{className:"settings-sidebar_options",children:[Object(Kd.jsx)(bc,{ico:cc,selected:0==n,onMouseDown:()=>D.set(0)}),Object(Kd.jsx)(bc,{ico:pc,selected:1==n,onMouseDown:()=>D.set(1)}),Object(Kd.jsx)(bc,{ico:uc,selected:2==n,onMouseDown:()=>D.set(2)})]}),Object(Kd.jsxs)("div",{className:"settings-sidebar_tabs",children:[Object(Kd.jsx)("div",{className:"settings-sidebar_tab "+(0==h?"option-selected":""),onMouseDown:()=>l(0),children:"controls"}),Object(Kd.jsx)("div",{className:"settings-sidebar_tab "+(1==h?"option-selected":""),onMouseDown:()=>l(1),children:"settings"})]}),Object(Kd.jsx)("div",{className:"settings-sidebar_content",children:0==h?Object(Kd.jsx)(p,{map:o?C:Mc[n].map,isCinecam:o}):Object(Kd.jsx)(Ac,{settings:o?N:Mc[n].settings,meta:o?k:Mc[n].settingsMeta,isCinecam:o})}),0==o&&Object(Kd.jsx)("div",{className:"settings-sidebar_tab option-selected",style:{borderTop:"3px solid #111",borderBottom:"3px solid #111",color:"#888",fontWeight:d?"1000":""},onClick:()=>{d?(0==h?Mc[n].map.reset():Mc[n].settings.reset(),c(!1)):c(!0)},children:d?"click again to confirm reset":"reset all to default"})]})};const Cc={General:{state:te,meta:$,collapsed:!1},Graphics:{state:Sh,meta:yh,collapsed:!1},Vehicle:{state:We,meta:Ge,collapsed:!1},Audio:{state:$s,meta:Ks,collapsed:!0}},Nc=({label:e,section:t,startCollapsed:i=!1})=>{const[n,a]=Object(s.useState)(t.collapsed);let o=Object.keys(t.meta);return Object(Kd.jsxs)(Kd.Fragment,{children:[Object(Kd.jsxs)("div",{className:"settings-input-row settings-input-list_section collapsible",onMouseDown:()=>{t.collapsed=!n,a(!n)},children:[Object(Kd.jsx)("div",{className:"collapsible-title",children:e}),Object(Kd.jsx)("div",{className:"collapsible-cross",children:t.collapsed?"+":"-"})]}),!n&&o.map(((i,s)=>Object(Kd.jsx)(kc,{settings:t.state,label:i,meta:t.meta[i]},e+"_"+s)))]})},kc=({settings:e,label:t,meta:i})=>{const[n,a]=Object(s.useState)(e.value[t]);Object(s.useEffect)((()=>(e.addListener(t,a),()=>{e.removeListener(t,a)})),[e,t,a]);const o=vc[i.type];return Object(Kd.jsxs)("div",{className:"settings-input-row",children:[Object(Kd.jsx)("div",{className:i.desc?"settings-input-label help":"settings-input-label",title:i.desc||"",children:i.readable||t}),Object(Kd.jsx)(o,{value:n,meta:i,onSet:i.onSet})]})};var zc=({onMouseEnter:e,onMouseLeave:t,onMouseDown:i})=>Object(Kd.jsx)("div",{className:"settings-sidebar",onMouseEnter:e,onMouseLeave:t,onMouseDown:i,children:Object(Kd.jsx)("div",{className:"settings-sidebar_content",children:Object(Kd.jsxs)("div",{className:"settings-input-list",children:[Object(Kd.jsx)(Nc,{label:"general",section:Cc.General}),Object(Kd.jsx)(Nc,{label:"graphics",section:Cc.Graphics}),Object(Kd.jsx)(Nc,{label:"vehicle",section:Cc.Vehicle}),Object(Kd.jsx)(Nc,{label:"audio",section:Cc.Audio})]})})}),jc=i.p+"static/media/globe.0021026f.svg",Lc=i.p+"static/media/config.fa1e0797.svg",Oc=i.p+"static/media/v_config_1.45a9fb9a.svg",Rc=i.p+"static/media/w_clear.e325f7bb.svg",Tc=i.p+"static/media/w_sunset.6daecb38.svg",Pc=i.p+"static/media/w_sunrise.d42cfd8c.svg",Gc=i.p+"static/media/w_cloud.126a5129.svg",Bc=i.p+"static/media/w_night.c1e24675.svg",Wc=i.p+"static/media/cycle_timer.e67c5684.svg",Fc=i.p+"static/media/s_winter.a14698ea.svg",Ec=i.p+"static/media/s_spring.9771ab1e.svg",Zc=i.p+"static/media/s_summer.eea0686a.svg",Hc=i.p+"static/media/s_autumn.76993205.svg",Qc=i.p+"static/media/mars.4b77b21a.svg",Yc=i.p+"static/media/s_moon.ef286549.svg",Vc=i.p+"static/media/venus.7fd51f92.svg",Uc=i.p+"static/media/panorama.568dc952.svg",Xc=i.p+"static/media/favicon_circle_white.eb1953e3.svg",Jc=(i.p,i.p,i.p,i.p+"static/media/loc_hills_lines.39f0c4cc.png"),qc=i.p+"static/media/loc_offworld.5e298b5e.png",Kc=(i(46),i.p+"static/media/vol_high.30de055e.svg"),_c=i.p+"static/media/vol_off.11497865.svg";const $c=({container:e,level:t,setLevel:i,dragging:n,setDragging:a})=>{const o=Object(s.useCallback)((t=>{if(e.current){let s=e.current.getBoundingClientRect();i(Math.min(Math.max(0,(s.bottom-t.clientY)/s.height),1))}t.stopPropagation()}),[e,i]),r=Object(s.useCallback)((()=>{a(!1)}),[a]);return Object(s.useEffect)((()=>(n?(window.addEventListener("mousemove",o),window.addEventListener("mouseup",r)):(window.removeEventListener("mousemove",o),window.removeEventListener("mouseup",r)),()=>{window.removeEventListener("mousemove",o),window.removeEventListener("mouseup",r)})),[o,r,n]),Object(Kd.jsx)("div",{id:"slider-handle",style:{top:100*(1-t)+"%"},onMouseDown:e=>{o(e),a(!0),e.stopPropagation()}})};var ep=({requestFocus:e})=>{const[t,i]=Object(s.useState)(te.AudioLevel),[n,a]=Object(s.useState)(t>0),[o,r]=Object(s.useState)(.5),[h,l]=Object(s.useState)(!1),d=Object(s.useRef)(null);return Object(s.useEffect)((()=>{a(t<=0)}),[a,t]),Object(s.useEffect)((()=>{te.set(J.AudioLevel,t)}),[t]),Object(s.useEffect)((()=>(te.addListener(J.AudioLevel,i),()=>{te.removeListener(J.AudioLevel,i)})),[i]),Object(Kd.jsx)(fp,{icon:n?_c:Kc,expanded:!!h,onMouseDown:e=>{n?i(0==o?.5:o):(r(t),i(0)),e.stopPropagation()},onExpanded:t=>{t&&e()},children:Object(Kd.jsx)("div",{id:"slider-container",ref:d,children:Object(Kd.jsx)("div",{id:"slider-line",onMouseDown:e=>{let t=e.target.getBoundingClientRect();i((t.bottom-e.clientY)/t.height),l(!0),e.stopPropagation()},children:Object(Kd.jsx)($c,{level:t,setLevel:i,dragging:h,setDragging:l,container:d})})})})};const tp=[cc,pc,uc],ip={clearSnow:Rc,clearSpring:Rc,clearAutumn:Rc,sunset:Tc,twilight:Tc,autumnSunset:Tc,winterSunset:Tc,autumnSunrise:Pc,winterSunrise:Pc,springSunrise:Pc,sunrise:Pc,clear:Rc,rain:Gc,autumnRain:Gc,springRain:Gc,snow:Gc,mars:Rc,venus:Gc,night:Bc,nightSnow:Bc,marsRise:Tc,venusSet:Tc,moon:Rc},sp={spring:Ec,summer:Zc,autumn:Hc,winter:Fc,mars:Qc,venus:Vc,moon:Yc},np=n.a.memo((({toggleSplash:e})=>Object(Kd.jsx)(Kd.Fragment,{children:Object(Kd.jsxs)("div",{id:"menu-bar",onMouseEnter:()=>{w.setMouseEnabled(!1)},onMouseLeave:()=>{w.setMouseEnabled(!0)},children:[Object(Kd.jsx)(ap,{}),Object(Kd.jsx)(gp,{toggleSplash:e})]})}))),ap=()=>Object(Kd.jsxs)("div",{id:"menu-bar-left",children:[Object(Kd.jsx)(op,{}),Object(Kd.jsx)("div",{className:"menu-bar-vertical-divider"}),Object(Kd.jsx)(pp,{}),Object(Kd.jsx)(up,{})]}),op=()=>{const[e,t]=Object(s.useState)(!1),[i,n]=Object(s.useState)(Ee),[a,o]=Object(s.useState)(Sh.value.sceneName),[r,h]=Object(s.useState)(Sh.value.topography),[l,d]=Object(s.useState)(!1),[c,p]=Object(s.useState)(!1),[u,g]=Object(s.useState)(!1),[m,x]=Object(s.useState)(Ee),[v,w]=Object(s.useState)(Sh.value.sceneName),[f,b]=Object(s.useState)(Sh.value.topography),[A,y]=Object(s.useState)(!1);return Object(s.useEffect)((()=>{t(l||c||u)}),[t,l,c,u]),Object(s.useEffect)((()=>{d(m!==i)}),[d,m,i]),Object(s.useEffect)((()=>{p(v!==a)}),[p,v,a]),Object(s.useEffect)((()=>{g(f!==r)}),[g,f,r]),Object(Kd.jsx)(Kd.Fragment,{children:Object(Kd.jsxs)("div",{className:"menu-item",tabIndex:-1,onMouseEnter:()=>{y(!0)},onMouseLeave:()=>{y(!1)},children:[Object(Kd.jsx)(lp,{src:jc}),A&&Object(Kd.jsxs)("div",{className:"menu-panel",children:[Object(Kd.jsx)("div",{className:"menu-panel-row menu-panel-title",style:{color:c?"#fff":"",textShadow:c?"0px 0px 5px #fff":""},children:"scene"}),Object(Kd.jsx)(hp,{options:["HILLS","OFF-WORLD"],bgs:[Jc,qc],selectedIndex:vh.indexOf(v),onSelectIndex:e=>{e<2&&w(vh[e])}}),Object(Kd.jsx)("div",{className:"menu-panel-row menu-panel-title",style:{color:u?"#fff":"",textShadow:u?"0px 0px 5px #fff":""},children:"road complexity"}),Object(Kd.jsx)(hp,{options:["STRAIGHT","CASUAL","EASY","NORMAL","HARD"],bgs:["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAARgAAAA8CAYAAAC9xKUYAAAACXBIWXMAAAsTAAALEwEAmpwYAAAGkGlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgOS4wLWMwMDAgNzkuMTcxYzI3ZiwgMjAyMi8wOC8xNi0xODowMjo0MyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RFdnQ9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZUV2ZW50IyIgeG1sbnM6ZGM9Imh0dHA6Ly9wdXJsLm9yZy9kYy9lbGVtZW50cy8xLjEvIiB4bWxuczpwaG90b3Nob3A9Imh0dHA6Ly9ucy5hZG9iZS5jb20vcGhvdG9zaG9wLzEuMC8iIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTkgKFdpbmRvd3MpIiB4bXA6Q3JlYXRlRGF0ZT0iMjAyMi0wNy0yMFQxODoyNjo1MCswMTowMCIgeG1wOk1ldGFkYXRhRGF0ZT0iMjAyMi0xMi0xOVQxNzo0Mjo0MVoiIHhtcDpNb2RpZnlEYXRlPSIyMDIyLTEyLTE5VDE3OjQyOjQxWiIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDpjMWZkNWU2My03NDI2LWI3NGMtYTNjYy1mNDk2MDg2NGYxNGYiIHhtcE1NOkRvY3VtZW50SUQ9ImFkb2JlOmRvY2lkOnBob3Rvc2hvcDpkN2ZkMWIzMS1kMDBmLTBhNGUtYjBmMS01ZTFiNzU3MWNmYzYiIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDpkN2RiZGM1Zi02OTcwLWYyNGQtOGVjYi1kY2U0NDQ1NWNmMTgiIGRjOmZvcm1hdD0iaW1hZ2UvcG5nIiBwaG90b3Nob3A6Q29sb3JNb2RlPSIzIj4gPHhtcE1NOkhpc3Rvcnk+IDxyZGY6U2VxPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0iY3JlYXRlZCIgc3RFdnQ6aW5zdGFuY2VJRD0ieG1wLmlpZDpkN2RiZGM1Zi02OTcwLWYyNGQtOGVjYi1kY2U0NDQ1NWNmMTgiIHN0RXZ0OndoZW49IjIwMjItMDctMjBUMTg6MjY6NTArMDE6MDAiIHN0RXZ0OnNvZnR3YXJlQWdlbnQ9IkFkb2JlIFBob3Rvc2hvcCBDQyAyMDE5IChXaW5kb3dzKSIvPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0ic2F2ZWQiIHN0RXZ0Omluc3RhbmNlSUQ9InhtcC5paWQ6NWJlMDMwNDYtMmI1OS1kNzQ1LTkxNTItNGEyMzJjYjFiMjQ3IiBzdEV2dDp3aGVuPSIyMDIyLTA3LTIwVDE4OjI2OjUwKzAxOjAwIiBzdEV2dDpzb2Z0d2FyZUFnZW50PSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOSAoV2luZG93cykiIHN0RXZ0OmNoYW5nZWQ9Ii8iLz4gPHJkZjpsaSBzdEV2dDphY3Rpb249InNhdmVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOmMxZmQ1ZTYzLTc0MjYtYjc0Yy1hM2NjLWY0OTYwODY0ZjE0ZiIgc3RFdnQ6d2hlbj0iMjAyMi0xMi0xOVQxNzo0Mjo0MVoiIHN0RXZ0OnNvZnR3YXJlQWdlbnQ9IkFkb2JlIFBob3Rvc2hvcCAyNC4wIChXaW5kb3dzKSIgc3RFdnQ6Y2hhbmdlZD0iLyIvPiA8L3JkZjpTZXE+IDwveG1wTU06SGlzdG9yeT4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz7yvX13AAAAwUlEQVR42u3asQ3AIAxEUZepqAn773lMYRSUV7wFztKvXEkKoIMRAIEBBAZAYACBAQQGQGAAgQEEBkBgAIEBBAZAYACBAQQGQGAAgQEEBkBgAIEBBAZAYACBAQQGQGCAKwIzADpUkgXQQWAAgQEEBkBggDOBmVzptYF7fl0leQA6eAYCfPICAgMgMIDAAAIDIDCAwAACAyAwgMAAAgMgMIDAAAIDIDCAwAACAyAwgMAAAgMgMIDAAAIDIDCAwAD/tQGalucfXEH8mwAAAABJRU5ErkJggg==","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAARgAAAA8CAYAAAC9xKUYAAAACXBIWXMAAAsTAAALEwEAmpwYAAAGkGlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgOS4wLWMwMDAgNzkuMTcxYzI3ZiwgMjAyMi8wOC8xNi0xODowMjo0MyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RFdnQ9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZUV2ZW50IyIgeG1sbnM6ZGM9Imh0dHA6Ly9wdXJsLm9yZy9kYy9lbGVtZW50cy8xLjEvIiB4bWxuczpwaG90b3Nob3A9Imh0dHA6Ly9ucy5hZG9iZS5jb20vcGhvdG9zaG9wLzEuMC8iIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTkgKFdpbmRvd3MpIiB4bXA6Q3JlYXRlRGF0ZT0iMjAyMi0wNy0yMFQxODoyNjo1MCswMTowMCIgeG1wOk1ldGFkYXRhRGF0ZT0iMjAyMi0xMi0xOVQxNzo0MjoyNFoiIHhtcDpNb2RpZnlEYXRlPSIyMDIyLTEyLTE5VDE3OjQyOjI0WiIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozYWRjY2Y0OS1kNWYyLTBlNDYtOWM4NS02MDU4ZDJmM2Q3YTIiIHhtcE1NOkRvY3VtZW50SUQ9ImFkb2JlOmRvY2lkOnBob3Rvc2hvcDo3MjIyMDVhZS0wNmM4LTdlNGItYjBiNS02OTIyNmQ3YWM0NGEiIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDpkN2RiZGM1Zi02OTcwLWYyNGQtOGVjYi1kY2U0NDQ1NWNmMTgiIGRjOmZvcm1hdD0iaW1hZ2UvcG5nIiBwaG90b3Nob3A6Q29sb3JNb2RlPSIzIj4gPHhtcE1NOkhpc3Rvcnk+IDxyZGY6U2VxPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0iY3JlYXRlZCIgc3RFdnQ6aW5zdGFuY2VJRD0ieG1wLmlpZDpkN2RiZGM1Zi02OTcwLWYyNGQtOGVjYi1kY2U0NDQ1NWNmMTgiIHN0RXZ0OndoZW49IjIwMjItMDctMjBUMTg6MjY6NTArMDE6MDAiIHN0RXZ0OnNvZnR3YXJlQWdlbnQ9IkFkb2JlIFBob3Rvc2hvcCBDQyAyMDE5IChXaW5kb3dzKSIvPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0ic2F2ZWQiIHN0RXZ0Omluc3RhbmNlSUQ9InhtcC5paWQ6NWJlMDMwNDYtMmI1OS1kNzQ1LTkxNTItNGEyMzJjYjFiMjQ3IiBzdEV2dDp3aGVuPSIyMDIyLTA3LTIwVDE4OjI2OjUwKzAxOjAwIiBzdEV2dDpzb2Z0d2FyZUFnZW50PSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOSAoV2luZG93cykiIHN0RXZ0OmNoYW5nZWQ9Ii8iLz4gPHJkZjpsaSBzdEV2dDphY3Rpb249InNhdmVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOjNhZGNjZjQ5LWQ1ZjItMGU0Ni05Yzg1LTYwNThkMmYzZDdhMiIgc3RFdnQ6d2hlbj0iMjAyMi0xMi0xOVQxNzo0MjoyNFoiIHN0RXZ0OnNvZnR3YXJlQWdlbnQ9IkFkb2JlIFBob3Rvc2hvcCAyNC4wIChXaW5kb3dzKSIgc3RFdnQ6Y2hhbmdlZD0iLyIvPiA8L3JkZjpTZXE+IDwveG1wTU06SGlzdG9yeT4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz59L7euAAAH30lEQVR42u2dyZqqMBCF9bazyKCA0O//nnU3J59pBCEhDIlnUasWaZPKn5pS2YjIJmD5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","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAARgAAAA8CAYAAAC9xKUYAAAACXBIWXMAAAsTAAALEwEAmpwYAAAGymlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDUgNzkuMTYzNDk5LCAyMDE4LzA4LzEzLTE2OjQwOjIyICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdEV2dD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlRXZlbnQjIiB4bWxuczpkYz0iaHR0cDovL3B1cmwub3JnL2RjL2VsZW1lbnRzLzEuMS8iIHhtbG5zOnBob3Rvc2hvcD0iaHR0cDovL25zLmFkb2JlLmNvbS9waG90b3Nob3AvMS4wLyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOSAoV2luZG93cykiIHhtcDpDcmVhdGVEYXRlPSIyMDIyLTA3LTIwVDE4OjI2OjUwKzAxOjAwIiB4bXA6TWV0YWRhdGFEYXRlPSIyMDIyLTA3LTIwVDIyOjI1OjI3KzAxOjAwIiB4bXA6TW9kaWZ5RGF0ZT0iMjAyMi0wNy0yMFQyMjoyNToyNyswMTowMCIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDpiMDMwZWJhNi0zM2ExLTczNGEtOWVmYS1mNWNiZTYxOGUwNmUiIHhtcE1NOkRvY3VtZW50SUQ9ImFkb2JlOmRvY2lkOnBob3Rvc2hvcDo1NWZiMTAyYi03OTQxLWIxNGQtYWMzYi1hOGQwN2QzNjRhOTkiIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDpkN2RiZGM1Zi02OTcwLWYyNGQtOGVjYi1kY2U0NDQ1NWNmMTgiIGRjOmZvcm1hdD0iaW1hZ2UvcG5nIiBwaG90b3Nob3A6Q29sb3JNb2RlPSIzIiBwaG90b3Nob3A6SUNDUHJvZmlsZT0ic1JHQiBJRUM2MTk2Ni0yLjEiPiA8eG1wTU06SGlzdG9yeT4gPHJkZjpTZXE+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJjcmVhdGVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOmQ3ZGJkYzVmLTY5NzAtZjI0ZC04ZWNiLWRjZTQ0NDU1Y2YxOCIgc3RFdnQ6d2hlbj0iMjAyMi0wNy0yMFQxODoyNjo1MCswMTowMCIgc3RFdnQ6c29mdHdhcmVBZ2VudD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTkgKFdpbmRvd3MpIi8+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJzYXZlZCIgc3RFdnQ6aW5zdGFuY2VJRD0ieG1wLmlpZDo1YmUwMzA0Ni0yYjU5LWQ3NDUtOTE1Mi00YTIzMmNiMWIyNDciIHN0RXZ0OndoZW49IjIwMjItMDctMjBUMTg6MjY6NTArMDE6MDAiIHN0RXZ0OnNvZnR3YXJlQWdlbnQ9IkFkb2JlIFBob3Rvc2hvcCBDQyAyMDE5IChXaW5kb3dzKSIgc3RFdnQ6Y2hhbmdlZD0iLyIvPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0ic2F2ZWQiIHN0RXZ0Omluc3RhbmNlSUQ9InhtcC5paWQ6YjAzMGViYTYtMzNhMS03MzRhLTllZmEtZjVjYmU2MThlMDZlIiBzdEV2dDp3aGVuPSIyMDIyLTA3LTIwVDIyOjI1OjI3KzAxOjAwIiBzdEV2dDpzb2Z0d2FyZUFnZW50PSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOSAoV2luZG93cykiIHN0RXZ0OmNoYW5nZWQ9Ii8iLz4gPC9yZGY6U2VxPiA8L3htcE1NOkhpc3Rvcnk+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+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","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAARgAAAA8CAYAAAC9xKUYAAAACXBIWXMAAAsTAAALEwEAmpwYAAAGymlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDUgNzkuMTYzNDk5LCAyMDE4LzA4LzEzLTE2OjQwOjIyICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdEV2dD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlRXZlbnQjIiB4bWxuczpkYz0iaHR0cDovL3B1cmwub3JnL2RjL2VsZW1lbnRzLzEuMS8iIHhtbG5zOnBob3Rvc2hvcD0iaHR0cDovL25zLmFkb2JlLmNvbS9waG90b3Nob3AvMS4wLyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOSAoV2luZG93cykiIHhtcDpDcmVhdGVEYXRlPSIyMDIyLTA3LTIwVDE4OjI2OjUwKzAxOjAwIiB4bXA6TWV0YWRhdGFEYXRlPSIyMDIyLTA3LTIwVDIyOjI0OjE5KzAxOjAwIiB4bXA6TW9kaWZ5RGF0ZT0iMjAyMi0wNy0yMFQyMjoyNDoxOSswMTowMCIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDpkOGQzZTNhOC1lZTRkLWRmNDYtOTc0MS00YThkOGZmNDVmYjYiIHhtcE1NOkRvY3VtZW50SUQ9ImFkb2JlOmRvY2lkOnBob3Rvc2hvcDo2MDk3Y2Y0Zi01MzRhLTA5NGMtYjg1MS03NDAzODQ1NjM5YjciIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDpkN2RiZGM1Zi02OTcwLWYyNGQtOGVjYi1kY2U0NDQ1NWNmMTgiIGRjOmZvcm1hdD0iaW1hZ2UvcG5nIiBwaG90b3Nob3A6Q29sb3JNb2RlPSIzIiBwaG90b3Nob3A6SUNDUHJvZmlsZT0ic1JHQiBJRUM2MTk2Ni0yLjEiPiA8eG1wTU06SGlzdG9yeT4gPHJkZjpTZXE+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJjcmVhdGVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOmQ3ZGJkYzVmLTY5NzAtZjI0ZC04ZWNiLWRjZTQ0NDU1Y2YxOCIgc3RFdnQ6d2hlbj0iMjAyMi0wNy0yMFQxODoyNjo1MCswMTowMCIgc3RFdnQ6c29mdHdhcmVBZ2VudD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTkgKFdpbmRvd3MpIi8+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJzYXZlZCIgc3RFdnQ6aW5zdGFuY2VJRD0ieG1wLmlpZDo1YmUwMzA0Ni0yYjU5LWQ3NDUtOTE1Mi00YTIzMmNiMWIyNDciIHN0RXZ0OndoZW49IjIwMjItMDctMjBUMTg6MjY6NTArMDE6MDAiIHN0RXZ0OnNvZnR3YXJlQWdlbnQ9IkFkb2JlIFBob3Rvc2hvcCBDQyAyMDE5IChXaW5kb3dzKSIgc3RFdnQ6Y2hhbmdlZD0iLyIvPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0ic2F2ZWQiIHN0RXZ0Omluc3RhbmNlSUQ9InhtcC5paWQ6ZDhkM2UzYTgtZWU0ZC1kZjQ2LTk3NDEtNGE4ZDhmZjQ1ZmI2IiBzdEV2dDp3aGVuPSIyMDIyLTA3LTIwVDIyOjI0OjE5KzAxOjAwIiBzdEV2dDpzb2Z0d2FyZUFnZW50PSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOSAoV2luZG93cykiIHN0RXZ0OmNoYW5nZWQ9Ii8iLz4gPC9yZGY6U2VxPiA8L3htcE1NOkhpc3Rvcnk+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+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","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAARgAAAA8CAYAAAC9xKUYAAAACXBIWXMAAAsTAAALEwEAmpwYAAAGymlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDUgNzkuMTYzNDk5LCAyMDE4LzA4LzEzLTE2OjQwOjIyICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdEV2dD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlRXZlbnQjIiB4bWxuczpkYz0iaHR0cDovL3B1cmwub3JnL2RjL2VsZW1lbnRzLzEuMS8iIHhtbG5zOnBob3Rvc2hvcD0iaHR0cDovL25zLmFkb2JlLmNvbS9waG90b3Nob3AvMS4wLyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOSAoV2luZG93cykiIHhtcDpDcmVhdGVEYXRlPSIyMDIyLTA3LTIwVDE4OjI2OjUwKzAxOjAwIiB4bXA6TWV0YWRhdGFEYXRlPSIyMDIyLTA3LTIwVDIyOjIzOjI2KzAxOjAwIiB4bXA6TW9kaWZ5RGF0ZT0iMjAyMi0wNy0yMFQyMjoyMzoyNiswMTowMCIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDpmMjI5ZmVhYS1kM2Q5LTI3NDktOTMxYy1hOTcxZmNiNGUwMzkiIHhtcE1NOkRvY3VtZW50SUQ9ImFkb2JlOmRvY2lkOnBob3Rvc2hvcDowMWQxODExZC1hNjczLTc5NDctOGU1ZS0yYTc5OWE4MjVlMzUiIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDpkN2RiZGM1Zi02OTcwLWYyNGQtOGVjYi1kY2U0NDQ1NWNmMTgiIGRjOmZvcm1hdD0iaW1hZ2UvcG5nIiBwaG90b3Nob3A6Q29sb3JNb2RlPSIzIiBwaG90b3Nob3A6SUNDUHJvZmlsZT0ic1JHQiBJRUM2MTk2Ni0yLjEiPiA8eG1wTU06SGlzdG9yeT4gPHJkZjpTZXE+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJjcmVhdGVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOmQ3ZGJkYzVmLTY5NzAtZjI0ZC04ZWNiLWRjZTQ0NDU1Y2YxOCIgc3RFdnQ6d2hlbj0iMjAyMi0wNy0yMFQxODoyNjo1MCswMTowMCIgc3RFdnQ6c29mdHdhcmVBZ2VudD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTkgKFdpbmRvd3MpIi8+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJzYXZlZCIgc3RFdnQ6aW5zdGFuY2VJRD0ieG1wLmlpZDo1YmUwMzA0Ni0yYjU5LWQ3NDUtOTE1Mi00YTIzMmNiMWIyNDciIHN0RXZ0OndoZW49IjIwMjItMDctMjBUMTg6MjY6NTArMDE6MDAiIHN0RXZ0OnNvZnR3YXJlQWdlbnQ9IkFkb2JlIFBob3Rvc2hvcCBDQyAyMDE5IChXaW5kb3dzKSIgc3RFdnQ6Y2hhbmdlZD0iLyIvPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0ic2F2ZWQiIHN0RXZ0Omluc3RhbmNlSUQ9InhtcC5paWQ6ZjIyOWZlYWEtZDNkOS0yNzQ5LTkzMWMtYTk3MWZjYjRlMDM5IiBzdEV2dDp3aGVuPSIyMDIyLTA3LTIwVDIyOjIzOjI2KzAxOjAwIiBzdEV2dDpzb2Z0d2FyZUFnZW50PSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOSAoV2luZG93cykiIHN0RXZ0OmNoYW5nZWQ9Ii8iLz4gPC9yZGY6U2VxPiA8L3htcE1NOkhpc3Rvcnk+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+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"],selectedIndex:wh.indexOf(f),onSelectIndex:e=>b(wh[e])}),Object(Kd.jsx)("div",{className:"menu-panel-row menu-panel-title",style:{color:l?"#fff":"",textShadow:l?"0px 0px 5px #fff":""},children:"generation seed"}),Object(Kd.jsx)(rp,{curValue:m,onChanged:x}),Object(Kd.jsx)("div",{className:"menu-panel-row menu-panel-title",children:e&&Object(Kd.jsx)("div",{className:"menu-apply-arrows arrows-down",children:"\u25be \u25be \u25be"})}),Object(Kd.jsx)("div",{className:"menu-panel-row menu-apply-row",children:Object(Kd.jsx)("div",{id:"menu-apply",className:e?"menu-panel-button":"menu-panel-button-inactive",onMouseDown:()=>{e&&(l?(Ye(m),Sh.set("topography",f,!0),Sh.set("sceneName",v,!0),Sh.set("seed",m)):c?(Sh.set("topography",f,!0),Sh.set("sceneName",v)):Sh.set("topography",f),n(Ee),h(f),o(v))},children:"apply changes"})}),Object(Kd.jsx)("div",{className:"menu-panel-row menu-panel-title",children:e&&Object(Kd.jsx)("div",{className:"menu-apply-arrows arrows-up",children:"\u25b4 \u25b4 \u25b4"})})]})]})})},rp=({curValue:e,onChanged:t})=>{const[i,n]=Object(s.useState)(e),[a,o]=Object(s.useState)(!1);return Object(s.useEffect)((()=>{o(!Ve(i))}),[o,i]),Object(s.useEffect)((()=>{a&&t(i)}),[a,t,i]),Object(s.useEffect)((()=>()=>{let e=document.getElementById("game-main");e&&e.focus(),w.unlockKeys()}),[]),Object(Kd.jsx)("div",{className:"menu-panel-row",children:Object(Kd.jsx)("input",{className:a||0==i.length?"seed-input":"seed-input seed-invalid",tabIndex:1,placeholder:"seed",value:i,maxLength:32,onChange:e=>n(e.target.value),onKeyDown:e=>{13==e.which&&e.target.blur()},onFocus:()=>{w.lockKeys()},onBlur:()=>{a||n(Ee),w.unlockKeys()}})})},hp=({options:e,bgs:t,selectedIndex:i,onSelectIndex:n})=>{const[a,o]=Object(s.useState)(!1);return Object(Kd.jsxs)("div",{className:"menu-panel-row",style:t?{backgroundImage:"url("+t[i]+")"}:{},onMouseEnter:()=>o(!0),onMouseLeave:()=>o(!1),children:[Object(Kd.jsxs)("div",{className:"",children:[e[i],Object(Kd.jsx)("div",{className:"menu-panel-row-expand",style:{opacity:a?1:.75},children:"\u25b8"})]}),a&&Object(Kd.jsxs)("div",{className:"menu-panel-option-list",style:{transform:"translateY(-"+(31*e.length-31)+"px)"},children:[e.map(((e,i)=>Object(Kd.jsx)("div",{className:"menu-panel-option-list-row",style:t?{backgroundImage:"url("+t[i]+")"}:{},onClick:()=>n(i),children:e},"option-"+e))),Object(Kd.jsx)("div",{className:"panel-expander"})]})]})},lp=({src:e,text:t,onMouseDown:i,highlight:s})=>t?Object(Kd.jsx)("div",{className:s?"menu-icon-text highlight":"menu-icon-text",onMouseDown:i,children:t}):Object(Kd.jsx)("img",{className:s?"menu-icon highlight":"menu-icon",src:e,alt:"",width:"50%",onMouseDown:i}),dp=()=>{const[e,t]=Object(s.useState)(qs.value);return Object(s.useEffect)((()=>(qs.addListener(t),()=>{qs.removeListener(t)})),[t]),Object(Kd.jsx)("div",{style:{borderTop:"1px solid #fff4"},children:Object(Kd.jsxs)(Ap,{selected:!1,icon:Wc,label:"cycle timer",children:[Object(Kd.jsx)(Ip,{selected:0==e,text:"off",onMouseDown:()=>qs.set(0)}),Object(Kd.jsx)(Ip,{selected:1==e,text:"3m",onMouseDown:()=>qs.set(1)}),Object(Kd.jsx)(Ip,{selected:2==e,text:"8m",onMouseDown:()=>qs.set(2)}),Object(Kd.jsx)(Ip,{selected:3==e,text:"15m",onMouseDown:()=>qs.set(3)})]})})},cp=({canSelect:e,configKey:t,configVal:i,icon:n,onMouseDown:a})=>{const[o,r]=Object(s.useState)(Sh.value[t]);return Object(s.useEffect)((()=>(Sh.addListener(t,r),()=>{Sh.removeListener(t,r)})),[t]),Object(Kd.jsx)(Ip,{selected:o==i&&e,icon:n,onMouseDown:a})},pp=()=>{const[e,t]=Object(s.useState)(Sh.sceneMeta.scenes[Sh.sceneMeta.current]),[i,n]=Object(s.useState)(Sh.value.skin),a=Object(s.useCallback)((()=>{t(Sh.sceneMeta.scenes[Sh.value.sceneName]),n("default")}),[t]);Object(s.useEffect)((()=>(Sh.addListener("sceneName",a),()=>{Sh.removeListener("sceneName",a)})),[a]),Object(s.useEffect)((()=>(Sh.addListener("skin",n),()=>{Sh.removeListener("skin",n)})),[n]),Object(s.useEffect)((()=>(Sh.addListener("seed",a),()=>{Sh.removeListener("seed",a)})),[a]);const o=Object(s.useCallback)(((t,i)=>{Sh.set("skin",e.skins[t]),Sh.set("weatherIndex",i)}),[e]),r=Object(s.useCallback)((t=>{Sh.set("skin",e.skins[t]),Sh.set("weatherIndex",0)}),[e]);let h=e.skins,l=e.skinNames,d=e.skinWeathers;return Object(Kd.jsxs)(fp,{icon:Uc,children:[h.length&&h.map(((e,t)=>Object(Kd.jsx)(Ap,{selected:e==i,icon:sp[l[e]],label:l[e],onMouseDown:()=>r(t),children:d[e].map(((s,n)=>Object(Kd.jsx)(cp,{canSelect:e==i,configKey:"weatherIndex",configVal:n,icon:ip[s],onMouseDown:()=>o(t,n)},n)))},e))),e.hasCycles&&Object(Kd.jsx)(dp,{}),Object(Kd.jsx)("div",{className:"stack-back",style:{width:"200px"}})]})},up=()=>{const[e,t]=Object(s.useState)(We.value.type);return Object(s.useEffect)((()=>(We.addListener("type",t),()=>{We.removeListener("type",t)})),[]),Object(Kd.jsxs)(fp,{icon:Oc,children:[ze.map((t=>Object(Kd.jsx)(Ap,{selected:t==e,icon:ke[t].icon,label:t.toLowerCase(),onMouseDown:()=>We.set("type",t)},"veh-type-"+t))),Object(Kd.jsx)("div",{className:"stack-back",style:{width:"200px"}})]})},gp=({toggleSplash:e})=>{const[t,i]=Object(s.useState)(null);return Object(Kd.jsxs)("div",{id:"menu-bar-right",children:[Object(Kd.jsx)(ep,{requestFocus:()=>i(1)}),Object(Kd.jsx)(xp,{canPin:2==t,requestFocus:()=>i(2)}),Object(Kd.jsx)(mp,{canPin:3==t,requestFocus:()=>i(3)}),Object(Kd.jsx)("div",{className:"menu-bar-vertical-divider"}),Object(Kd.jsx)(wp,{toggleSplash:e})]})},mp=({canPin:e,requestFocus:t})=>{const[i,n]=Object(s.useState)(!1),[a,o]=Object(s.useState)(!1),[r,h]=Object(s.useState)(Fd.value);Object(s.useEffect)((()=>(Fd.addListener(h),()=>{Fd.removeListener(h)})),[h]),Object(s.useEffect)((()=>{i?(Fd.disable(),h(!1),w.setMouseEnabled(!1)):w.setMouseEnabled(!0)}),[i]),Object(s.useEffect)((()=>{o(a&&e)}),[o,a,e]);let l=i&&e;return Object(Kd.jsxs)(Kd.Fragment,{children:[l&&Object(Kd.jsxs)(Kd.Fragment,{children:[Object(Kd.jsx)(zc,{onMouseEnter:e=>{n(!0)},onMouseLeave:e=>{n(a)},onMouseDown:e=>{o(!0)}}),Object(Kd.jsx)(vp,{onMouseDown:e=>{o(!1),n(!1)}})]}),Object(Kd.jsx)("div",{className:l?"menu-item item-selected":"menu-item",style:{padding:"0px 12px",width:"auto",textAlign:"right",display:"flex"},onMouseDown:e=>{o(!a),t()},onMouseEnter:e=>{n(!0),t()},onMouseLeave:e=>{n(a)},children:Object(Kd.jsx)("img",{alt:"",style:{height:"50%",marginTop:"25px",marginRight:"4px",transform:"translateY(-50%)"},src:Lc})}),r&&Object(Kd.jsxs)("div",{id:"fps-prompt",children:[Object(Kd.jsx)("span",{style:{fontSize:"18px",fontWeight:1e3},children:"Low FPS?"}),Object(Kd.jsx)("br",{}),"Try lowering the quality settings",Object(Kd.jsx)("br",{})," or enabling hardware acceleration",Object(Kd.jsx)("br",{}),Object(Kd.jsx)("span",{style:{paddingLeft:"calc(100% - 50px)"},children:"\u2193"})]})]})},xp=({canPin:e,requestFocus:t})=>{const[i,n]=Object(s.useState)(!1),[a,o]=Object(s.useState)(!1),[r,h]=Object(s.useState)(D.value);Object(s.useEffect)((()=>(D.addListener(h),()=>{D.removeListener(h)})),[h]),Object(s.useEffect)((()=>{i||a?w.setMouseEnabled(!1):w.setMouseEnabled(!0)}),[i,a]),Object(s.useEffect)((()=>{o(a&&e)}),[o,a,e]);let l=i&&e;return Object(Kd.jsxs)(Kd.Fragment,{children:[l&&Object(Kd.jsxs)(Kd.Fragment,{children:[Object(Kd.jsx)(Dc,{onMouseEnter:e=>{n(!0)},onMouseLeave:e=>{n(a)},onMouseDown:e=>{o(!0)}}),Object(Kd.jsx)(vp,{onMouseDown:e=>{o(!1),n(!1)}})]}),Object(Kd.jsx)("div",{className:l?"menu-item item-selected":"menu-item",style:{padding:"0px 12px",width:"auto",textAlign:"right",display:"flex"},onMouseDown:e=>{o(!a),t()},onMouseEnter:e=>{n(!0),t()},onMouseLeave:e=>{n(a)},children:Object(Kd.jsx)("img",{alt:"",style:{height:"50%",marginTop:"25px",marginRight:"4px",transform:"translateY(-50%)"},src:tp[r]})})]})},vp=({onMouseDown:e})=>Object(Kd.jsx)("div",{id:"input-blocker",onMouseDown:t=>{e(t),t.preventDefault()}}),wp=({toggleSplash:e})=>Object(Kd.jsx)(Kd.Fragment,{children:Object(Kd.jsx)("div",{className:"menu-item",onMouseDown:()=>e(),children:Object(Kd.jsx)(lp,{src:Xc})})}),fp=e=>{const[t,i]=Object(s.useState)(e.expanded);return Object(Kd.jsxs)("div",{className:e.highlight?"menu-item highlight":"menu-item",tabIndex:-1,onMouseEnter:()=>{var t;i(!0),null===(t=e.onExpanded)||void 0===t||t.call(e,!0)},onMouseLeave:()=>{var t;i(!1),null===(t=e.onExpanded)||void 0===t||t.call(e,!1)},children:[Object(Kd.jsx)(lp,{src:e.icon,onMouseDown:e.onMouseDown,highlight:e.highlight}),(t||e.expanded)&&Object(Kd.jsx)(bp,{children:e.children})]})},bp=e=>Object(Kd.jsx)("div",{className:"menu-stack",children:e.children}),Ap=e=>{const[t,i]=Object(s.useState)(e.expanded||e.pinned);return Object(s.useEffect)((()=>{i(e.pinned)}),[e.pinned]),Object(Kd.jsxs)("div",{className:e.selected?"menu-item item-selected":"menu-item",onMouseEnter:()=>{var t;i(!0),null===(t=e.onMouseEnter)||void 0===t||t.call(e)},onMouseLeave:()=>{var t;i(e.pinned),null===(t=e.onMouseLeave)||void 0===t||t.call(e)},children:[Object(Kd.jsx)("img",{className:"menu-icon",src:e.icon,alt:"",onMouseDown:()=>{var t;return null===(t=e.onMouseDown)||void 0===t?void 0:t.call(e)}}),t&&e.children?Object(Kd.jsx)(yp,{children:e.children}):Object(Kd.jsx)("div",{className:"stack-label",style:e.selected?{color:"#fff"}:{},onMouseEnter:()=>i(!0),onMouseLeave:()=>i(!1),children:e.label})]})},yp=e=>Object(Kd.jsx)("div",{className:"stack-row",children:e.children}),Ip=e=>Object(Kd.jsx)("div",{className:e.selected?"stack-row-item item-selected":"stack-row-item",onMouseDown:()=>{var t;return null===(t=e.onMouseDown)||void 0===t?void 0:t.call(e)},children:Object(Kd.jsx)(lp,{src:e.icon,text:e.text})});var Sp=np;i(47);const Mp=16,Dp=.0625;class Cp{constructor(e,t,i,s){this.origin={x:0,z:0},this.seenIndex=0,this.loadedNode=null,this.subNode=0,this.angles=[],this.pos={x:0,y:0},this.onLoadStateBound=this.onLoadState.bind(this),this.onTickBound=this.onTick.bind(this),this.progressCounter=0,this.tickTimer=0,this.svg=e,this.lineDOM=t,this.points=this.lineDOM.points,this.underlineDOM=i,this.uPoints=this.underlineDOM.points,this.circleDOM=s,this.loadedNode=ii.vehicleNode,this.seenIndex=ii.vehicleNode.i,this.baseA=ii.vehicleNode.a,this.angles.push(this.baseA),this.pA=this.baseA,this.pos.x=this.loadedNode.p.x,this.pos.y=this.loadedNode.p.z,d.addListener(this.onLoadStateBound),this.onLoadState(d.value)}onLoadState(e){e?ae.removeSlowListener(this.onTickBound):ae.addSlowListener(this.onTickBound)}makePoint(e,t){let i=this.svg.createSVGPoint();return i.x=e,i.y=t,i}destroy(){ae.removeSlowListener(this.onTickBound),d.removeListener(this.onLoadStateBound)}onTick(e){if(this.lerp=Math.floor(((e,t,i)=>{let s,n,a,o,r,h;return a=i.p.x,o=i.p.z,r=i.next.p.x,h=i.next.p.z,s=(r-a)*(r-a)+(h-o)*(h-o),n=((e-a)*(r-a)+(t-o)*(h-o))/s,isNaN(n)?0:Math.max(Math.min(n,1),0)})(be.position.x,be.position.z,ii.vehicleNode)*Mp),!(this.loadedNode.i==ii.vehicleNode.i+16&&this.lerp<=this.subNode)){for(;this.loadedNode.i<ii.vehicleNode.i+16;){for(this.i=this.subNode;this.i<Mp;this.i++)this.l=this.i/Mp,this.l1=1-this.l,this.p=this.makePoint(this.loadedNode.p.x*this.l1+this.loadedNode.next.p.x*this.l,this.loadedNode.p.z*this.l1+this.loadedNode.next.p.z*this.l),this.points.appendItem(this.p),this.uPoints.appendItem(this.p),this.baseA-=this.loadedNode.next.da*Dp,this.angles.push(this.baseA);this.loadedNode=this.loadedNode.next,this.progressCounter++,this.progressCounter>100&&Math.abs(this.loadedNode.a-this.baseA)<.1&&(this.baseA=this.loadedNode.a,this.progressCounter=0),this.subNode=0}for(this.i=this.subNode;this.i<this.lerp;this.i++)this.l=this.i/Mp,this.l1=1-this.l,this.p=this.makePoint(this.loadedNode.p.x*this.l1+this.loadedNode.next.p.x*this.l,this.loadedNode.p.z*this.l1+this.loadedNode.next.p.z*this.l),this.points.appendItem(this.p),this.uPoints.appendItem(this.p),this.baseA-=this.loadedNode.next.da*Dp,this.angles.push(this.baseA);for(this.subNode=this.lerp;this.points.length>256;)this.points.removeItem(0),this.uPoints.removeItem(0),this.angles.shift(),this.pos=this.points.getItem(0)}this.pA=.95*this.pA+.05*this.angles[0],this.transform="rotate("+(90-180*this.pA/Math.PI)+")",this.transform+=" translate("+-1*this.pos.x+" "+-1*this.pos.y+")",this.lineDOM.setAttribute("transform",this.transform),this.underlineDOM.setAttribute("transform",this.transform),this.circleDOM.setAttribute("cx",this.pos.x),this.circleDOM.setAttribute("cy",this.pos.y),this.circleDOM.setAttribute("transform",this.transform)}}var Np=n.a.memo((()=>{const e=Object(s.useRef)(null),t=Object(s.useRef)(null),i=Object(s.useRef)(null),n=Object(s.useRef)(null),a=Object(s.useRef)(null),[o,r]=Object(s.useState)(de.value),[h,l]=Object(s.useState)(te.value.ShowWorm);Object(s.useEffect)((()=>{if(null!==e.current&&null!==t.current&&null!==i.current&&null!==n.current)return a.current||(a.current=new Cp(e.current,t.current,i.current,n.current)),()=>{a.current&&a.current.destroy()}}),[e,t,i,n,a]),Object(s.useEffect)((()=>(de.addListener(r),()=>{de.removeListener(r)})),[r]),Object(s.useEffect)((()=>(te.addListener("ShowWorm",l),()=>{te.removeListener("ShowWorm",l)})),[r]);let d=h==q||h==K&&!o;return Object(Kd.jsx)("div",{id:"upcoming-container",style:{opacity:d?"1":"0"},children:Object(Kd.jsx)("svg",{ref:e,viewBox:"0 0 160 120",width:"100%",height:"100%",children:Object(Kd.jsxs)("g",{transform:"translate(80 96) scale(-0.5 -0.5)",children:[Object(Kd.jsx)("polyline",{ref:i,points:"",transform:"translate(0 0)",stroke:"#2224",strokeWidth:"24",strokeLinecap:"round",fill:"none"}),Object(Kd.jsx)("polyline",{ref:t,points:"",transform:"translate(0 0)",stroke:"#fff9",strokeWidth:"12",strokeLinecap:"round",fill:"none"}),Object(Kd.jsx)("circle",{ref:n,fill:"#444",r:"3"})]})})})}));i(48);const kp={edge:{title:"The Edge",body:'"No, it\'s not a bug! Stay on the road!"'}};var zp=()=>{const[e,t]=Object(s.useState)(null),[i,n]=Object(s.useState)(null);return Object(s.useEffect)((()=>(yl.addListener("any",t),()=>{yl.removeListener("any",t)})),[t]),Object(s.useEffect)((()=>{e&&n(kp[e])}),[e,n]),null!==e&&setTimeout((()=>{t(null)}),5e3),Object(Kd.jsx)("div",{id:"achievement",className:null!==e?"achievement-active":"",children:null!=i&&Object(Kd.jsxs)(Kd.Fragment,{children:[Object(Kd.jsx)("div",{id:"achievement-title",children:i.title}),Object(Kd.jsx)("div",{id:"achievement-body",children:i.body}),Object(Kd.jsx)("div",{id:"achievement-unlocked",children:"achievement unlocked"})]})})};var jp=Zh.top;i(49);const Lp=e=>{if("number"!==typeof e&&(e=parseFloat(e)),e<60)return e.toFixed(3);let t=Math.floor(e/60);return(e=(e-60*t).toFixed(3))<10&&(e="0"+e),t<10&&(t="0"+t),t+":"+e},Op=({view:e})=>Object(Kd.jsxs)("div",{id:"ui-records-leaderboard",children:[Object(Kd.jsxs)("div",{className:"ui-records-title",children:[Object(Kd.jsx)("div",{children:"Records"}),Object(Kd.jsxs)("div",{className:"ui-records-board-switch",children:[Object(Kd.jsx)("div",{className:"ui-records-board-switch-arrow",onMouseDown:()=>Ll.switchBoard(),children:"\u25c2"}),Object(Kd.jsx)("div",{className:"ui-records-board-switch-value",children:e.board}),Object(Kd.jsx)("div",{className:"ui-records-board-switch-arrow",onMouseDown:()=>Ll.switchBoard(),children:"\u25b8"})]}),"global"==e.board&&Object(Kd.jsxs)("div",{className:"ui-records-board-switch",children:[Object(Kd.jsx)("div",{className:"ui-records-board-switch-arrow",onMouseDown:()=>Ll.switchTime(),children:"\u25c2"}),Object(Kd.jsx)("div",{className:"ui-records-board-switch-value",children:"allTime"==e.time?"all time":"daily"}),Object(Kd.jsx)("div",{className:"ui-records-board-switch-arrow",onMouseDown:()=>Ll.switchTime(),children:"\u25b8"})]})]}),"personal"==e.board?Object(Kd.jsx)(Rp,{topography:e.topography,vehicle:e.vehicle}):Object(Kd.jsx)(Tp,{time:e.time,topography:e.topography,vehicle:e.vehicle})]}),Rp=({topography:e,vehicle:t})=>{const[i,n]=Object(s.useState)(zl.personal),a=Object(s.useCallback)((e=>{n({...e})}),[n]);Object(s.useEffect)((()=>(zl.addListener("personal",a),()=>{zl.removeListener("personal",a)})),[a]);const o=i[e][t];return Object(Kd.jsxs)("div",{className:"ui-records-row",children:[Object(Kd.jsx)("div",{className:"ui-records-record",children:"Fastest Mile:"}),Object(Kd.jsx)("div",{className:"ui-records-value",children:o<0?"-":Lp(o)})]})},Tp=({time:e,topography:t,vehicle:i})=>{var n,a;const[o,r]=Object(s.useState)(Ll.global);Object(s.useEffect)((()=>(Ll.addListener("global",r),()=>{Ll.removeListener("global",r)})),[r]);let h=null;return o&&(h=o[e][t][i]),h?Object(Kd.jsxs)("div",{className:"ui-records-row",children:[Object(Kd.jsx)("div",{className:"ui-records-record",children:"Fastest Mile:"}),Object(Kd.jsx)("div",{className:"ui-records-value",children:(null===(n=h)||void 0===n||null===(a=n.fastestMile)||void 0===a?void 0:a.value)>0?Lp(h.fastestMile.value):"-"}),Object(Kd.jsx)("div",{className:"ui-records-addendum",children:h.fastestMile.name})]}):Object(Kd.jsx)("div",{className:"ui-records-row",style:{fontStyle:"italic"},children:"Could not connect"})},Pp=e=>{const[t,i]=Object(s.useState)(zl.live),n=Object(s.useCallback)((e=>{i({...e})}),[i]);return Object(s.useEffect)((()=>(zl.addListener("live",n),()=>{zl.removeListener("live",n)})),[n]),Object(Kd.jsxs)("div",{id:"ui-records-current",children:[Object(Kd.jsx)("div",{className:"ui-records-title",children:"Current"}),Object(Kd.jsxs)("div",{className:"ui-records-row",children:[Object(Kd.jsx)("div",{className:"ui-records-record",children:"Fastest Mile:"}),Object(Kd.jsx)("div",{className:"ui-records-value",children:t.value<0?"-":Lp(t.value.toFixed(3))}),Object(Kd.jsxs)("div",{className:"ui-records-addendum",children:[Object(Kd.jsx)("div",{className:"ui-records-progress",children:Object(Kd.jsx)("div",{className:"ui-records-progress-fill",style:{width:100*t.progress+"%"}})}),Object(Kd.jsx)("img",{alt:"",src:sc,className:"ui-records-reset",onMouseDown:()=>{Tl.resetFastestMile()}})]})]}),Object(Kd.jsxs)("div",{className:"ui-records-row",children:[Object(Kd.jsx)("div",{className:"ui-records-record",style:{fontSize:"14px",fontStyle:"italic"},children:"previous:"}),Object(Kd.jsx)("div",{className:"ui-records-value",style:{fontSize:"12px"},children:t.prev<=0?"-":Lp(t.prev)}),Object(Kd.jsx)("div",{className:"ui-records-addendum",style:{fontSize:"10px"}})]})]})};var Gp=e=>{var t;const[i,n]=Object(s.useState)(Rl.value),[a,o]=Object(s.useState)(Ll.view);return Object(s.useEffect)((()=>(Rl.addListener(n),()=>{Rl.removeListener(n)})),[]),Object(s.useEffect)((()=>(Ll.addListener("view",o),()=>{Ll.removeListener("view",o)})),[o]),i?Object(Kd.jsxs)("div",{id:"ui-records-main",children:[Object(Kd.jsxs)("div",{id:"ui-records-header",children:[Object(Kd.jsx)("div",{id:"ui-records-title",children:"STATS"}),Object(Kd.jsx)("div",{id:"ui-records-category",children:a.topography+" / "+(null===(t=a.vehicle)||void 0===t?void 0:t.toLowerCase())})]}),Object(Kd.jsx)(Op,{view:a}),Object(Kd.jsx)("br",{}),Object(Kd.jsx)(Pp,{})]}):Object(Kd.jsx)(Kd.Fragment,{children:" "})};const Bp=!0;window.localStorage.removeItem("reloading");const Wp=n.a.memo((()=>{const e=Object(s.useRef)(null),t=Object(s.useRef)(null),i=Object(s.useRef)(null),[n,a]=Object(s.useState)(Bp),[o,r]=Object(s.useState)(!0),[h,l]=Object(s.useState)(0),[d,c]=Object(s.useState)(null),[p,u]=Object(s.useState)(!1),[g,m]=Object(s.useState)(!1),x=Object(s.useCallback)((()=>{n?ae.resume(!0):ae.pause(!0),!p&&n&&u(!0),a(!n)}),[a,n,u,p]),v=Object(s.useCallback)((()=>{e.current.focus(),r(!o)}),[r,o]);Object(s.useEffect)((()=>(w.addListener(V.Esc,x),()=>{w.removeListener(V.Esc,x)})),[x]),Object(s.useEffect)((()=>(Y.addListener("ToggleUI",v),()=>{Y.removeListener("ToggleUI",v)})),[v]),Object(s.useEffect)((()=>(se.addListener(m),()=>{se.removeListener(m)})),[m]),Object(s.useEffect)((()=>{if(null===e.current||null===t.current)return;if(new ResizeObserver((t=>{i.current&&e.current&&i.current.setSize(e.current.offsetWidth,e.current.offsetHeight)})).observe(e.current),!i.current&&p){if(U)return;i.current=new Ed(t.current,e.current,c,l),i.current.beginGame()}return()=>{i.current}}),[p]);const f=h<1;return Object(Kd.jsxs)("div",{id:"game-main",ref:e,tabIndex:1,className:"render-panel",children:[n&&Object(Kd.jsx)(ec,{supported:!U,loadProgress:h,gameHasBegun:p,onClose:()=>{var e;x(),null===(e=i.current)||void 0===e||e.beginGame()}}),null!==d&&Object(Kd.jsx)(Qp,{msg:d}),p&&Object(Kd.jsxs)("div",{id:"game-ui",style:{display:n||!o?"none":"block"},onContextMenu:e=>{e.preventDefault()},children:[Object(Kd.jsx)(Zp,{}),Object(Kd.jsx)(zp,{}),Object(Kd.jsx)(Hp,{sceneController:i}),Object(Kd.jsx)("div",{id:"game-paused",onClick:()=>{g?se.disable():ae.resume(!0)},children:1==g?Object(Kd.jsxs)("div",{className:"game-paused-ha",children:["Critically low FPS detected - check you have hardware acceleration enabled for your browser.",Object(Kd.jsx)("br",{}),Object(Kd.jsx)("br",{}),"You may have to check your browser settings, GPU control panel, or OS settings for your browser application.",Object(Kd.jsx)("br",{}),Object(Kd.jsx)("br",{}),"Refresh the page to dismiss this message.",Object(Kd.jsx)("br",{})]}):Object(Kd.jsx)("div",{className:"game-paused-main",children:"PAUSED"})}),Object(Kd.jsx)(Gp,{}),Object(Kd.jsx)(Ep,{}),Object(Kd.jsx)(Sp,{toggleSplash:x}),Object(Kd.jsx)(dc,{}),f?Object(Kd.jsx)(Fp,{loadProgress:h}):Object(Kd.jsx)(Np,{}),Object(Kd.jsx)("div",{id:"game-ui-backing"})]}),Object(Kd.jsxs)("div",{id:"ui-debug",children:[Object(Kd.jsxs)("div",{className:"ui-debug-row",children:[Object(Kd.jsx)("div",{className:"ui-debug-label",children:"Position:"}),Object(Kd.jsx)("div",{id:"ui-debug-position",children:"1, 2, 3"})]}),Object(Kd.jsxs)("div",{className:"ui-debug-row",children:[Object(Kd.jsx)("div",{className:"ui-debug-label",children:"Far Coords:"}),Object(Kd.jsx)("div",{id:"ui-debug-far-coords",children:"1, 2, 3"})]}),Object(Kd.jsxs)("div",{className:"ui-debug-row",children:[Object(Kd.jsx)("div",{className:"ui-debug-label",children:"Vehicle Node:"}),Object(Kd.jsx)("div",{id:"ui-debug-node",children:"1"})]}),Object(Kd.jsxs)("div",{className:"ui-debug-row",children:[Object(Kd.jsx)("div",{className:"ui-debug-label",children:"Midline Tail:"}),Object(Kd.jsx)("div",{id:"ui-debug-midline-tail",children:"123"})]}),Object(Kd.jsx)("hr",{})]}),Object(Kd.jsx)("canvas",{ref:t,id:"render-canvas",tabIndex:-1,onContextMenu:e=>{e.preventDefault()}})]})}));-1==Hd.indexOf(btoa(Zd))&&(jp[atob("bG9jYXRpb24=")]=atob("aHR0cHM6Ly9mcmVlemVub3ZhLmdhbWVz"));const Fp=({loadProgress:e})=>Object(Kd.jsx)("div",{id:"live-loader-bg",children:Object(Kd.jsxs)("div",{id:"live-loader",children:[Object(Kd.jsx)("div",{className:"live-load-text",children:Math.round(100*e)+"%"}),Object(Kd.jsx)("div",{className:"live-load-bar",style:{width:100*e+"%"}}),Object(Kd.jsx)("div",{className:"live-load-title",children:"generating..."})]})}),Ep=()=>{const[e,t]=Object(s.useState)(de.value);return Object(s.useEffect)((()=>(de.addListener(t),()=>{de.removeListener(t)})),[t]),Object(Kd.jsxs)("div",{id:"autodrive",className:e?"autodrive-active":"",onMouseDown:()=>de.set(!e),children:[Object(Kd.jsx)("div",{className:e?"autodrive-bar autodrive-bar-left autodrive-bar-active":"autodrive-bar autodrive-bar-left"}),Object(Kd.jsxs)("div",{id:"autodrive-button",children:["autodrive ",e?"on":"off"]}),Object(Kd.jsx)("div",{className:e?"autodrive-bar autodrive-bar-right autodrive-bar-active":"autodrive-bar autodrive-bar-right"})]})},Zp=()=>{const[e,t]=Object(s.useState)(Vl.value),[i,n]=Object(s.useState)(Vl.value);return Object(s.useEffect)((()=>(Vl.addListener(t),()=>{Vl.removeListener(t)})),[t]),Object(s.useEffect)((()=>{e!==El.None&&n(e)}),[e,n]),Object(Kd.jsxs)("div",{id:"control-prompt",style:{opacity:Vl.value},children:[i==El.Basic&&Object(Kd.jsxs)(Kd.Fragment,{children:[Object(Kd.jsxs)("div",{children:[Object(Kd.jsx)("div",{className:"control-key-row",children:Object(Kd.jsx)("div",{className:"control-key",children:"W"})}),Object(Kd.jsxs)("div",{className:"control-key-row",children:[Object(Kd.jsx)("div",{className:"control-key",children:"A"}),Object(Kd.jsx)("div",{className:"control-key",children:"S"}),Object(Kd.jsx)("div",{className:"control-key",children:"D"})]}),Object(Kd.jsx)("div",{className:"control-label",children:"drive"})]}),Object(Kd.jsxs)("div",{style:{width:"18vh"},children:[Object(Kd.jsxs)("div",{className:"control-key-row",style:{marginTop:"5.8vh"},children:[Object(Kd.jsx)("div",{className:"control-key",children:"Q"}),Object(Kd.jsx)("div",{className:"control-key",children:"E"})]}),Object(Kd.jsx)("div",{className:"control-label",children:"change setting"})]}),Object(Kd.jsxs)("div",{style:{width:"18vh"},children:[Object(Kd.jsx)("div",{className:"control-key-row",style:{marginTop:"5.8vh"},children:Object(Kd.jsx)("div",{className:"control-key",children:"C"})}),Object(Kd.jsx)("div",{className:"control-label",children:"change camera"})]}),Object(Kd.jsxs)("div",{style:{width:"18vh"},children:[Object(Kd.jsx)("div",{className:"control-key-row",style:{marginTop:"5.8vh"},children:Object(Kd.jsx)("div",{className:"control-key",children:"F"})}),Object(Kd.jsx)("div",{className:"control-label",children:"toggle autodrive"})]})]}),i==El.Reset&&Object(Kd.jsxs)("div",{style:{width:"18vh"},children:[Object(Kd.jsx)("div",{className:"control-key-row",style:{marginTop:"6.5vh"},children:Object(Kd.jsx)("div",{className:"control-key",children:"R"})}),Object(Kd.jsx)("div",{className:"control-label",children:"stay on the road"})]}),i==El.Boost&&Object(Kd.jsxs)("div",{style:{width:"18vh"},children:[Object(Kd.jsx)("div",{className:"control-key-row",style:{marginTop:"6.5vh"},children:Object(Kd.jsx)("div",{className:"control-key",style:{width:"8vh"},children:"shift"})}),Object(Kd.jsx)("div",{className:"control-label",children:"hold to boost acceleration"})]}),i==El.UTurn&&Object(Kd.jsxs)("div",{style:{width:"18vh"},children:[Object(Kd.jsx)("div",{className:"control-key-row",style:{marginTop:"6.5vh"},children:Object(Kd.jsx)("img",{id:"wrong-way-icon",src:Yd,alt:""})}),Object(Kd.jsx)("div",{className:"control-label",children:"wrong way"})]}),i==El.Reverse&&Object(Kd.jsxs)("div",{style:{width:"18vh"},children:[Object(Kd.jsx)("div",{className:"control-key-row",style:{marginTop:"6.5vh"},children:Object(Kd.jsx)("img",{id:"wrong-way-icon",src:Vd,alt:""})}),Object(Kd.jsx)("div",{className:"control-label",children:"keep moving forward"})]})]})},Hp=({sceneController:e})=>{const[t,i]=Object(s.useState)(D.value),[n,a]=Object(s.useState)(m.axisWidth);Object(s.useEffect)((()=>(D.addListener(i),()=>D.removeListener(i))),[i]);const o=1==t;return Object(s.useEffect)((()=>(m.addListener("axisWidth",a),()=>m.removeListener("axisWidth",a))),[a]),Object(Kd.jsxs)("div",{id:"ui-mouse",style:{bottom:"calc("+c.mouseWidgetHeight+"vh + 25px)",display:o?"block":"none"},children:[Object(Kd.jsx)("div",{id:"ui-mouse-prompt",children:"[ click to begin ]"}),Object(Kd.jsxs)("div",{id:"ui-mouse-input",style:{width:"max(320px, "+100*n+"vw)"},children:[Object(Kd.jsxs)("div",{className:"ui-mouse-bar",children:[Object(Kd.jsx)("div",{className:"ui-mouse-bar-line"}),Object(Kd.jsx)("div",{className:"ui-mouse-bar-midline"})]}),Object(Kd.jsx)("div",{id:"ui-mouse-bar-marker",children:Object(Kd.jsx)("div",{className:"ui-mouse-bar-marker-tick"})})]}),Object(Kd.jsx)("div",{className:"ui-mouse-bar-boundary"}),Object(Kd.jsx)("div",{className:"ui-mouse-reset",onMouseDown:t=>{var i;null===(i=e.current)||void 0===i||i.resetVehicle(),t.preventDefault(),t.stopPropagation()},children:"reset"})]})},Qp=({msg:e})=>Object(Kd.jsxs)("div",{id:"game-error",children:[Object(Kd.jsx)("img",{id:"game-error-icon",src:Qd,alt:""}),Object(Kd.jsx)("br",{}),Object(Kd.jsx)("br",{}),Object(Kd.jsx)("div",{id:"game-error-title",children:"Critical Error"}),Object(Kd.jsx)("br",{}),Object(Kd.jsxs)("div",{id:"game-error-message",children:["Apologies - please click below to continue with a different generation seed. Your distance progress will carry over.",Object(Kd.jsx)("br",{}),Object(Kd.jsx)("br",{}),"This error has been recorded for investigation."]}),Object(Kd.jsx)("br",{}),Object(Kd.jsx)("br",{}),Object(Kd.jsx)("div",{id:"game-error-reload",onMouseDown:()=>{window.localStorage.setItem("restore-progress",ii.vehicleIndex-ii.initIndex+Sh.accumulatedProgress),Ye(null,!0)},children:"reload"})]});var Yp=Wp;const Vp=()=>Object(Kd.jsx)("div",{className:"App",children:Object(Kd.jsx)(Yp,{})});var Up=function(){return Object(Kd.jsx)(Vp,{})};i(27),i(3),i(50);Kd.Fragment,Kd.Fragment;i(51);var Xp=i(28);const Jp={sessionCount:0,pastSessionCount:0,averages:{duration:0,distance:0,resetCount:0,skins:{},difficultyResets:{easy:0,normal:0,hard:0},skinChanges:0,weatherChanges:0,vehicleChanges:0,driveModeChanges:0,cruiseControlSpeed:0,fps:0,autodriveTime:0},maxes:{duration:0,distance:0},cumulatives:{difficulty:{easy:0,normal:0,hard:0},totalVisits:0,viewDistance:[],detailLevel:[],returningPlayers:0,revisits:0,skinTimes:{},driveModeTimes:{},stickySteer:0,cruiseControlUses:0,browser:{},hourlyVisits:[],lowFPS:0,lowFPSBrowser:{},lowFPSResolution:{},lowFPSView:[0,0,0,0],lowFPSDetail:[0,0,0,0],location:{}},poorPerformance:[],activeSessions:{},feedback:[],quarterlyActiveSessions:[],quarterlyCumulativeSessions:[],pastSessions:[],upTime:0};new class{constructor(){this.connected=!1,this.sessionCount=0,this.pastSessionCount=0,this.averages={duration:0,distance:0,resetCount:0,skins:{},difficultyResets:{easy:0,normal:0,hard:0},skinChanges:0,weatherChanges:0,vehicleChanges:0,driveModeChanges:0,autodriveTime:0},this.maxes={duration:0,distance:0},this.cumulatives={totalVisits:0,revisits:0,mobileVisits:0,returningPlayers:0,difficulty:{easy:0,normal:0,hard:0},viewDistance:[],detailLevel:[],skinTimes:{},driveModeTimes:{},hourlyVisits:[],browser:{}},this.activeSessions={},this.feedback=[],this.quarterlyActiveSessions=[],this.quarterlyCumulativeSessions=[],this.poorPerformance=[],this.pastSessions=[],this.upTime=0,this.callbacks={},this.setConnected=()=>{};for(let e in Jp)this.callbacks[e]=()=>{}}initialise(){this.connected||(console.log("yada yada"),this.socket=Object(Xp.a)(""),this.socket.on("connect",(()=>{console.log("Got connect"),this.socket.emit("request-dash",window.location.hash.slice(1))})),this.socket.on("connect_error",(()=>{this.setConnected(!1)})),this.socket.on("disconnect",(()=>{this.setConnected(!1)})),this.socket.on("authenticated",(e=>{console.log("Authenticated"),console.log(e),this.connected=!0,this.setConnected(!0),this.parseData(e)})),this.socket.on("dash-update",(e=>{this.parseData(e)})))}parseData(e){for(let t in e)"dashSessionCount"!==t&&"dashSessions"!==t&&(this[t]=e[t],"averages"==t&&(e.averages.autodriveTime=qp(e.averages.autodriveTime),e.averages.duration=qp(e.averages.duration)),this.callbacks[t](this[t]))}addCallback(e,t){this.callbacks[e]=t}};function qp(e){let t=e/1e3,i=t/60;t%=60;let s=i/60;return i%=60,Kp(Math.floor(s))+":"+Kp(Math.floor(i))+":"+Kp(Math.floor(t))}function Kp(e){return e<10?"0"+e:""+e}Math.PI;const _p={layer:0,d:0,h:0,sq:0,sqb:0,wx:0,wz:0,ox:0,oz:0,px:0,pz:0,cell:null,ix:0,iz:0,depth:0};new r.D({vertexColors:!0}),new r.Q({uniforms:{groundCol:{value:new r.i(4473924)}},vertexShader:"\n  attribute float gradient;\n\n  varying vec4 col;\n\n  varying float height;\n  varying float vGradient;\n\n  void main() {\n    vec4 wPos = modelMatrix * vec4( position, 1.0 );\n\n    // col.x = 0.5;\n    // col.y = wPos.y / 1000.0; // Height range between black and white // doesn't get used\n    // col.z = 0.5;\n    // col.w = 1.0;\n\n    height = wPos.y / 200.0; // clamp between 0 and 1 if possible? choose something matched to scene, 200m max range\n\n    vGradient = gradient;\n\n    gl_Position = projectionMatrix * modelViewMatrix * vec4( position.x, 0.0, position.z, 1.0 );\n  }\n",fragmentShader:"\n\nvarying vec4 col;\nvarying float height;\nvarying float vGradient;\n\nvoid main() {\n\n  float hh = mod(height * 200.0, 5.0); // mod is spacing between lines, height converted back to metres\n\n  // swap - and pos tan for whack art\n  // Use atan for more accurate version\n\n  float boundA = 0.1 + vGradient * 0.25;// + tan(vGradient);//*vGradient*0.25;\n\n  float addB = 0.1 + vGradient * 0.25;\n  float boundB = 5.0 - addB;\n\n  if(hh < boundA) {\n    if(hh < boundA * 0.6) {\n      hh = 0.0;\n    } else {\n      hh = (hh - boundA * 0.6) / (boundA * 0.4);\n    }\n  } else if(hh > boundB) {\n    if(hh > 5.0 - (addB * 0.4)) {\n      hh = 1.0 - (hh - (addB * 0.4)) / (addB * 0.6);\n    } else {\n      hh = 1.0;\n    }\n  } else {\n    hh = 1.0;\n  }\n\n  vec3 base = vec3(0.0, 0.0, 0.0);\n  // vec3 base = vec3(height);\n  vec3 topo = vec3(hh, hh, hh);\n\n  gl_FragColor = vec4(mix(base, topo, 1.0), 1.0);\n}\n\n"}),new r.a(16777215,.1),new r.s(16777215,16777215,.2),new r.j(16777215,.6);var $p=e=>{e&&e instanceof Function&&i.e(3).then(i.bind(null,58)).then((({getCLS:t,getFID:i,getFCP:s,getLCP:n,getTTFB:a})=>{t(e),i(e),s(e),n(e),a(e)}))};o.a.render(Object(Kd.jsx)(n.a.StrictMode,{children:Object(Kd.jsx)(Up,{})}),document.getElementById("root")),$p()}],[[57,1,2]]]);